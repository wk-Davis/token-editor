{"version":3,"sources":["envvars.ts","assets/index.ts","features/canvas/Canvas.tsx","features/editor/editorUtil.tsx","features/colorPicker/colorUtil.tsx","features/colorPicker/hue/Hue.tsx","features/colorPicker/hue/hueUtil.tsx","features/colorPicker/saturation/Saturation.tsx","features/colorPicker/saturation/saturationUtil.tsx","features/colorPicker/ColorPicker.tsx","assets/icons/chevron_right-18dp.tsx","assets/icons/save_alt-18dp.tsx","features/editor/EditorHeader.tsx","features/menu/Menu.tsx","features/listItem/ListItem.tsx","features/editor/Editor.tsx","features/grid/GridHeader.tsx","features/grid/Grid.tsx","App.tsx","serviceWorker.ts","index.tsx","features/canvas/fabric.js","assets/icons/chevron_right-18dp.svg","assets/tokens/cleric/cloak.png","assets/tokens/cleric/hair.png","assets/tokens/cleric/lineart.png","assets/tokens/cleric/mace_handle.png","assets/tokens/cleric/mace_head.png","assets/tokens/cleric/shield.png","assets/tokens/cleric/shoes.png","assets/tokens/cleric/skin.png","assets/tokens/cleric/skirt.png","assets/tokens/cleric/sleeves.png","assets/tokens/cleric/top.png","assets/tokens/inquisitor/lineart.png","assets/tokens/gunslinger/lineart.png","assets/tokens/monk/lineart.png","assets/tokens/ranger/lineart.png"],"names":["envvars","REACT_APP_DELIMITER","REACT_APP_BASE","REACT_APP_FILETYPE","REACT_APP_TOKEN_PATH","process","config","cleric","cloak","color","src","cleric_cloak","hair","cleric_hair","lineart","cleric_lineart","mace_handle","cleric_mace_handle","mace_head","cleric_mace_head","shield","cleric_shield","shoes","cleric_shoes","skin","cleric_skin","skirt","cleric_skirt","sleeves","cleric_sleeves","top","cleric_top","gunslinger","gunslinger_lineart","inquisitor","inquisitor_lineart","monk","monk_lineart","ranger","ranger_lineart","Canvas","saveCanvas","state","token","canvasRef","useRef","fabricCanvas","useEffect","current","fabric","StaticCanvas","data","toDataURL","format","multiplier","enableRetinaScaling","saveAs","sources","tokenConfig","Object","keys","reduce","srcs","filename","getSources","forEach","key","Image","fromURL","img","filter","filters","BlendColor","mode","alpha","applyFilters","add","name","bringToFront","sendToBack","clear","getObjects","renderAll","height","ref","width","simpleCheckForValidColor","checked","passed","letter","isNaN","test","toState","oldHue","tinycolor","hex","hsl","toHsl","hsv","toHsv","rgb","toRgb","toHex","s","h","a","Hue","onChange","container","pointerPosition","left","handleChange","e","change","containerWidth","clientWidth","pageX","touches","getBoundingClientRect","window","pageXOffset","l","calculateChange","className","onClick","onMouseDown","onTouchMove","onTouchStart","draggable","onDrag","onDragEnd","style","Saturation","v","backgroundColor","background","containerHeight","pageY","x","y","pageYOffset","saturation","bright","ColorPicker","stateColor","isOpen","pickerOpen","setColor","setIsOpen","setPickerOpen","useState","utils","ownColor","setOwnColor","newColor","iconColor","mostReadable","level","size","transform","title","alt","chevron_right","chevronRight","xmlns","viewBox","fill","d","saveAlt","EditorHeader","unsetToken","icon","strategy","alignEnd","accent","saveIcon","GroupHandle","props","ripple","Menu","prevGroup","listItems","filenames","sort","comps","delimiterIndex","indexOf","groupName","substring","groupKeys","startsWith","push","handle","map","Fragment","InputListItem","selectComponent","selected","styles","toHexString","tabIndex","id","newVal","currentTarget","value","replace","slice","onFocus","stopPropagation","type","toUpperCase","Editor","selectedComponent","getState","tokenState","setTokenState","callback","timeout","debouncedFunction","cancelDebouncedCallback","useCallback","clearTimeout","args","setTimeout","useDebouncedCallback","prevState","setOpen","shouldWait","useThrottledCallback","componentNames","getComponentNames","items","GridHeader","Grid","setToken","tokenNames","tag","use","withTextProtection","isAvailable","item","App","selectedToken","setSelectedToken","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message","version","exports","HTMLDocument","Document","implementation","createHTMLDocument","virtualWindow","require","JSDOM","decodeURIComponent","features","FetchExternalResources","resources","jsdomImplForWrapper","implForWrapper","nodeCanvas","copyGLTo2DDrawImage","gl","pipelineState","glCanvas","canvas","targetCanvas","ctx","getContext","translate","scale","sourceY","drawImage","copyGLTo2DPutImageData","dWidth","destinationWidth","dHeight","destinationHeight","numBytes","u8","Uint8Array","this","imageBuffer","u8Clamped","Uint8ClampedArray","readPixels","RGBA","UNSIGNED_BYTE","imgData","ImageData","putImageData","isTouchSupported","maxTouchPoints","isLikelyNode","Buffer","SHARED_ATTRIBUTES","DPI","reNum","rePathCommand","reNonWord","fontPaths","iMatrix","svgNS","perfLimitSizeTotal","maxCacheSideLimit","minCacheSideLimit","charWidthsCache","textureSize","disableStyleCopyPaste","enableGLFiltering","devicePixelRatio","webkitDevicePixelRatio","mozDevicePixelRatio","browserShadowBlurConstant","arcToSegmentsCache","boundsOfCurveCache","cachesBoundsOfCurve","forceGLPutImageData","initFilterBackend","isWebglSupported","log","maxTextureSize","WebglFilterBackend","tileSize","Canvas2dFilterBackend","_removeEventListener","eventName","handler","__eventListeners","eventListener","util","array","observe","arguments","length","prop","on","stopObserving","call","fire","options","listenersForEvent","i","len","Observable","off","trigger","Collection","_objects","apply","_onObjectAdded","renderOnAddRemove","requestRenderAll","insertAt","object","index","nonSplicing","objects","splice","remove","somethingRemoved","_onObjectRemoved","forEachObject","context","concat","o","isEmpty","contains","complexity","memo","CommonMethods","_setOptions","set","_initGradient","filler","property","colorStops","Gradient","_initPattern","source","Pattern","_initClipping","clipTo","functionBody","getFunctionBody","_setObject","obj","_set","get","toggle","global","sqrt","Math","atan2","pow","PiBy180","PI","PiBy2","cos","angle","sin","sign","removeFromArray","idx","getRandomInt","min","max","floor","random","degreesToRadians","degrees","radiansToDegrees","radians","rotatePoint","point","origin","subtractEquals","rotateVector","Point","addEquals","vector","transformPoint","p","t","ignoreOffset","makeBoundingBoxFromPoints","points","xPoints","minX","yPoints","minY","invertTransform","r","toFixed","number","fractionDigits","parseFloat","Number","parseUnit","fontSize","unit","exec","Text","DEFAULT_SVG_FONT_SIZE","falseFunction","getKlass","namespace","string","camelize","charAt","resolveNamespace","getSvgAttributes","attributes","parts","split","loadImage","url","crossOrigin","createImage","onLoadCallback","onload","onerror","loadImageInDom","div","createElement","position","appendChild","querySelector","parentNode","removeChild","enlivenObjects","reviver","enlivenedObjects","numLoadedObjects","numTotalObjects","onLoaded","fromObject","enlivenPatterns","patterns","numLoadedPatterns","numPatterns","enlivenedPatterns","pattern","groupSVGElements","elements","path","centerPoint","Group","sourcePath","populateWithProperties","destination","properties","prototype","toString","drawDashedLine","x2","y2","da","dx","dy","rot","dc","di","draw","save","moveTo","rotate","restore","createCanvasElement","copyCanvasElement","newCanvas","canvasEl","quality","clipContext","receiver","beginPath","clip","multiplyTransformMatrices","b","is2x2","qrDecompose","denom","scaleX","scaleY","skewX","skewY","translateX","translateY","calcRotateMatrix","theta","calcDimensionsMatrix","scaleMatrix","flipX","flipY","multiply","tan","composeMatrix","matrix","customTransformMatrix","resetObjectTransform","target","saveObjectTransform","fn","String","isTransparent","tolerance","_isTransparent","imageData","getImageData","parsePreserveAspectRatioAttribute","attribute","align","meetOrSlice","aspectRatioAttrs","pop","alignX","alignY","clearFabricFontCache","fontFamily","toLowerCase","limitDimsByArea","ar","maximumArea","roughWidth","perfLimitSizeY","capValue","findScaleToFit","findScaleToCover","matrixToSVG","NUM_FRACTION_DIGITS","join","_join","Array","arcToSegments","toX","toY","rx","ry","large","sweep","rotateX","argsString","th","sinTh","cosTh","fromX","fromY","px","py","rx2","abs","ry2","py2","px2","pl","root","cx","cy","cx1","cy1","mTheta","calcVectorAngle","dtheta","segments","ceil","result","mDelta","mT","th3","segmentToBezier","th2","costh2","sinth2","costh3","sinth3","ux","uy","vx","vy","ta","tb","getBoundsOfCurve","x0","y0","x1","y1","x3","y3","c","t1","t2","b2ac","sqrtb2ac","tvalues","bounds","mt","j","jlen","drawArc","fx","fy","coords","segs","segsNorm","bezierCurveTo","getBoundsOfArc","tx","ty","bound","find","byProperty","condition","k","invoke","method","value1","value2","extend","deep","Element","hasOwnProperty","clone","getWholeChar","str","code","charCodeAt","Error","next","prev","character","capitalize","firstLetterOnly","escapeXml","graphemeSplit","textstring","chr","graphemes","emptyFunction","IS_DONTENUM_BUGGY","addMethods","klass","parent","superclass","constructor","returnValue","valueOf","Subclass","callSuper","methodName","parentMethod","_this","superClassMethod","createClass","initialize","shift","subclasses","parseEl","supportsOpacity","opacity","supportsFilters","reOpacity","setOpacity","element","es","currentStyle","hasLayout","zoom","setStyle","elementStyle","cssText","styleFloat","_slice","sliceCanConvertNodelists","getElementStyle","toArray","arrayLike","childNodes","err","makeElement","tagName","el","htmlFor","setAttribute","getScrollLeftTop","docElement","documentElement","body","scrollLeft","scrollTop","host","nodeType","arr","defaultView","getComputedStyle","attr","undefined","selectProp","makeElementUnselectable","onselectstart","unselectable","makeElementSelectable","getScript","headEl","getElementsByTagName","scriptEl","loading","onreadystatechange","readyState","event","getById","addClass","wrapElement","wrapper","replaceChild","getElementOffset","docElem","scrollLeftTop","doc","ownerDocument","box","offset","offsetAttributes","borderLeftWidth","borderTopWidth","paddingLeft","paddingTop","parseInt","clientLeft","clientTop","getNodeCanvas","impl","_canvas","_image","cleanUpJsdomNode","_currentSrc","_attributes","_classList","warn","noop","defaultEasing","_requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","_cancelAnimFrame","cancelAnimationFrame","requestAnimFrame","animate","timestamp","time","start","Date","duration","finish","abort","onComplete","easing","startValue","endValue","byValue","onStart","tick","ticktime","currentTime","timePerc","valuePerc","cancelAnimFrame","animateColor","fromColor","toColor","startColor","Color","getSource","endColor","begin","end","pos","calculateColor","colorEasing","normalize","asin","elastic","opts","easeInBounce","easeOutBounce","ease","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInOutBounce","that","scalarAdd","scalar","scalarAddEquals","subtract","scalarSubtract","scalarSubtractEquals","multiplyEquals","divide","divideEquals","eq","lt","lte","gt","gte","lerp","distanceFrom","midPointFrom","setXY","setX","setY","setFromPoint","swap","Intersection","status","appendPoint","appendPoints","intersectLineLine","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","intersectLinePolygon","inter","intersectPolygonPolygon","points1","points2","intersectPolygonRectangle","r1","r2","topRight","bottomLeft","inter1","inter2","inter3","inter4","_tryParsingColor","setSource","hue2rgb","q","colorNameMap","sourceFromHex","sourceFromRgb","sourceFromHsl","_rgbToHsl","g","round","_source","toRgba","toHsla","toHexa","getAlpha","setAlpha","toGrayscale","average","currentAlpha","toBlackWhite","threshold","overlayWith","otherColor","otherSource","reRGBa","reHSLa","reHex","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","fromRgb","fromSource","fromRgba","fromHsl","fromHsla","fromHex","isShortNotation","isRGBa","oColor","CANVAS_INIT_ERROR","renderAndResetBound","renderAndReset","bind","requestRenderAllBound","_initStatic","backgroundImage","overlayColor","overlayImage","includeDefaultValues","stateful","controlsAboveOverlay","allowTouchScrolling","imageSmoothingEnabled","viewportTransform","backgroundVpt","overlayVpt","onBeforeScaleRotate","vptCoords","skipOffscreen","clipPath","cb","_createLowerCanvas","_initOptions","_setImageSmoothing","interactive","_initRetinaScaling","setOverlayImage","setBackgroundImage","setBackgroundColor","setOverlayColor","calcOffset","_isRetinaScaling","getRetinaScaling","scaleRatio","__initRetinaScaling","lowerCanvasEl","contextContainer","upperCanvasEl","contextTop","_offset","image","__setBgOverlayImage","__setBgOverlayColor","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","oImageSmoothingEnabled","instance","setOptions","_createCanvasElement","_applyCanvasStyle","getWidth","getHeight","setWidth","setDimensions","setHeight","dimensions","cssValue","cssOnly","_setBackstoreDimension","hasLostContext","backstoreOnly","_setCssDimension","_isCurrentlyDrawing","freeDrawingBrush","_setBrushStyles","cacheCanvasEl","wrapperEl","getZoom","setViewportTransform","vpt","activeObject","_activeObject","group","setCoords","calcViewportBoundaries","zoomToPoint","before","after","setZoom","absolutePan","relativePan","getElement","setupState","clearContext","clearRect","_hasITextHandlers","_mouseUpITextHandler","_iTextInstances","canvasToDrawOn","renderCanvas","isRendering","iVpt","tl","br","tr","bl","cancelRequestedRender","_renderBackground","_renderObjects","drawControls","shouldCache","_transformDone","renderCache","forClipping","drawClipPathOnCanvas","_renderOverlay","globalCompositeOperation","zoomX","zoomY","_cacheCanvas","cacheTranslationX","cacheTranslationY","_renderBackgroundOrOverlay","needsVpt","lineTo","closePath","fillStyle","toLive","offsetX","offsetY","m","gradientTransform","patternTransform","getCenter","centerObjectH","_centerObject","getCenterPoint","centerObjectV","centerObject","center","viewportCenterObject","vpCenter","getVpCenter","viewportCenterObjectH","viewportCenterObjectV","setPositionByOrigin","toDatalessJSON","propertiesToInclude","toDatalessObject","toObject","_toObjectMethod","_toObjects","_toObject","__serializeBgOverlay","excludeFromExport","originalValue","bgImage","overlay","svgViewportTransformation","toSVG","markup","_setSVGPreamble","_setSVGHeader","clipPathId","_setSVGBgOverlayColor","_setSVGBgOverlayImage","_setSVGObjects","suppressPreamble","encoding","createSVGFontFacesMarkup","createSVGRefElementsMarkup","createSVGClipPathMarkup","__uid","toClipPathSVG","shouldTransform","additionalTransform","row","rowIndex","charIndex","fontList","_setSVGObject","finalWidth","finalHeight","repeat","objs","activeSelection","unshift","sendBackwards","intersecting","newIdx","objsMoved","_findNewLowerIndex","intersectsWithObject","isContainedWithinObject","bringForward","_findNewUpperIndex","dispose","DataURLExporter","EMPTY_JSON","supports","setLineDash","toJSON","createPNGStream","createJPEGStream","toCanvasElement","cropping","scaledWidth","scaledHeight","originalWidth","originalHeight","newZoom","vp","originalInteractive","newVp","originalRetina","originalContextTop","supportsLineDash","objectCaching","originX","originY","cornerSize","transparentCorners","hoverCursor","moveCursor","padding","borderColor","borderDashArray","cornerColor","cornerStrokeColor","cornerStyle","cornerDashArray","centeredScaling","centeredRotation","fillRule","selectionBackgroundColor","stroke","strokeWidth","strokeDashArray","strokeDashOffset","strokeLineCap","strokeLineJoin","strokeMiterLimit","shadow","borderOpacityWhenMoving","borderScaleFactor","transformMatrix","minScaleLimit","selectable","evented","visible","hasControls","hasBorders","hasRotatingPoint","rotatingPointOffset","perPixelTargetFind","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockUniScaling","lockSkewingX","lockSkewingY","lockScalingFlip","statefullCache","noScaleCache","strokeUniform","dirty","__corner","paintFirst","stateProperties","cacheProperties","inverted","absolutePositioned","_createCacheCanvas","_cacheProperties","_cacheContext","_updateCacheCanvas","_limitCacheSize","dims","limitedDims","capped","_getCacheCanvasDimensions","objectScale","getTotalObjectScaling","dim","_getTransformedDimensions","neededX","neededY","_currentTransform","action","drawingWidth","drawingHeight","minCacheSize","dimensionsChanged","cacheWidth","cacheHeight","zoomChanged","shouldRedraw","additionalWidth","additionalHeight","shouldResizeCanvas","canvasWidth","canvasHeight","sizeGrowing","setTransform","calcTransformMatrix","calcOwnMatrix","_removeDefaultValues","getObjectScaling","retina","getObjectOpacity","shouldConstrainValue","isChanged","groupNeedsUpdate","_constrainScale","Shadow","isOnACache","setOnGroup","getViewportTransform","isNotVisible","isOnScreen","_setupCompositeOperation","drawSelectionBackground","_setOpacity","_setShadow","drawCacheOnCanvas","_removeCacheCanvas","drawObject","saveState","propertySet","isCacheDirty","hasStroke","hasFill","needsItsOwnCache","ownCaching","willDrawShadow","drawClipPathOnCache","originalFill","originalStroke","_setClippingProperties","_setStrokeStyles","_setFillStyles","_render","_drawClipPath","skipCanvas","hasStateChanged","_getNonTransformedDimensions","fillRect","_removeShadow","globalAlpha","decl","lineWidth","lineCap","lineDashOffset","lineJoin","miterLimit","strokeStyle","_setLineDash","dashArray","alternative","_renderControls","styleOverride","drawBorders","isMoving","forActiveSelection","drawBordersInGroup","scaling","multX","multY","nonScaling","shadowColor","shadowBlur","blur","shadowOffsetX","shadowOffsetY","_applyPatternGradientTransform","gradientUnits","_renderPaintInOrder","_renderStroke","_renderFill","affectStroke","_renderDashedStroke","_applyPatternForTransformedGradient","pCtx","pCanvas","retinaScaling","createPattern","_findCenterFromElement","_assignTransformMatrixProps","_removeTransformMatrix","preserveAspectRatioOptions","cropX","cropY","offsetLeft","offsetTop","objectForm","_fromObject","cloneAsImage","origParams","originalGroup","originalShadow","withoutTransform","withoutShadow","boundingRect","getBoundingRect","shadowOffset","originalCanvas","isType","setGradient","gradient","addColorStop","forObject","setPatternFill","setShadow","shouldCenterOrigin","_setOriginToCenter","_resetOrigin","centerH","viewportCenterH","centerV","viewportCenterV","viewportCenter","getLocalPointer","pointer","getPointer","pClicked","objectLeftTop","_getLeftTopCoords","createAccessors","extraParam","enlivedProps","originXOffset","right","originYOffset","bottom","translateToGivenOrigin","fromOriginX","fromOriginY","toOriginX","toOriginY","translateToCenterPoint","translateToOriginPoint","leftTop","getPointByOrigin","toLocalPoint","p2","adjustPosition","to","offsetFrom","offsetTo","hypotFull","getScaledWidth","xFull","yFull","_originalOriginX","_originalOriginY","originPoint","multiplyMatrices","wh","_calculateCurrentDimensions","oCoords","aCoords","ownMatrixCache","matrixCache","getCoords","absolute","calculate","calcCoords","intersectsWithRect","pointTL","pointBR","other","lines","_getImageLines","containsPoint","isContainedWithinRect","objLines","_findCrossPoints","_containsCenterOfCanvas","isPartiallyOnScreen","topline","rightline","bottomline","leftline","xi","iLine","xcount","lineKey","getScaledHeight","scaleToWidth","boundingRectFactor","scaleToHeight","rotateMatrix","_calcRotateMatrix","translateMatrix","_calcTranslateMatrix","startMatrix","finalMatrix","w","cosP","sinP","cosPSinP","cosPMinusSinP","ml","mr","mb","mtr","ignoreZoom","skipAbsolute","_setCornerCoords","transformMatrixKey","skipGroup","prefix","cache","tMatrix","_calcDimensionsTransformMatrix","flipping","dimX","dimY","noSkew","_finalizeDimensions","bbox","getSvgColorString","getSvgStyles","skipShadow","visibility","getSvgFilter","getSvgSpanStyles","useWhiteSpace","fontStyle","fontWeight","textDecoration","getSvgTextDecoration","deltaY","decoration","getSvgCommons","getSvgTransform","full","getSvgTransformMatrix","_setSVGBg","textBgRects","_getFillAttributes","_createBaseSVGMarkup","_toSVG","_createBaseClipPathSVGMarkup","objectMarkup","commonPieces","clipPathMarkup","noStyle","styleInfo","shadowInfo","withShadow","vectorEffect","absoluteClipPath","addPaintOrder","saveProps","tmpObj","dashedPropertySet","_isEqual","origValue","currentValue","firstPass","isArray","skipCallbacks","propsToAnimate","_animate","propPair","from","by","valueProgress","timeProgress","subTargetCheck","useSetOnGroup","isAlreadyGrouped","_updateObjectsACoords","_calcBounds","_updateObjectsCoords","actualCenter","_updateObjectCoords","objectLeft","objectTop","addWithUpdate","_restoreObjectsState","removeWithUpdate","_includeDefaultValues","objsToObject","originalDefaults","_obj","ownCache","_restoreObjectState","realizeTransform","destroy","toActiveSelection","ActiveSelection","ungroupOnCanvas","setObjectsCoords","onlyWidthHeight","aX","aY","iLen","jLen","_getBounds","minXY","maxXY","svgString","enlivedClipPath","loadSVGFromURL","srcFromAttribute","_lastScaleX","_lastScaleY","_filterScalingX","_filterScalingY","minimumScaleTrigger","cacheKey","_initElement","_element","setElement","removeTexture","_originalElement","_initConfig","resizeFilter","applyResizeFilters","backend","filterBackend","evictCachesForKey","setCrossOrigin","getOriginalSize","naturalWidth","naturalHeight","_stroke","filterObj","getSrc","hasCrop","strokeSvg","imageMarkup","getSvgSrc","origFill","filtered","getAttribute","setSrc","_setWidthHeight","minimumScale","elementToFilter","_filteredEl","sourceWidth","sourceHeight","isNeutralState","imgElement","_needsResize","elementToDraw","sW","sH","sX","sY","_resetWidthHeight","CSS_CANVAS","_initFilters","pAR","preserveAspectRatio","rWidth","rHeight","pWidth","pHeight","parsedAttributes","_object","resizeFilters","imgOptions","ATTRIBUTE_NAMES","fromElement","parseAttributes","testPrecision","precision","fragmentSource","fragmentShader","createShader","FRAGMENT_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","setupGLContext","captureGPUInfo","isSupported","getParameter","MAX_TEXTURE_SIZE","precisions","webGlPrecision","createWebGLCanvas","aPosition","Float32Array","chooseFastestCopyGLTo2DMethod","canUseImageData","canMeasurePerf","performance","canUseArrayBuffer","ArrayBuffer","canUseUint8Clamped","copyGLTo2D","startTime","drawImageTime","testContext","now","glOptions","premultipliedAlpha","depth","stencil","antialias","clearColor","cachedTexture","getCachedTexture","sourceTexture","createTexture","targetTexture","originalTexture","passes","webgl","programCache","pass","tempFbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","applyTo","resizeCanvasIfNeeded","bindTexture","TEXTURE_2D","deleteTexture","deleteFramebuffer","clearWebGLCaches","textureCache","textureImageSource","texture","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","uniqueId","gpuInfo","renderer","vendor","ext","getExtension","UNMASKED_RENDERER_WEBGL","UNMASKED_VENDOR_WEBGL","sourceElement","originalEl","originalImageData","BaseFilter","vertexSource","createProgram","vertexShader","VERTEX_SHADER","getShaderInfoLog","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","attributeLocations","getAttributeLocations","uniformLocations","getUniformLocations","uStepW","getUniformLocation","uStepH","getAttribLocation","sendAttributeData","aPositionData","attributeLocation","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","FLOAT","bufferData","STATIC_DRAW","_setupFrameBuffer","framebufferTexture2D","COLOR_ATTACHMENT0","_swapTextures","temp","main","mainParameter","_class","applyToWebGL","applyTo2d","retrieveShader","shader","useProgram","uniform1f","sendUniformData","viewport","drawArrays","TRIANGLE_STRIP","bindAdditionalTexture","textureUnit","activeTexture","TEXTURE0","unbindAdditionalTexture","getMainParameter","setMainParameter","createHelpLayer","helpLayer","mainP","screen","diff","lighten","darken","exclusion","tint","buildSource","tg","alpha1","uColor","uniform4fv","BlendImage","mask","TEXTURE1","calculateMatrix","canvas1","blendData","blendImage","uTransformMatrix","uImage","uniform1i","uniformMatrix3fv","Resize","resizeType","lanczosLobes","uDelta","uTaps","uniform2fv","horizontal","uniform1fv","taps","filterWindow","getFilterWindow","generateShader","tempScale","getTaps","lobeFunction","lanczosCreate","offsets","fragmentSourceTOP","dW","dH","lobes","xx","rcpScaleX","rcpScaleY","newData","oW","oH","sliceByTwo","hermiteFastResize","bilinearFiltering","lanczosResize","tmpCanvas","doneW","doneH","stepW","stepH","dX","dY","srcData","destImg","createImageData","destData","lanczos","ratioX","ratioY","rcpRatioX","rcpRatioY","range2X","range2Y","cacheLanc","icenter","u","weight","fX","fY","xDiff","yDiff","chnl","origPix","w4","pixels","destImage","destPixels","ratioW","ratioH","ratioWHalf","ratioHHalf","img2","data2","weights","weightsAlpha","gxR","gxG","gxB","gxA","centerY","yy","centerX","w0","module"],"mappings":"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","file":"static/js/main.8a8f951a.chunk.js","sourcesContent":["const envvars = {\n  REACT_APP_DELIMITER: '_',\n  REACT_APP_BASE: 'lineart',\n  REACT_APP_FILETYPE: 'png',\n  REACT_APP_TOKEN_PATH: 'src/assets/tokens',\n  ...process.env,\n};\n\nexport default envvars;\n","import cleric_cloak from './tokens/cleric/cloak.png';\nimport cleric_hair from './tokens/cleric/hair.png';\nimport cleric_lineart from './tokens/cleric/lineart.png';\nimport cleric_mace_handle from './tokens/cleric/mace_handle.png';\nimport cleric_mace_head from './tokens/cleric/mace_head.png';\nimport cleric_shield from './tokens/cleric/shield.png';\nimport cleric_shoes from './tokens/cleric/shoes.png';\nimport cleric_skin from './tokens/cleric/skin.png';\nimport cleric_skirt from './tokens/cleric/skirt.png';\nimport cleric_sleeves from './tokens/cleric/sleeves.png';\nimport cleric_top from './tokens/cleric/top.png';\nimport inquisitor_lineart from './tokens/inquisitor/lineart.png';\nimport gunslinger_lineart from './tokens/gunslinger/lineart.png';\nimport monk_lineart from './tokens/monk/lineart.png';\nimport ranger_lineart from './tokens/ranger/lineart.png';\n    \ninterface Config {\n    [tokenName: string]: {\n      [filename: string]: {\n        color: string;\n        src: string;\n      };\n    };\n  }  \n    \nconst config: Config = {cleric:{cloak:{ color: '#EEEEEE', src: cleric_cloak },hair:{ color: '#EEEEEE', src: cleric_hair },lineart:{ color: '#000000', src: cleric_lineart },mace_handle:{ color: '#EEEEEE', src: cleric_mace_handle },mace_head:{ color: '#EEEEEE', src: cleric_mace_head },shield:{ color: '#EEEEEE', src: cleric_shield },shoes:{ color: '#EEEEEE', src: cleric_shoes },skin:{ color: '#EEEEEE', src: cleric_skin },skirt:{ color: '#EEEEEE', src: cleric_skirt },sleeves:{ color: '#EEEEEE', src: cleric_sleeves },top:{ color: '#EEEEEE', src: cleric_top }},gunslinger:{lineart:{ color: '#000000', src: gunslinger_lineart }},inquisitor:{lineart:{ color: '#000000', src: inquisitor_lineart }},monk:{lineart:{ color: '#000000', src: monk_lineart }},ranger:{lineart:{ color: '#000000', src: ranger_lineart }}};\n    \nexport default config;","import React, { MutableRefObject, useEffect, useRef } from 'react';\nimport { fabric } from './fabric.js';\nimport { saveAs } from 'file-saver';\n\nimport './Canvas.css';\nimport envvars from '../../envvars';\nimport { getSources } from '../editor/editorUtil';\n\ninterface Props {\n  saveCanvas: MutableRefObject<(() => void) | null>;\n  state: { [filename: string]: string };\n  token: string;\n}\n\nconst Canvas: React.FunctionComponent<Props> = ({\n  saveCanvas,\n  state,\n  token,\n}) => {\n  const canvasRef: MutableRefObject<HTMLCanvasElement | null> = useRef(null);\n  const fabricCanvas: MutableRefObject<fabric.StaticCanvas | null> = useRef(\n    null\n  );\n\n  useEffect(() => {\n    fabricCanvas.current = new fabric.StaticCanvas(canvasRef.current);\n  }, []);\n\n  useEffect(() => {\n    if (saveCanvas)\n      saveCanvas.current = () => {\n        if (fabricCanvas.current) {\n          const data = fabricCanvas.current.toDataURL({\n            format: 'png',\n            multiplier: 1,\n            enableRetinaScaling: true,\n          });\n          saveAs(data, 'token.png');\n        }\n      };\n  }, [saveCanvas]);\n\n  useEffect(() => {\n    if (fabricCanvas.current && token) {\n      const sources = getSources(token);\n      Object.keys(sources).forEach((key: string) => {\n        fabric.Image.fromURL(\n          sources[key],\n          (img: fabric.Image) => {\n            const filter = new fabric.Image.filters.BlendColor({\n              color: key === envvars.REACT_APP_BASE ? '#000000' : '#EEEEEE',\n              mode: 'tint',\n              alpha: 1,\n            });\n            img.filters = [filter];\n            img.applyFilters();\n            fabricCanvas.current?.add(img);\n            if (img.name === envvars.REACT_APP_BASE)\n              fabricCanvas.current?.bringToFront(img);\n            else fabricCanvas.current?.sendToBack(img);\n          },\n          { name: key }\n        );\n      });\n      return function clear() {\n        fabricCanvas.current?.clear();\n      };\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (fabricCanvas.current && token) {\n      const images: fabric.Object[] = fabricCanvas.current.getObjects('image');\n      images.forEach((img) => {\n        const filter = new fabric.Image.filters.BlendColor({\n          color: state[img.name as string],\n          mode: 'tint',\n          alpha: 1,\n        });\n        (img as fabric.Image).filters = [filter];\n        (img as fabric.Image).applyFilters();\n      });\n      fabricCanvas.current.renderAll();\n    }\n  }, [state, token]);\n\n  return <canvas height={200} ref={canvasRef} width={200}></canvas>;\n};\n\nexport default Canvas;\n","import { MutableRefObject, useCallback, useRef } from 'react';\nimport config from '../../assets';\n\nconst DEBOUNCE_RATE = 100;\nconst THROTTLE_RATE = 100;\n\nexport interface TokenState {\n  [filename: string]: HexStr;\n}\n\nexport const getState = (token: string) => {\n  const tokenConfig: Token = config[token];\n  return Object.keys(tokenConfig).reduce(\n    (state: TokenState, filename: string) => {\n      state[filename] = tokenConfig[filename].color;\n      return state;\n    },\n    {}\n  );\n};\n\nexport const getSources = (token: string) => {\n  const tokenConfig: Token = config[token];\n  return Object.keys(tokenConfig).reduce(\n    (srcs: { [filename: string]: string }, filename: string) => {\n      srcs[filename] = tokenConfig[filename].src;\n      return srcs;\n    },\n    {}\n  );\n};\n\nexport const getComponentNames = (token: string) => Object.keys(config[token]);\n\nexport function useDebouncedCallback<T extends unknown[]>(\n  callback: (...args: T) => unknown\n): (...args: T) => void {\n  const timeout: MutableRefObject<NodeJS.Timeout | null> = useRef(null);\n  const debouncedFunction = useRef(callback);\n  debouncedFunction.current = callback;\n\n  const cancelDebouncedCallback: () => void = useCallback(() => {\n    clearTimeout(timeout.current as NodeJS.Timeout);\n    timeout.current = null;\n  }, []);\n\n  const debouncedCallback = useCallback(\n    (...args: T) => {\n      clearTimeout(timeout.current as NodeJS.Timeout);\n      timeout.current = setTimeout(() => {\n        cancelDebouncedCallback();\n\n        debouncedFunction.current(...args);\n      }, DEBOUNCE_RATE);\n    },\n    [cancelDebouncedCallback]\n  );\n\n  return debouncedCallback;\n}\n\nexport function useThrottledCallback<T extends unknown[]>(\n  callback: (...args: T) => unknown\n): (...args: T) => void {\n  const shouldWait: MutableRefObject<boolean> = useRef(false);\n\n  return function throttledCallback(...args) {\n    if (!shouldWait.current) {\n      callback(...args);\n      shouldWait.current = true;\n    }\n    setTimeout(() => {\n      shouldWait.current = false;\n    }, THROTTLE_RATE);\n  };\n}\n","import tinycolor from 'tinycolor2';\nimport { PickerColor } from './ColorPicker';\n\nexport const simpleCheckForValidColor = (data: any) => {\n  const keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  let checked = 0;\n  let passed = 0;\n  keysToCheck.forEach((letter) => {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        const percentExpr = /^\\d+%$/;\n        if (percentExpr.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport const toState = (data: any, oldHue?: number): PickerColor => {\n  const color =\n    typeof data !== 'string' && 'hex' in data\n      ? tinycolor(data.hex)\n      : tinycolor(data);\n  const hsl = color.toHsl();\n  const hsv = color.toHsv();\n  const rgb = color.toRgb();\n  const hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  const transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl,\n    hex: transparent ? 'transparent' : `#${hex}`,\n    hsv,\n    oldHue: data.h || oldHue || hsl.h,\n  };\n};\n\nexport default {\n  simpleCheckForValidColor,\n  toState,\n};\n","import React, { MutableRefObject, useRef } from 'react';\nimport { ColorChangeEvent } from '../ColorPicker';\nimport { calculateChange } from './hueUtil';\n\ninterface Props {\n  hsl: tinycolor.ColorFormats.HSLA;\n  onChange: (change: tinycolor.ColorFormats.HSLA, e: ColorChangeEvent) => void;\n}\n\nconst Hue: React.FunctionComponent<Props> = ({ hsl, onChange }) => {\n  const container: MutableRefObject<HTMLDivElement | null> = useRef(null);\n  const pointerPosition = { left: `${(hsl.h * 100) / 360}%` };\n\n  const handleChange = (e: ColorChangeEvent) => {\n    const change = calculateChange(e, hsl, container.current as HTMLDivElement);\n    if (change) onChange(change, e);\n  };\n\n  return (\n    <div className='hue-selector'>\n      <div\n        className={`hue-selector__bar`}\n        onClick={handleChange}\n        onMouseDown={handleChange}\n        onTouchMove={handleChange}\n        onTouchStart={handleChange}\n        ref={container}\n      >\n        <style>{`\n            .hue-selector__bar {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          `}</style>\n        <div\n          className='hue-selector__pointer'\n          draggable\n          onDrag={handleChange}\n          onDragEnd={handleChange}\n          style={pointerPosition}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default Hue;\n","import { ColorChangeEvent } from '../ColorPicker';\n\nexport const calculateChange = (\n  e: ColorChangeEvent,\n  hsl: tinycolor.ColorFormats.HSLA,\n  container: HTMLDivElement\n): tinycolor.ColorFormats.HSLA | null => {\n  const containerWidth = container.clientWidth;\n  const x = 'pageX' in e ? e.pageX : e.touches[0].pageX;\n  const left =\n    x - (container.getBoundingClientRect().left + window.pageXOffset);\n\n  let h: number;\n  if (left < 0) {\n    h = 0;\n  } else if (left > containerWidth) {\n    h = 359;\n  } else {\n    const percent = (left * 100) / containerWidth;\n    h = (360 * percent) / 100;\n  }\n\n  if (hsl.h !== h) {\n    return {\n      h,\n      s: hsl.s,\n      l: hsl.l,\n      a: hsl.a,\n    };\n  }\n\n  return null;\n};\n","import React, { MutableRefObject, useRef } from 'react';\nimport { ColorChangeEvent } from '../ColorPicker';\nimport { calculateChange } from './saturationUtil';\n\ninterface Props {\n  hsv: tinycolor.ColorFormats.HSVA;\n  hsl: tinycolor.ColorFormats.HSLA;\n  onChange: (change: tinycolor.ColorFormats.HSVA, e: ColorChangeEvent) => void;\n}\n\nconst Saturation: React.FunctionComponent<Props> = ({ hsv, hsl, onChange }) => {\n  const container: MutableRefObject<HTMLDivElement | null> = useRef(null);\n  const pointerPosition = {\n    top: `${-(hsv.v * 100) + 100}%`,\n    left: `${hsv.s * 100}%`,\n  };\n  const backgroundColor = {\n    background: `hsl(${hsl.h},100%, 50%)`,\n  };\n\n  const handleChange = (e: ColorChangeEvent) => {\n    const change = calculateChange(e, hsl, container.current as HTMLDivElement);\n    onChange(change, e);\n  };\n\n  return (\n    <div className='saturation-selector'>\n      <div\n        className='saturation-selector__color'\n        onClick={handleChange}\n        onMouseDown={handleChange}\n        onTouchMove={handleChange}\n        onTouchStart={handleChange}\n        ref={container}\n        style={backgroundColor}\n      >\n        <style>{`\n            .saturation-selector__white {\n              background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n              background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n            }\n            .saturation-selector__black {\n              background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n              background: linear-gradient(to top, #000, rgba(0,0,0,0));\n            }\n          `}</style>\n        <div className='saturation-selector__white'>\n          <div className='saturation-selector__black' />\n          <div\n            className='saturation-selector__pointer'\n            draggable\n            onDrag={handleChange}\n            onDragEnd={handleChange}\n            style={pointerPosition}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default Saturation;\n","import { ColorChangeEvent } from '../ColorPicker';\n\nexport const calculateChange = (\n  e: ColorChangeEvent,\n  hsl: tinycolor.ColorFormats.HSLA,\n  container: HTMLDivElement\n): tinycolor.ColorFormats.HSVA => {\n  const {\n    width: containerWidth,\n    height: containerHeight,\n  } = container.getBoundingClientRect();\n  const [x, y] =\n    'pageY' in e\n      ? [e.pageX, e.pageY]\n      : [e.touches[0].pageX, e.touches[0].pageY];\n  let left: number =\n    x - (container.getBoundingClientRect().left + window.pageXOffset);\n  let top: number =\n    y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  const saturation = left / containerWidth;\n  const bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n  };\n};\n","import React, { Dispatch, useEffect, useState } from 'react';\nimport tinycolor from 'tinycolor2';\n\nimport * as utils from './colorUtil';\nimport Hue from './hue/Hue';\nimport Saturation from './saturation/Saturation';\nimport chevron_right from '../../assets/icons/chevron_right-18dp.svg';\n\nimport './ColorPicker.css';\n\nexport type ColorChangeEvent =\n  | React.MouseEvent<HTMLDivElement, MouseEvent>\n  | React.TouchEvent<HTMLDivElement>;\n\nexport interface PickerColor {\n  hex: HexStr;\n  hsl: tinycolor.ColorFormats.HSLA;\n  hsv: tinycolor.ColorFormats.HSVA;\n  oldHue?: number;\n};\n\ninterface Props {\n  color: string;\n  pickerOpen: boolean;\n  setColor: (arg: string) => void;\n  setPickerOpen: (arg: boolean) => void;\n}\n\nconst ColorPicker: React.FunctionComponent<Props> = ({\n  color: stateColor,\n  pickerOpen: isOpen,\n  setColor,\n  setPickerOpen: setIsOpen,\n}) => {\n  const [ownColor, setOwnColor]: [\n    PickerColor,\n    Dispatch<PickerColor>\n  ] = useState(utils.toState(stateColor));\n\n  useEffect(() => {\n    setOwnColor(utils.toState(stateColor));\n  }, [stateColor]);\n\n  const handleChange = (\n    color: tinycolor.ColorFormats.HSLA | tinycolor.ColorFormats.HSVA\n  ): void => {\n    const isValidColor: boolean = utils.simpleCheckForValidColor(color);\n    if (isValidColor) {\n      const newColor = utils.toState(color, color.h || ownColor.oldHue);\n      setOwnColor(newColor);\n      setColor(newColor.hex);\n    }\n  };\n\n  const togglePicker = (): void => {\n    setIsOpen(!isOpen);\n  };\n\n  const iconColor: string = tinycolor\n    .mostReadable(ownColor.hex, ['#000000', '#ffffff'], {\n      level: 'AAA',\n      size: 'small',\n    })\n    .toHex();\n\n  return (\n    <>\n      <button\n        className='color-toggle'\n        onClick={togglePicker}\n        style={{\n          backgroundColor: ownColor.hex,\n          transform: isOpen ? 'rotate(90deg)' : 'rotate(0deg)',\n        }}\n        title={`${isOpen ? 'Hide' : 'Show'} Color Picker`}\n      >\n        <img\n          alt='arrow indicator'\n          src={chevron_right}\n          style={{\n            filter: `invert(${iconColor === '000000' ? '0%' : '100%'})`,\n          }}\n        />\n      </button>\n      {isOpen && (\n        <div className='picker'>\n          <Saturation {...ownColor} onChange={handleChange} />\n          <Hue {...ownColor} onChange={handleChange} />\n        </div>\n      )}\n    </>\n  );\n};\nexport default ColorPicker;\n","import React from 'react';\n\nconst chevronRight = (color: string) => (\n  <svg\n    xmlns='http://www.w3.org/2000/svg'\n    viewBox='0 0 24 24'\n    fill={color}\n    width='18px'\n    height='18px'\n  >\n    <path d='M0 0h24v24H0V0z' fill='none' />\n    <path d='M9.29 6.71c-.39.39-.39 1.02 0 1.41L13.17 12l-3.88 3.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41L10.7 6.7c-.38-.38-1.02-.38-1.41.01z' />\n  </svg>\n);\n\nexport default chevronRight;\n","import React from 'react';\n\nconst saveAlt = (color: string) => (\n  <svg\n    xmlns='http://www.w3.org/2000/svg'\n    viewBox='0 0 24 24'\n    fill={color}\n    width='18px'\n    height='18px'\n  >\n    <path d='M0 0h24v24H0V0z' fill='none' />\n    <path d='M19 13v5c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-5c0-.55-.45-1-1-1s-1 .45-1 1v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1zm-6-.33l1.88-1.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-3.59 3.59c-.39.39-1.02.39-1.41 0L7.7 12.2c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0L11 12.67V4c0-.55.45-1 1-1s1 .45 1 1v8.67z' />\n  </svg>\n);\n\nexport default saveAlt;\n","import React from 'react';\nimport { Ripple } from '@rmwc/ripple';\nimport {\n  TopAppBar,\n  TopAppBarActionItem,\n  TopAppBarFixedAdjust,\n  TopAppBarNavigationIcon,\n  TopAppBarRow,\n  TopAppBarSection,\n  TopAppBarTitle,\n} from '@rmwc/top-app-bar';\n\nimport chevronRight from '../../assets/icons/chevron_right-18dp';\nimport saveIcon from '../../assets/icons/save_alt-18dp';\n\nconst EditorHeader: React.FunctionComponent<{\n  saveCanvas: () => void;\n  unsetToken: () => void;\n}> = ({ saveCanvas, unsetToken }) => {\n  return (\n    <>\n      <TopAppBar>\n        <TopAppBarRow>\n          <TopAppBarSection>\n            <TopAppBarNavigationIcon\n              icon={{\n                strategy: 'component',\n                icon: (\n                  <Ripple>{chevronRight('--mdc-theme-text-on-primary')}</Ripple>\n                ),\n              }}\n              className={`flipx`}\n              onClick={unsetToken}\n            />\n            <TopAppBarTitle>Token Editor</TopAppBarTitle>\n          </TopAppBarSection>\n          <TopAppBarSection alignEnd>\n            <TopAppBarActionItem\n              icon={{\n                strategy: 'component',\n                icon: (\n                  <Ripple accent>\n                    {saveIcon('--mdc-theme-text-on-primary')}\n                  </Ripple>\n                ),\n              }}\n              onClick={saveCanvas}\n              title='Save'\n            />\n          </TopAppBarSection>\n        </TopAppBarRow>\n      </TopAppBar>\n      <TopAppBarFixedAdjust />\n    </>\n  );\n};\n\nexport default EditorHeader;\n","import React from 'react';\nimport { CollapsibleList, List, ListItem, ListItemMeta } from '@rmwc/list';\n\nimport chevron_right from '../../assets/icons/chevron_right-18dp.svg';\nimport envvars from '../../envvars';\nimport { ListItemsIndex } from '../editor/Editor';\n\nimport './Menu.css';\n\nconst GroupHandle: React.FunctionComponent<{ title: string }> = ({\n  title,\n  ...props\n}) => (\n  <ListItem ripple={false} {...props}>\n    {title}\n    <ListItemMeta icon={chevron_right} />\n  </ListItem>\n);\n\ninterface Props {\n  listItems: ListItemsIndex;\n  filenames: string[];\n}\n\nconst Menu: React.FunctionComponent<Props> = ({ listItems, filenames }) => {\n  const keys: string[] = filenames?.sort();\n\n  let prevGroup: string;\n  return (\n    <List>\n      {keys.reduce((comps: Array<React.ReactNode>, name) => {\n        const delimiterIndex: number = name.indexOf(\n          envvars.REACT_APP_DELIMITER\n        );\n        if (delimiterIndex >= 0) {\n          const groupName = name.substring(0, delimiterIndex);\n          if (groupName === prevGroup) return comps;\n\n          prevGroup = groupName;\n          const groupKeys = keys.filter((key) =>\n            key.startsWith(`${groupName}_`)\n          );\n          comps.push(\n            <CollapsibleList\n              handle={<GroupHandle title={groupName} />}\n              key={groupName}\n            >\n              {groupKeys.map((key) => {\n                return (\n                  <React.Fragment key={key}>{listItems[key]}</React.Fragment>\n                );\n              })}\n            </CollapsibleList>\n          );\n        } else {\n          comps.push(\n            <React.Fragment key={name}>{listItems[name]}</React.Fragment>\n          );\n        }\n        return comps;\n      }, [])}\n    </List>\n  );\n};\n\nexport default Menu;\n","import React, { FormEvent, useEffect, useState } from 'react';\nimport { ListItem, ListItemMeta } from '@rmwc/list';\nimport envvars from '../../envvars';\nimport tinycolor from 'tinycolor2';\n\nimport './ListItem.css';\n\ninterface Props {\n  color: string;\n  filename: string;\n  selectComponent: () => void;\n  selected: boolean;\n  setColor: (color: HexStr) => void;\n  setPickerOpen: (arg: boolean) => void;\n}\n\nconst InputListItem: React.FunctionComponent<Props> = ({\n  color,\n  filename,\n  selectComponent,\n  selected,\n  setColor,\n  setPickerOpen,\n}) => {\n  const [ownColor, setOwnColor] = useState(color);\n  const delimiterIndex: number = filename.indexOf(envvars.REACT_APP_DELIMITER);\n  const name: string =\n    delimiterIndex >= 0 ? filename.substring(delimiterIndex + 1) : filename;\n\n  useEffect(() => {\n    setOwnColor(color);\n  }, [color]);\n\n  const handleChange = (e: FormEvent<HTMLInputElement>) => {\n    const newVal = `#${e.currentTarget.value\n      .replace(/[^a-fA-F\\d]/g, '')\n      .slice(0, 6)}`;\n    setOwnColor(newVal);\n    setColor(newVal);\n  };\n\n  const handleItemClick = () => {\n    selectComponent();\n    setPickerOpen(true);\n  };\n\n  const handleInputFocus = (e: React.FocusEvent<HTMLInputElement>) => {\n    e.stopPropagation();\n    selectComponent();\n    setPickerOpen(false);\n  };\n\n  const styles = {\n    backgroundColor: tinycolor(ownColor).toHexString(),\n    color: tinycolor\n      .mostReadable(ownColor, ['#000000', '#ffffff'], {\n        level: 'AAA',\n        size: 'small',\n      })\n      .toHexString(),\n  };\n\n  return (\n    <ListItem onClick={handleItemClick} selected={selected} tabIndex={-1}>\n      {name}\n      <ListItemMeta>\n        <input\n          className={`input-chip`}\n          id={`${name}-input`}\n          name={name}\n          onChange={handleChange}\n          onFocus={handleInputFocus}\n          style={styles}\n          type='text'\n          value={ownColor?.toUpperCase()}\n        />\n      </ListItemMeta>\n    </ListItem>\n  );\n};\n\nexport default InputListItem;\n","import React, { Dispatch, MutableRefObject, useRef, useState } from 'react';\n\nimport Canvas from '../canvas/Canvas';\nimport ColorPicker from '../colorPicker/ColorPicker';\nimport EditorHeader from './EditorHeader';\nimport Menu from '../menu/Menu';\nimport {\n  TokenState,\n  getComponentNames,\n  getState,\n  useDebouncedCallback,\n  useThrottledCallback,\n} from './editorUtil';\n\nimport './Editor.css';\nimport InputListItem from '../listItem/ListItem';\n\ninterface Props {\n  token: string;\n  unsetToken: () => void;\n}\n\nexport interface ListItemsIndex {\n  [filename: string]: JSX.Element;\n}\n\nconst Editor: React.FunctionComponent<Props> = ({ token, unsetToken }) => {\n  const saveCanvas: MutableRefObject<(() => void) | null> = useRef(null);\n  const [selectedComponent, selectComponent]: [\n    string | null,\n    Dispatch<any>\n  ] = useState(null);\n  const [pickerOpen, setPickerOpen] = useState(false);\n  const [tokenState, setTokenState]: [TokenState, Dispatch<any>] = useState(\n    getState(token)\n  );\n  const setColor = useDebouncedCallback((color) => {\n    if (selectedComponent)\n      setTokenState((prevState: TokenState) => ({\n        ...prevState,\n        [selectedComponent]: color,\n      }));\n  });\n  // This is throttled so the input list items can control picker/keyboard visibility\n  const setOpen = useThrottledCallback((isOpen: boolean) => {\n    setPickerOpen(isOpen);\n  });\n\n  if (!token) return null;\n\n  const componentNames = getComponentNames(token);\n  const listItems: ListItemsIndex = componentNames.reduce(\n    (items: ListItemsIndex, name) => {\n      items[name] = (\n        <InputListItem\n          color={tokenState[name]}\n          filename={name}\n          selectComponent={() => selectComponent(name)}\n          selected={selectedComponent === name}\n          setColor={setColor}\n          setPickerOpen={setOpen}\n        />\n      );\n      return items;\n    },\n    {}\n  );\n  return (\n    <>\n      <EditorHeader\n        saveCanvas={saveCanvas.current as () => void}\n        unsetToken={unsetToken}\n      />\n      <div className='editor'>\n        <div className='col-1'>\n          <Canvas saveCanvas={saveCanvas} state={tokenState} token={token} />\n          {selectedComponent && (\n            <ColorPicker\n              color={tokenState[selectedComponent]}\n              pickerOpen={pickerOpen}\n              setColor={setColor}\n              setPickerOpen={setOpen}\n            />\n          )}\n        </div>\n        <div className='col-2'>\n          {componentNames && (\n            <Menu listItems={listItems} filenames={componentNames} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Editor;\n","import React from 'react';\nimport {\n  TopAppBar,\n  TopAppBarFixedAdjust,\n  TopAppBarRow,\n  TopAppBarSection,\n  TopAppBarTitle,\n} from '@rmwc/top-app-bar';\n\nconst GridHeader: React.FunctionComponent<{}> = () => {\n  return (\n    <>\n      <TopAppBar>\n        <TopAppBarRow>\n          <TopAppBarSection>\n            <TopAppBarTitle>Token Editor</TopAppBarTitle>\n          </TopAppBarSection>\n        </TopAppBarRow>\n      </TopAppBar>\n      <TopAppBarFixedAdjust />\n    </>\n  );\n};\n\nexport default GridHeader;\n","import React from 'react';\nimport { Ripple } from '@rmwc/ripple';\nimport {\n  ImageList,\n  ImageListImage,\n  ImageListItem,\n  ImageListLabel,\n  ImageListSupporting,\n} from '@rmwc/image-list';\nimport { Typography } from '@rmwc/typography';\n\nimport GridHeader from './GridHeader';\nimport config from '../../assets';\nimport envvars from '../../envvars';\n\nimport './Grid.css';\nimport '@rmwc/image-list/styles';\n\nconst Grid: React.FunctionComponent<{\n  setToken: (arg: string) => void;\n}> = ({ setToken }) => {\n  const tokenNames: string[] = Object.keys(config);\n  return (\n    <>\n      <GridHeader />\n      <div className='token-grid'>\n        <Typography className='text-center' tag='p' use='subtitle1'>\n          Select a token:\n        </Typography>\n        <ImageList withTextProtection>\n          {tokenNames.map((ref: string) => {\n            const isAvailable: boolean = ref === 'cleric';\n            const src: string = config[ref][envvars.REACT_APP_BASE].src;\n            const item = (\n              <ImageListItem\n                className={isAvailable ? '' : 'no-hover'}\n                key={ref}\n                onClick={() => {\n                  isAvailable && setToken(ref);\n                }}\n              >\n                <ImageListImage src={src} alt={`${ref} token`} />\n                {!isAvailable && (\n                  <ImageListSupporting>\n                    <ImageListLabel>Available Soon!</ImageListLabel>\n                  </ImageListSupporting>\n                )}\n              </ImageListItem>\n            );\n            return isAvailable ? <Ripple key={ref}>{item}</Ripple> : item;\n          })}\n        </ImageList>\n      </div>\n    </>\n  );\n};\n\nexport default Grid;\n","import React, { useState, Dispatch } from 'react';\n\nimport Editor from './features/editor/Editor';\nimport TokenGrid from './features/grid/Grid';\n\nimport '@rmwc/list/styles';\nimport '@rmwc/ripple/styles';\nimport '@rmwc/top-app-bar/styles';\nimport '@rmwc/typography/styles';\n\nconst App: React.FunctionComponent<{}> = () => {\n  const [selectedToken, setSelectedToken]: [\n    string | null,\n    Dispatch<any>\n  ] = useState(null);\n\n  return (\n    <div className='app'>\n      {selectedToken ? (\n        <Editor\n          token={selectedToken}\n          unsetToken={() => {\n            setSelectedToken(null);\n          }}\n        />\n      ) : (\n        <TokenGrid setToken={setSelectedToken} />\n      )}\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */\n\nlet define;\n// eslint-disable-next-line\nvar fabric = fabric || { version: '3.6.3' };\nif (typeof exports !== 'undefined') {\n  exports.fabric = fabric;\n} else if (typeof define === 'function' && define.amd) {\n  /* _AMD_START_ */\n  define([], function () {\n    return fabric;\n  });\n}\n/* _AMD_END_ */\nif (typeof document !== 'undefined' && typeof window !== 'undefined') {\n  if (\n    document instanceof\n    (typeof HTMLDocument !== 'undefined' ? HTMLDocument : Document)\n  ) {\n    fabric.document = document;\n  } else {\n    fabric.document = document.implementation.createHTMLDocument('');\n  }\n  fabric.window = window;\n} else {\n  // assume we're running under node.js when document/window are not present\n  var jsdom = require('jsdom');\n  var virtualWindow = new jsdom.JSDOM(\n    decodeURIComponent(\n      '%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E'\n    ),\n    {\n      features: {\n        FetchExternalResources: ['img'],\n      },\n      resources: 'usable',\n    }\n  ).window;\n  fabric.document = virtualWindow.document;\n  fabric.jsdomImplForWrapper = require('jsdom/lib/jsdom/living/generated/utils').implForWrapper;\n  fabric.nodeCanvas = require('jsdom/lib/jsdom/utils').Canvas;\n  fabric.window = virtualWindow;\n  // DOMParser = fabric.window.DOMParser;\n}\n\n/**\n * True when in environment that supports touch events\n * @type boolean\n */\nfabric.isTouchSupported =\n  'ontouchstart' in fabric.window ||\n  'ontouchstart' in fabric.document ||\n  (fabric.window &&\n    fabric.window.navigator &&\n    fabric.window.navigator.maxTouchPoints > 0);\n\n/**\n * True when in environment that's probably Node.js\n * @type boolean\n */\nfabric.isLikelyNode =\n  typeof Buffer !== 'undefined' && typeof window === 'undefined';\n\n/* _FROM_SVG_START_ */\n/**\n * Attributes parsed from all SVG elements\n * @type array\n */\nfabric.SHARED_ATTRIBUTES = [\n  'display',\n  'transform',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'opacity',\n  'stroke',\n  'stroke-dasharray',\n  'stroke-linecap',\n  'stroke-dashoffset',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke-width',\n  'id',\n  'paint-order',\n  'vector-effect',\n  'instantiated_by_use',\n  'clip-path',\n];\n/* _FROM_SVG_END_ */\n\n/**\n * Pixel per Inch as a default value set to 96. Can be changed for more realistic conversion.\n */\nfabric.DPI = 96;\nfabric.reNum = '(?:[-+]?(?:\\\\d+|\\\\d*\\\\.\\\\d+)(?:[eE][-+]?\\\\d+)?)';\nfabric.rePathCommand = /([-+]?((\\d+\\.\\d+)|((\\d+)|(\\.\\d+)))(?:[eE][-+]?\\d+)?)/gi;\nfabric.reNonWord = /[ \\n.,;!?-]/;\nfabric.fontPaths = {};\nfabric.iMatrix = [1, 0, 0, 1, 0, 0];\nfabric.svgNS = 'http://www.w3.org/2000/svg';\n\n/**\n * Pixel limit for cache canvases. 1Mpx , 4Mpx should be fine.\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.perfLimitSizeTotal = 2097152;\n\n/**\n * Pixel limit for cache canvases width or height. IE fixes the maximum at 5000\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.maxCacheSideLimit = 4096;\n\n/**\n * Lowest pixel limit for cache canvases, set at 256PX\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.minCacheSideLimit = 256;\n\n/**\n * Cache Object for widths of chars in text rendering.\n */\nfabric.charWidthsCache = {};\n\n/**\n * if webgl is enabled and available, textureSize will determine the size\n * of the canvas backend\n * @since 2.0.0\n * @type Number\n * @default\n */\nfabric.textureSize = 2048;\n\n/**\n * When 'true', style information is not retained when copy/pasting text, making\n * pasted text use destination style.\n * Defaults to 'false'.\n * @type Boolean\n * @default\n */\nfabric.disableStyleCopyPaste = false;\n\n/**\n * Enable webgl for filtering picture is available\n * A filtering backend will be initialized, this will both take memory and\n * time since a default 2048x2048 canvas will be created for the gl context\n * @since 2.0.0\n * @type Boolean\n * @default\n */\nfabric.enableGLFiltering = true;\n\n/**\n * Device Pixel Ratio\n * @see https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/HTML-canvas-guide/SettingUptheCanvas/SettingUptheCanvas.html\n */\nfabric.devicePixelRatio =\n  fabric.window.devicePixelRatio ||\n  fabric.window.webkitDevicePixelRatio ||\n  fabric.window.mozDevicePixelRatio ||\n  1;\n/**\n * Browser-specific constant to adjust CanvasRenderingContext2D.shadowBlur value,\n * which is unitless and not rendered equally across browsers.\n *\n * Values that work quite well (as of October 2017) are:\n * - Chrome: 1.5\n * - Edge: 1.75\n * - Firefox: 0.9\n * - Safari: 0.95\n *\n * @since 2.0.0\n * @type Number\n * @default 1\n */\nfabric.browserShadowBlurConstant = 1;\n\n/**\n * This object contains the result of arc to beizer conversion for faster retrieving if the same arc needs to be converted again.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.arcToSegmentsCache = {};\n\n/**\n * This object keeps the results of the boundsOfCurve calculation mapped by the joined arguments necessary to calculate it.\n * It does speed up calculation, if you parse and add always the same paths, but in case of heavy usage of freedrawing\n * you do not get any speed benefit and you get a big object in memory.\n * The object was a private variable before, while now is appended to the lib so that you have access to it and you\n * can eventually clear it.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.boundsOfCurveCache = {};\n\n/**\n * If disabled boundsOfCurveCache is not used. For apps that make heavy usage of pencil drawing probably disabling it is better\n * @default true\n */\nfabric.cachesBoundsOfCurve = true;\n\n/**\n * Skip performance testing of setupGLContext and force the use of putImageData that seems to be the one that works best on\n * Chrome + old hardware. if your users are experiencing empty images after filtering you may try to force this to true\n * this has to be set before instantiating the filtering backend ( before filtering the first image )\n * @type Boolean\n * @default false\n */\nfabric.forceGLPutImageData = false;\n\nfabric.initFilterBackend = function () {\n  if (\n    fabric.enableGLFiltering &&\n    fabric.isWebglSupported &&\n    fabric.isWebglSupported(fabric.textureSize)\n  ) {\n    console.log('max texture size: ' + fabric.maxTextureSize);\n    return new fabric.WebglFilterBackend({ tileSize: fabric.textureSize });\n  } else if (fabric.Canvas2dFilterBackend) {\n    return new fabric.Canvas2dFilterBackend();\n  }\n};\n(function () {\n  /**\n   * @private\n   * @param {String} eventName\n   * @param {Function} handler\n   */\n  function _removeEventListener(eventName, handler) {\n    if (!this.__eventListeners[eventName]) {\n      return;\n    }\n    var eventListener = this.__eventListeners[eventName];\n    if (handler) {\n      eventListener[eventListener.indexOf(handler)] = false;\n    } else {\n      fabric.util.array.fill(eventListener, false);\n    }\n  }\n\n  /**\n   * Observes specified event\n   * @deprecated `observe` deprecated since 0.8.34 (use `on` instead)\n   * @memberOf fabric.Observable\n   * @alias on\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function that receives a notification when an event of the specified type occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function observe(eventName, handler) {\n    if (!this.__eventListeners) {\n      this.__eventListeners = {};\n    }\n    // one object with key/value pairs was passed\n    if (arguments.length === 1) {\n      for (var prop in eventName) {\n        this.on(prop, eventName[prop]);\n      }\n    } else {\n      if (!this.__eventListeners[eventName]) {\n        this.__eventListeners[eventName] = [];\n      }\n      this.__eventListeners[eventName].push(handler);\n    }\n    return this;\n  }\n\n  /**\n   * Stops event observing for a particular event handler. Calling this method\n   * without arguments removes all handlers for all events\n   * @deprecated `stopObserving` deprecated since 0.8.34 (use `off` instead)\n   * @memberOf fabric.Observable\n   * @alias off\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function to be deleted from EventListeners\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function stopObserving(eventName, handler) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    // remove all key/value pairs (event name -> event handler)\n    if (arguments.length === 0) {\n      for (eventName in this.__eventListeners) {\n        _removeEventListener.call(this, eventName);\n      }\n    }\n    // one object with key/value pairs was passed\n    else if (arguments.length === 1 && typeof arguments[0] === 'object') {\n      for (var prop in eventName) {\n        _removeEventListener.call(this, prop, eventName[prop]);\n      }\n    } else {\n      _removeEventListener.call(this, eventName, handler);\n    }\n    return this;\n  }\n\n  /**\n   * Fires event with an optional options object\n   * @deprecated `fire` deprecated since 1.0.7 (use `trigger` instead)\n   * @memberOf fabric.Observable\n   * @alias trigger\n   * @param {String} eventName Event name to fire\n   * @param {Object} [options] Options object\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function fire(eventName, options) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    var listenersForEvent = this.__eventListeners[eventName];\n    if (!listenersForEvent) {\n      return this;\n    }\n\n    for (var i = 0, len = listenersForEvent.length; i < len; i++) {\n      listenersForEvent[i] && listenersForEvent[i].call(this, options || {});\n    }\n    this.__eventListeners[eventName] = listenersForEvent.filter(function (\n      value\n    ) {\n      return value !== false;\n    });\n    return this;\n  }\n\n  /**\n   * @namespace fabric.Observable\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#events}\n   * @see {@link http://fabricjs.com/events|Events demo}\n   */\n  fabric.Observable = {\n    observe: observe,\n    stopObserving: stopObserving,\n    fire: fire,\n\n    on: observe,\n    off: stopObserving,\n    trigger: fire,\n  };\n})();\n/**\n * @namespace fabric.Collection\n */\nfabric.Collection = {\n  _objects: [],\n\n  /**\n   * Adds objects to collection, Canvas or Group, then renders canvas\n   * (if `renderOnAddRemove` is not `false`).\n   * in case of Group no changes to bounding box are made.\n   * Objects should be instances of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the add method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  add: function () {\n    this._objects.push.apply(this._objects, arguments);\n    if (this._onObjectAdded) {\n      for (var i = 0, length = arguments.length; i < length; i++) {\n        this._onObjectAdded(arguments[i]);\n      }\n    }\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Inserts an object into collection at specified index, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * An object should be an instance of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the insertAt method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {Object} object Object to insert\n   * @param {Number} index Index to insert object at\n   * @param {Boolean} nonSplicing When `true`, no splicing (shifting) of objects occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  insertAt: function (object, index, nonSplicing) {\n    var objects = this._objects;\n    if (nonSplicing) {\n      objects[index] = object;\n    } else {\n      objects.splice(index, 0, object);\n    }\n    this._onObjectAdded && this._onObjectAdded(object);\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Removes objects from a collection, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  remove: function () {\n    var objects = this._objects,\n      index,\n      somethingRemoved = false;\n\n    for (var i = 0, length = arguments.length; i < length; i++) {\n      index = objects.indexOf(arguments[i]);\n\n      // only call onObjectRemoved if an object was actually removed\n      if (index !== -1) {\n        somethingRemoved = true;\n        objects.splice(index, 1);\n        this._onObjectRemoved && this._onObjectRemoved(arguments[i]);\n      }\n    }\n\n    this.renderOnAddRemove && somethingRemoved && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Executes given function for each object in this group\n   * @param {Function} callback\n   *                   Callback invoked with current object as first argument,\n   *                   index - as second and an array of all objects - as third.\n   *                   Callback is invoked in a context of Global Object (e.g. `window`)\n   *                   when no `context` argument is given\n   *\n   * @param {Object} context Context (aka thisObject)\n   * @return {Self} thisArg\n   * @chainable\n   */\n  forEachObject: function (callback, context) {\n    var objects = this.getObjects();\n    for (var i = 0, len = objects.length; i < len; i++) {\n      callback.call(context, objects[i], i, objects);\n    }\n    return this;\n  },\n\n  /**\n   * Returns an array of children objects of this instance\n   * Type parameter introduced in 1.3.10\n   * since 2.3.5 this method return always a COPY of the array;\n   * @param {String} [type] When specified, only objects of this type are returned\n   * @return {Array}\n   */\n  getObjects: function (type) {\n    if (typeof type === 'undefined') {\n      return this._objects.concat();\n    }\n    return this._objects.filter(function (o) {\n      return o.type === type;\n    });\n  },\n\n  /**\n   * Returns object at specified index\n   * @param {Number} index\n   * @return {Self} thisArg\n   */\n  item: function (index) {\n    return this._objects[index];\n  },\n\n  /**\n   * Returns true if collection contains no objects\n   * @return {Boolean} true if collection is empty\n   */\n  isEmpty: function () {\n    return this._objects.length === 0;\n  },\n\n  /**\n   * Returns a size of a collection (i.e: length of an array containing its objects)\n   * @return {Number} Collection size\n   */\n  size: function () {\n    return this._objects.length;\n  },\n\n  /**\n   * Returns true if collection contains an object\n   * @param {Object} object Object to check against\n   * @return {Boolean} `true` if collection contains an object\n   */\n  contains: function (object) {\n    return this._objects.indexOf(object) > -1;\n  },\n\n  /**\n   * Returns number representation of a collection complexity\n   * @return {Number} complexity\n   */\n  complexity: function () {\n    return this._objects.reduce(function (memo, current) {\n      memo += current.complexity ? current.complexity() : 0;\n      return memo;\n    }, 0);\n  },\n};\n/**\n * @namespace fabric.CommonMethods\n */\nfabric.CommonMethods = {\n  /**\n   * Sets object's properties from options\n   * @param {Object} [options] Options object\n   */\n  _setOptions: function (options) {\n    for (var prop in options) {\n      this.set(prop, options[prop]);\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Gradient to\n   */\n  _initGradient: function (filler, property) {\n    if (filler && filler.colorStops && !(filler instanceof fabric.Gradient)) {\n      this.set(property, new fabric.Gradient(filler));\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Pattern to\n   * @param {Function} [callback] callback to invoke after pattern load\n   */\n  _initPattern: function (filler, property, callback) {\n    if (filler && filler.source && !(filler instanceof fabric.Pattern)) {\n      this.set(property, new fabric.Pattern(filler, callback));\n    } else {\n      callback && callback();\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [options] Options object\n   */\n  _initClipping: function (options) {\n    if (!options.clipTo || typeof options.clipTo !== 'string') {\n      return;\n    }\n\n    // var functionBody = fabric.util.getFunctionBody(options.clipTo);\n    if (typeof functionBody !== 'undefined') {\n      this.clipTo = function (ctx) {\n        fabric.util.getFunctionBody(options.clipTo);\n      };\n      // this.clipTo = new Function('ctx', functionBody);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _setObject: function (obj) {\n    for (var prop in obj) {\n      this._set(prop, obj[prop]);\n    }\n  },\n\n  /**\n   * Sets property to a given value. When changing position/dimension -related properties (left, top, scale, angle, etc.) `set` does not update position of object's borders/controls. If you need to update those, call `setCoords()`.\n   * @param {String|Object} key Property name or object (if object, iterate over the object properties)\n   * @param {Object|Function} value Property value (if function, the value is passed into it and its return value is used as a new one)\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  set: function (key, value) {\n    if (typeof key === 'object') {\n      this._setObject(key);\n    } else {\n      if (typeof value === 'function' && key !== 'clipTo') {\n        this._set(key, value(this.get(key)));\n      } else {\n        this._set(key, value);\n      }\n    }\n    return this;\n  },\n\n  _set: function (key, value) {\n    this[key] = value;\n  },\n\n  /**\n   * Toggles specified property from `true` to `false` or from `false` to `true`\n   * @param {String} property Property to toggle\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  toggle: function (property) {\n    var value = this.get(property);\n    if (typeof value === 'boolean') {\n      this.set(property, !value);\n    }\n    return this;\n  },\n\n  /**\n   * Basic getter\n   * @param {String} property Property name\n   * @return {*} value of a property\n   */\n  get: function (property) {\n    return this[property];\n  },\n};\n(function initUtilities(global) {\n  var sqrt = Math.sqrt,\n    atan2 = Math.atan2,\n    pow = Math.pow,\n    PiBy180 = Math.PI / 180,\n    PiBy2 = Math.PI / 2;\n\n  /**\n   * @namespace fabric.util\n   */\n  fabric.util = {\n    /**\n     * Calculate the cos of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    cos: function (angle) {\n      if (angle === 0) {\n        return 1;\n      }\n      if (angle < 0) {\n        // cos(a) = cos(-a)\n        angle = -angle;\n      }\n      var angleSlice = angle / PiBy2;\n      switch (angleSlice) {\n        case 1:\n        case 3:\n          return 0;\n        case 2:\n          return -1;\n        default:\n      }\n      return Math.cos(angle);\n    },\n\n    /**\n     * Calculate the sin of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    sin: function (angle) {\n      if (angle === 0) {\n        return 0;\n      }\n      var angleSlice = angle / PiBy2,\n        sign = 1;\n      if (angle < 0) {\n        // sin(-a) = -sin(a)\n        sign = -1;\n      }\n      switch (angleSlice) {\n        case 1:\n          return sign;\n        case 2:\n          return 0;\n        case 3:\n          return -sign;\n        default:\n      }\n      return Math.sin(angle);\n    },\n\n    /**\n     * Removes value from an array.\n     * Presence of value (and its position in an array) is determined via `Array.prototype.indexOf`\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} array\n     * @param {*} value\n     * @return {Array} original array\n     */\n    removeFromArray: function (array, value) {\n      var idx = array.indexOf(value);\n      if (idx !== -1) {\n        array.splice(idx, 1);\n      }\n      return array;\n    },\n\n    /**\n     * Returns random number between 2 specified ones.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} min lower limit\n     * @param {Number} max upper limit\n     * @return {Number} random value (between min and max)\n     */\n    getRandomInt: function (min, max) {\n      return Math.floor(Math.random() * (max - min + 1)) + min;\n    },\n\n    /**\n     * Transforms degrees to radians.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} degrees value in degrees\n     * @return {Number} value in radians\n     */\n    degreesToRadians: function (degrees) {\n      return degrees * PiBy180;\n    },\n\n    /**\n     * Transforms radians to degrees.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} radians value in radians\n     * @return {Number} value in degrees\n     */\n    radiansToDegrees: function (radians) {\n      return radians / PiBy180;\n    },\n\n    /**\n     * Rotates `point` around `origin` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {fabric.Point} point The point to rotate\n     * @param {fabric.Point} origin The origin of the rotation\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {fabric.Point} The new rotated point\n     */\n    rotatePoint: function (point, origin, radians) {\n      point.subtractEquals(origin);\n      var v = fabric.util.rotateVector(point, radians);\n      return new fabric.Point(v.x, v.y).addEquals(origin);\n    },\n\n    /**\n     * Rotates `vector` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} vector The vector to rotate (x and y)\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {Object} The new rotated point\n     */\n    rotateVector: function (vector, radians) {\n      var sin = fabric.util.sin(radians),\n        cos = fabric.util.cos(radians),\n        rx = vector.x * cos - vector.y * sin,\n        ry = vector.x * sin + vector.y * cos;\n      return {\n        x: rx,\n        y: ry,\n      };\n    },\n\n    /**\n     * Apply transform t to point p\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Point} p The point to transform\n     * @param  {Array} t The transform\n     * @param  {Boolean} [ignoreOffset] Indicates that the offset should not be applied\n     * @return {fabric.Point} The transformed point\n     */\n    transformPoint: function (p, t, ignoreOffset) {\n      if (ignoreOffset) {\n        return new fabric.Point(\n          t[0] * p.x + t[2] * p.y,\n          t[1] * p.x + t[3] * p.y\n        );\n      }\n      return new fabric.Point(\n        t[0] * p.x + t[2] * p.y + t[4],\n        t[1] * p.x + t[3] * p.y + t[5]\n      );\n    },\n\n    /**\n     * Returns coordinates of points's bounding rectangle (left, top, width, height)\n     * @param {Array} points 4 points array\n     * @param {Array} [transform] an array of 6 numbers representing a 2x3 transform matrix\n     * @return {Object} Object with left, top, width, height properties\n     */\n    makeBoundingBoxFromPoints: function (points, transform) {\n      if (transform) {\n        for (var i = 0; i < points.length; i++) {\n          points[i] = fabric.util.transformPoint(points[i], transform);\n        }\n      }\n      var xPoints = [points[0].x, points[1].x, points[2].x, points[3].x],\n        minX = fabric.util.array.min(xPoints),\n        maxX = fabric.util.array.max(xPoints),\n        width = maxX - minX,\n        yPoints = [points[0].y, points[1].y, points[2].y, points[3].y],\n        minY = fabric.util.array.min(yPoints),\n        maxY = fabric.util.array.max(yPoints),\n        height = maxY - minY;\n\n      return {\n        left: minX,\n        top: minY,\n        width: width,\n        height: height,\n      };\n    },\n\n    /**\n     * Invert transformation t\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} t The transform\n     * @return {Array} The inverted transform\n     */\n    invertTransform: function (t) {\n      var a = 1 / (t[0] * t[3] - t[1] * t[2]),\n        r = [a * t[3], -a * t[1], -a * t[2], a * t[0]],\n        o = fabric.util.transformPoint({ x: t[4], y: t[5] }, r, true);\n      r[4] = -o.x;\n      r[5] = -o.y;\n      return r;\n    },\n\n    /**\n     * A wrapper around Number#toFixed, which contrary to native method returns number, not string.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number|String} number number to operate on\n     * @param {Number} fractionDigits number of fraction digits to \"leave\"\n     * @return {Number}\n     */\n    toFixed: function (number, fractionDigits) {\n      return parseFloat(Number(number).toFixed(fractionDigits));\n    },\n\n    /**\n     * Converts from attribute value to pixel value if applicable.\n     * Returns converted pixels or original value not converted.\n     * @param {Number|String} value number to operate on\n     * @param {Number} fontSize\n     * @return {Number|String}\n     */\n    parseUnit: function (value, fontSize) {\n      var unit = /\\D{0,2}$/.exec(value),\n        number = parseFloat(value);\n      if (!fontSize) {\n        fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\n      }\n      switch (unit[0]) {\n        case 'mm':\n          return (number * fabric.DPI) / 25.4;\n\n        case 'cm':\n          return (number * fabric.DPI) / 2.54;\n\n        case 'in':\n          return number * fabric.DPI;\n\n        case 'pt':\n          return (number * fabric.DPI) / 72; // or * 4 / 3\n\n        case 'pc':\n          return ((number * fabric.DPI) / 72) * 12; // or * 16\n\n        case 'em':\n          return number * fontSize;\n\n        default:\n          return number;\n      }\n    },\n\n    /**\n     * Function which always returns `false`.\n     * @static\n     * @memberOf fabric.util\n     * @return {Boolean}\n     */\n    falseFunction: function () {\n      return false;\n    },\n\n    /**\n     * Returns klass \"Class\" object of given namespace\n     * @memberOf fabric.util\n     * @param {String} type Type of object (eg. 'circle')\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @return {Object} klass \"Class\"\n     */\n    getKlass: function (type, namespace) {\n      // capitalize first letter only\n      type = fabric.util.string.camelize(\n        type.charAt(0).toUpperCase() + type.slice(1)\n      );\n      return fabric.util.resolveNamespace(namespace)[type];\n    },\n\n    /**\n     * Returns array of attributes for given svg that fabric parses\n     * @memberOf fabric.util\n     * @param {String} type Type of svg element (eg. 'circle')\n     * @return {Array} string names of supported attributes\n     */\n    getSvgAttributes: function (type) {\n      var attributes = ['instantiated_by_use', 'style', 'id', 'class'];\n      switch (type) {\n        case 'linearGradient':\n          attributes = attributes.concat([\n            'x1',\n            'y1',\n            'x2',\n            'y2',\n            'gradientUnits',\n            'gradientTransform',\n          ]);\n          break;\n        case 'radialGradient':\n          attributes = attributes.concat([\n            'gradientUnits',\n            'gradientTransform',\n            'cx',\n            'cy',\n            'r',\n            'fx',\n            'fy',\n            'fr',\n          ]);\n          break;\n        case 'stop':\n          attributes = attributes.concat([\n            'offset',\n            'stop-color',\n            'stop-opacity',\n          ]);\n          break;\n        default:\n          break;\n      }\n      return attributes;\n    },\n\n    /**\n     * Returns object of given namespace\n     * @memberOf fabric.util\n     * @param {String} namespace Namespace string e.g. 'fabric.Image.filter' or 'fabric'\n     * @return {Object} Object for given namespace (default fabric)\n     */\n    resolveNamespace: function (namespace) {\n      if (!namespace) {\n        return fabric;\n      }\n\n      var parts = namespace.split('.'),\n        len = parts.length,\n        i,\n        obj = global || fabric.window;\n\n      for (i = 0; i < len; ++i) {\n        obj = obj[parts[i]];\n      }\n\n      return obj;\n    },\n\n    /**\n     * Loads image element from given url and passes it to a callback\n     * @memberOf fabric.util\n     * @param {String} url URL representing an image\n     * @param {Function} callback Callback; invoked with loaded image\n     * @param {*} [context] Context to invoke callback in\n     * @param {Object} [crossOrigin] crossOrigin value to set image element to\n     */\n    loadImage: function (url, callback, context, crossOrigin) {\n      if (!url) {\n        callback && callback.call(context, url);\n        return;\n      }\n\n      var img = fabric.util.createImage();\n\n      /** @ignore */\n      var onLoadCallback = function () {\n        callback && callback.call(context, img);\n        img = img.onload = img.onerror = null;\n      };\n\n      img.onload = onLoadCallback;\n      /** @ignore */\n      img.onerror = function () {\n        fabric.log('Error loading ' + img.src);\n        callback && callback.call(context, null, true);\n        img = img.onload = img.onerror = null;\n      };\n\n      // data-urls appear to be buggy with crossOrigin\n      // https://github.com/kangax/fabric.js/commit/d0abb90f1cd5c5ef9d2a94d3fb21a22330da3e0a#commitcomment-4513767\n      // see https://code.google.com/p/chromium/issues/detail?id=315152\n      //     https://bugzilla.mozilla.org/show_bug.cgi?id=935069\n      if (url.indexOf('data') !== 0 && crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      // IE10 / IE11-Fix: SVG contents from data: URI\n      // will only be available if the IMG is present\n      // in the DOM (and visible)\n      if (url.substring(0, 14) === 'data:image/svg') {\n        img.onload = null;\n        fabric.util.loadImageInDom(img, onLoadCallback);\n      }\n\n      img.src = url;\n    },\n\n    /**\n     * Attaches SVG image with data: URL to the dom\n     * @memberOf fabric.util\n     * @param {Object} img Image object with data:image/svg src\n     * @param {Function} callback Callback; invoked with loaded image\n     * @return {Object} DOM element (div containing the SVG image)\n     */\n    loadImageInDom: function (img, onLoadCallback) {\n      var div = fabric.document.createElement('div');\n      div.style.width = div.style.height = '1px';\n      div.style.left = div.style.top = '-100%';\n      div.style.position = 'absolute';\n      div.appendChild(img);\n      fabric.document.querySelector('body').appendChild(div);\n      /**\n       * Wrap in function to:\n       *   1. Call existing callback\n       *   2. Cleanup DOM\n       */\n      img.onload = function () {\n        onLoadCallback();\n        div.parentNode.removeChild(div);\n        div = null;\n      };\n    },\n\n    /**\n     * Creates corresponding fabric instances from their object representations\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} objects Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @param {Function} reviver Method for further parsing of object elements,\n     * called after each fabric object created.\n     */\n    enlivenObjects: function (objects, callback, namespace, reviver) {\n      objects = objects || [];\n\n      var enlivenedObjects = [],\n        numLoadedObjects = 0,\n        numTotalObjects = objects.length;\n\n      function onLoaded() {\n        if (++numLoadedObjects === numTotalObjects) {\n          callback &&\n            callback(\n              enlivenedObjects.filter(function (obj) {\n                // filter out undefined objects (objects that gave error)\n                return obj;\n              })\n            );\n        }\n      }\n\n      if (!numTotalObjects) {\n        callback && callback(enlivenedObjects);\n        return;\n      }\n\n      objects.forEach(function (o, index) {\n        // if sparse array\n        if (!o || !o.type) {\n          onLoaded();\n          return;\n        }\n        var klass = fabric.util.getKlass(o.type, namespace);\n        klass.fromObject(o, function (obj, error) {\n          error || (enlivenedObjects[index] = obj);\n          reviver && reviver(o, obj, error);\n          onLoaded();\n        });\n      });\n    },\n\n    /**\n     * Create and wait for loading of patterns\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} patterns Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * called after each fabric object created.\n     */\n    enlivenPatterns: function (patterns, callback) {\n      patterns = patterns || [];\n\n      function onLoaded() {\n        if (++numLoadedPatterns === numPatterns) {\n          callback && callback(enlivenedPatterns);\n        }\n      }\n\n      var enlivenedPatterns = [],\n        numLoadedPatterns = 0,\n        numPatterns = patterns.length;\n\n      if (!numPatterns) {\n        callback && callback(enlivenedPatterns);\n        return;\n      }\n\n      patterns.forEach(function (p, index) {\n        if (p && p.source) {\n          new fabric.Pattern(p, function (pattern) {\n            enlivenedPatterns[index] = pattern;\n            onLoaded();\n          });\n        } else {\n          enlivenedPatterns[index] = p;\n          onLoaded();\n        }\n      });\n    },\n\n    /**\n     * Groups SVG elements (usually those retrieved from SVG document)\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} elements SVG elements to group\n     * @param {Object} [options] Options object\n     * @param {String} path Value to set sourcePath to\n     * @return {fabric.Object|fabric.Group}\n     */\n    groupSVGElements: function (elements, options, path) {\n      var object;\n      if (elements && elements.length === 1) {\n        return elements[0];\n      }\n      if (options) {\n        if (options.width && options.height) {\n          options.centerPoint = {\n            x: options.width / 2,\n            y: options.height / 2,\n          };\n        } else {\n          delete options.width;\n          delete options.height;\n        }\n      }\n      object = new fabric.Group(elements, options);\n      if (typeof path !== 'undefined') {\n        object.sourcePath = path;\n      }\n      return object;\n    },\n\n    /**\n     * Populates an object with properties of another object\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} source Source object\n     * @param {Object} destination Destination object\n     * @return {Array} properties Properties names to include\n     */\n    populateWithProperties: function (source, destination, properties) {\n      if (\n        properties &&\n        Object.prototype.toString.call(properties) === '[object Array]'\n      ) {\n        for (var i = 0, len = properties.length; i < len; i++) {\n          if (properties[i] in source) {\n            destination[properties[i]] = source[properties[i]];\n          }\n        }\n      }\n    },\n\n    /**\n     * Draws a dashed line between two points\n     *\n     * This method is used to draw dashed line around selection area.\n     * See <a href=\"http://stackoverflow.com/questions/4576724/dotted-stroke-in-canvas\">dotted stroke in canvas</a>\n     *\n     * @param {CanvasRenderingContext2D} ctx context\n     * @param {Number} x  start x coordinate\n     * @param {Number} y start y coordinate\n     * @param {Number} x2 end x coordinate\n     * @param {Number} y2 end y coordinate\n     * @param {Array} da dash array pattern\n     */\n    drawDashedLine: function (ctx, x, y, x2, y2, da) {\n      var dx = x2 - x,\n        dy = y2 - y,\n        len = sqrt(dx * dx + dy * dy),\n        rot = atan2(dy, dx),\n        dc = da.length,\n        di = 0,\n        draw = true;\n\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.moveTo(0, 0);\n      ctx.rotate(rot);\n\n      x = 0;\n      while (len > x) {\n        x += da[di++ % dc];\n        if (x > len) {\n          x = len;\n        }\n        ctx[draw ? 'lineTo' : 'moveTo'](x, 0);\n        draw = !draw;\n      }\n\n      ctx.restore();\n    },\n\n    /**\n     * Creates canvas element\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    createCanvasElement: function () {\n      return fabric.document.createElement('canvas');\n    },\n\n    /**\n     * Creates a canvas element that is a copy of another and is also painted\n     * @param {CanvasElement} canvas to copy size and content of\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    copyCanvasElement: function (canvas) {\n      var newCanvas = fabric.util.createCanvasElement();\n      newCanvas.width = canvas.width;\n      newCanvas.height = canvas.height;\n      newCanvas.getContext('2d').drawImage(canvas, 0, 0);\n      return newCanvas;\n    },\n\n    /**\n     * since 2.6.0 moved from canvas instance to utility.\n     * @param {CanvasElement} canvasEl to copy size and content of\n     * @param {String} format 'jpeg' or 'png', in some browsers 'webp' is ok too\n     * @param {Number} quality <= 1 and > 0\n     * @static\n     * @memberOf fabric.util\n     * @return {String} data url\n     */\n    toDataURL: function (canvasEl, format, quality) {\n      return canvasEl.toDataURL('image/' + format, quality);\n    },\n\n    /**\n     * Creates image element (works on client and node)\n     * @static\n     * @memberOf fabric.util\n     * @return {HTMLImageElement} HTML image element\n     */\n    createImage: function () {\n      return fabric.document.createElement('img');\n    },\n\n    /**\n     * @static\n     * @memberOf fabric.util\n     * @deprecated since 2.0.0\n     * @param {fabric.Object} receiver Object implementing `clipTo` method\n     * @param {CanvasRenderingContext2D} ctx Context to clip\n     */\n    clipContext: function (receiver, ctx) {\n      ctx.save();\n      ctx.beginPath();\n      receiver.clipTo(ctx);\n      ctx.clip();\n    },\n\n    /**\n     * Multiply matrix A by matrix B to nest transformations\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a First transformMatrix\n     * @param  {Array} b Second transformMatrix\n     * @param  {Boolean} is2x2 flag to multiply matrices as 2x2 matrices\n     * @return {Array} The product of the two transform matrices\n     */\n    multiplyTransformMatrices: function (a, b, is2x2) {\n      // Matrix multiply a * b\n      return [\n        a[0] * b[0] + a[2] * b[1],\n        a[1] * b[0] + a[3] * b[1],\n        a[0] * b[2] + a[2] * b[3],\n        a[1] * b[2] + a[3] * b[3],\n        is2x2 ? 0 : a[0] * b[4] + a[2] * b[5] + a[4],\n        is2x2 ? 0 : a[1] * b[4] + a[3] * b[5] + a[5],\n      ];\n    },\n\n    /**\n     * Decomposes standard 2x3 matrix into transform components\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a transformMatrix\n     * @return {Object} Components of transform\n     */\n    qrDecompose: function (a) {\n      var angle = atan2(a[1], a[0]),\n        denom = pow(a[0], 2) + pow(a[1], 2),\n        scaleX = sqrt(denom),\n        scaleY = (a[0] * a[3] - a[2] * a[1]) / scaleX,\n        skewX = atan2(a[0] * a[2] + a[1] * a[3], denom);\n      return {\n        angle: angle / PiBy180,\n        scaleX: scaleX,\n        scaleY: scaleY,\n        skewX: skewX / PiBy180,\n        skewY: 0,\n        translateX: a[4],\n        translateY: a[5],\n      };\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle] angle in degrees\n     * @return {Number[]} transform matrix\n     */\n    calcRotateMatrix: function (options) {\n      if (!options.angle) {\n        return fabric.iMatrix.concat();\n      }\n      var theta = fabric.util.degreesToRadians(options.angle),\n        cos = fabric.util.cos(theta),\n        sin = fabric.util.sin(theta);\n      return [cos, sin, -sin, cos, 0, 0];\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet.\n     * is called DimensionsTransformMatrix because those properties are the one that influence\n     * the size of the resulting box of the object.\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewX]\n     * @return {Number[]} transform matrix\n     */\n    calcDimensionsMatrix: function (options) {\n      var scaleX = typeof options.scaleX === 'undefined' ? 1 : options.scaleX,\n        scaleY = typeof options.scaleY === 'undefined' ? 1 : options.scaleY,\n        scaleMatrix = [\n          options.flipX ? -scaleX : scaleX,\n          0,\n          0,\n          options.flipY ? -scaleY : scaleY,\n          0,\n          0,\n        ],\n        multiply = fabric.util.multiplyTransformMatrices,\n        degreesToRadians = fabric.util.degreesToRadians;\n      if (options.skewX) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, 0, Math.tan(degreesToRadians(options.skewX)), 1],\n          true\n        );\n      }\n      if (options.skewY) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, Math.tan(degreesToRadians(options.skewY)), 0, 1],\n          true\n        );\n      }\n      return scaleMatrix;\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle]\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.translateX]\n     * @param  {Number} [options.translateY]\n     * @return {Number[]} transform matrix\n     */\n    composeMatrix: function (options) {\n      var matrix = [\n          1,\n          0,\n          0,\n          1,\n          options.translateX || 0,\n          options.translateY || 0,\n        ],\n        multiply = fabric.util.multiplyTransformMatrices;\n      if (options.angle) {\n        matrix = multiply(matrix, fabric.util.calcRotateMatrix(options));\n      }\n      if (\n        options.scaleX ||\n        options.scaleY ||\n        options.skewX ||\n        options.skewY ||\n        options.flipX ||\n        options.flipY\n      ) {\n        matrix = multiply(matrix, fabric.util.calcDimensionsMatrix(options));\n      }\n      return matrix;\n    },\n\n    /**\n     * Returns a transform matrix that has the same effect of scaleX, scaleY and skewX.\n     * Is deprecated for composeMatrix. Please do not use it.\n     * @static\n     * @deprecated since 3.4.0\n     * @memberOf fabric.util\n     * @param  {Number} scaleX\n     * @param  {Number} scaleY\n     * @param  {Number} skewX\n     * @return {Number[]} transform matrix\n     */\n    customTransformMatrix: function (scaleX, scaleY, skewX) {\n      return fabric.util.composeMatrix({\n        scaleX: scaleX,\n        scaleY: scaleY,\n        skewX: skewX,\n      });\n    },\n\n    /**\n     * reset an object transform state to neutral. Top and left are not accounted for\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to transform\n     */\n    resetObjectTransform: function (target) {\n      target.scaleX = 1;\n      target.scaleY = 1;\n      target.skewX = 0;\n      target.skewY = 0;\n      target.flipX = false;\n      target.flipY = false;\n      target.rotate(0);\n    },\n\n    /**\n     * Extract Object transform values\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to read from\n     * @return {Object} Components of transform\n     */\n    saveObjectTransform: function (target) {\n      return {\n        scaleX: target.scaleX,\n        scaleY: target.scaleY,\n        skewX: target.skewX,\n        skewY: target.skewY,\n        angle: target.angle,\n        left: target.left,\n        flipX: target.flipX,\n        flipY: target.flipY,\n        top: target.top,\n      };\n    },\n\n    /**\n     * Returns string representation of function body\n     * @param {Function} fn Function to get body of\n     * @return {String} Function body\n     */\n    getFunctionBody: function (fn) {\n      return (String(fn).match(/function[^{]*\\{([\\s\\S]*)\\}/) || {})[1];\n    },\n\n    /**\n     * Returns true if context has transparent pixel\n     * at specified location (taking tolerance into account)\n     * @param {CanvasRenderingContext2D} ctx context\n     * @param {Number} x x coordinate\n     * @param {Number} y y coordinate\n     * @param {Number} tolerance Tolerance\n     */\n    isTransparent: function (ctx, x, y, tolerance) {\n      // If tolerance is > 0 adjust start coords to take into account.\n      // If moves off Canvas fix to 0\n      if (tolerance > 0) {\n        if (x > tolerance) {\n          x -= tolerance;\n        } else {\n          x = 0;\n        }\n        if (y > tolerance) {\n          y -= tolerance;\n        } else {\n          y = 0;\n        }\n      }\n\n      var _isTransparent = true,\n        i,\n        temp,\n        imageData = ctx.getImageData(\n          x,\n          y,\n          tolerance * 2 || 1,\n          tolerance * 2 || 1\n        ),\n        l = imageData.data.length;\n\n      // Split image data - for tolerance > 1, pixelDataSize = 4;\n      for (i = 3; i < l; i += 4) {\n        temp = imageData.data[i];\n        _isTransparent = temp <= 0;\n        if (_isTransparent === false) {\n          break; // Stop if colour found\n        }\n      }\n\n      imageData = null;\n\n      return _isTransparent;\n    },\n\n    /**\n     * Parse preserveAspectRatio attribute from element\n     * @param {string} attribute to be parsed\n     * @return {Object} an object containing align and meetOrSlice attribute\n     */\n    parsePreserveAspectRatioAttribute: function (attribute) {\n      var meetOrSlice = 'meet',\n        alignX = 'Mid',\n        alignY = 'Mid',\n        aspectRatioAttrs = attribute.split(' '),\n        align;\n\n      if (aspectRatioAttrs && aspectRatioAttrs.length) {\n        meetOrSlice = aspectRatioAttrs.pop();\n        if (meetOrSlice !== 'meet' && meetOrSlice !== 'slice') {\n          align = meetOrSlice;\n          meetOrSlice = 'meet';\n        } else if (aspectRatioAttrs.length) {\n          align = aspectRatioAttrs.pop();\n        }\n      }\n      //divide align in alignX and alignY\n      alignX = align !== 'none' ? align.slice(1, 4) : 'none';\n      alignY = align !== 'none' ? align.slice(5, 8) : 'none';\n      return {\n        meetOrSlice: meetOrSlice,\n        alignX: alignX,\n        alignY: alignY,\n      };\n    },\n\n    /**\n     * Clear char widths cache for the given font family or all the cache if no\n     * fontFamily is specified.\n     * Use it if you know you are loading fonts in a lazy way and you are not waiting\n     * for custom fonts to load properly when adding text objects to the canvas.\n     * If a text object is added when its own font is not loaded yet, you will get wrong\n     * measurement and so wrong bounding boxes.\n     * After the font cache is cleared, either change the textObject text content or call\n     * initDimensions() to trigger a recalculation\n     * @memberOf fabric.util\n     * @param {String} [fontFamily] font family to clear\n     */\n    clearFabricFontCache: function (fontFamily) {\n      fontFamily = (fontFamily || '').toLowerCase();\n      if (!fontFamily) {\n        fabric.charWidthsCache = {};\n      } else if (fabric.charWidthsCache[fontFamily]) {\n        delete fabric.charWidthsCache[fontFamily];\n      }\n    },\n\n    /**\n     * Given current aspect ratio, determines the max width and height that can\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Number} ar aspect ratio\n     * @param {Number} maximumArea Maximum area you want to achieve\n     * @return {Object.x} Limited dimensions by X\n     * @return {Object.y} Limited dimensions by Y\n     */\n    limitDimsByArea: function (ar, maximumArea) {\n      var roughWidth = Math.sqrt(maximumArea * ar),\n        perfLimitSizeY = Math.floor(maximumArea / roughWidth);\n      return { x: Math.floor(roughWidth), y: perfLimitSizeY };\n    },\n\n    capValue: function (min, value, max) {\n      return Math.max(min, Math.min(value, max));\n    },\n\n    /**\n     * Finds the scale for the object source to fit inside the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to fit into destination\n     */\n    findScaleToFit: function (source, destination) {\n      return Math.min(\n        destination.width / source.width,\n        destination.height / source.height\n      );\n    },\n\n    /**\n     * Finds the scale for the object source to cover entirely the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to cover destination\n     */\n    findScaleToCover: function (source, destination) {\n      return Math.max(\n        destination.width / source.width,\n        destination.height / source.height\n      );\n    },\n\n    /**\n     * given an array of 6 number returns something like `\"matrix(...numbers)\"`\n     * @memberOf fabric.util\n     * @param {Array} trasnform an array with 6 numbers\n     * @return {String} transform matrix for svg\n     * @return {Object.y} Limited dimensions by Y\n     */\n    matrixToSVG: function (transform) {\n      return (\n        'matrix(' +\n        transform\n          .map(function (value) {\n            return fabric.util.toFixed(\n              value,\n              fabric.Object.NUM_FRACTION_DIGITS\n            );\n          })\n          .join(' ') +\n        ')'\n      );\n    },\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function nsSVGPathDataParser() {\n  var _join = Array.prototype.join;\n\n  /* Adapted from http://dxr.mozilla.org/mozilla-central/source/content/svg/content/src/nsSVGPathDataParser.cpp\n   * by Andrea Bogazzi code is under MPL. if you don't have a copy of the license you can take it here\n   * http://mozilla.org/MPL/2.0/\n   */\n  function arcToSegments(toX, toY, rx, ry, large, sweep, rotateX) {\n    var argsString = _join.call(arguments);\n    if (fabric.arcToSegmentsCache[argsString]) {\n      return fabric.arcToSegmentsCache[argsString];\n    }\n\n    var PI = Math.PI,\n      th = (rotateX * PI) / 180,\n      sinTh = fabric.util.sin(th),\n      cosTh = fabric.util.cos(th),\n      fromX = 0,\n      fromY = 0;\n\n    rx = Math.abs(rx);\n    ry = Math.abs(ry);\n\n    var px = -cosTh * toX * 0.5 - sinTh * toY * 0.5,\n      py = -cosTh * toY * 0.5 + sinTh * toX * 0.5,\n      rx2 = rx * rx,\n      ry2 = ry * ry,\n      py2 = py * py,\n      px2 = px * px,\n      pl = rx2 * ry2 - rx2 * py2 - ry2 * px2,\n      root = 0;\n\n    if (pl < 0) {\n      var s = Math.sqrt(1 - pl / (rx2 * ry2));\n      rx *= s;\n      ry *= s;\n    } else {\n      root =\n        (large === sweep ? -1.0 : 1.0) *\n        Math.sqrt(pl / (rx2 * py2 + ry2 * px2));\n    }\n\n    var cx = (root * rx * py) / ry,\n      cy = (-root * ry * px) / rx,\n      cx1 = cosTh * cx - sinTh * cy + toX * 0.5,\n      cy1 = sinTh * cx + cosTh * cy + toY * 0.5,\n      mTheta = calcVectorAngle(1, 0, (px - cx) / rx, (py - cy) / ry),\n      dtheta = calcVectorAngle(\n        (px - cx) / rx,\n        (py - cy) / ry,\n        (-px - cx) / rx,\n        (-py - cy) / ry\n      );\n\n    if (sweep === 0 && dtheta > 0) {\n      dtheta -= 2 * PI;\n    } else if (sweep === 1 && dtheta < 0) {\n      dtheta += 2 * PI;\n    }\n\n    // Convert into cubic bezier segments <= 90deg\n    var segments = Math.ceil(Math.abs((dtheta / PI) * 2)),\n      result = [],\n      mDelta = dtheta / segments,\n      mT =\n        ((8 / 3) * Math.sin(mDelta / 4) * Math.sin(mDelta / 4)) /\n        Math.sin(mDelta / 2),\n      th3 = mTheta + mDelta;\n\n    for (var i = 0; i < segments; i++) {\n      result[i] = segmentToBezier(\n        mTheta,\n        th3,\n        cosTh,\n        sinTh,\n        rx,\n        ry,\n        cx1,\n        cy1,\n        mT,\n        fromX,\n        fromY\n      );\n      fromX = result[i][4];\n      fromY = result[i][5];\n      mTheta = th3;\n      th3 += mDelta;\n    }\n    fabric.arcToSegmentsCache[argsString] = result;\n    return result;\n  }\n\n  function segmentToBezier(\n    th2,\n    th3,\n    cosTh,\n    sinTh,\n    rx,\n    ry,\n    cx1,\n    cy1,\n    mT,\n    fromX,\n    fromY\n  ) {\n    var costh2 = fabric.util.cos(th2),\n      sinth2 = fabric.util.sin(th2),\n      costh3 = fabric.util.cos(th3),\n      sinth3 = fabric.util.sin(th3),\n      toX = cosTh * rx * costh3 - sinTh * ry * sinth3 + cx1,\n      toY = sinTh * rx * costh3 + cosTh * ry * sinth3 + cy1,\n      cp1X = fromX + mT * (-cosTh * rx * sinth2 - sinTh * ry * costh2),\n      cp1Y = fromY + mT * (-sinTh * rx * sinth2 + cosTh * ry * costh2),\n      cp2X = toX + mT * (cosTh * rx * sinth3 + sinTh * ry * costh3),\n      cp2Y = toY + mT * (sinTh * rx * sinth3 - cosTh * ry * costh3);\n\n    return [cp1X, cp1Y, cp2X, cp2Y, toX, toY];\n  }\n\n  /*\n   * Private\n   */\n  function calcVectorAngle(ux, uy, vx, vy) {\n    var ta = Math.atan2(uy, ux),\n      tb = Math.atan2(vy, vx);\n    if (tb >= ta) {\n      return tb - ta;\n    } else {\n      return 2 * Math.PI - (ta - tb);\n    }\n  }\n\n  /**\n   * Draws arc\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {Number} fx\n   * @param {Number} fy\n   * @param {Array} coords\n   */\n  fabric.util.drawArc = function (ctx, fx, fy, coords) {\n    var rx = coords[0],\n      ry = coords[1],\n      rot = coords[2],\n      large = coords[3],\n      sweep = coords[4],\n      tx = coords[5],\n      ty = coords[6],\n      segs = [[], [], [], []],\n      segsNorm = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\n\n    for (var i = 0, len = segsNorm.length; i < len; i++) {\n      segs[i][0] = segsNorm[i][0] + fx;\n      segs[i][1] = segsNorm[i][1] + fy;\n      segs[i][2] = segsNorm[i][2] + fx;\n      segs[i][3] = segsNorm[i][3] + fy;\n      segs[i][4] = segsNorm[i][4] + fx;\n      segs[i][5] = segsNorm[i][5] + fy;\n      ctx.bezierCurveTo.apply(ctx, segs[i]);\n    }\n  };\n\n  /**\n   * Calculate bounding box of a elliptic-arc\n   * @param {Number} fx start point of arc\n   * @param {Number} fy\n   * @param {Number} rx horizontal radius\n   * @param {Number} ry vertical radius\n   * @param {Number} rot angle of horizontal axe\n   * @param {Number} large 1 or 0, whatever the arc is the big or the small on the 2 points\n   * @param {Number} sweep 1 or 0, 1 clockwise or counterclockwise direction\n   * @param {Number} tx end point of arc\n   * @param {Number} ty\n   */\n  fabric.util.getBoundsOfArc = function (\n    fx,\n    fy,\n    rx,\n    ry,\n    rot,\n    large,\n    sweep,\n    tx,\n    ty\n  ) {\n    var fromX = 0,\n      fromY = 0,\n      bound,\n      bounds = [],\n      segs = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\n\n    for (var i = 0, len = segs.length; i < len; i++) {\n      bound = getBoundsOfCurve(\n        fromX,\n        fromY,\n        segs[i][0],\n        segs[i][1],\n        segs[i][2],\n        segs[i][3],\n        segs[i][4],\n        segs[i][5]\n      );\n      bounds.push({ x: bound[0].x + fx, y: bound[0].y + fy });\n      bounds.push({ x: bound[1].x + fx, y: bound[1].y + fy });\n      fromX = segs[i][4];\n      fromY = segs[i][5];\n    }\n    return bounds;\n  };\n\n  /**\n   * Calculate bounding box of a beziercurve\n   * @param {Number} x0 starting point\n   * @param {Number} y0\n   * @param {Number} x1 first control point\n   * @param {Number} y1\n   * @param {Number} x2 secondo control point\n   * @param {Number} y2\n   * @param {Number} x3 end of beizer\n   * @param {Number} y3\n   */\n  // taken from http://jsbin.com/ivomiq/56/edit  no credits available for that.\n  function getBoundsOfCurve(x0, y0, x1, y1, x2, y2, x3, y3) {\n    var argsString;\n    if (fabric.cachesBoundsOfCurve) {\n      argsString = _join.call(arguments);\n      if (fabric.boundsOfCurveCache[argsString]) {\n        return fabric.boundsOfCurveCache[argsString];\n      }\n    }\n\n    var sqrt = Math.sqrt,\n      min = Math.min,\n      max = Math.max,\n      abs = Math.abs,\n      tvalues = [],\n      bounds = [[], []],\n      a,\n      b,\n      c,\n      t,\n      t1,\n      t2,\n      b2ac,\n      sqrtb2ac;\n\n    b = 6 * x0 - 12 * x1 + 6 * x2;\n    a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n    c = 3 * x1 - 3 * x0;\n\n    for (var i = 0; i < 2; ++i) {\n      if (i > 0) {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n\n      if (abs(a) < 1e-12) {\n        if (abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      if (b2ac < 0) {\n        continue;\n      }\n      sqrtb2ac = sqrt(b2ac);\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    var x,\n      y,\n      j = tvalues.length,\n      jlen = j,\n      mt;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      x =\n        mt * mt * mt * x0 +\n        3 * mt * mt * t * x1 +\n        3 * mt * t * t * x2 +\n        t * t * t * x3;\n      bounds[0][j] = x;\n\n      y =\n        mt * mt * mt * y0 +\n        3 * mt * mt * t * y1 +\n        3 * mt * t * t * y2 +\n        t * t * t * y3;\n      bounds[1][j] = y;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    var result = [\n      {\n        x: min.apply(null, bounds[0]),\n        y: min.apply(null, bounds[1]),\n      },\n      {\n        x: max.apply(null, bounds[0]),\n        y: max.apply(null, bounds[1]),\n      },\n    ];\n    if (fabric.cachesBoundsOfCurve) {\n      fabric.boundsOfCurveCache[argsString] = result;\n    }\n    return result;\n  }\n\n  fabric.util.getBoundsOfCurve = getBoundsOfCurve;\n})();\n(function initArrayUtilities() {\n  var slice = Array.prototype.slice;\n\n  /**\n   * Invokes method on all items in a given array\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} method Name of a method to invoke\n   * @return {Array}\n   */\n  function invoke(array, method) {\n    var args = slice.call(arguments, 2),\n      result = [];\n    for (var i = 0, len = array.length; i < len; i++) {\n      result[i] = args.length\n        ? array[i][method].apply(array[i], args)\n        : array[i][method].call(array[i]);\n    }\n    return result;\n  }\n\n  /**\n   * Finds maximum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function max(array, byProperty) {\n    return find(array, byProperty, function (value1, value2) {\n      return value1 >= value2;\n    });\n  }\n\n  /**\n   * Finds minimum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function min(array, byProperty) {\n    return find(array, byProperty, function (value1, value2) {\n      return value1 < value2;\n    });\n  }\n\n  /**\n   * @private\n   */\n  function fill(array, value) {\n    var k = array.length;\n    while (k--) {\n      array[k] = value;\n    }\n    return array;\n  }\n\n  /**\n   * @private\n   */\n  function find(array, byProperty, condition) {\n    if (!array || array.length === 0) {\n      return;\n    }\n\n    var i = array.length - 1,\n      result = byProperty ? array[i][byProperty] : array[i];\n    if (byProperty) {\n      while (i--) {\n        if (condition(array[i][byProperty], result)) {\n          result = array[i][byProperty];\n        }\n      }\n    } else {\n      while (i--) {\n        if (condition(array[i], result)) {\n          result = array[i];\n        }\n      }\n    }\n    return result;\n  }\n\n  /**\n   * @namespace fabric.util.array\n   */\n  fabric.util.array = {\n    fill: fill,\n    invoke: invoke,\n    min: min,\n    max: max,\n  };\n})();\n(function () {\n  /**\n   * Copies all enumerable properties of one js object to another\n   * this does not and cannot compete with generic utils.\n   * Does not clone or extend fabric.Object subclasses.\n   * This is mostly for internal use and has extra handling for fabricJS objects\n   * it skips the canvas property in deep cloning.\n   * @memberOf fabric.util.object\n   * @param {Object} destination Where to copy to\n   * @param {Object} source Where to copy from\n   * @return {Object}\n   */\n\n  function extend(destination, source, deep) {\n    // JScript DontEnum bug is not taken care of\n    // the deep clone is for internal use, is not meant to avoid\n    // javascript traps or cloning html element or self referenced objects.\n    if (deep) {\n      if (!fabric.isLikelyNode && source instanceof Element) {\n        // avoid cloning deep images, canvases,\n        destination = source;\n      } else if (source instanceof Array) {\n        destination = [];\n        for (let i = 0, len = source.length; i < len; i++) {\n          destination[i] = extend({}, source[i], deep);\n        }\n      } else if (source && typeof source === 'object') {\n        for (let property in source) {\n          if (property === 'canvas') {\n            destination[property] = extend({}, source[property]);\n          } else if (source.hasOwnProperty(property)) {\n            destination[property] = extend({}, source[property], deep);\n          }\n        }\n      } else {\n        // this sounds odd for an extend but is ok for recursive use\n        destination = source;\n      }\n    } else {\n      for (let property in source) {\n        destination[property] = source[property];\n      }\n    }\n    return destination;\n  }\n\n  /**\n   * Creates an empty object and copies all enumerable properties of another object to it\n   * @memberOf fabric.util.object\n   * TODO: this function return an empty object if you try to clone null\n   * @param {Object} object Object to clone\n   * @return {Object}\n   */\n  function clone(object, deep) {\n    return extend({}, object, deep);\n  }\n\n  /** @namespace fabric.util.object */\n  fabric.util.object = {\n    extend: extend,\n    clone: clone,\n  };\n  fabric.util.object.extend(fabric.util, fabric.Observable);\n})();\n(function initStringUtilities() {\n  /**\n   * Camelizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to camelize\n   * @return {String} Camelized version of a string\n   */\n  function camelize(string) {\n    return string.replace(/-+(.)?/g, function (match, character) {\n      return character ? character.toUpperCase() : '';\n    });\n  }\n\n  /**\n   * Capitalizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to capitalize\n   * @param {Boolean} [firstLetterOnly] If true only first letter is capitalized\n   * and other letters stay untouched, if false first letter is capitalized\n   * and other letters are converted to lowercase.\n   * @return {String} Capitalized version of a string\n   */\n  function capitalize(string, firstLetterOnly) {\n    return (\n      string.charAt(0).toUpperCase() +\n      (firstLetterOnly ? string.slice(1) : string.slice(1).toLowerCase())\n    );\n  }\n\n  /**\n   * Escapes XML in a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to escape\n   * @return {String} Escaped version of a string\n   */\n  function escapeXml(string) {\n    return string\n      .replace(/&/g, '&amp;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;');\n  }\n\n  /**\n   * Divide a string in the user perceived single units\n   * @memberOf fabric.util.string\n   * @param {String} textstring String to escape\n   * @return {Array} array containing the graphemes\n   */\n  function graphemeSplit(textstring) {\n    var i = 0,\n      chr,\n      graphemes = [];\n    for (i = 0, chr; i < textstring.length; i++) {\n      if ((chr = getWholeChar(textstring, i)) === false) {\n        continue;\n      }\n      graphemes.push(chr);\n    }\n    return graphemes;\n  }\n\n  // taken from mdn in the charAt doc page.\n  function getWholeChar(str, i) {\n    var code = str.charCodeAt(i);\n\n    if (isNaN(code)) {\n      return ''; // Position not found\n    }\n    if (code < 0xd800 || code > 0xdfff) {\n      return str.charAt(i);\n    }\n\n    // High surrogate (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xd800 <= code && code <= 0xdbff) {\n      if (str.length <= i + 1) {\n        throw new Error('High surrogate without following low surrogate');\n      }\n      var next = str.charCodeAt(i + 1);\n      if (0xdc00 > next || next > 0xdfff) {\n        throw new Error('High surrogate without following low surrogate');\n      }\n      return str.charAt(i) + str.charAt(i + 1);\n    }\n    // Low surrogate (0xDC00 <= code && code <= 0xDFFF)\n    if (i === 0) {\n      throw new Error('Low surrogate without preceding high surrogate');\n    }\n    var prev = str.charCodeAt(i - 1);\n\n    // (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xd800 > prev || prev > 0xdbff) {\n      throw new Error('Low surrogate without preceding high surrogate');\n    }\n    // We can pass over low surrogates now as the second component\n    // in a pair which we have already processed\n    return false;\n  }\n\n  /**\n   * String utilities\n   * @namespace fabric.util.string\n   */\n  fabric.util.string = {\n    camelize: camelize,\n    capitalize: capitalize,\n    escapeXml: escapeXml,\n    graphemeSplit: graphemeSplit,\n  };\n})();\n(function () {\n  var slice = Array.prototype.slice,\n    emptyFunction = function () {},\n    IS_DONTENUM_BUGGY = (function () {\n      for (var p in { toString: 1 }) {\n        if (p === 'toString') {\n          return false;\n        }\n      }\n      return true;\n    })(),\n    /** @ignore */\n    addMethods = function (klass, source, parent) {\n      for (var property in source) {\n        if (\n          property in klass.prototype &&\n          typeof klass.prototype[property] === 'function' &&\n          (source[property] + '').indexOf('callSuper') > -1\n        ) {\n          klass.prototype[property] = (function (property) {\n            return function () {\n              var superclass = this.constructor.superclass;\n              this.constructor.superclass = parent;\n              var returnValue = source[property].apply(this, arguments);\n              this.constructor.superclass = superclass;\n\n              if (property !== 'initialize') {\n                return returnValue;\n              }\n            };\n          })(property);\n        } else {\n          klass.prototype[property] = source[property];\n        }\n\n        if (IS_DONTENUM_BUGGY) {\n          if (source.toString !== Object.prototype.toString) {\n            klass.prototype.toString = source.toString;\n          }\n          if (source.valueOf !== Object.prototype.valueOf) {\n            klass.prototype.valueOf = source.valueOf;\n          }\n        }\n      }\n    };\n\n  function Subclass() {}\n\n  function callSuper(methodName) {\n    var parentMethod = null,\n      _this = this;\n\n    // climb prototype chain to find method not equal to callee's method\n    while (_this.constructor.superclass) {\n      var superClassMethod = _this.constructor.superclass.prototype[methodName];\n      if (_this[methodName] !== superClassMethod) {\n        parentMethod = superClassMethod;\n        break;\n      }\n      // eslint-disable-next-line\n      _this = _this.constructor.superclass.prototype;\n    }\n\n    if (!parentMethod) {\n      return console.log(\n        'tried to callSuper ' +\n          methodName +\n          ', method not found in prototype chain',\n        this\n      );\n    }\n\n    return arguments.length > 1\n      ? parentMethod.apply(this, slice.call(arguments, 1))\n      : parentMethod.call(this);\n  }\n\n  /**\n   * Helper for creation of \"classes\".\n   * @memberOf fabric.util\n   * @param {Function} [parent] optional \"Class\" to inherit from\n   * @param {Object} [properties] Properties shared by all instances of this class\n   *                  (be careful modifying objects defined here as this would affect all instances)\n   */\n  function createClass() {\n    var parent = null,\n      properties = slice.call(arguments, 0);\n\n    if (typeof properties[0] === 'function') {\n      parent = properties.shift();\n    }\n    function klass() {\n      this.initialize.apply(this, arguments);\n    }\n\n    klass.superclass = parent;\n    klass.subclasses = [];\n\n    if (parent) {\n      Subclass.prototype = parent.prototype;\n      klass.prototype = new Subclass();\n      parent.subclasses.push(klass);\n    }\n    for (var i = 0, length = properties.length; i < length; i++) {\n      addMethods(klass, properties[i], parent);\n    }\n    if (!klass.prototype.initialize) {\n      klass.prototype.initialize = emptyFunction;\n    }\n    klass.prototype.constructor = klass;\n    klass.prototype.callSuper = callSuper;\n    return klass;\n  }\n\n  fabric.util.createClass = createClass;\n})();\n(function initStyles() {\n  /**\n   * Cross-browser wrapper for setting element's style\n   * @memberOf fabric.util\n   * @param {HTMLElement} element\n   * @param {Object} styles\n   * @return {HTMLElement} Element that was passed as a first argument\n   */\n  function setStyle(element, styles) {\n    var elementStyle = element.style;\n    if (!elementStyle) {\n      return element;\n    }\n    if (typeof styles === 'string') {\n      element.style.cssText += ';' + styles;\n      return styles.indexOf('opacity') > -1\n        ? setOpacity(element, styles.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1])\n        : element;\n    }\n    for (var property in styles) {\n      if (property === 'opacity') {\n        setOpacity(element, styles[property]);\n      } else {\n        var normalizedProperty =\n          property === 'float' || property === 'cssFloat'\n            ? typeof elementStyle.styleFloat === 'undefined'\n              ? 'cssFloat'\n              : 'styleFloat'\n            : property;\n        elementStyle[normalizedProperty] = styles[property];\n      }\n    }\n    return element;\n  }\n\n  var parseEl = fabric.document.createElement('div'),\n    supportsOpacity = typeof parseEl.style.opacity === 'string',\n    supportsFilters = typeof parseEl.style.filter === 'string',\n    reOpacity = /alpha\\s*\\(\\s*opacity\\s*=\\s*([^)]+)\\)/,\n    /** @ignore */\n    setOpacity = function (element) {\n      return element;\n    };\n\n  if (supportsOpacity) {\n    /** @ignore */\n    setOpacity = function (element, value) {\n      element.style.opacity = value;\n      return element;\n    };\n  } else if (supportsFilters) {\n    /** @ignore */\n    setOpacity = function (element, value) {\n      var es = element.style;\n      if (element.currentStyle && !element.currentStyle.hasLayout) {\n        es.zoom = 1;\n      }\n      if (reOpacity.test(es.filter)) {\n        value = value >= 0.9999 ? '' : 'alpha(opacity=' + value * 100 + ')';\n        es.filter = es.filter.replace(reOpacity, value);\n      } else {\n        es.filter += ' alpha(opacity=' + value * 100 + ')';\n      }\n      return element;\n    };\n  }\n\n  fabric.util.setStyle = setStyle;\n})();\n(function () {\n  var _slice = Array.prototype.slice;\n\n  /**\n   * Takes id and returns an element with that id (if one exists in a document)\n   * @memberOf fabric.util\n   * @param {String|HTMLElement} id\n   * @return {HTMLElement|null}\n   */\n  function getById(id) {\n    return typeof id === 'string' ? fabric.document.getElementById(id) : id;\n  }\n\n  var sliceCanConvertNodelists,\n    /**\n     * Converts an array-like object (e.g. arguments or NodeList) to an array\n     * @memberOf fabric.util\n     * @param {Object} arrayLike\n     * @return {Array}\n     */\n    toArray = function (arrayLike) {\n      return _slice.call(arrayLike, 0);\n    };\n\n  try {\n    sliceCanConvertNodelists =\n      toArray(fabric.document.childNodes) instanceof Array;\n  } catch (err) {}\n\n  if (!sliceCanConvertNodelists) {\n    toArray = function (arrayLike) {\n      var arr = new Array(arrayLike.length),\n        i = arrayLike.length;\n      while (i--) {\n        arr[i] = arrayLike[i];\n      }\n      return arr;\n    };\n  }\n\n  /**\n   * Creates specified element with specified attributes\n   * @memberOf fabric.util\n   * @param {String} tagName Type of an element to create\n   * @param {Object} [attributes] Attributes to set on an element\n   * @return {HTMLElement} Newly created element\n   */\n  function makeElement(tagName, attributes) {\n    var el = fabric.document.createElement(tagName);\n    for (var prop in attributes) {\n      if (prop === 'class') {\n        el.className = attributes[prop];\n      } else if (prop === 'for') {\n        el.htmlFor = attributes[prop];\n      } else {\n        el.setAttribute(prop, attributes[prop]);\n      }\n    }\n    return el;\n  }\n\n  /**\n   * Adds class to an element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to add class to\n   * @param {String} className Class to add to an element\n   */\n  function addClass(element, className) {\n    if (\n      element &&\n      (' ' + element.className + ' ').indexOf(' ' + className + ' ') === -1\n    ) {\n      element.className += (element.className ? ' ' : '') + className;\n    }\n  }\n\n  /**\n   * Wraps element with another element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to wrap\n   * @param {HTMLElement|String} wrapper Element to wrap with\n   * @param {Object} [attributes] Attributes to set on a wrapper\n   * @return {HTMLElement} wrapper\n   */\n  function wrapElement(element, wrapper, attributes) {\n    if (typeof wrapper === 'string') {\n      wrapper = makeElement(wrapper, attributes);\n    }\n    if (element.parentNode) {\n      element.parentNode.replaceChild(wrapper, element);\n    }\n    wrapper.appendChild(element);\n    return wrapper;\n  }\n\n  /**\n   * Returns element scroll offsets\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to operate on\n   * @return {Object} Object with left/top values\n   */\n  function getScrollLeftTop(element) {\n    var left = 0,\n      top = 0,\n      docElement = fabric.document.documentElement,\n      body = fabric.document.body || {\n        scrollLeft: 0,\n        scrollTop: 0,\n      };\n\n    // While loop checks (and then sets element to) .parentNode OR .host\n    //  to account for ShadowDOM. We still want to traverse up out of ShadowDOM,\n    //  but the .parentNode of a root ShadowDOM node will always be null, instead\n    //  it should be accessed through .host. See http://stackoverflow.com/a/24765528/4383938\n    while (element && (element.parentNode || element.host)) {\n      // Set element to element parent, or 'host' in case of ShadowDOM\n      element = element.parentNode || element.host;\n\n      if (element === fabric.document) {\n        left = body.scrollLeft || docElement.scrollLeft || 0;\n        top = body.scrollTop || docElement.scrollTop || 0;\n      } else {\n        left += element.scrollLeft || 0;\n        top += element.scrollTop || 0;\n      }\n\n      if (element.nodeType === 1 && element.style.position === 'fixed') {\n        break;\n      }\n    }\n\n    return { left: left, top: top };\n  }\n\n  /**\n   * Returns offset for a given element\n   * @function\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get offset for\n   * @return {Object} Object with \"left\" and \"top\" properties\n   */\n  function getElementOffset(element) {\n    var docElem,\n      doc = element && element.ownerDocument,\n      box = { left: 0, top: 0 },\n      offset = { left: 0, top: 0 },\n      scrollLeftTop,\n      offsetAttributes = {\n        borderLeftWidth: 'left',\n        borderTopWidth: 'top',\n        paddingLeft: 'left',\n        paddingTop: 'top',\n      };\n\n    if (!doc) {\n      return offset;\n    }\n\n    for (var attr in offsetAttributes) {\n      offset[offsetAttributes[attr]] +=\n        parseInt(getElementStyle(element, attr), 10) || 0;\n    }\n\n    docElem = doc.documentElement;\n    if (typeof element.getBoundingClientRect !== 'undefined') {\n      box = element.getBoundingClientRect();\n    }\n\n    scrollLeftTop = getScrollLeftTop(element);\n\n    return {\n      left:\n        box.left + scrollLeftTop.left - (docElem.clientLeft || 0) + offset.left,\n      top: box.top + scrollLeftTop.top - (docElem.clientTop || 0) + offset.top,\n    };\n  }\n\n  /**\n   * Returns style attribute value of a given element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get style attribute for\n   * @param {String} attr Style attribute to get for element\n   * @return {String} Style attribute value of the given element.\n   */\n  var getElementStyle;\n  if (\n    fabric.document.defaultView &&\n    fabric.document.defaultView.getComputedStyle\n  ) {\n    getElementStyle = function (element, attr) {\n      var style = fabric.document.defaultView.getComputedStyle(element, null);\n      return style ? style[attr] : undefined;\n    };\n  } else {\n    getElementStyle = function (element, attr) {\n      var value = element.style[attr];\n      if (!value && element.currentStyle) {\n        value = element.currentStyle[attr];\n      }\n      return value;\n    };\n  }\n\n  (function () {\n    var style = fabric.document.documentElement.style,\n      selectProp =\n        'userSelect' in style\n          ? 'userSelect'\n          : 'MozUserSelect' in style\n          ? 'MozUserSelect'\n          : 'WebkitUserSelect' in style\n          ? 'WebkitUserSelect'\n          : 'KhtmlUserSelect' in style\n          ? 'KhtmlUserSelect'\n          : '';\n\n    /**\n     * Makes element unselectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make unselectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementUnselectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = fabric.util.falseFunction;\n      }\n      if (selectProp) {\n        element.style[selectProp] = 'none';\n      } else if (typeof element.unselectable === 'string') {\n        element.unselectable = 'on';\n      }\n      return element;\n    }\n\n    /**\n     * Makes element selectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make selectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementSelectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = null;\n      }\n      if (selectProp) {\n        element.style[selectProp] = '';\n      } else if (typeof element.unselectable === 'string') {\n        element.unselectable = '';\n      }\n      return element;\n    }\n\n    fabric.util.makeElementUnselectable = makeElementUnselectable;\n    fabric.util.makeElementSelectable = makeElementSelectable;\n  })();\n\n  (function () {\n    /**\n     * Inserts a script element with a given url into a document; invokes callback, when that script is finished loading\n     * @memberOf fabric.util\n     * @param {String} url URL of a script to load\n     * @param {Function} callback Callback to execute when script is finished loading\n     */\n    function getScript(url, callback) {\n      var headEl = fabric.document.getElementsByTagName('head')[0],\n        scriptEl = fabric.document.createElement('script'),\n        loading = true;\n\n      /** @ignore */\n      scriptEl.onload = /** @ignore */ scriptEl.onreadystatechange = function (\n        e\n      ) {\n        if (loading) {\n          if (\n            typeof this.readyState === 'string' &&\n            this.readyState !== 'loaded' &&\n            this.readyState !== 'complete'\n          ) {\n            return;\n          }\n          loading = false;\n          callback(e || fabric.window.event);\n          scriptEl = scriptEl.onload = scriptEl.onreadystatechange = null;\n        }\n      };\n      scriptEl.src = url;\n      headEl.appendChild(scriptEl);\n      // causes issue in Opera\n      // headEl.removeChild(scriptEl);\n    }\n\n    fabric.util.getScript = getScript;\n  })();\n\n  function getNodeCanvas(element) {\n    var impl = fabric.jsdomImplForWrapper(element);\n    return impl._canvas || impl._image;\n  }\n\n  function cleanUpJsdomNode(element) {\n    if (!fabric.isLikelyNode) {\n      return;\n    }\n    var impl = fabric.jsdomImplForWrapper(element);\n    if (impl) {\n      impl._image = null;\n      impl._canvas = null;\n      // unsure if necessary\n      impl._currentSrc = null;\n      impl._attributes = null;\n      impl._classList = null;\n    }\n  }\n\n  fabric.util.getById = getById;\n  fabric.util.toArray = toArray;\n  fabric.util.makeElement = makeElement;\n  fabric.util.addClass = addClass;\n  fabric.util.wrapElement = wrapElement;\n  fabric.util.getScrollLeftTop = getScrollLeftTop;\n  fabric.util.getElementOffset = getElementOffset;\n  fabric.util.getElementStyle = getElementStyle;\n  fabric.util.getNodeCanvas = getNodeCanvas;\n  fabric.util.cleanUpJsdomNode = cleanUpJsdomNode;\n})();\n/**\n * Wrapper around `console.log` (when available)\n * @param {*} [values] Values to log\n */\nfabric.log = console.log;\n\n/**\n * Wrapper around `console.warn` (when available)\n * @param {*} [values] Values to log as a warning\n */\nfabric.warn = console.warn;\n(function () {\n  function noop() {\n    return false;\n  }\n\n  function defaultEasing(t, b, c, d) {\n    return -c * Math.cos((t / d) * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Changes value from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {Object} [options] Animation options\n   * @param {Function} [options.onChange] Callback; invoked on every value change\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\n   * @param {Number} [options.startValue=0] Starting value\n   * @param {Number} [options.endValue=100] Ending value\n   * @param {Number} [options.byValue=100] Value to modify the property by\n   * @param {Function} [options.easing] Easing function\n   * @param {Number} [options.duration=500] Duration of change (in ms)\n   * @param {Function} [options.abort] Additional function with logic. If returns true, onComplete is called.\n   */\n  function animate(options) {\n    requestAnimFrame(function (timestamp) {\n      options || (options = {});\n\n      var start = timestamp || +new Date(),\n        duration = options.duration || 500,\n        finish = start + duration,\n        time,\n        onChange = options.onChange || noop,\n        abort = options.abort || noop,\n        onComplete = options.onComplete || noop,\n        easing = options.easing || defaultEasing,\n        startValue = 'startValue' in options ? options.startValue : 0,\n        endValue = 'endValue' in options ? options.endValue : 100,\n        byValue = options.byValue || endValue - startValue;\n\n      options.onStart && options.onStart();\n\n      (function tick(ticktime) {\n        // TODO: move abort call after calculation\n        // and pass (current,valuePerc, timePerc) as arguments\n        time = ticktime || +new Date();\n        var currentTime = time > finish ? duration : time - start,\n          timePerc = currentTime / duration,\n          current = easing(currentTime, startValue, byValue, duration),\n          valuePerc = Math.abs((current - startValue) / byValue);\n        if (abort()) {\n          onComplete(endValue, 1, 1);\n          return;\n        }\n        if (time > finish) {\n          onChange(endValue, 1, 1);\n          onComplete(endValue, 1, 1);\n          return;\n        } else {\n          onChange(current, valuePerc, timePerc);\n          requestAnimFrame(tick);\n        }\n      })(start);\n    });\n  }\n\n  var _requestAnimFrame =\n    fabric.window.requestAnimationFrame ||\n    fabric.window.webkitRequestAnimationFrame ||\n    fabric.window.mozRequestAnimationFrame ||\n    fabric.window.oRequestAnimationFrame ||\n    fabric.window.msRequestAnimationFrame ||\n    function (callback) {\n      return fabric.window.setTimeout(callback, 1000 / 60);\n    };\n\n  var _cancelAnimFrame =\n    fabric.window.cancelAnimationFrame || fabric.window.clearTimeout;\n\n  /**\n   * requestAnimationFrame polyfill based on http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   * In order to get a precise start time, `requestAnimFrame` should be called as an entry into the method\n   * @memberOf fabric.util\n   * @param {Function} callback Callback to invoke\n   * @param {DOMElement} element optional Element to associate with animation\n   */\n  function requestAnimFrame() {\n    return _requestAnimFrame.apply(fabric.window, arguments);\n  }\n\n  function cancelAnimFrame() {\n    return _cancelAnimFrame.apply(fabric.window, arguments);\n  }\n\n  fabric.util.animate = animate;\n  fabric.util.requestAnimFrame = requestAnimFrame;\n  fabric.util.cancelAnimFrame = cancelAnimFrame;\n})();\n(function () {\n  // Calculate an in-between color. Returns a \"rgba()\" string.\n  // Credit: Edwin Martin <edwin@bitstorm.org>\n  //         http://www.bitstorm.org/jquery/color-animation/jquery.animate-colors.js\n  function calculateColor(begin, end, pos) {\n    var color =\n      'rgba(' +\n      parseInt(begin[0] + pos * (end[0] - begin[0]), 10) +\n      ',' +\n      parseInt(begin[1] + pos * (end[1] - begin[1]), 10) +\n      ',' +\n      parseInt(begin[2] + pos * (end[2] - begin[2]), 10);\n\n    color +=\n      ',' +\n      (begin && end ? parseFloat(begin[3] + pos * (end[3] - begin[3])) : 1);\n    color += ')';\n    return color;\n  }\n\n  /**\n   * Changes the color from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {String} fromColor The starting color in hex or rgb(a) format.\n   * @param {String} toColor The starting color in hex or rgb(a) format.\n   * @param {Number} [duration] Duration of change (in ms).\n   * @param {Object} [options] Animation options\n   * @param {Function} [options.onChange] Callback; invoked on every value change\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\n   * @param {Function} [options.colorEasing] Easing function. Note that this function only take two arguments (currentTime, duration). Thus the regular animation easing functions cannot be used.\n   * @param {Function} [options.abort] Additional function with logic. If returns true, onComplete is called.\n   */\n  function animateColor(fromColor, toColor, duration, options) {\n    var startColor = new fabric.Color(fromColor).getSource(),\n      endColor = new fabric.Color(toColor).getSource();\n\n    options = options || {};\n\n    fabric.util.animate(\n      fabric.util.object.extend(options, {\n        duration: duration || 500,\n        startValue: startColor,\n        endValue: endColor,\n        byValue: endColor,\n        easing: function (currentTime, startValue, byValue, duration) {\n          var posValue = options.colorEasing\n            ? options.colorEasing(currentTime, duration)\n            : 1 - Math.cos((currentTime / duration) * (Math.PI / 2));\n          return calculateColor(startValue, byValue, posValue);\n        },\n      })\n    );\n  }\n\n  fabric.util.animateColor = animateColor;\n})();\n(function initEasingUtilities() {\n  function normalize(a, c, p, s) {\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      //handle the 0/0 case:\n      if (c === 0 && a === 0) {\n        s = (p / (2 * Math.PI)) * Math.asin(1);\n      } else {\n        s = (p / (2 * Math.PI)) * Math.asin(c / a);\n      }\n    }\n    return { a: a, c: c, p: p, s: s };\n  }\n\n  function elastic(opts, t, d) {\n    return (\n      opts.a *\n      Math.pow(2, 10 * (t -= 1)) *\n      Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p)\n    );\n  }\n\n  /**\n   * Cubic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCubic(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t + 1) + b;\n  }\n\n  /**\n   * Cubic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCubic(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t + b;\n    }\n    return (c / 2) * ((t -= 2) * t * t + 2) + b;\n  }\n\n  /**\n   * Quartic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuart(t, b, c, d) {\n    return c * (t /= d) * t * t * t + b;\n  }\n\n  /**\n   * Quartic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuart(t, b, c, d) {\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n  }\n\n  /**\n   * Quartic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuart(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t * t + b;\n    }\n    return (-c / 2) * ((t -= 2) * t * t * t - 2) + b;\n  }\n\n  /**\n   * Quintic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuint(t, b, c, d) {\n    return c * (t /= d) * t * t * t * t + b;\n  }\n\n  /**\n   * Quintic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuint(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  }\n\n  /**\n   * Quintic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuint(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t * t * t + b;\n    }\n    return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n  }\n\n  /**\n   * Sinusoidal easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInSine(t, b, c, d) {\n    return -c * Math.cos((t / d) * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Sinusoidal easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutSine(t, b, c, d) {\n    return c * Math.sin((t / d) * (Math.PI / 2)) + b;\n  }\n\n  /**\n   * Sinusoidal easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutSine(t, b, c, d) {\n    return (-c / 2) * (Math.cos((Math.PI * t) / d) - 1) + b;\n  }\n\n  /**\n   * Exponential easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInExpo(t, b, c, d) {\n    return t === 0 ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n  }\n\n  /**\n   * Exponential easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutExpo(t, b, c, d) {\n    return t === d ? b + c : c * (-Math.pow(2, (-10 * t) / d) + 1) + b;\n  }\n\n  /**\n   * Exponential easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutExpo(t, b, c, d) {\n    if (t === 0) {\n      return b;\n    }\n    if (t === d) {\n      return b + c;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * Math.pow(2, 10 * (t - 1)) + b;\n    }\n    return (c / 2) * (-Math.pow(2, -10 * --t) + 2) + b;\n  }\n\n  /**\n   * Circular easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInCirc(t, b, c, d) {\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n  }\n\n  /**\n   * Circular easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCirc(t, b, c, d) {\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n  }\n\n  /**\n   * Circular easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCirc(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (-c / 2) * (Math.sqrt(1 - t * t) - 1) + b;\n    }\n    return (c / 2) * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n  }\n\n  /**\n   * Elastic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return -elastic(opts, t, d) + b;\n  }\n\n  /**\n   * Elastic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return (\n      opts.a *\n        Math.pow(2, -10 * t) *\n        Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p) +\n      opts.c +\n      b\n    );\n  }\n\n  /**\n   * Elastic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d / 2;\n    if (t === 2) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n    var opts = normalize(a, c, p, s);\n    if (t < 1) {\n      return -0.5 * elastic(opts, t, d) + b;\n    }\n    return (\n      opts.a *\n        Math.pow(2, -10 * (t -= 1)) *\n        Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p) *\n        0.5 +\n      opts.c +\n      b\n    );\n  }\n\n  /**\n   * Backwards easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  }\n\n  /**\n   * Backwards easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  }\n\n  /**\n   * Backwards easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    }\n    return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n  }\n\n  /**\n   * Bouncing easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBounce(t, b, c, d) {\n    return c - easeOutBounce(d - t, 0, c, d) + b;\n  }\n\n  /**\n   * Bouncing easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBounce(t, b, c, d) {\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  }\n\n  /**\n   * Bouncing easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBounce(t, b, c, d) {\n    if (t < d / 2) {\n      return easeInBounce(t * 2, 0, c, d) * 0.5 + b;\n    }\n    return easeOutBounce(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n  }\n\n  /**\n   * Easing functions\n   * See <a href=\"http://gizma.com/easing/\">Easing Equations by Robert Penner</a>\n   * @namespace fabric.util.ease\n   */\n  fabric.util.ease = {\n    /**\n     * Quadratic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInQuad: function (t, b, c, d) {\n      return c * (t /= d) * t + b;\n    },\n\n    /**\n     * Quadratic easing out\n     * @memberOf fabric.util.ease\n     */\n    easeOutQuad: function (t, b, c, d) {\n      return -c * (t /= d) * (t - 2) + b;\n    },\n\n    /**\n     * Quadratic easing in and out\n     * @memberOf fabric.util.ease\n     */\n    easeInOutQuad: function (t, b, c, d) {\n      t /= d / 2;\n      if (t < 1) {\n        return (c / 2) * t * t + b;\n      }\n      return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n\n    /**\n     * Cubic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInCubic: function (t, b, c, d) {\n      return c * (t /= d) * t * t + b;\n    },\n\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n    easeInSine: easeInSine,\n    easeOutSine: easeOutSine,\n    easeInOutSine: easeInOutSine,\n    easeInExpo: easeInExpo,\n    easeOutExpo: easeOutExpo,\n    easeInOutExpo: easeInOutExpo,\n    easeInCirc: easeInCirc,\n    easeOutCirc: easeOutCirc,\n    easeInOutCirc: easeInOutCirc,\n    easeInElastic: easeInElastic,\n    easeOutElastic: easeOutElastic,\n    easeInOutElastic: easeInOutElastic,\n    easeInBack: easeInBack,\n    easeOutBack: easeOutBack,\n    easeInOutBack: easeInOutBack,\n    easeInBounce: easeInBounce,\n    easeOutBounce: easeOutBounce,\n    easeInOutBounce: easeInOutBounce,\n  };\n})();\n(function initPoint(global) {\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Point) {\n    fabric.warn('fabric.Point is already defined');\n    return;\n  }\n\n  fabric.Point = Point;\n\n  /**\n   * Point class\n   * @class fabric.Point\n   * @memberOf fabric\n   * @constructor\n   * @param {Number} x\n   * @param {Number} y\n   * @return {fabric.Point} thisArg\n   */\n  function Point(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  Point.prototype = /** @lends fabric.Point.prototype */ {\n    type: 'point',\n\n    constructor: Point,\n\n    /**\n     * Adds another point to this one and returns another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point instance with added values\n     */\n    add: function (that) {\n      return new Point(this.x + that.x, this.y + that.y);\n    },\n\n    /**\n     * Adds another point to this one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    addEquals: function (that) {\n      this.x += that.x;\n      this.y += that.y;\n      return this;\n    },\n\n    /**\n     * Adds value to this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point} new Point with added value\n     */\n    scalarAdd: function (scalar) {\n      return new Point(this.x + scalar, this.y + scalar);\n    },\n\n    /**\n     * Adds value to this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarAddEquals: function (scalar) {\n      this.x += scalar;\n      this.y += scalar;\n      return this;\n    },\n\n    /**\n     * Subtracts another point from this point and returns a new one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point object with subtracted values\n     */\n    subtract: function (that) {\n      return new Point(this.x - that.x, this.y - that.y);\n    },\n\n    /**\n     * Subtracts another point from this point\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    subtractEquals: function (that) {\n      this.x -= that.x;\n      this.y -= that.y;\n      return this;\n    },\n\n    /**\n     * Subtracts value from this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    scalarSubtract: function (scalar) {\n      return new Point(this.x - scalar, this.y - scalar);\n    },\n\n    /**\n     * Subtracts value from this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarSubtractEquals: function (scalar) {\n      this.x -= scalar;\n      this.y -= scalar;\n      return this;\n    },\n\n    /**\n     * Multiplies this point by a value and returns a new one\n     * TODO: rename in scalarMultiply in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    multiply: function (scalar) {\n      return new Point(this.x * scalar, this.y * scalar);\n    },\n\n    /**\n     * Multiplies this point by a value\n     * TODO: rename in scalarMultiplyEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    multiplyEquals: function (scalar) {\n      this.x *= scalar;\n      this.y *= scalar;\n      return this;\n    },\n\n    /**\n     * Divides this point by a value and returns a new one\n     * TODO: rename in scalarDivide in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    divide: function (scalar) {\n      return new Point(this.x / scalar, this.y / scalar);\n    },\n\n    /**\n     * Divides this point by a value\n     * TODO: rename in scalarDivideEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    divideEquals: function (scalar) {\n      this.x /= scalar;\n      this.y /= scalar;\n      return this;\n    },\n\n    /**\n     * Returns true if this point is equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    eq: function (that) {\n      return this.x === that.x && this.y === that.y;\n    },\n\n    /**\n     * Returns true if this point is less than another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lt: function (that) {\n      return this.x < that.x && this.y < that.y;\n    },\n\n    /**\n     * Returns true if this point is less than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lte: function (that) {\n      return this.x <= that.x && this.y <= that.y;\n    },\n\n    /**\n\n     * Returns true if this point is greater another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gt: function (that) {\n      return this.x > that.x && this.y > that.y;\n    },\n\n    /**\n     * Returns true if this point is greater than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gte: function (that) {\n      return this.x >= that.x && this.y >= that.y;\n    },\n\n    /**\n     * Returns new point which is the result of linear interpolation with this one and another one\n     * @param {fabric.Point} that\n     * @param {Number} t , position of interpolation, between 0 and 1 default 0.5\n     * @return {fabric.Point}\n     */\n    lerp: function (that, t) {\n      if (typeof t === 'undefined') {\n        t = 0.5;\n      }\n      t = Math.max(Math.min(1, t), 0);\n      return new Point(\n        this.x + (that.x - this.x) * t,\n        this.y + (that.y - this.y) * t\n      );\n    },\n\n    /**\n     * Returns distance from this point and another one\n     * @param {fabric.Point} that\n     * @return {Number}\n     */\n    distanceFrom: function (that) {\n      var dx = this.x - that.x,\n        dy = this.y - that.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    },\n\n    /**\n     * Returns the point between this point and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    midPointFrom: function (that) {\n      return this.lerp(that);\n    },\n\n    /**\n     * Returns a new point which is the min of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    min: function (that) {\n      return new Point(Math.min(this.x, that.x), Math.min(this.y, that.y));\n    },\n\n    /**\n     * Returns a new point which is the max of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    max: function (that) {\n      return new Point(Math.max(this.x, that.x), Math.max(this.y, that.y));\n    },\n\n    /**\n     * Returns string representation of this point\n     * @return {String}\n     */\n    toString: function () {\n      return this.x + ',' + this.y;\n    },\n\n    /**\n     * Sets x/y of this point\n     * @param {Number} x\n     * @param {Number} y\n     * @chainable\n     */\n    setXY: function (x, y) {\n      this.x = x;\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x of this point\n     * @param {Number} x\n     * @chainable\n     */\n    setX: function (x) {\n      this.x = x;\n      return this;\n    },\n\n    /**\n     * Sets y of this point\n     * @param {Number} y\n     * @chainable\n     */\n    setY: function (y) {\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x/y of this point from another point\n     * @param {fabric.Point} that\n     * @chainable\n     */\n    setFromPoint: function (that) {\n      this.x = that.x;\n      this.y = that.y;\n      return this;\n    },\n\n    /**\n     * Swaps x/y of this point and another point\n     * @param {fabric.Point} that\n     */\n    swap: function (that) {\n      var x = this.x,\n        y = this.y;\n      this.x = that.x;\n      this.y = that.y;\n      that.x = x;\n      that.y = y;\n    },\n\n    /**\n     * return a cloned instance of the point\n     * @return {fabric.Point}\n     */\n    clone: function () {\n      return new Point(this.x, this.y);\n    },\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initIntersection(global) {\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Intersection) {\n    fabric.warn('fabric.Intersection is already defined');\n    return;\n  }\n\n  /**\n   * Intersection class\n   * @class fabric.Intersection\n   * @memberOf fabric\n   * @constructor\n   */\n  function Intersection(status) {\n    this.status = status;\n    this.points = [];\n  }\n\n  fabric.Intersection = Intersection;\n\n  fabric.Intersection.prototype = /** @lends fabric.Intersection.prototype */ {\n    constructor: Intersection,\n\n    /**\n     * Appends a point to intersection\n     * @param {fabric.Point} point\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoint: function (point) {\n      this.points.push(point);\n      return this;\n    },\n\n    /**\n     * Appends points to intersection\n     * @param {Array} points\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoints: function (points) {\n      this.points = this.points.concat(points);\n      return this;\n    },\n  };\n\n  /**\n   * Checks if one line intersects another\n   * TODO: rename in intersectSegmentSegment\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {fabric.Point} b1\n   * @param {fabric.Point} b2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLineLine = function (a1, a2, b1, b2) {\n    var result,\n      uaT = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),\n      ubT = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),\n      uB = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n    if (uB !== 0) {\n      var ua = uaT / uB,\n        ub = ubT / uB;\n      if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\n        result = new Intersection('Intersection');\n        result.appendPoint(\n          new fabric.Point(a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y))\n        );\n      } else {\n        result = new Intersection();\n      }\n    } else {\n      if (uaT === 0 || ubT === 0) {\n        result = new Intersection('Coincident');\n      } else {\n        result = new Intersection('Parallel');\n      }\n    }\n    return result;\n  };\n\n  /**\n   * Checks if line intersects polygon\n   * TODO: rename in intersectSegmentPolygon\n   * fix detection of coincident\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {Array} points\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLinePolygon = function (a1, a2, points) {\n    var result = new Intersection(),\n      length = points.length,\n      b1,\n      b2,\n      inter,\n      i;\n\n    for (i = 0; i < length; i++) {\n      b1 = points[i];\n      b2 = points[(i + 1) % length];\n      inter = Intersection.intersectLineLine(a1, a2, b1, b2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects another polygon\n   * @static\n   * @param {Array} points1\n   * @param {Array} points2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonPolygon = function (points1, points2) {\n    var result = new Intersection(),\n      length = points1.length,\n      i;\n\n    for (i = 0; i < length; i++) {\n      var a1 = points1[i],\n        a2 = points1[(i + 1) % length],\n        inter = Intersection.intersectLinePolygon(a1, a2, points2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects rectangle\n   * @static\n   * @param {Array} points\n   * @param {fabric.Point} r1\n   * @param {fabric.Point} r2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonRectangle = function (points, r1, r2) {\n    var min = r1.min(r2),\n      max = r1.max(r2),\n      topRight = new fabric.Point(max.x, min.y),\n      bottomLeft = new fabric.Point(min.x, max.y),\n      inter1 = Intersection.intersectLinePolygon(min, topRight, points),\n      inter2 = Intersection.intersectLinePolygon(topRight, max, points),\n      inter3 = Intersection.intersectLinePolygon(max, bottomLeft, points),\n      inter4 = Intersection.intersectLinePolygon(bottomLeft, min, points),\n      result = new Intersection();\n\n    result.appendPoints(inter1.points);\n    result.appendPoints(inter2.points);\n    result.appendPoints(inter3.points);\n    result.appendPoints(inter4.points);\n\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initColor(global) {\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Color) {\n    fabric.warn('fabric.Color is already defined.');\n    return;\n  }\n\n  /**\n   * Color class\n   * The purpose of {@link fabric.Color} is to abstract and encapsulate common color operations;\n   * {@link fabric.Color} is a constructor and creates instances of {@link fabric.Color} objects.\n   *\n   * @class fabric.Color\n   * @param {String} color optional in hex or rgb(a) or hsl format or from known color list\n   * @return {fabric.Color} thisArg\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#colors}\n   */\n  function Color(color) {\n    if (!color) {\n      this.setSource([0, 0, 0, 1]);\n    } else {\n      this._tryParsingColor(color);\n    }\n  }\n\n  fabric.Color = Color;\n\n  fabric.Color.prototype = /** @lends fabric.Color.prototype */ {\n    /**\n     * @private\n     * @param {String|Array} color Color value to parse\n     */\n    _tryParsingColor: function (color) {\n      var source;\n\n      if (color in Color.colorNameMap) {\n        color = Color.colorNameMap[color];\n      }\n\n      if (color === 'transparent') {\n        source = [255, 255, 255, 0];\n      }\n\n      if (!source) {\n        source = Color.sourceFromHex(color);\n      }\n      if (!source) {\n        source = Color.sourceFromRgb(color);\n      }\n      if (!source) {\n        source = Color.sourceFromHsl(color);\n      }\n      if (!source) {\n        //if color is not recognize let's make black as canvas does\n        source = [0, 0, 0, 1];\n      }\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n    /**\n     * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n     * @private\n     * @param {Number} r Red color value\n     * @param {Number} g Green color value\n     * @param {Number} b Blue color value\n     * @return {Array} Hsl color\n     */\n    _rgbToHsl: function (r, g, b) {\n      r /= 255;\n      g /= 255;\n      b /= 255;\n\n      var h,\n        s,\n        l,\n        max = fabric.util.array.max([r, g, b]),\n        min = fabric.util.array.min([r, g, b]);\n\n      l = (max + min) / 2;\n\n      if (max === min) {\n        h = s = 0; // achromatic\n      } else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n          case r:\n            h = (g - b) / d + (g < b ? 6 : 0);\n            break;\n          case g:\n            h = (b - r) / d + 2;\n            break;\n          case b:\n            h = (r - g) / d + 4;\n            break;\n          default:\n            break;\n        }\n        h /= 6;\n      }\n\n      return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];\n    },\n\n    /**\n     * Returns source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @return {Array}\n     */\n    getSource: function () {\n      return this._source;\n    },\n\n    /**\n     * Sets source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @param {Array} source\n     */\n    setSource: function (source) {\n      this._source = source;\n    },\n\n    /**\n     * Returns color representation in RGB format\n     * @return {String} ex: rgb(0-255,0-255,0-255)\n     */\n    toRgb: function () {\n      var source = this.getSource();\n      return 'rgb(' + source[0] + ',' + source[1] + ',' + source[2] + ')';\n    },\n\n    /**\n     * Returns color representation in RGBA format\n     * @return {String} ex: rgba(0-255,0-255,0-255,0-1)\n     */\n    toRgba: function () {\n      var source = this.getSource();\n      return (\n        'rgba(' +\n        source[0] +\n        ',' +\n        source[1] +\n        ',' +\n        source[2] +\n        ',' +\n        source[3] +\n        ')'\n      );\n    },\n\n    /**\n     * Returns color representation in HSL format\n     * @return {String} ex: hsl(0-360,0%-100%,0%-100%)\n     */\n    toHsl: function () {\n      var source = this.getSource(),\n        hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return 'hsl(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%)';\n    },\n\n    /**\n     * Returns color representation in HSLA format\n     * @return {String} ex: hsla(0-360,0%-100%,0%-100%,0-1)\n     */\n    toHsla: function () {\n      var source = this.getSource(),\n        hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return (\n        'hsla(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%,' + source[3] + ')'\n      );\n    },\n\n    /**\n     * Returns color representation in HEX format\n     * @return {String} ex: FF5555\n     */\n    toHex: function () {\n      var source = this.getSource(),\n        r,\n        g,\n        b;\n\n      r = source[0].toString(16);\n      r = r.length === 1 ? '0' + r : r;\n\n      g = source[1].toString(16);\n      g = g.length === 1 ? '0' + g : g;\n\n      b = source[2].toString(16);\n      b = b.length === 1 ? '0' + b : b;\n\n      return r.toUpperCase() + g.toUpperCase() + b.toUpperCase();\n    },\n\n    /**\n     * Returns color representation in HEXA format\n     * @return {String} ex: FF5555CC\n     */\n    toHexa: function () {\n      var source = this.getSource(),\n        a;\n\n      a = Math.round(source[3] * 255);\n      a = a.toString(16);\n      a = a.length === 1 ? '0' + a : a;\n\n      return this.toHex() + a.toUpperCase();\n    },\n\n    /**\n     * Gets value of alpha channel for this color\n     * @return {Number} 0-1\n     */\n    getAlpha: function () {\n      return this.getSource()[3];\n    },\n\n    /**\n     * Sets value of alpha channel for this color\n     * @param {Number} alpha Alpha value 0-1\n     * @return {fabric.Color} thisArg\n     */\n    setAlpha: function (alpha) {\n      var source = this.getSource();\n      source[3] = alpha;\n      this.setSource(source);\n      return this;\n    },\n\n    /**\n     * Transforms color to its grayscale representation\n     * @return {fabric.Color} thisArg\n     */\n    toGrayscale: function () {\n      var source = this.getSource(),\n        average = parseInt(\n          (source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0),\n          10\n        ),\n        currentAlpha = source[3];\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Transforms color to its black and white representation\n     * @param {Number} threshold\n     * @return {fabric.Color} thisArg\n     */\n    toBlackWhite: function (threshold) {\n      var source = this.getSource(),\n        average = (\n          source[0] * 0.3 +\n          source[1] * 0.59 +\n          source[2] * 0.11\n        ).toFixed(0),\n        currentAlpha = source[3];\n\n      threshold = threshold || 127;\n\n      average = Number(average) < Number(threshold) ? 0 : 255;\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Overlays color with another color\n     * @param {String|fabric.Color} otherColor\n     * @return {fabric.Color} thisArg\n     */\n    overlayWith: function (otherColor) {\n      if (!(otherColor instanceof Color)) {\n        otherColor = new Color(otherColor);\n      }\n\n      var result = [],\n        alpha = this.getAlpha(),\n        otherAlpha = 0.5,\n        source = this.getSource(),\n        otherSource = otherColor.getSource(),\n        i;\n\n      for (i = 0; i < 3; i++) {\n        result.push(\n          Math.round(source[i] * (1 - otherAlpha) + otherSource[i] * otherAlpha)\n        );\n      }\n\n      result[3] = alpha;\n      this.setSource(result);\n      return this;\n    },\n  };\n\n  /**\n   * Regex matching color in RGB or RGBA formats (ex: rgb(0, 0, 0), rgba(255, 100, 10, 0.5), rgba( 255 , 100 , 10 , 0.5 ), rgb(1,1,1), rgba(100%, 60%, 10%, 0.5))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  // eslint-disable-next-line max-len\n  fabric.Color.reRGBa = /^rgba?\\(\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*(?:\\s*,\\s*((?:\\d*\\.?\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HSL or HSLA formats (ex: hsl(200, 80%, 10%), hsla(300, 50%, 80%, 0.5), hsla( 300 , 50% , 80% , 0.5 ))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHSLa = /^hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}%)\\s*,\\s*(\\d{1,3}%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HEX format (ex: #FF5544CC, #FF5555, 010155, aff)\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHex = /^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i;\n\n  /**\n   * Map of the 148 color names with HEX code\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   * @see: https://www.w3.org/TR/css3-color/#svg-color\n   */\n  fabric.Color.colorNameMap = {\n    aliceblue: '#F0F8FF',\n    antiquewhite: '#FAEBD7',\n    aqua: '#00FFFF',\n    aquamarine: '#7FFFD4',\n    azure: '#F0FFFF',\n    beige: '#F5F5DC',\n    bisque: '#FFE4C4',\n    black: '#000000',\n    blanchedalmond: '#FFEBCD',\n    blue: '#0000FF',\n    blueviolet: '#8A2BE2',\n    brown: '#A52A2A',\n    burlywood: '#DEB887',\n    cadetblue: '#5F9EA0',\n    chartreuse: '#7FFF00',\n    chocolate: '#D2691E',\n    coral: '#FF7F50',\n    cornflowerblue: '#6495ED',\n    cornsilk: '#FFF8DC',\n    crimson: '#DC143C',\n    cyan: '#00FFFF',\n    darkblue: '#00008B',\n    darkcyan: '#008B8B',\n    darkgoldenrod: '#B8860B',\n    darkgray: '#A9A9A9',\n    darkgrey: '#A9A9A9',\n    darkgreen: '#006400',\n    darkkhaki: '#BDB76B',\n    darkmagenta: '#8B008B',\n    darkolivegreen: '#556B2F',\n    darkorange: '#FF8C00',\n    darkorchid: '#9932CC',\n    darkred: '#8B0000',\n    darksalmon: '#E9967A',\n    darkseagreen: '#8FBC8F',\n    darkslateblue: '#483D8B',\n    darkslategray: '#2F4F4F',\n    darkslategrey: '#2F4F4F',\n    darkturquoise: '#00CED1',\n    darkviolet: '#9400D3',\n    deeppink: '#FF1493',\n    deepskyblue: '#00BFFF',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1E90FF',\n    firebrick: '#B22222',\n    floralwhite: '#FFFAF0',\n    forestgreen: '#228B22',\n    fuchsia: '#FF00FF',\n    gainsboro: '#DCDCDC',\n    ghostwhite: '#F8F8FF',\n    gold: '#FFD700',\n    goldenrod: '#DAA520',\n    gray: '#808080',\n    grey: '#808080',\n    green: '#008000',\n    greenyellow: '#ADFF2F',\n    honeydew: '#F0FFF0',\n    hotpink: '#FF69B4',\n    indianred: '#CD5C5C',\n    indigo: '#4B0082',\n    ivory: '#FFFFF0',\n    khaki: '#F0E68C',\n    lavender: '#E6E6FA',\n    lavenderblush: '#FFF0F5',\n    lawngreen: '#7CFC00',\n    lemonchiffon: '#FFFACD',\n    lightblue: '#ADD8E6',\n    lightcoral: '#F08080',\n    lightcyan: '#E0FFFF',\n    lightgoldenrodyellow: '#FAFAD2',\n    lightgray: '#D3D3D3',\n    lightgrey: '#D3D3D3',\n    lightgreen: '#90EE90',\n    lightpink: '#FFB6C1',\n    lightsalmon: '#FFA07A',\n    lightseagreen: '#20B2AA',\n    lightskyblue: '#87CEFA',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#B0C4DE',\n    lightyellow: '#FFFFE0',\n    lime: '#00FF00',\n    limegreen: '#32CD32',\n    linen: '#FAF0E6',\n    magenta: '#FF00FF',\n    maroon: '#800000',\n    mediumaquamarine: '#66CDAA',\n    mediumblue: '#0000CD',\n    mediumorchid: '#BA55D3',\n    mediumpurple: '#9370DB',\n    mediumseagreen: '#3CB371',\n    mediumslateblue: '#7B68EE',\n    mediumspringgreen: '#00FA9A',\n    mediumturquoise: '#48D1CC',\n    mediumvioletred: '#C71585',\n    midnightblue: '#191970',\n    mintcream: '#F5FFFA',\n    mistyrose: '#FFE4E1',\n    moccasin: '#FFE4B5',\n    navajowhite: '#FFDEAD',\n    navy: '#000080',\n    oldlace: '#FDF5E6',\n    olive: '#808000',\n    olivedrab: '#6B8E23',\n    orange: '#FFA500',\n    orangered: '#FF4500',\n    orchid: '#DA70D6',\n    palegoldenrod: '#EEE8AA',\n    palegreen: '#98FB98',\n    paleturquoise: '#AFEEEE',\n    palevioletred: '#DB7093',\n    papayawhip: '#FFEFD5',\n    peachpuff: '#FFDAB9',\n    peru: '#CD853F',\n    pink: '#FFC0CB',\n    plum: '#DDA0DD',\n    powderblue: '#B0E0E6',\n    purple: '#800080',\n    rebeccapurple: '#663399',\n    red: '#FF0000',\n    rosybrown: '#BC8F8F',\n    royalblue: '#4169E1',\n    saddlebrown: '#8B4513',\n    salmon: '#FA8072',\n    sandybrown: '#F4A460',\n    seagreen: '#2E8B57',\n    seashell: '#FFF5EE',\n    sienna: '#A0522D',\n    silver: '#C0C0C0',\n    skyblue: '#87CEEB',\n    slateblue: '#6A5ACD',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#FFFAFA',\n    springgreen: '#00FF7F',\n    steelblue: '#4682B4',\n    tan: '#D2B48C',\n    teal: '#008080',\n    thistle: '#D8BFD8',\n    tomato: '#FF6347',\n    turquoise: '#40E0D0',\n    violet: '#EE82EE',\n    wheat: '#F5DEB3',\n    white: '#FFFFFF',\n    whitesmoke: '#F5F5F5',\n    yellow: '#FFFF00',\n    yellowgreen: '#9ACD32',\n  };\n\n  /**\n   * @private\n   * @param {Number} p\n   * @param {Number} q\n   * @param {Number} t\n   * @return {Number}\n   */\n  function hue2rgb(p, q, t) {\n    if (t < 0) {\n      t += 1;\n    }\n    if (t > 1) {\n      t -= 1;\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n    if (t < 1 / 2) {\n      return q;\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n  }\n\n  /**\n   * Returns new color object, when given a color in RGB format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255)\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgb = function (color) {\n    return Color.fromSource(Color.sourceFromRgb(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in RGB or RGBA format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255), rgb(0%-100%,0%-100%,0%-100%)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromRgb = function (color) {\n    var match = color.match(Color.reRGBa);\n    if (match) {\n      var r =\n          (parseInt(match[1], 10) / (/%$/.test(match[1]) ? 100 : 1)) *\n          (/%$/.test(match[1]) ? 255 : 1),\n        g =\n          (parseInt(match[2], 10) / (/%$/.test(match[2]) ? 100 : 1)) *\n          (/%$/.test(match[2]) ? 255 : 1),\n        b =\n          (parseInt(match[3], 10) / (/%$/.test(match[3]) ? 100 : 1)) *\n          (/%$/.test(match[3]) ? 255 : 1);\n\n      return [\n        parseInt(r, 10),\n        parseInt(g, 10),\n        parseInt(b, 10),\n        match[4] ? parseFloat(match[4]) : 1,\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given a color in RGBA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgba = Color.fromRgb;\n\n  /**\n   * Returns new color object, when given a color in HSL format\n   * @param {String} color Color value ex: hsl(0-260,0%-100%,0%-100%)\n   * @memberOf fabric.Color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsl = function (color) {\n    return Color.fromSource(Color.sourceFromHsl(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HSL or HSLA format.\n   * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: hsl(0-360,0%-100%,0%-100%) or hsla(0-360,0%-100%,0%-100%, 0-1)\n   * @return {Array} source\n   * @see http://http://www.w3.org/TR/css3-color/#hsl-color\n   */\n  fabric.Color.sourceFromHsl = function (color) {\n    var match = color.match(Color.reHSLa);\n    if (!match) {\n      return;\n    }\n\n    var h = (((parseFloat(match[1]) % 360) + 360) % 360) / 360,\n      s = parseFloat(match[2]) / (/%$/.test(match[2]) ? 100 : 1),\n      l = parseFloat(match[3]) / (/%$/.test(match[3]) ? 100 : 1),\n      r,\n      g,\n      b;\n\n    if (s === 0) {\n      r = g = b = l;\n    } else {\n      var q = l <= 0.5 ? l * (s + 1) : l + s - l * s,\n        p = l * 2 - q;\n\n      r = hue2rgb(p, q, h + 1 / 3);\n      g = hue2rgb(p, q, h);\n      b = hue2rgb(p, q, h - 1 / 3);\n    }\n\n    return [\n      Math.round(r * 255),\n      Math.round(g * 255),\n      Math.round(b * 255),\n      match[4] ? parseFloat(match[4]) : 1,\n    ];\n  };\n\n  /**\n   * Returns new color object, when given a color in HSLA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsla = Color.fromHsl;\n\n  /**\n   * Returns new color object, when given a color in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: FF5555\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHex = function (color) {\n    return Color.fromSource(Color.sourceFromHex(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color ex: FF5555 or FF5544CC (RGBa)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromHex = function (color) {\n    if (color.match(Color.reHex)) {\n      var value = color.slice(color.indexOf('#') + 1),\n        isShortNotation = value.length === 3 || value.length === 4,\n        isRGBa = value.length === 8 || value.length === 4,\n        r = isShortNotation\n          ? value.charAt(0) + value.charAt(0)\n          : value.substring(0, 2),\n        g = isShortNotation\n          ? value.charAt(1) + value.charAt(1)\n          : value.substring(2, 4),\n        b = isShortNotation\n          ? value.charAt(2) + value.charAt(2)\n          : value.substring(4, 6),\n        a = isRGBa\n          ? isShortNotation\n            ? value.charAt(3) + value.charAt(3)\n            : value.substring(6, 8)\n          : 'FF';\n\n      return [\n        parseInt(r, 16),\n        parseInt(g, 16),\n        parseInt(b, 16),\n        parseFloat((parseInt(a, 16) / 255).toFixed(2)),\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given color in array representation (ex: [200, 100, 100, 0.5])\n   * @static\n   * @memberOf fabric.Color\n   * @param {Array} source\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromSource = function (source) {\n    var oColor = new Color();\n    oColor.setSource(source);\n    return oColor;\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initStaticCanvas() {\n  if (fabric.StaticCanvas) {\n    fabric.warn('fabric.StaticCanvas is already defined.');\n    return;\n  }\n\n  // aliases for faster resolution\n  var extend = fabric.util.object.extend,\n    getElementOffset = fabric.util.getElementOffset,\n    removeFromArray = fabric.util.removeFromArray,\n    toFixed = fabric.util.toFixed,\n    transformPoint = fabric.util.transformPoint,\n    invertTransform = fabric.util.invertTransform,\n    getNodeCanvas = fabric.util.getNodeCanvas,\n    createCanvasElement = fabric.util.createCanvasElement,\n    CANVAS_INIT_ERROR = new Error('Could not initialize `canvas` element');\n\n  /**\n   * Static canvas class\n   * @class fabric.StaticCanvas\n   * @mixes fabric.Collection\n   * @mixes fabric.Observable\n   * @see {@link http://fabricjs.com/static_canvas|StaticCanvas demo}\n   * @see {@link fabric.StaticCanvas#initialize} for constructor definition\n   * @fires before:render\n   * @fires after:render\n   * @fires canvas:cleared\n   * @fires object:added\n   * @fires object:removed\n   */\n  fabric.StaticCanvas = fabric.util.createClass(\n    fabric.CommonMethods,\n    /** @lends fabric.StaticCanvas.prototype */ {\n      /**\n       * Constructor\n       * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n       * @param {Object} [options] Options object\n       * @return {Object} thisArg\n       */\n      initialize: function (el, options) {\n        options || (options = {});\n        this.renderAndResetBound = this.renderAndReset.bind(this);\n        this.requestRenderAllBound = this.requestRenderAll.bind(this);\n        this._initStatic(el, options);\n      },\n\n      /**\n       * Background color of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setBackgroundColor}.\n       * @type {(String|fabric.Pattern)}\n       * @default\n       */\n      backgroundColor: '',\n\n      /**\n       * Background image of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setBackgroundImage}.\n       * <b>Backwards incompatibility note:</b> The \"backgroundImageOpacity\"\n       * and \"backgroundImageStretch\" properties are deprecated since 1.3.9.\n       * Use {@link fabric.Image#opacity}, {@link fabric.Image#width} and {@link fabric.Image#height}.\n       * since 2.4.0 image caching is active, please when putting an image as background, add to the\n       * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n       * vale. As an alternative you can disable image objectCaching\n       * @type fabric.Image\n       * @default\n       */\n      backgroundImage: null,\n\n      /**\n       * Overlay color of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setOverlayColor}\n       * @since 1.3.9\n       * @type {(String|fabric.Pattern)}\n       * @default\n       */\n      overlayColor: '',\n\n      /**\n       * Overlay image of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setOverlayImage}.\n       * <b>Backwards incompatibility note:</b> The \"overlayImageLeft\"\n       * and \"overlayImageTop\" properties are deprecated since 1.3.9.\n       * Use {@link fabric.Image#left} and {@link fabric.Image#top}.\n       * since 2.4.0 image caching is active, please when putting an image as overlay, add to the\n       * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n       * vale. As an alternative you can disable image objectCaching\n       * @type fabric.Image\n       * @default\n       */\n      overlayImage: null,\n\n      /**\n       * Indicates whether toObject/toDatalessObject should include default values\n       * if set to false, takes precedence over the object value.\n       * @type Boolean\n       * @default\n       */\n      includeDefaultValues: true,\n\n      /**\n       * Indicates whether objects' state should be saved\n       * @type Boolean\n       * @default\n       */\n      stateful: false,\n\n      /**\n       * Indicates whether {@link fabric.Collection.add}, {@link fabric.Collection.insertAt} and {@link fabric.Collection.remove},\n       * {@link fabric.StaticCanvas.moveTo}, {@link fabric.StaticCanvas.clear} and many more, should also re-render canvas.\n       * Disabling this option will not give a performance boost when adding/removing a lot of objects to/from canvas at once\n       * since the renders are quequed and executed one per frame.\n       * Disabling is suggested anyway and managing the renders of the app manually is not a big effort ( canvas.requestRenderAll() )\n       * Left default to true to do not break documentation and old app, fiddles.\n       * @type Boolean\n       * @default\n       */\n      renderOnAddRemove: true,\n\n      /**\n       * Function that determines clipping of entire canvas area\n       * Being passed context as first argument.\n       * If you are using code minification, ctx argument can be minified/manglied you should use\n       * as a workaround `var ctx = arguments[0];` in the function;\n       * See clipping canvas area in {@link https://github.com/kangax/fabric.js/wiki/FAQ}\n       * @deprecated since 2.0.0\n       * @type Function\n       * @default\n       */\n      clipTo: null,\n\n      /**\n       * Indicates whether object controls (borders/controls) are rendered above overlay image\n       * @type Boolean\n       * @default\n       */\n      controlsAboveOverlay: false,\n\n      /**\n       * Indicates whether the browser can be scrolled when using a touchscreen and dragging on the canvas\n       * @type Boolean\n       * @default\n       */\n      allowTouchScrolling: false,\n\n      /**\n       * Indicates whether this canvas will use image smoothing, this is on by default in browsers\n       * @type Boolean\n       * @default\n       */\n      imageSmoothingEnabled: true,\n\n      /**\n       * The transformation (in the format of Canvas transform) which focuses the viewport\n       * @type Array\n       * @default\n       */\n      viewportTransform: fabric.iMatrix.concat(),\n\n      /**\n       * if set to false background image is not affected by viewport transform\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      backgroundVpt: true,\n\n      /**\n       * if set to false overlya image is not affected by viewport transform\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      overlayVpt: true,\n\n      /**\n       * Callback; invoked right before object is about to be scaled/rotated\n       * @deprecated since 2.3.0\n       * Use before:transform event\n       */\n      onBeforeScaleRotate: function () {\n        /* NOOP */\n      },\n\n      /**\n       * When true, canvas is scaled by devicePixelRatio for better rendering on retina screens\n       * @type Boolean\n       * @default\n       */\n      enableRetinaScaling: true,\n\n      /**\n       * Describe canvas element extension over design\n       * properties are tl,tr,bl,br.\n       * if canvas is not zoomed/panned those points are the four corner of canvas\n       * if canvas is viewportTransformed you those points indicate the extension\n       * of canvas element in plain untrasformed coordinates\n       * The coordinates get updated with @method calcViewportBoundaries.\n       * @memberOf fabric.StaticCanvas.prototype\n       */\n      vptCoords: {},\n\n      /**\n       * Based on vptCoords and object.aCoords, skip rendering of objects that\n       * are not included in current viewport.\n       * May greatly help in applications with crowded canvas and use of zoom/pan\n       * If One of the corner of the bounding box of the object is on the canvas\n       * the objects get rendered.\n       * @memberOf fabric.StaticCanvas.prototype\n       * @type Boolean\n       * @default\n       */\n      skipOffscreen: true,\n\n      /**\n       * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n       * the clipPath object gets used when the canvas has rendered, and the context is placed in the\n       * top left corner of the canvas.\n       * clipPath will clip away controls, if you do not want this to happen use controlsAboveOverlay = true\n       * @type fabric.Object\n       */\n      clipPath: undefined,\n\n      /**\n       * @private\n       * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n       * @param {Object} [options] Options object\n       */\n      _initStatic: function (el, options) {\n        var cb = this.requestRenderAllBound;\n        this._objects = [];\n        this._createLowerCanvas(el);\n        this._initOptions(options);\n        this._setImageSmoothing();\n        // only initialize retina scaling once\n        if (!this.interactive) {\n          this._initRetinaScaling();\n        }\n\n        if (options.overlayImage) {\n          this.setOverlayImage(options.overlayImage, cb);\n        }\n        if (options.backgroundImage) {\n          this.setBackgroundImage(options.backgroundImage, cb);\n        }\n        if (options.backgroundColor) {\n          this.setBackgroundColor(options.backgroundColor, cb);\n        }\n        if (options.overlayColor) {\n          this.setOverlayColor(options.overlayColor, cb);\n        }\n        this.calcOffset();\n      },\n\n      /**\n       * @private\n       */\n      _isRetinaScaling: function () {\n        return fabric.devicePixelRatio !== 1 && this.enableRetinaScaling;\n      },\n\n      /**\n       * @private\n       * @return {Number} retinaScaling if applied, otherwise 1;\n       */\n      getRetinaScaling: function () {\n        return this._isRetinaScaling() ? fabric.devicePixelRatio : 1;\n      },\n\n      /**\n       * @private\n       */\n      _initRetinaScaling: function () {\n        if (!this._isRetinaScaling()) {\n          return;\n        }\n        var scaleRatio = fabric.devicePixelRatio;\n        this.__initRetinaScaling(\n          scaleRatio,\n          this.lowerCanvasEl,\n          this.contextContainer\n        );\n        if (this.upperCanvasEl) {\n          this.__initRetinaScaling(\n            scaleRatio,\n            this.upperCanvasEl,\n            this.contextTop\n          );\n        }\n      },\n\n      __initRetinaScaling: function (scaleRatio, canvas, context) {\n        canvas.setAttribute('width', this.width * scaleRatio);\n        canvas.setAttribute('height', this.height * scaleRatio);\n        context.scale(scaleRatio, scaleRatio);\n      },\n\n      /**\n       * Calculates canvas element offset relative to the document\n       * This method is also attached as \"resize\" event handler of window\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      calcOffset: function () {\n        this._offset = getElementOffset(this.lowerCanvasEl);\n        return this;\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#overlayImage|overlay image} for this canvas\n       * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set overlay to\n       * @param {Function} callback callback to invoke when image is loaded and set as an overlay\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|overlay image}.\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/MnzHT/|jsFiddle demo}\n       * @example <caption>Normal overlayImage with left/top = 0</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   // Needed to position overlayImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>overlayImage with different properties</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>Stretched overlayImage #1 - width/height correspond to canvas width/height</caption>\n       * fabric.Image.fromURL('http://fabricjs.com/assets/jail_cell_bars.png', function(img) {\n       *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n       *    canvas.setOverlayImage(img, canvas.renderAll.bind(canvas));\n       * });\n       * @example <caption>Stretched overlayImage #2 - width/height correspond to canvas width/height</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   width: canvas.width,\n       *   height: canvas.height,\n       *   // Needed to position overlayImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>overlayImage loaded from cross-origin</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top',\n       *   crossOrigin: 'anonymous'\n       * });\n       */\n      setOverlayImage: function (image, callback, options) {\n        return this.__setBgOverlayImage(\n          'overlayImage',\n          image,\n          callback,\n          options\n        );\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#backgroundImage|background image} for this canvas\n       * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set background to\n       * @param {Function} callback Callback to invoke when image is loaded and set as background\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|background image}.\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/djnr8o7a/28/|jsFiddle demo}\n       * @example <caption>Normal backgroundImage with left/top = 0</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   // Needed to position backgroundImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>backgroundImage with different properties</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>Stretched backgroundImage #1 - width/height correspond to canvas width/height</caption>\n       * fabric.Image.fromURL('http://fabricjs.com/assets/honey_im_subtle.png', function(img) {\n       *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n       *    canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));\n       * });\n       * @example <caption>Stretched backgroundImage #2 - width/height correspond to canvas width/height</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   width: canvas.width,\n       *   height: canvas.height,\n       *   // Needed to position backgroundImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>backgroundImage loaded from cross-origin</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top',\n       *   crossOrigin: 'anonymous'\n       * });\n       */\n      // TODO: fix stretched examples\n      setBackgroundImage: function (image, callback, options) {\n        return this.__setBgOverlayImage(\n          'backgroundImage',\n          image,\n          callback,\n          options\n        );\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#overlayColor|foreground color} for this canvas\n       * @param {(String|fabric.Pattern)} overlayColor Color or pattern to set foreground color to\n       * @param {Function} callback Callback to invoke when foreground color is set\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/pB55h/|jsFiddle demo}\n       * @example <caption>Normal overlayColor - color value</caption>\n       * canvas.setOverlayColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as overlayColor</caption>\n       * canvas.setOverlayColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n       * }, canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as overlayColor with repeat and offset</caption>\n       * canvas.setOverlayColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat',\n       *   offsetX: 200,\n       *   offsetY: 100\n       * }, canvas.renderAll.bind(canvas));\n       */\n      setOverlayColor: function (overlayColor, callback) {\n        return this.__setBgOverlayColor('overlayColor', overlayColor, callback);\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#backgroundColor|background color} for this canvas\n       * @param {(String|fabric.Pattern)} backgroundColor Color or pattern to set background color to\n       * @param {Function} callback Callback to invoke when background color is set\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/hXzvk/|jsFiddle demo}\n       * @example <caption>Normal backgroundColor - color value</caption>\n       * canvas.setBackgroundColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as backgroundColor</caption>\n       * canvas.setBackgroundColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n       * }, canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as backgroundColor with repeat and offset</caption>\n       * canvas.setBackgroundColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat',\n       *   offsetX: 200,\n       *   offsetY: 100\n       * }, canvas.renderAll.bind(canvas));\n       */\n      setBackgroundColor: function (backgroundColor, callback) {\n        return this.__setBgOverlayColor(\n          'backgroundColor',\n          backgroundColor,\n          callback\n        );\n      },\n\n      /**\n       * @private\n       * @see {@link http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled|WhatWG Canvas Standard}\n       */\n      _setImageSmoothing: function () {\n        var ctx = this.getContext();\n\n        ctx.imageSmoothingEnabled =\n          ctx.imageSmoothingEnabled ||\n          ctx.webkitImageSmoothingEnabled ||\n          ctx.mozImageSmoothingEnabled ||\n          ctx.msImageSmoothingEnabled ||\n          ctx.oImageSmoothingEnabled;\n        ctx.imageSmoothingEnabled = this.imageSmoothingEnabled;\n      },\n\n      /**\n       * @private\n       * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundImage|backgroundImage}\n       * or {@link fabric.StaticCanvas#overlayImage|overlayImage})\n       * @param {(fabric.Image|String|null)} image fabric.Image instance, URL of an image or null to set background or overlay to\n       * @param {Function} callback Callback to invoke when image is loaded and set as background or overlay\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|image}.\n       */\n      __setBgOverlayImage: function (property, image, callback, options) {\n        if (typeof image === 'string') {\n          fabric.util.loadImage(\n            image,\n            function (img) {\n              if (img) {\n                var instance = new fabric.Image(img, options);\n                this[property] = instance;\n                instance.canvas = this;\n              }\n              callback && callback(img);\n            },\n            this,\n            options && options.crossOrigin\n          );\n        } else {\n          options && image.setOptions(options);\n          this[property] = image;\n          image && (image.canvas = this);\n          callback && callback(image);\n        }\n\n        return this;\n      },\n\n      /**\n       * @private\n       * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundColor|backgroundColor}\n       * or {@link fabric.StaticCanvas#overlayColor|overlayColor})\n       * @param {(Object|String|null)} color Object with pattern information, color value or null\n       * @param {Function} [callback] Callback is invoked when color is set\n       */\n      __setBgOverlayColor: function (property, color, callback) {\n        this[property] = color;\n        this._initGradient(color, property);\n        this._initPattern(color, property, callback);\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _createCanvasElement: function () {\n        var element = createCanvasElement();\n        if (!element) {\n          throw CANVAS_INIT_ERROR;\n        }\n        if (!element.style) {\n          element.style = {};\n        }\n        if (typeof element.getContext === 'undefined') {\n          throw CANVAS_INIT_ERROR;\n        }\n        return element;\n      },\n\n      /**\n       * @private\n       * @param {Object} [options] Options object\n       */\n      _initOptions: function (options) {\n        var lowerCanvasEl = this.lowerCanvasEl;\n        this._setOptions(options);\n\n        this.width = this.width || parseInt(lowerCanvasEl.width, 10) || 0;\n        this.height = this.height || parseInt(lowerCanvasEl.height, 10) || 0;\n\n        if (!this.lowerCanvasEl.style) {\n          return;\n        }\n\n        lowerCanvasEl.width = this.width;\n        lowerCanvasEl.height = this.height;\n\n        lowerCanvasEl.style.width = this.width + 'px';\n        lowerCanvasEl.style.height = this.height + 'px';\n\n        this.viewportTransform = this.viewportTransform.slice();\n      },\n\n      /**\n       * Creates a bottom canvas\n       * @private\n       * @param {HTMLElement} [canvasEl]\n       */\n      _createLowerCanvas: function (canvasEl) {\n        // canvasEl === 'HTMLCanvasElement' does not work on jsdom/node\n        if (canvasEl && canvasEl.getContext) {\n          this.lowerCanvasEl = canvasEl;\n        } else {\n          this.lowerCanvasEl =\n            fabric.util.getById(canvasEl) || this._createCanvasElement();\n        }\n\n        fabric.util.addClass(this.lowerCanvasEl, 'lower-canvas');\n\n        if (this.interactive) {\n          this._applyCanvasStyle(this.lowerCanvasEl);\n        }\n\n        this.contextContainer = this.lowerCanvasEl.getContext('2d');\n      },\n\n      /**\n       * Returns canvas width (in px)\n       * @return {Number}\n       */\n      getWidth: function () {\n        return this.width;\n      },\n\n      /**\n       * Returns canvas height (in px)\n       * @return {Number}\n       */\n      getHeight: function () {\n        return this.height;\n      },\n\n      /**\n       * Sets width of this canvas instance\n       * @param {Number|String} value                         Value to set width to\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setWidth: function (value, options) {\n        return this.setDimensions({ width: value }, options);\n      },\n\n      /**\n       * Sets height of this canvas instance\n       * @param {Number|String} value                         Value to set height to\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setHeight: function (value, options) {\n        return this.setDimensions({ height: value }, options);\n      },\n\n      /**\n       * Sets dimensions (width, height) of this canvas instance. when options.cssOnly flag active you should also supply the unit of measure (px/%/em)\n       * @param {Object}        dimensions                    Object with width/height properties\n       * @param {Number|String} [dimensions.width]            Width of canvas element\n       * @param {Number|String} [dimensions.height]           Height of canvas element\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      setDimensions: function (dimensions, options) {\n        var cssValue;\n\n        options = options || {};\n\n        for (var prop in dimensions) {\n          cssValue = dimensions[prop];\n\n          if (!options.cssOnly) {\n            this._setBackstoreDimension(prop, dimensions[prop]);\n            cssValue += 'px';\n            this.hasLostContext = true;\n          }\n\n          if (!options.backstoreOnly) {\n            this._setCssDimension(prop, cssValue);\n          }\n        }\n        if (this._isCurrentlyDrawing) {\n          this.freeDrawingBrush && this.freeDrawingBrush._setBrushStyles();\n        }\n        this._initRetinaScaling();\n        this._setImageSmoothing();\n        this.calcOffset();\n\n        if (!options.cssOnly) {\n          this.requestRenderAll();\n        }\n\n        return this;\n      },\n\n      /**\n       * Helper for setting width/height\n       * @private\n       * @param {String} prop property (width|height)\n       * @param {Number} value value to set property to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      _setBackstoreDimension: function (prop, value) {\n        this.lowerCanvasEl[prop] = value;\n\n        if (this.upperCanvasEl) {\n          this.upperCanvasEl[prop] = value;\n        }\n\n        if (this.cacheCanvasEl) {\n          this.cacheCanvasEl[prop] = value;\n        }\n\n        this[prop] = value;\n\n        return this;\n      },\n\n      /**\n       * Helper for setting css width/height\n       * @private\n       * @param {String} prop property (width|height)\n       * @param {String} value value to set property to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      _setCssDimension: function (prop, value) {\n        this.lowerCanvasEl.style[prop] = value;\n\n        if (this.upperCanvasEl) {\n          this.upperCanvasEl.style[prop] = value;\n        }\n\n        if (this.wrapperEl) {\n          this.wrapperEl.style[prop] = value;\n        }\n\n        return this;\n      },\n\n      /**\n       * Returns canvas zoom level\n       * @return {Number}\n       */\n      getZoom: function () {\n        return this.viewportTransform[0];\n      },\n\n      /**\n       * Sets viewport transform of this canvas instance\n       * @param {Array} vpt the transform in the form of context.transform\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setViewportTransform: function (vpt) {\n        var activeObject = this._activeObject,\n          object,\n          ignoreVpt = false,\n          skipAbsolute = true,\n          i,\n          len;\n        this.viewportTransform = vpt;\n        for (i = 0, len = this._objects.length; i < len; i++) {\n          object = this._objects[i];\n          object.group || object.setCoords(ignoreVpt, skipAbsolute);\n        }\n        if (activeObject && activeObject.type === 'activeSelection') {\n          activeObject.setCoords(ignoreVpt, skipAbsolute);\n        }\n        this.calcViewportBoundaries();\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Sets zoom level of this canvas instance, zoom centered around point\n       * @param {fabric.Point} point to zoom with respect to\n       * @param {Number} value to set zoom to, less than 1 zooms out\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      zoomToPoint: function (point, value) {\n        // TODO: just change the scale, preserve other transformations\n        var before = point,\n          vpt = this.viewportTransform.slice(0);\n        point = transformPoint(point, invertTransform(this.viewportTransform));\n        vpt[0] = value;\n        vpt[3] = value;\n        var after = transformPoint(point, vpt);\n        vpt[4] += before.x - after.x;\n        vpt[5] += before.y - after.y;\n        return this.setViewportTransform(vpt);\n      },\n\n      /**\n       * Sets zoom level of this canvas instance\n       * @param {Number} value to set zoom to, less than 1 zooms out\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setZoom: function (value) {\n        this.zoomToPoint(new fabric.Point(0, 0), value);\n        return this;\n      },\n\n      /**\n       * Pan viewport so as to place point at top left corner of canvas\n       * @param {fabric.Point} point to move to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      absolutePan: function (point) {\n        var vpt = this.viewportTransform.slice(0);\n        vpt[4] = -point.x;\n        vpt[5] = -point.y;\n        return this.setViewportTransform(vpt);\n      },\n\n      /**\n       * Pans viewpoint relatively\n       * @param {fabric.Point} point (position vector) to move by\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      relativePan: function (point) {\n        return this.absolutePan(\n          new fabric.Point(\n            -point.x - this.viewportTransform[4],\n            -point.y - this.viewportTransform[5]\n          )\n        );\n      },\n\n      /**\n       * Returns &lt;canvas> element corresponding to this instance\n       * @return {HTMLCanvasElement}\n       */\n      getElement: function () {\n        return this.lowerCanvasEl;\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} obj Object that was added\n       */\n      _onObjectAdded: function (obj) {\n        this.stateful && obj.setupState();\n        obj._set('canvas', this);\n        obj.setCoords();\n        this.fire('object:added', { target: obj });\n        obj.fire('added');\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} obj Object that was removed\n       */\n      _onObjectRemoved: function (obj) {\n        this.fire('object:removed', { target: obj });\n        obj.fire('removed');\n        delete obj.canvas;\n      },\n\n      /**\n       * Clears specified context of canvas element\n       * @param {CanvasRenderingContext2D} ctx Context to clear\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      clearContext: function (ctx) {\n        ctx.clearRect(0, 0, this.width, this.height);\n        return this;\n      },\n\n      /**\n       * Returns context of canvas where objects are drawn\n       * @return {CanvasRenderingContext2D}\n       */\n      getContext: function () {\n        return this.contextContainer;\n      },\n\n      /**\n       * Clears all contexts (background, main, top) of an instance\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      clear: function () {\n        this._objects.length = 0;\n        this.backgroundImage = null;\n        this.overlayImage = null;\n        this.backgroundColor = '';\n        this.overlayColor = '';\n        if (this._hasITextHandlers) {\n          this.off('mouse:up', this._mouseUpITextHandler);\n          this._iTextInstances = null;\n          this._hasITextHandlers = false;\n        }\n        this.clearContext(this.contextContainer);\n        this.fire('canvas:cleared');\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Renders the canvas\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderAll: function () {\n        var canvasToDrawOn = this.contextContainer;\n        this.renderCanvas(canvasToDrawOn, this._objects);\n        return this;\n      },\n\n      /**\n       * Function created to be instance bound at initialization\n       * used in requestAnimationFrame rendering\n       * Let the fabricJS call it. If you call it manually you could have more\n       * animationFrame stacking on to of each other\n       * for an imperative rendering, use canvas.renderAll\n       * @private\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderAndReset: function () {\n        this.isRendering = 0;\n        this.renderAll();\n      },\n\n      /**\n       * Append a renderAll request to next animation frame.\n       * unless one is already in progress, in that case nothing is done\n       * a boolean flag will avoid appending more.\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      requestRenderAll: function () {\n        if (!this.isRendering) {\n          this.isRendering = fabric.util.requestAnimFrame(\n            this.renderAndResetBound\n          );\n        }\n        return this;\n      },\n\n      /**\n       * Calculate the position of the 4 corner of canvas with current viewportTransform.\n       * helps to determinate when an object is in the current rendering viewport using\n       * object absolute coordinates ( aCoords )\n       * @return {Object} points.tl\n       * @chainable\n       */\n      calcViewportBoundaries: function () {\n        var points = {},\n          width = this.width,\n          height = this.height,\n          iVpt = invertTransform(this.viewportTransform);\n        points.tl = transformPoint({ x: 0, y: 0 }, iVpt);\n        points.br = transformPoint({ x: width, y: height }, iVpt);\n        points.tr = new fabric.Point(points.br.x, points.tl.y);\n        points.bl = new fabric.Point(points.tl.x, points.br.y);\n        this.vptCoords = points;\n        return points;\n      },\n\n      cancelRequestedRender: function () {\n        if (this.isRendering) {\n          fabric.util.cancelAnimFrame(this.isRendering);\n          this.isRendering = 0;\n        }\n      },\n\n      /**\n       * Renders background, objects, overlay and controls.\n       * @param {CanvasRenderingContext2D} ctx\n       * @param {Array} objects to render\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderCanvas: function (ctx, objects) {\n        var v = this.viewportTransform,\n          path = this.clipPath;\n        this.cancelRequestedRender();\n        this.calcViewportBoundaries();\n        this.clearContext(ctx);\n        this.fire('before:render', { ctx: ctx });\n        if (this.clipTo) {\n          fabric.util.clipContext(this, ctx);\n        }\n        this._renderBackground(ctx);\n\n        ctx.save();\n        //apply viewport transform once for all rendering process\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        this._renderObjects(ctx, objects);\n        ctx.restore();\n        if (!this.controlsAboveOverlay && this.interactive) {\n          this.drawControls(ctx);\n        }\n        if (this.clipTo) {\n          ctx.restore();\n        }\n        if (path) {\n          path.canvas = this;\n          // needed to setup a couple of variables\n          path.shouldCache();\n          path._transformDone = true;\n          path.renderCache({ forClipping: true });\n          this.drawClipPathOnCanvas(ctx);\n        }\n        this._renderOverlay(ctx);\n        if (this.controlsAboveOverlay && this.interactive) {\n          this.drawControls(ctx);\n        }\n        this.fire('after:render', { ctx: ctx });\n      },\n\n      /**\n       * Paint the cached clipPath on the lowerCanvasEl\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawClipPathOnCanvas: function (ctx) {\n        var v = this.viewportTransform,\n          path = this.clipPath;\n        ctx.save();\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        // DEBUG: uncomment this line, comment the following\n        // ctx.globalAlpha = 0.4;\n        ctx.globalCompositeOperation = 'destination-in';\n        path.transform(ctx);\n        ctx.scale(1 / path.zoomX, 1 / path.zoomY);\n        ctx.drawImage(\n          path._cacheCanvas,\n          -path.cacheTranslationX,\n          -path.cacheTranslationY\n        );\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Array} objects to render\n       */\n      _renderObjects: function (ctx, objects) {\n        var i, len;\n        for (i = 0, len = objects.length; i < len; ++i) {\n          objects[i] && objects[i].render(ctx);\n        }\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {string} property 'background' or 'overlay'\n       */\n      _renderBackgroundOrOverlay: function (ctx, property) {\n        var fill = this[property + 'Color'],\n          object = this[property + 'Image'],\n          v = this.viewportTransform,\n          needsVpt = this[property + 'Vpt'];\n        if (!fill && !object) {\n          return;\n        }\n        if (fill) {\n          ctx.save();\n          ctx.beginPath();\n          ctx.moveTo(0, 0);\n          ctx.lineTo(this.width, 0);\n          ctx.lineTo(this.width, this.height);\n          ctx.lineTo(0, this.height);\n          ctx.closePath();\n          ctx.fillStyle = fill.toLive ? fill.toLive(ctx, this) : fill;\n          if (needsVpt) {\n            ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n          }\n          ctx.transform(1, 0, 0, 1, fill.offsetX || 0, fill.offsetY || 0);\n          var m = fill.gradientTransform || fill.patternTransform;\n          m && ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n          ctx.fill();\n          ctx.restore();\n        }\n        if (object) {\n          ctx.save();\n          if (needsVpt) {\n            ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n          }\n          object.render(ctx);\n          ctx.restore();\n        }\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderBackground: function (ctx) {\n        this._renderBackgroundOrOverlay(ctx, 'background');\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderOverlay: function (ctx) {\n        this._renderBackgroundOrOverlay(ctx, 'overlay');\n      },\n\n      /**\n       * Returns coordinates of a center of canvas.\n       * Returned value is an object with top and left properties\n       * @return {Object} object with \"top\" and \"left\" number values\n       */\n      getCenter: function () {\n        return {\n          top: this.height / 2,\n          left: this.width / 2,\n        };\n      },\n\n      /**\n       * Centers object horizontally in the canvas\n       * @param {fabric.Object} object Object to center horizontally\n       * @return {fabric.Canvas} thisArg\n       */\n      centerObjectH: function (object) {\n        return this._centerObject(\n          object,\n          new fabric.Point(this.getCenter().left, object.getCenterPoint().y)\n        );\n      },\n\n      /**\n       * Centers object vertically in the canvas\n       * @param {fabric.Object} object Object to center vertically\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      centerObjectV: function (object) {\n        return this._centerObject(\n          object,\n          new fabric.Point(object.getCenterPoint().x, this.getCenter().top)\n        );\n      },\n\n      /**\n       * Centers object vertically and horizontally in the canvas\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      centerObject: function (object) {\n        var center = this.getCenter();\n\n        return this._centerObject(\n          object,\n          new fabric.Point(center.left, center.top)\n        );\n      },\n\n      /**\n       * Centers object vertically and horizontally in the viewport\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObject: function (object) {\n        var vpCenter = this.getVpCenter();\n\n        return this._centerObject(object, vpCenter);\n      },\n\n      /**\n       * Centers object horizontally in the viewport, object.top is unchanged\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObjectH: function (object) {\n        var vpCenter = this.getVpCenter();\n        this._centerObject(\n          object,\n          new fabric.Point(vpCenter.x, object.getCenterPoint().y)\n        );\n        return this;\n      },\n\n      /**\n       * Centers object Vertically in the viewport, object.top is unchanged\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObjectV: function (object) {\n        var vpCenter = this.getVpCenter();\n\n        return this._centerObject(\n          object,\n          new fabric.Point(object.getCenterPoint().x, vpCenter.y)\n        );\n      },\n\n      /**\n       * Calculate the point in canvas that correspond to the center of actual viewport.\n       * @return {fabric.Point} vpCenter, viewport center\n       * @chainable\n       */\n      getVpCenter: function () {\n        var center = this.getCenter(),\n          iVpt = invertTransform(this.viewportTransform);\n        return transformPoint({ x: center.left, y: center.top }, iVpt);\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} object Object to center\n       * @param {fabric.Point} center Center point\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      _centerObject: function (object, center) {\n        object.setPositionByOrigin(center, 'center', 'center');\n        object.setCoords();\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Returs dataless JSON representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {String} json string\n       */\n      toDatalessJSON: function (propertiesToInclude) {\n        return this.toDatalessObject(propertiesToInclude);\n      },\n\n      /**\n       * Returns object representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        return this._toObjectMethod('toObject', propertiesToInclude);\n      },\n\n      /**\n       * Returns dataless object representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        return this._toObjectMethod('toDatalessObject', propertiesToInclude);\n      },\n\n      /**\n       * @private\n       */\n      _toObjectMethod: function (methodName, propertiesToInclude) {\n        var clipPath = this.clipPath,\n          data = {\n            version: fabric.version,\n            objects: this._toObjects(methodName, propertiesToInclude),\n          };\n        if (clipPath) {\n          data.clipPath = this._toObject(\n            this.clipPath,\n            methodName,\n            propertiesToInclude\n          );\n        }\n        extend(\n          data,\n          this.__serializeBgOverlay(methodName, propertiesToInclude)\n        );\n\n        fabric.util.populateWithProperties(this, data, propertiesToInclude);\n\n        return data;\n      },\n\n      /**\n       * @private\n       */\n      _toObjects: function (methodName, propertiesToInclude) {\n        return this._objects\n          .filter(function (object) {\n            return !object.excludeFromExport;\n          })\n          .map(function (instance) {\n            return this._toObject(instance, methodName, propertiesToInclude);\n          }, this);\n      },\n\n      /**\n       * @private\n       */\n      _toObject: function (instance, methodName, propertiesToInclude) {\n        var originalValue;\n\n        if (!this.includeDefaultValues) {\n          originalValue = instance.includeDefaultValues;\n          instance.includeDefaultValues = false;\n        }\n\n        var object = instance[methodName](propertiesToInclude);\n        if (!this.includeDefaultValues) {\n          instance.includeDefaultValues = originalValue;\n        }\n        return object;\n      },\n\n      /**\n       * @private\n       */\n      __serializeBgOverlay: function (methodName, propertiesToInclude) {\n        var data = {},\n          bgImage = this.backgroundImage,\n          overlay = this.overlayImage;\n\n        if (this.backgroundColor) {\n          data.background = this.backgroundColor.toObject\n            ? this.backgroundColor.toObject(propertiesToInclude)\n            : this.backgroundColor;\n        }\n\n        if (this.overlayColor) {\n          data.overlay = this.overlayColor.toObject\n            ? this.overlayColor.toObject(propertiesToInclude)\n            : this.overlayColor;\n        }\n        if (bgImage && !bgImage.excludeFromExport) {\n          data.backgroundImage = this._toObject(\n            bgImage,\n            methodName,\n            propertiesToInclude\n          );\n        }\n        if (overlay && !overlay.excludeFromExport) {\n          data.overlayImage = this._toObject(\n            overlay,\n            methodName,\n            propertiesToInclude\n          );\n        }\n\n        return data;\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * When true, getSvgTransform() will apply the StaticCanvas.viewportTransform to the SVG transformation. When true,\n       * a zoomed canvas will then produce zoomed SVG output.\n       * @type Boolean\n       * @default\n       */\n      svgViewportTransformation: true,\n\n      /**\n       * Returns SVG representation of canvas\n       * @function\n       * @param {Object} [options] Options object for SVG output\n       * @param {Boolean} [options.suppressPreamble=false] If true xml tag is not included\n       * @param {Object} [options.viewBox] SVG viewbox object\n       * @param {Number} [options.viewBox.x] x-cooridnate of viewbox\n       * @param {Number} [options.viewBox.y] y-coordinate of viewbox\n       * @param {Number} [options.viewBox.width] Width of viewbox\n       * @param {Number} [options.viewBox.height] Height of viewbox\n       * @param {String} [options.encoding=UTF-8] Encoding of SVG output\n       * @param {String} [options.width] desired width of svg with or without units\n       * @param {String} [options.height] desired height of svg with or without units\n       * @param {Function} [reviver] Method for further parsing of svg elements, called after each fabric object converted into svg representation.\n       * @return {String} SVG string\n       * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n       * @see {@link http://jsfiddle.net/fabricjs/jQ3ZZ/|jsFiddle demo}\n       * @example <caption>Normal SVG output</caption>\n       * var svg = canvas.toSVG();\n       * @example <caption>SVG output without preamble (without &lt;?xml ../>)</caption>\n       * var svg = canvas.toSVG({suppressPreamble: true});\n       * @example <caption>SVG output with viewBox attribute</caption>\n       * var svg = canvas.toSVG({\n       *   viewBox: {\n       *     x: 100,\n       *     y: 100,\n       *     width: 200,\n       *     height: 300\n       *   }\n       * });\n       * @example <caption>SVG output with different encoding (default: UTF-8)</caption>\n       * var svg = canvas.toSVG({encoding: 'ISO-8859-1'});\n       * @example <caption>Modify SVG output with reviver function</caption>\n       * var svg = canvas.toSVG(null, function(svg) {\n       *   return svg.replace('stroke-dasharray: ; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; ', '');\n       * });\n       */\n      toSVG: function (options, reviver) {\n        options || (options = {});\n        options.reviver = reviver;\n        var markup = [];\n\n        this._setSVGPreamble(markup, options);\n        this._setSVGHeader(markup, options);\n        if (this.clipPath) {\n          markup.push(\n            '<g clip-path=\"url(#' + this.clipPath.clipPathId + ')\" >\\n'\n          );\n        }\n        this._setSVGBgOverlayColor(markup, 'background');\n        this._setSVGBgOverlayImage(markup, 'backgroundImage', reviver);\n        this._setSVGObjects(markup, reviver);\n        if (this.clipPath) {\n          markup.push('</g>\\n');\n        }\n        this._setSVGBgOverlayColor(markup, 'overlay');\n        this._setSVGBgOverlayImage(markup, 'overlayImage', reviver);\n\n        markup.push('</svg>');\n\n        return markup.join('');\n      },\n\n      /**\n       * @private\n       */\n      _setSVGPreamble: function (markup, options) {\n        if (options.suppressPreamble) {\n          return;\n        }\n        markup.push(\n          '<?xml version=\"1.0\" encoding=\"',\n          options.encoding || 'UTF-8',\n          '\" standalone=\"no\" ?>\\n',\n          '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" ',\n          '\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n'\n        );\n      },\n\n      /**\n       * @private\n       */\n      _setSVGHeader: function (markup, options) {\n        var width = options.width || this.width,\n          height = options.height || this.height,\n          vpt,\n          viewBox = 'viewBox=\"0 0 ' + this.width + ' ' + this.height + '\" ',\n          NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n\n        if (options.viewBox) {\n          viewBox =\n            'viewBox=\"' +\n            options.viewBox.x +\n            ' ' +\n            options.viewBox.y +\n            ' ' +\n            options.viewBox.width +\n            ' ' +\n            options.viewBox.height +\n            '\" ';\n        } else {\n          if (this.svgViewportTransformation) {\n            vpt = this.viewportTransform;\n            viewBox =\n              'viewBox=\"' +\n              toFixed(-vpt[4] / vpt[0], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(-vpt[5] / vpt[3], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(this.width / vpt[0], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(this.height / vpt[3], NUM_FRACTION_DIGITS) +\n              '\" ';\n          }\n        }\n\n        markup.push(\n          '<svg ',\n          'xmlns=\"http://www.w3.org/2000/svg\" ',\n          'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ',\n          'version=\"1.1\" ',\n          'width=\"',\n          width,\n          '\" ',\n          'height=\"',\n          height,\n          '\" ',\n          viewBox,\n          'xml:space=\"preserve\">\\n',\n          '<desc>Created with Fabric.js ',\n          fabric.version,\n          '</desc>\\n',\n          '<defs>\\n',\n          this.createSVGFontFacesMarkup(),\n          this.createSVGRefElementsMarkup(),\n          this.createSVGClipPathMarkup(options),\n          '</defs>\\n'\n        );\n      },\n\n      createSVGClipPathMarkup: function (options) {\n        var clipPath = this.clipPath;\n        if (clipPath) {\n          clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n          return (\n            '<clipPath id=\"' +\n            clipPath.clipPathId +\n            '\" >\\n' +\n            this.clipPath.toClipPathSVG(options.reviver) +\n            '</clipPath>\\n'\n          );\n        }\n        return '';\n      },\n\n      /**\n       * Creates markup containing SVG referenced elements like patterns, gradients etc.\n       * @return {String}\n       */\n      createSVGRefElementsMarkup: function () {\n        var _this = this,\n          markup = ['background', 'overlay'].map(function (prop) {\n            var fill = _this[prop + 'Color'];\n            if (fill && fill.toLive) {\n              var shouldTransform = _this[prop + 'Vpt'],\n                vpt = _this.viewportTransform,\n                object = {\n                  width: _this.width / (shouldTransform ? vpt[0] : 1),\n                  height: _this.height / (shouldTransform ? vpt[3] : 1),\n                };\n              return fill.toSVG(object, {\n                additionalTransform: shouldTransform\n                  ? fabric.util.matrixToSVG(vpt)\n                  : '',\n              });\n            }\n            return undefined;\n          });\n        return markup.join('');\n      },\n\n      /**\n       * Creates markup containing SVG font faces,\n       * font URLs for font faces must be collected by developers\n       * and are not extracted from the DOM by fabricjs\n       * @param {Array} objects Array of fabric objects\n       * @return {String}\n       */\n      createSVGFontFacesMarkup: function () {\n        var markup = '',\n          fontList = {},\n          obj,\n          fontFamily,\n          style,\n          row,\n          rowIndex,\n          _char,\n          charIndex,\n          i,\n          len,\n          fontPaths = fabric.fontPaths,\n          objects = [];\n\n        this._objects.forEach(function add(object) {\n          objects.push(object);\n          if (object._objects) {\n            object._objects.forEach(add);\n          }\n        });\n\n        for (i = 0, len = objects.length; i < len; i++) {\n          obj = objects[i];\n          fontFamily = obj.fontFamily;\n          if (\n            obj.type.indexOf('text') === -1 ||\n            fontList[fontFamily] ||\n            !fontPaths[fontFamily]\n          ) {\n            continue;\n          }\n          fontList[fontFamily] = true;\n          if (!obj.styles) {\n            continue;\n          }\n          style = obj.styles;\n          for (rowIndex in style) {\n            row = style[rowIndex];\n            for (charIndex in row) {\n              _char = row[charIndex];\n              fontFamily = _char.fontFamily;\n              if (!fontList[fontFamily] && fontPaths[fontFamily]) {\n                fontList[fontFamily] = true;\n              }\n            }\n          }\n        }\n\n        for (var j in fontList) {\n          markup += [\n            '\\t\\t@font-face {\\n',\n            \"\\t\\t\\tfont-family: '\",\n            j,\n            \"';\\n\",\n            \"\\t\\t\\tsrc: url('\",\n            fontPaths[j],\n            \"');\\n\",\n            '\\t\\t}\\n',\n          ].join('');\n        }\n\n        if (markup) {\n          markup = [\n            '\\t<style type=\"text/css\">',\n            '<![CDATA[\\n',\n            markup,\n            ']]>',\n            '</style>\\n',\n          ].join('');\n        }\n\n        return markup;\n      },\n\n      /**\n       * @private\n       */\n      _setSVGObjects: function (markup, reviver) {\n        var instance,\n          i,\n          len,\n          objects = this._objects;\n        for (i = 0, len = objects.length; i < len; i++) {\n          instance = objects[i];\n          if (instance.excludeFromExport) {\n            continue;\n          }\n          this._setSVGObject(markup, instance, reviver);\n        }\n      },\n\n      /**\n       * @private\n       */\n      _setSVGObject: function (markup, instance, reviver) {\n        markup.push(instance.toSVG(reviver));\n      },\n\n      /**\n       * @private\n       */\n      _setSVGBgOverlayImage: function (markup, property, reviver) {\n        if (\n          this[property] &&\n          !this[property].excludeFromExport &&\n          this[property].toSVG\n        ) {\n          markup.push(this[property].toSVG(reviver));\n        }\n      },\n\n      /**\n       * @private\n       */\n      _setSVGBgOverlayColor: function (markup, property) {\n        var filler = this[property + 'Color'],\n          vpt = this.viewportTransform,\n          finalWidth = this.width,\n          finalHeight = this.height;\n        if (!filler) {\n          return;\n        }\n        if (filler.toLive) {\n          var repeat = filler.repeat,\n            iVpt = fabric.util.invertTransform(vpt),\n            shouldInvert = this[property + 'Vpt'],\n            additionalTransform = shouldInvert\n              ? fabric.util.matrixToSVG(iVpt)\n              : '';\n          markup.push(\n            '<rect transform=\"' + additionalTransform + ' translate(',\n            finalWidth / 2,\n            ',',\n            finalHeight / 2,\n            ')\"',\n            ' x=\"',\n            filler.offsetX - finalWidth / 2,\n            '\" y=\"',\n            filler.offsetY - finalHeight / 2,\n            '\" ',\n            'width=\"',\n            repeat === 'repeat-y' || repeat === 'no-repeat'\n              ? filler.source.width\n              : finalWidth,\n            '\" height=\"',\n            repeat === 'repeat-x' || repeat === 'no-repeat'\n              ? filler.source.height\n              : finalHeight,\n            '\" fill=\"url(#SVGID_' + filler.id + ')\"',\n            '></rect>\\n'\n          );\n        } else {\n          markup.push(\n            '<rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" ',\n            'fill=\"',\n            filler,\n            '\"',\n            '></rect>\\n'\n          );\n        }\n      },\n      /* _TO_SVG_END_ */\n\n      /**\n       * Moves an object or the objects of a multiple selection\n       * to the bottom of the stack of drawn objects\n       * @param {fabric.Object} object Object to send to back\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      sendToBack: function (object) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          objs;\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = objs.length; i--; ) {\n            obj = objs[i];\n            removeFromArray(this._objects, obj);\n            this._objects.unshift(obj);\n          }\n        } else {\n          removeFromArray(this._objects, object);\n          this._objects.unshift(object);\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Moves an object or the objects of a multiple selection\n       * to the top of the stack of drawn objects\n       * @param {fabric.Object} object Object to send\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      bringToFront: function (object) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          objs;\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = 0; i < objs.length; i++) {\n            obj = objs[i];\n            removeFromArray(this._objects, obj);\n            this._objects.push(obj);\n          }\n        } else {\n          removeFromArray(this._objects, object);\n          this._objects.push(object);\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Moves an object or a selection down in stack of drawn objects\n       * An optional paramter, intersecting allowes to move the object in behind\n       * the first intersecting object. Where intersection is calculated with\n       * bounding box. If no intersection is found, there will not be change in the\n       * stack.\n       * @param {fabric.Object} object Object to send\n       * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      sendBackwards: function (object, intersecting) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          idx,\n          newIdx,\n          objs,\n          objsMoved = 0;\n\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = 0; i < objs.length; i++) {\n            obj = objs[i];\n            idx = this._objects.indexOf(obj);\n            if (idx > 0 + objsMoved) {\n              newIdx = idx - 1;\n              removeFromArray(this._objects, obj);\n              this._objects.splice(newIdx, 0, obj);\n            }\n            objsMoved++;\n          }\n        } else {\n          idx = this._objects.indexOf(object);\n          if (idx !== 0) {\n            // if object is not on the bottom of stack\n            newIdx = this._findNewLowerIndex(object, idx, intersecting);\n            removeFromArray(this._objects, object);\n            this._objects.splice(newIdx, 0, object);\n          }\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _findNewLowerIndex: function (object, idx, intersecting) {\n        var newIdx, i;\n\n        if (intersecting) {\n          newIdx = idx;\n\n          // traverse down the stack looking for the nearest intersecting object\n          for (i = idx - 1; i >= 0; --i) {\n            var isIntersecting =\n              object.intersectsWithObject(this._objects[i]) ||\n              object.isContainedWithinObject(this._objects[i]) ||\n              this._objects[i].isContainedWithinObject(object);\n\n            if (isIntersecting) {\n              newIdx = i;\n              break;\n            }\n          }\n        } else {\n          newIdx = idx - 1;\n        }\n\n        return newIdx;\n      },\n\n      /**\n       * Moves an object or a selection up in stack of drawn objects\n       * An optional paramter, intersecting allowes to move the object in front\n       * of the first intersecting object. Where intersection is calculated with\n       * bounding box. If no intersection is found, there will not be change in the\n       * stack.\n       * @param {fabric.Object} object Object to send\n       * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      bringForward: function (object, intersecting) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          idx,\n          newIdx,\n          objs,\n          objsMoved = 0;\n\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = objs.length; i--; ) {\n            obj = objs[i];\n            idx = this._objects.indexOf(obj);\n            if (idx < this._objects.length - 1 - objsMoved) {\n              newIdx = idx + 1;\n              removeFromArray(this._objects, obj);\n              this._objects.splice(newIdx, 0, obj);\n            }\n            objsMoved++;\n          }\n        } else {\n          idx = this._objects.indexOf(object);\n          if (idx !== this._objects.length - 1) {\n            // if object is not on top of stack (last item in an array)\n            newIdx = this._findNewUpperIndex(object, idx, intersecting);\n            removeFromArray(this._objects, object);\n            this._objects.splice(newIdx, 0, object);\n          }\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _findNewUpperIndex: function (object, idx, intersecting) {\n        var newIdx, i, len;\n\n        if (intersecting) {\n          newIdx = idx;\n\n          // traverse up the stack looking for the nearest intersecting object\n          for (i = idx + 1, len = this._objects.length; i < len; ++i) {\n            var isIntersecting =\n              object.intersectsWithObject(this._objects[i]) ||\n              object.isContainedWithinObject(this._objects[i]) ||\n              this._objects[i].isContainedWithinObject(object);\n\n            if (isIntersecting) {\n              newIdx = i;\n              break;\n            }\n          }\n        } else {\n          newIdx = idx + 1;\n        }\n\n        return newIdx;\n      },\n\n      /**\n       * Moves an object to specified level in stack of drawn objects\n       * @param {fabric.Object} object Object to send\n       * @param {Number} index Position to move to\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      moveTo: function (object, index) {\n        removeFromArray(this._objects, object);\n        this._objects.splice(index, 0, object);\n        return this.renderOnAddRemove && this.requestRenderAll();\n      },\n\n      /**\n       * Clears a canvas element and dispose objects\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      dispose: function () {\n        // cancel eventually ongoing renders\n        if (this.isRendering) {\n          fabric.util.cancelAnimFrame(this.isRendering);\n          this.isRendering = 0;\n        }\n        this.forEachObject(function (object) {\n          object.dispose && object.dispose();\n        });\n        this._objects = [];\n        if (this.backgroundImage && this.backgroundImage.dispose) {\n          this.backgroundImage.dispose();\n        }\n        this.backgroundImage = null;\n        if (this.overlayImage && this.overlayImage.dispose) {\n          this.overlayImage.dispose();\n        }\n        this.overlayImage = null;\n        this._iTextInstances = null;\n        this.contextContainer = null;\n        fabric.util.cleanUpJsdomNode(this.lowerCanvasEl);\n        this.lowerCanvasEl = undefined;\n        return this;\n      },\n\n      /**\n       * Returns a string representation of an instance\n       * @return {String} string representation of an instance\n       */\n      toString: function () {\n        return (\n          '#<fabric.Canvas (' +\n          this.complexity() +\n          '): ' +\n          '{ objects: ' +\n          this._objects.length +\n          ' }>'\n        );\n      },\n    }\n  );\n\n  extend(fabric.StaticCanvas.prototype, fabric.Observable);\n  extend(fabric.StaticCanvas.prototype, fabric.Collection);\n  extend(fabric.StaticCanvas.prototype, fabric.DataURLExporter);\n\n  extend(\n    fabric.StaticCanvas,\n    /** @lends fabric.StaticCanvas */ {\n      /**\n       * @static\n       * @type String\n       * @default\n       */\n      EMPTY_JSON: '{\"objects\": [], \"background\": \"white\"}',\n\n      /**\n       * Provides a way to check support of some of the canvas methods\n       * (either those of HTMLCanvasElement itself, or rendering context)\n       *\n       * @param {String} methodName Method to check support for;\n       *                            Could be one of \"setLineDash\"\n       * @return {Boolean | null} `true` if method is supported (or at least exists),\n       *                          `null` if canvas element or context can not be initialized\n       */\n      supports: function (methodName) {\n        var el = createCanvasElement();\n\n        if (!el || !el.getContext) {\n          return null;\n        }\n\n        var ctx = el.getContext('2d');\n        if (!ctx) {\n          return null;\n        }\n\n        switch (methodName) {\n          case 'setLineDash':\n            return typeof ctx.setLineDash !== 'undefined';\n\n          default:\n            return null;\n        }\n      },\n    }\n  );\n\n  /**\n   * Returns JSON representation of canvas\n   * @function\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @return {String} JSON string\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n   * @see {@link http://jsfiddle.net/fabricjs/pec86/|jsFiddle demo}\n   * @example <caption>JSON without additional properties</caption>\n   * var json = canvas.toJSON();\n   * @example <caption>JSON with additional properties included</caption>\n   * var json = canvas.toJSON(['lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY', 'lockUniScaling']);\n   * @example <caption>JSON without default values</caption>\n   * canvas.includeDefaultValues = false;\n   * var json = canvas.toJSON();\n   */\n  fabric.StaticCanvas.prototype.toJSON = fabric.StaticCanvas.prototype.toObject;\n\n  if (fabric.isLikelyNode) {\n    fabric.StaticCanvas.prototype.createPNGStream = function () {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createPNGStream();\n    };\n    fabric.StaticCanvas.prototype.createJPEGStream = function (opts) {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createJPEGStream(opts);\n    };\n  }\n})();\n(function initToDataURL() {\n  fabric.util.object.extend(\n    fabric.StaticCanvas.prototype,\n    /** @lends fabric.StaticCanvas.prototype */ {\n      /**\n       * Exports canvas element to a dataurl image. Note that when multiplier is used, cropping is scaled appropriately\n       * @param {Object} [options] Options object\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by, to have consistent\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 2.0.0\n       * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n       * @see {@link http://jsfiddle.net/fabricjs/NfZVb/|jsFiddle demo}\n       * @example <caption>Generate jpeg dataURL with lower quality</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'jpeg',\n       *   quality: 0.8\n       * });\n       * @example <caption>Generate cropped png dataURL (clipping of canvas)</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'png',\n       *   left: 100,\n       *   top: 100,\n       *   width: 200,\n       *   height: 200\n       * });\n       * @example <caption>Generate double scaled png dataURL</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'png',\n       *   multiplier: 2\n       * });\n       */\n      toDataURL: function (options) {\n        options || (options = {});\n\n        var format = options.format || 'png',\n          quality = options.quality || 1,\n          multiplier =\n            (options.multiplier || 1) *\n            (options.enableRetinaScaling ? this.getRetinaScaling() : 1),\n          canvasEl = this.toCanvasElement(multiplier, options);\n        return fabric.util.toDataURL(canvasEl, format, quality);\n      },\n\n      /**\n       * Create a new HTMLCanvas element painted with the current canvas content.\n       * No need to resize the actual one or repaint it.\n       * Will transfer object ownership to a new canvas, paint it, and set everything back.\n       * This is an intermediary step used to get to a dataUrl but also it is useful to\n       * create quick image copies of a canvas without passing for the dataUrl string\n       * @param {Number} [multiplier] a zoom factor.\n       * @param {Object} [cropping] Cropping informations\n       * @param {Number} [cropping.left] Cropping left offset.\n       * @param {Number} [cropping.top] Cropping top offset.\n       * @param {Number} [cropping.width] Cropping width.\n       * @param {Number} [cropping.height] Cropping height.\n       */\n      toCanvasElement: function (multiplier, cropping) {\n        multiplier = multiplier || 1;\n        cropping = cropping || {};\n        var scaledWidth = (cropping.width || this.width) * multiplier,\n          scaledHeight = (cropping.height || this.height) * multiplier,\n          zoom = this.getZoom(),\n          originalWidth = this.width,\n          originalHeight = this.height,\n          newZoom = zoom * multiplier,\n          vp = this.viewportTransform,\n          translateX = (vp[4] - (cropping.left || 0)) * multiplier,\n          translateY = (vp[5] - (cropping.top || 0)) * multiplier,\n          originalInteractive = this.interactive,\n          newVp = [newZoom, 0, 0, newZoom, translateX, translateY],\n          originalRetina = this.enableRetinaScaling,\n          canvasEl = fabric.util.createCanvasElement(),\n          originalContextTop = this.contextTop;\n        canvasEl.width = scaledWidth;\n        canvasEl.height = scaledHeight;\n        this.contextTop = null;\n        this.enableRetinaScaling = false;\n        this.interactive = false;\n        this.viewportTransform = newVp;\n        this.width = scaledWidth;\n        this.height = scaledHeight;\n        this.calcViewportBoundaries();\n        this.renderCanvas(canvasEl.getContext('2d'), this._objects);\n        this.viewportTransform = vp;\n        this.width = originalWidth;\n        this.height = originalHeight;\n        this.calcViewportBoundaries();\n        this.interactive = originalInteractive;\n        this.enableRetinaScaling = originalRetina;\n        this.contextTop = originalContextTop;\n        return canvasEl;\n      },\n    }\n  );\n})();\n(function init2dRoot(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    extend = fabric.util.object.extend,\n    clone = fabric.util.object.clone,\n    toFixed = fabric.util.toFixed,\n    capitalize = fabric.util.string.capitalize,\n    degreesToRadians = fabric.util.degreesToRadians,\n    supportsLineDash = fabric.StaticCanvas.supports('setLineDash'),\n    objectCaching = !fabric.isLikelyNode,\n    ALIASING_LIMIT = 2;\n\n  if (fabric.Object) {\n    return;\n  }\n\n  /**\n   * Root object class from which all 2d shape classes inherit from\n   * @class fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#objects}\n   * @see {@link fabric.Object#initialize} for constructor definition\n   *\n   * @fires added\n   * @fires removed\n   *\n   * @fires selected\n   * @fires deselected\n   * @fires modified\n   * @fires modified\n   * @fires moved\n   * @fires scaled\n   * @fires rotated\n   * @fires skewed\n   *\n   * @fires rotating\n   * @fires scaling\n   * @fires moving\n   * @fires skewing\n   *\n   * @fires mousedown\n   * @fires mouseup\n   * @fires mouseover\n   * @fires mouseout\n   * @fires mousewheel\n   * @fires mousedblclick\n   *\n   * @fires dragover\n   * @fires dragenter\n   * @fires dragleave\n   * @fires drop\n   */\n  fabric.Object = fabric.util.createClass(\n    fabric.CommonMethods,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Type of an object (rect, circle, path, etc.).\n       * Note that this property is meant to be read-only and not meant to be modified.\n       * If you modify, certain parts of Fabric (such as JSON loading) won't work correctly.\n       * @type String\n       * @default\n       */\n      type: 'object',\n\n      /**\n       * Horizontal origin of transformation of an object (one of \"left\", \"right\", \"center\")\n       * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n       * @type String\n       * @default\n       */\n      originX: 'left',\n\n      /**\n       * Vertical origin of transformation of an object (one of \"top\", \"bottom\", \"center\")\n       * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n       * @type String\n       * @default\n       */\n      originY: 'top',\n\n      /**\n       * Top position of an object. Note that by default it's relative to object top. You can change this by setting originY={top/center/bottom}\n       * @type Number\n       * @default\n       */\n      top: 0,\n\n      /**\n       * Left position of an object. Note that by default it's relative to object left. You can change this by setting originX={left/center/right}\n       * @type Number\n       * @default\n       */\n      left: 0,\n\n      /**\n       * Object width\n       * @type Number\n       * @default\n       */\n      width: 0,\n\n      /**\n       * Object height\n       * @type Number\n       * @default\n       */\n      height: 0,\n\n      /**\n       * Object scale factor (horizontal)\n       * @type Number\n       * @default\n       */\n      scaleX: 1,\n\n      /**\n       * Object scale factor (vertical)\n       * @type Number\n       * @default\n       */\n      scaleY: 1,\n\n      /**\n       * When true, an object is rendered as flipped horizontally\n       * @type Boolean\n       * @default\n       */\n      flipX: false,\n\n      /**\n       * When true, an object is rendered as flipped vertically\n       * @type Boolean\n       * @default\n       */\n      flipY: false,\n\n      /**\n       * Opacity of an object\n       * @type Number\n       * @default\n       */\n      opacity: 1,\n\n      /**\n       * Angle of rotation of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      angle: 0,\n\n      /**\n       * Angle of skew on x axes of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      skewX: 0,\n\n      /**\n       * Angle of skew on y axes of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      skewY: 0,\n\n      /**\n       * Size of object's controlling corners (in pixels)\n       * @type Number\n       * @default\n       */\n      cornerSize: 13,\n\n      /**\n       * When true, object's controlling corners are rendered as transparent inside (i.e. stroke instead of fill)\n       * @type Boolean\n       * @default\n       */\n      transparentCorners: true,\n\n      /**\n       * Default cursor value used when hovering over this object on canvas\n       * @type String\n       * @default\n       */\n      hoverCursor: null,\n\n      /**\n       * Default cursor value used when moving this object on canvas\n       * @type String\n       * @default\n       */\n      moveCursor: null,\n\n      /**\n       * Padding between object and its controlling borders (in pixels)\n       * @type Number\n       * @default\n       */\n      padding: 0,\n\n      /**\n       * Color of controlling borders of an object (when it's active)\n       * @type String\n       * @default\n       */\n      borderColor: 'rgba(102,153,255,0.75)',\n\n      /**\n       * Array specifying dash pattern of an object's borders (hasBorder must be true)\n       * @since 1.6.2\n       * @type Array\n       */\n      borderDashArray: null,\n\n      /**\n       * Color of controlling corners of an object (when it's active)\n       * @type String\n       * @default\n       */\n      cornerColor: 'rgba(102,153,255,0.5)',\n\n      /**\n       * Color of controlling corners of an object (when it's active and transparentCorners false)\n       * @since 1.6.2\n       * @type String\n       * @default\n       */\n      cornerStrokeColor: null,\n\n      /**\n       * Specify style of control, 'rect' or 'circle'\n       * @since 1.6.2\n       * @type String\n       */\n      cornerStyle: 'rect',\n\n      /**\n       * Array specifying dash pattern of an object's control (hasBorder must be true)\n       * @since 1.6.2\n       * @type Array\n       */\n      cornerDashArray: null,\n\n      /**\n       * When true, this object will use center point as the origin of transformation\n       * when being scaled via the controls.\n       * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n       * @since 1.3.4\n       * @type Boolean\n       * @default\n       */\n      centeredScaling: false,\n\n      /**\n       * When true, this object will use center point as the origin of transformation\n       * when being rotated via the controls.\n       * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n       * @since 1.3.4\n       * @type Boolean\n       * @default\n       */\n      centeredRotation: true,\n\n      /**\n       * Color of object's fill\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      fill: 'rgb(0,0,0)',\n\n      /**\n       * Fill rule used to fill an object\n       * accepted values are nonzero, evenodd\n       * <b>Backwards incompatibility note:</b> This property was used for setting globalCompositeOperation until v1.4.12 (use `fabric.Object#globalCompositeOperation` instead)\n       * @type String\n       * @default\n       */\n      fillRule: 'nonzero',\n\n      /**\n       * Composite rule used for canvas globalCompositeOperation\n       * @type String\n       * @default\n       */\n      globalCompositeOperation: 'source-over',\n\n      /**\n       * Background color of an object.\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      backgroundColor: '',\n\n      /**\n       * Selection Background color of an object. colored layer behind the object when it is active.\n       * does not mix good with globalCompositeOperation methods.\n       * @type String\n       * @default\n       */\n      selectionBackgroundColor: '',\n\n      /**\n       * When defined, an object is rendered via stroke and this property specifies its color\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      stroke: null,\n\n      /**\n       * Width of a stroke used to render this object\n       * @type Number\n       * @default\n       */\n      strokeWidth: 1,\n\n      /**\n       * Array specifying dash pattern of an object's stroke (stroke must be defined)\n       * @type Array\n       */\n      strokeDashArray: null,\n\n      /**\n       * Line offset of an object's stroke\n       * @type Number\n       * @default\n       */\n      strokeDashOffset: 0,\n\n      /**\n       * Line endings style of an object's stroke (one of \"butt\", \"round\", \"square\")\n       * @type String\n       * @default\n       */\n      strokeLineCap: 'butt',\n\n      /**\n       * Corner style of an object's stroke (one of \"bevil\", \"round\", \"miter\")\n       * @type String\n       * @default\n       */\n      strokeLineJoin: 'miter',\n\n      /**\n       * Maximum miter length (used for strokeLineJoin = \"miter\") of an object's stroke\n       * @type Number\n       * @default\n       */\n      strokeMiterLimit: 4,\n\n      /**\n       * Shadow object representing shadow of this shape\n       * @type fabric.Shadow\n       * @default\n       */\n      shadow: null,\n\n      /**\n       * Opacity of object's controlling borders when object is active and moving\n       * @type Number\n       * @default\n       */\n      borderOpacityWhenMoving: 0.4,\n\n      /**\n       * Scale factor of object's controlling borders\n       * bigger number will make a thicker border\n       * border is 1, so this is basically a border tickness\n       * since there is no way to change the border itself.\n       * @type Number\n       * @default\n       */\n      borderScaleFactor: 1,\n\n      /**\n       * Transform matrix (similar to SVG's transform matrix)\n       * This property has been depreacted. Since caching and and qrDecompose this\n       * property can be handled with the standard top,left,scaleX,scaleY,angle and skewX.\n       * A documentation example on how to parse and merge a transformMatrix will be provided before\n       * completely removing it in fabric 4.0\n       * If you are starting a project now, DO NOT use it.\n       * @deprecated since 3.2.0\n       * @type Array\n       */\n      transformMatrix: null,\n\n      /**\n       * Minimum allowed scale value of an object\n       * @type Number\n       * @default\n       */\n      minScaleLimit: 0,\n\n      /**\n       * When set to `false`, an object can not be selected for modification (using either point-click-based or group-based selection).\n       * But events still fire on it.\n       * @type Boolean\n       * @default\n       */\n      selectable: true,\n\n      /**\n       * When set to `false`, an object can not be a target of events. All events propagate through it. Introduced in v1.3.4\n       * @type Boolean\n       * @default\n       */\n      evented: true,\n\n      /**\n       * When set to `false`, an object is not rendered on canvas\n       * @type Boolean\n       * @default\n       */\n      visible: true,\n\n      /**\n       * When set to `false`, object's controls are not displayed and can not be used to manipulate object\n       * @type Boolean\n       * @default\n       */\n      hasControls: true,\n\n      /**\n       * When set to `false`, object's controlling borders are not rendered\n       * @type Boolean\n       * @default\n       */\n      hasBorders: true,\n\n      /**\n       * When set to `false`, object's controlling rotating point will not be visible or selectable\n       * @type Boolean\n       * @default\n       */\n      hasRotatingPoint: true,\n\n      /**\n       * Offset for object's controlling rotating point (when enabled via `hasRotatingPoint`)\n       * @type Number\n       * @default\n       */\n      rotatingPointOffset: 40,\n\n      /**\n       * When set to `true`, objects are \"found\" on canvas on per-pixel basis rather than according to bounding box\n       * @type Boolean\n       * @default\n       */\n      perPixelTargetFind: false,\n\n      /**\n       * When `false`, default object's values are not included in its serialization\n       * @type Boolean\n       * @default\n       */\n      includeDefaultValues: true,\n\n      /**\n       * Function that determines clipping of an object (context is passed as a first argument).\n       * If you are using code minification, ctx argument can be minified/manglied you should use\n       * as a workaround `var ctx = arguments[0];` in the function;\n       * Note that context origin is at the object's center point (not left/top corner)\n       * @deprecated since 2.0.0\n       * @type Function\n       */\n      clipTo: null,\n\n      /**\n       * When `true`, object horizontal movement is locked\n       * @type Boolean\n       * @default\n       */\n      lockMovementX: false,\n\n      /**\n       * When `true`, object vertical movement is locked\n       * @type Boolean\n       * @default\n       */\n      lockMovementY: false,\n\n      /**\n       * When `true`, object rotation is locked\n       * @type Boolean\n       * @default\n       */\n      lockRotation: false,\n\n      /**\n       * When `true`, object horizontal scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockScalingX: false,\n\n      /**\n       * When `true`, object vertical scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockScalingY: false,\n\n      /**\n       * When `true`, object non-uniform scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockUniScaling: false,\n\n      /**\n       * When `true`, object horizontal skewing is locked\n       * @type Boolean\n       * @default\n       */\n      lockSkewingX: false,\n\n      /**\n       * When `true`, object vertical skewing is locked\n       * @type Boolean\n       * @default\n       */\n      lockSkewingY: false,\n\n      /**\n       * When `true`, object cannot be flipped by scaling into negative values\n       * @type Boolean\n       * @default\n       */\n      lockScalingFlip: false,\n\n      /**\n       * When `true`, object is not exported in OBJECT/JSON\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      excludeFromExport: false,\n\n      /**\n       * When `true`, object is cached on an additional canvas.\n       * When `false`, object is not cached unless necessary ( clipPath )\n       * default to true\n       * @since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      objectCaching: objectCaching,\n\n      /**\n       * When `true`, object properties are checked for cache invalidation. In some particular\n       * situation you may want this to be disabled ( spray brush, very big, groups)\n       * or if your application does not allow you to modify properties for groups child you want\n       * to disable it for groups.\n       * default to false\n       * since 1.7.0\n       * @type Boolean\n       * @default false\n       */\n      statefullCache: false,\n\n      /**\n       * When `true`, cache does not get updated during scaling. The picture will get blocky if scaled\n       * too much and will be redrawn with correct details at the end of scaling.\n       * this setting is performance and application dependant.\n       * default to true\n       * since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      noScaleCache: true,\n\n      /**\n       * When `false`, the stoke width will scale with the object.\n       * When `true`, the stroke will always match the exact pixel size entered for stroke width.\n       * default to false\n       * @since 2.6.0\n       * @type Boolean\n       * @default false\n       * @type Boolean\n       * @default false\n       */\n      strokeUniform: false,\n\n      /**\n       * When set to `true`, object's cache will be rerendered next render call.\n       * since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      dirty: true,\n\n      /**\n       * keeps the value of the last hovered corner during mouse move.\n       * 0 is no corner, or 'mt', 'ml', 'mtr' etc..\n       * It should be private, but there is no harm in using it as\n       * a read-only property.\n       * @type number|string|any\n       * @default 0\n       */\n      __corner: 0,\n\n      /**\n       * Determines if the fill or the stroke is drawn first (one of \"fill\" or \"stroke\")\n       * @type String\n       * @default\n       */\n      paintFirst: 'fill',\n\n      /**\n       * List of properties to consider when checking if state\n       * of an object is changed (fabric.Object#hasStateChanged)\n       * as well as for history (undo/redo) purposes\n       * @type Array\n       */\n      stateProperties: (\n        'top left width height scaleX scaleY flipX flipY originX originY transformMatrix ' +\n        'stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit ' +\n        'angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor ' +\n        'skewX skewY fillRule paintFirst clipPath strokeUniform'\n      ).split(' '),\n\n      /**\n       * List of properties to consider when checking if cache needs refresh\n       * Those properties are checked by statefullCache ON ( or lazy mode if we want ) or from single\n       * calls to Object.set(key, value). If the key is in this list, the object is marked as dirty\n       * and refreshed at the next render\n       * @type Array\n       */\n      cacheProperties: (\n        'fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform' +\n        ' strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath'\n      ).split(' '),\n\n      /**\n       * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n       * the clipPath object gets used when the object has rendered, and the context is placed in the center\n       * of the object cacheCanvas.\n       * If you want 0,0 of a clipPath to align with an object center, use clipPath.originX/Y to 'center'\n       * @type fabric.Object\n       */\n      clipPath: undefined,\n\n      /**\n       * Meaningful ONLY when the object is used as clipPath.\n       * if true, the clipPath will make the object clip to the outside of the clipPath\n       * since 2.4.0\n       * @type boolean\n       * @default false\n       */\n      inverted: false,\n\n      /**\n       * Meaningful ONLY when the object is used as clipPath.\n       * if true, the clipPath will have its top and left relative to canvas, and will\n       * not be influenced by the object transform. This will make the clipPath relative\n       * to the canvas, but clipping just a particular object.\n       * WARNING this is beta, this feature may change or be renamed.\n       * since 2.4.0\n       * @type boolean\n       * @default false\n       */\n      absolutePositioned: false,\n\n      /**\n       * Constructor\n       * @param {Object} [options] Options object\n       */\n      initialize: function (options) {\n        if (options) {\n          this.setOptions(options);\n        }\n      },\n\n      /**\n       * Create a the canvas used to keep the cached copy of the object\n       * @private\n       */\n      _createCacheCanvas: function () {\n        this._cacheProperties = {};\n        this._cacheCanvas = fabric.util.createCanvasElement();\n        this._cacheContext = this._cacheCanvas.getContext('2d');\n        this._updateCacheCanvas();\n        // if canvas gets created, is empty, so dirty.\n        this.dirty = true;\n      },\n\n      /**\n       * Limit the cache dimensions so that X * Y do not cross fabric.perfLimitSizeTotal\n       * and each side do not cross fabric.cacheSideLimit\n       * those numbers are configurable so that you can get as much detail as you want\n       * making bargain with performances.\n       * @param {Object} dims\n       * @param {Object} dims.width width of canvas\n       * @param {Object} dims.height height of canvas\n       * @param {Object} dims.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @param {Object} dims.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       * @return {Object}.width width of canvas\n       * @return {Object}.height height of canvas\n       * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       */\n      _limitCacheSize: function (dims) {\n        var perfLimitSizeTotal = fabric.perfLimitSizeTotal,\n          width = dims.width,\n          height = dims.height,\n          max = fabric.maxCacheSideLimit,\n          min = fabric.minCacheSideLimit;\n        if (\n          width <= max &&\n          height <= max &&\n          width * height <= perfLimitSizeTotal\n        ) {\n          if (width < min) {\n            dims.width = min;\n          }\n          if (height < min) {\n            dims.height = min;\n          }\n          return dims;\n        }\n        var ar = width / height,\n          limitedDims = fabric.util.limitDimsByArea(ar, perfLimitSizeTotal),\n          capValue = fabric.util.capValue,\n          x = capValue(min, limitedDims.x, max),\n          y = capValue(min, limitedDims.y, max);\n        if (width > x) {\n          dims.zoomX /= width / x;\n          dims.width = x;\n          dims.capped = true;\n        }\n        if (height > y) {\n          dims.zoomY /= height / y;\n          dims.height = y;\n          dims.capped = true;\n        }\n        return dims;\n      },\n\n      /**\n       * Return the dimension and the zoom level needed to create a cache canvas\n       * big enough to host the object to be cached.\n       * @private\n       * @return {Object}.x width of object to be cached\n       * @return {Object}.y height of object to be cached\n       * @return {Object}.width width of canvas\n       * @return {Object}.height height of canvas\n       * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       */\n      _getCacheCanvasDimensions: function () {\n        var objectScale = this.getTotalObjectScaling(),\n          // caculate dimensions without skewing\n          dim = this._getTransformedDimensions(0, 0),\n          neededX = (dim.x * objectScale.scaleX) / this.scaleX,\n          neededY = (dim.y * objectScale.scaleY) / this.scaleY;\n        return {\n          // for sure this ALIASING_LIMIT is slightly creating problem\n          // in situation in which the cache canvas gets an upper limit\n          // also objectScale contains already scaleX and scaleY\n          width: neededX + ALIASING_LIMIT,\n          height: neededY + ALIASING_LIMIT,\n          zoomX: objectScale.scaleX,\n          zoomY: objectScale.scaleY,\n          x: neededX,\n          y: neededY,\n        };\n      },\n\n      /**\n       * Update width and height of the canvas for cache\n       * returns true or false if canvas needed resize.\n       * @private\n       * @return {Boolean} true if the canvas has been resized\n       */\n      _updateCacheCanvas: function () {\n        var targetCanvas = this.canvas;\n        if (\n          this.noScaleCache &&\n          targetCanvas &&\n          targetCanvas._currentTransform\n        ) {\n          var target = targetCanvas._currentTransform.target,\n            action = targetCanvas._currentTransform.action;\n          if (\n            this === target &&\n            action.slice &&\n            action.slice(0, 5) === 'scale'\n          ) {\n            return false;\n          }\n        }\n        var canvas = this._cacheCanvas,\n          dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          minCacheSize = fabric.minCacheSideLimit,\n          width = dims.width,\n          height = dims.height,\n          drawingWidth,\n          drawingHeight,\n          zoomX = dims.zoomX,\n          zoomY = dims.zoomY,\n          dimensionsChanged =\n            width !== this.cacheWidth || height !== this.cacheHeight,\n          zoomChanged = this.zoomX !== zoomX || this.zoomY !== zoomY,\n          shouldRedraw = dimensionsChanged || zoomChanged,\n          additionalWidth = 0,\n          additionalHeight = 0,\n          shouldResizeCanvas = false;\n        if (dimensionsChanged) {\n          var canvasWidth = this._cacheCanvas.width,\n            canvasHeight = this._cacheCanvas.height,\n            sizeGrowing = width > canvasWidth || height > canvasHeight,\n            sizeShrinking =\n              (width < canvasWidth * 0.9 || height < canvasHeight * 0.9) &&\n              canvasWidth > minCacheSize &&\n              canvasHeight > minCacheSize;\n          shouldResizeCanvas = sizeGrowing || sizeShrinking;\n          if (\n            sizeGrowing &&\n            !dims.capped &&\n            (width > minCacheSize || height > minCacheSize)\n          ) {\n            additionalWidth = width * 0.1;\n            additionalHeight = height * 0.1;\n          }\n        }\n        if (shouldRedraw) {\n          if (shouldResizeCanvas) {\n            canvas.width = Math.ceil(width + additionalWidth);\n            canvas.height = Math.ceil(height + additionalHeight);\n          } else {\n            this._cacheContext.setTransform(1, 0, 0, 1, 0, 0);\n            this._cacheContext.clearRect(0, 0, canvas.width, canvas.height);\n          }\n          drawingWidth = dims.x / 2;\n          drawingHeight = dims.y / 2;\n          this.cacheTranslationX =\n            Math.round(canvas.width / 2 - drawingWidth) + drawingWidth;\n          this.cacheTranslationY =\n            Math.round(canvas.height / 2 - drawingHeight) + drawingHeight;\n          this.cacheWidth = width;\n          this.cacheHeight = height;\n          this._cacheContext.translate(\n            this.cacheTranslationX,\n            this.cacheTranslationY\n          );\n          this._cacheContext.scale(zoomX, zoomY);\n          this.zoomX = zoomX;\n          this.zoomY = zoomY;\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Sets object's properties from options\n       * @param {Object} [options] Options object\n       */\n      setOptions: function (options) {\n        this._setOptions(options);\n        this._initGradient(options.fill, 'fill');\n        this._initGradient(options.stroke, 'stroke');\n        this._initClipping(options);\n        this._initPattern(options.fill, 'fill');\n        this._initPattern(options.stroke, 'stroke');\n      },\n\n      /**\n       * Transforms context when rendering an object\n       * @param {CanvasRenderingContext2D} ctx Context\n       */\n      transform: function (ctx) {\n        var m;\n        if (this.group && !this.group._transformDone) {\n          m = this.calcTransformMatrix();\n        } else {\n          m = this.calcOwnMatrix();\n        }\n        ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n      },\n\n      /**\n       * Returns an object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n          object = {\n            type: this.type,\n            version: fabric.version,\n            originX: this.originX,\n            originY: this.originY,\n            left: toFixed(this.left, NUM_FRACTION_DIGITS),\n            top: toFixed(this.top, NUM_FRACTION_DIGITS),\n            width: toFixed(this.width, NUM_FRACTION_DIGITS),\n            height: toFixed(this.height, NUM_FRACTION_DIGITS),\n            fill:\n              this.fill && this.fill.toObject\n                ? this.fill.toObject()\n                : this.fill,\n            stroke:\n              this.stroke && this.stroke.toObject\n                ? this.stroke.toObject()\n                : this.stroke,\n            strokeWidth: toFixed(this.strokeWidth, NUM_FRACTION_DIGITS),\n            strokeDashArray: this.strokeDashArray\n              ? this.strokeDashArray.concat()\n              : this.strokeDashArray,\n            strokeLineCap: this.strokeLineCap,\n            strokeDashOffset: this.strokeDashOffset,\n            strokeLineJoin: this.strokeLineJoin,\n            // TODO: add this before release\n            // strokeUniform:            this.strokeUniform,\n            strokeMiterLimit: toFixed(\n              this.strokeMiterLimit,\n              NUM_FRACTION_DIGITS\n            ),\n            scaleX: toFixed(this.scaleX, NUM_FRACTION_DIGITS),\n            scaleY: toFixed(this.scaleY, NUM_FRACTION_DIGITS),\n            angle: toFixed(this.angle, NUM_FRACTION_DIGITS),\n            flipX: this.flipX,\n            flipY: this.flipY,\n            opacity: toFixed(this.opacity, NUM_FRACTION_DIGITS),\n            shadow:\n              this.shadow && this.shadow.toObject\n                ? this.shadow.toObject()\n                : this.shadow,\n            visible: this.visible,\n            clipTo: this.clipTo && String(this.clipTo),\n            backgroundColor: this.backgroundColor,\n            fillRule: this.fillRule,\n            paintFirst: this.paintFirst,\n            globalCompositeOperation: this.globalCompositeOperation,\n            transformMatrix: this.transformMatrix\n              ? this.transformMatrix.concat()\n              : null,\n            skewX: toFixed(this.skewX, NUM_FRACTION_DIGITS),\n            skewY: toFixed(this.skewY, NUM_FRACTION_DIGITS),\n          };\n\n        if (this.clipPath) {\n          object.clipPath = this.clipPath.toObject(propertiesToInclude);\n          object.clipPath.inverted = this.clipPath.inverted;\n          object.clipPath.absolutePositioned = this.clipPath.absolutePositioned;\n        }\n\n        fabric.util.populateWithProperties(this, object, propertiesToInclude);\n        if (!this.includeDefaultValues) {\n          object = this._removeDefaultValues(object);\n        }\n\n        return object;\n      },\n\n      /**\n       * Returns (dataless) object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        // will be overwritten by subclasses\n        return this.toObject(propertiesToInclude);\n      },\n\n      /**\n       * @private\n       * @param {Object} object\n       */\n      _removeDefaultValues: function (object) {\n        var prototype = fabric.util.getKlass(object.type).prototype,\n          stateProperties = prototype.stateProperties;\n        stateProperties.forEach(function (prop) {\n          if (prop === 'left' || prop === 'top') {\n            return;\n          }\n          if (object[prop] === prototype[prop]) {\n            delete object[prop];\n          }\n          var isArray =\n            Object.prototype.toString.call(object[prop]) === '[object Array]' &&\n            Object.prototype.toString.call(prototype[prop]) ===\n              '[object Array]';\n\n          // basically a check for [] === []\n          if (\n            isArray &&\n            object[prop].length === 0 &&\n            prototype[prop].length === 0\n          ) {\n            delete object[prop];\n          }\n        });\n\n        return object;\n      },\n\n      /**\n       * Returns a string representation of an instance\n       * @return {String}\n       */\n      toString: function () {\n        return '#<fabric.' + capitalize(this.type) + '>';\n      },\n\n      /**\n       * Return the object scale factor counting also the group scaling\n       * @return {Object} object with scaleX and scaleY properties\n       */\n      getObjectScaling: function () {\n        var options = fabric.util.qrDecompose(this.calcTransformMatrix());\n        return {\n          scaleX: Math.abs(options.scaleX),\n          scaleY: Math.abs(options.scaleY),\n        };\n      },\n\n      /**\n       * Return the object scale factor counting also the group scaling, zoom and retina\n       * @return {Object} object with scaleX and scaleY properties\n       */\n      getTotalObjectScaling: function () {\n        var scale = this.getObjectScaling(),\n          scaleX = scale.scaleX,\n          scaleY = scale.scaleY;\n        if (this.canvas) {\n          var zoom = this.canvas.getZoom();\n          var retina = this.canvas.getRetinaScaling();\n          scaleX *= zoom * retina;\n          scaleY *= zoom * retina;\n        }\n        return { scaleX: scaleX, scaleY: scaleY };\n      },\n\n      /**\n       * Return the object opacity counting also the group property\n       * @return {Number}\n       */\n      getObjectOpacity: function () {\n        var opacity = this.opacity;\n        if (this.group) {\n          opacity *= this.group.getObjectOpacity();\n        }\n        return opacity;\n      },\n\n      /**\n       * @private\n       * @param {String} key\n       * @param {*} value\n       * @return {fabric.Object} thisArg\n       */\n      _set: function (key, value) {\n        var shouldConstrainValue = key === 'scaleX' || key === 'scaleY',\n          isChanged = this[key] !== value,\n          groupNeedsUpdate = false;\n\n        if (shouldConstrainValue) {\n          value = this._constrainScale(value);\n        }\n        if (key === 'scaleX' && value < 0) {\n          this.flipX = !this.flipX;\n          value *= -1;\n        } else if (key === 'scaleY' && value < 0) {\n          this.flipY = !this.flipY;\n          value *= -1;\n        } else if (\n          key === 'shadow' &&\n          value &&\n          !(value instanceof fabric.Shadow)\n        ) {\n          value = new fabric.Shadow(value);\n        } else if (key === 'dirty' && this.group) {\n          this.group.set('dirty', value);\n        }\n\n        this[key] = value;\n\n        if (isChanged) {\n          groupNeedsUpdate = this.group && this.group.isOnACache();\n          if (this.cacheProperties.indexOf(key) > -1) {\n            this.dirty = true;\n            groupNeedsUpdate && this.group.set('dirty', true);\n          } else if (\n            groupNeedsUpdate &&\n            this.stateProperties.indexOf(key) > -1\n          ) {\n            this.group.set('dirty', true);\n          }\n        }\n\n        return this;\n      },\n\n      /**\n       * This callback function is called by the parent group of an object every\n       * time a non-delegated property changes on the group. It is passed the key\n       * and value as parameters. Not adding in this function's signature to avoid\n       * Travis build error about unused variables.\n       */\n      setOnGroup: function () {\n        // implemented by sub-classes, as needed.\n      },\n\n      /**\n       * Retrieves viewportTransform from Object's canvas if possible\n       * @method getViewportTransform\n       * @memberOf fabric.Object.prototype\n       * @return {Array}\n       */\n      getViewportTransform: function () {\n        if (this.canvas && this.canvas.viewportTransform) {\n          return this.canvas.viewportTransform;\n        }\n        return fabric.iMatrix.concat();\n      },\n\n      /*\n       * @private\n       * return if the object would be visible in rendering\n       * @memberOf fabric.Object.prototype\n       * @return {Boolean}\n       */\n      isNotVisible: function () {\n        return (\n          this.opacity === 0 ||\n          (this.width === 0 && this.height === 0 && this.strokeWidth === 0) ||\n          !this.visible\n        );\n      },\n\n      /**\n       * Renders an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      render: function (ctx) {\n        // do not render if width/height are zeros or object is not visible\n        if (this.isNotVisible()) {\n          return;\n        }\n        if (\n          this.canvas &&\n          this.canvas.skipOffscreen &&\n          !this.group &&\n          !this.isOnScreen()\n        ) {\n          return;\n        }\n        ctx.save();\n        this._setupCompositeOperation(ctx);\n        this.drawSelectionBackground(ctx);\n        this.transform(ctx);\n        this._setOpacity(ctx);\n        this._setShadow(ctx, this);\n        if (this.transformMatrix) {\n          ctx.transform.apply(ctx, this.transformMatrix);\n        }\n        this.clipTo && fabric.util.clipContext(this, ctx);\n        if (this.shouldCache()) {\n          this.renderCache();\n          this.drawCacheOnCanvas(ctx);\n        } else {\n          this._removeCacheCanvas();\n          this.dirty = false;\n          this.drawObject(ctx);\n          if (this.objectCaching && this.statefullCache) {\n            this.saveState({ propertySet: 'cacheProperties' });\n          }\n        }\n        this.clipTo && ctx.restore();\n        ctx.restore();\n      },\n\n      renderCache: function (options) {\n        options = options || {};\n        if (!this._cacheCanvas) {\n          this._createCacheCanvas();\n        }\n        if (this.isCacheDirty()) {\n          this.statefullCache &&\n            this.saveState({ propertySet: 'cacheProperties' });\n          this.drawObject(this._cacheContext, options.forClipping);\n          this.dirty = false;\n        }\n      },\n\n      /**\n       * Remove cacheCanvas and its dimensions from the objects\n       */\n      _removeCacheCanvas: function () {\n        this._cacheCanvas = null;\n        this.cacheWidth = 0;\n        this.cacheHeight = 0;\n      },\n\n      /**\n       * return true if the object will draw a stroke\n       * Does not consider text styles. This is just a shortcut used at rendering time\n       * We want it to be an aproximation and be fast.\n       * wrote to avoid extra caching, it has to return true when stroke happens,\n       * can guess when it will not happen at 100% chance, does not matter if it misses\n       * some use case where the stroke is invisible.\n       * @since 3.0.0\n       * @returns Boolean\n       */\n      hasStroke: function () {\n        return (\n          this.stroke && this.stroke !== 'transparent' && this.strokeWidth !== 0\n        );\n      },\n\n      /**\n       * return true if the object will draw a fill\n       * Does not consider text styles. This is just a shortcut used at rendering time\n       * We want it to be an aproximation and be fast.\n       * wrote to avoid extra caching, it has to return true when fill happens,\n       * can guess when it will not happen at 100% chance, does not matter if it misses\n       * some use case where the fill is invisible.\n       * @since 3.0.0\n       * @returns Boolean\n       */\n      hasFill: function () {\n        return this.fill && this.fill !== 'transparent';\n      },\n\n      /**\n       * When set to `true`, force the object to have its own cache, even if it is inside a group\n       * it may be needed when your object behave in a particular way on the cache and always needs\n       * its own isolated canvas to render correctly.\n       * Created to be overridden\n       * since 1.7.12\n       * @returns Boolean\n       */\n      needsItsOwnCache: function () {\n        if (\n          this.paintFirst === 'stroke' &&\n          this.hasFill() &&\n          this.hasStroke() &&\n          typeof this.shadow === 'object'\n        ) {\n          return true;\n        }\n        if (this.clipPath) {\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * objectCaching is a global flag, wins over everything\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group outside is cached.\n       * Read as: cache if is needed, or if the feature is enabled but we are not already caching.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        this.ownCaching =\n          this.needsItsOwnCache() ||\n          (this.objectCaching && (!this.group || !this.group.isOnACache()));\n        return this.ownCaching;\n      },\n\n      /**\n       * Check if this object or a child object will cast a shadow\n       * used by Group.shouldCache to know if child has a shadow recursively\n       * @return {Boolean}\n       */\n      willDrawShadow: function () {\n        return (\n          !!this.shadow &&\n          (this.shadow.offsetX !== 0 || this.shadow.offsetY !== 0)\n        );\n      },\n\n      /**\n       * Execute the drawing operation for an object clipPath\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawClipPathOnCache: function (ctx) {\n        var path = this.clipPath;\n        ctx.save();\n        // DEBUG: uncomment this line, comment the following\n        // ctx.globalAlpha = 0.4\n        if (path.inverted) {\n          ctx.globalCompositeOperation = 'destination-out';\n        } else {\n          ctx.globalCompositeOperation = 'destination-in';\n        }\n        //ctx.scale(1 / 2, 1 / 2);\n        if (path.absolutePositioned) {\n          var m = fabric.util.invertTransform(this.calcTransformMatrix());\n          ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n        path.transform(ctx);\n        ctx.scale(1 / path.zoomX, 1 / path.zoomY);\n        ctx.drawImage(\n          path._cacheCanvas,\n          -path.cacheTranslationX,\n          -path.cacheTranslationY\n        );\n        ctx.restore();\n      },\n\n      /**\n       * Execute the drawing operation for an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawObject: function (ctx, forClipping) {\n        var originalFill = this.fill,\n          originalStroke = this.stroke;\n        if (forClipping) {\n          this.fill = 'black';\n          this.stroke = '';\n          this._setClippingProperties(ctx);\n        } else {\n          this._renderBackground(ctx);\n          this._setStrokeStyles(ctx, this);\n          this._setFillStyles(ctx, this);\n        }\n        this._render(ctx);\n        this._drawClipPath(ctx);\n        this.fill = originalFill;\n        this.stroke = originalStroke;\n      },\n\n      _drawClipPath: function (ctx) {\n        var path = this.clipPath;\n        if (!path) {\n          return;\n        }\n        // needed to setup a couple of variables\n        // path canvas gets overridden with this one.\n        // TODO find a better solution?\n        path.canvas = this.canvas;\n        path.shouldCache();\n        path._transformDone = true;\n        path.renderCache({ forClipping: true });\n        this.drawClipPathOnCache(ctx);\n      },\n\n      /**\n       * Paint the cached copy of the object on the target context.\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawCacheOnCanvas: function (ctx) {\n        ctx.scale(1 / this.zoomX, 1 / this.zoomY);\n        ctx.drawImage(\n          this._cacheCanvas,\n          -this.cacheTranslationX,\n          -this.cacheTranslationY\n        );\n      },\n\n      /**\n       * Check if cache is dirty\n       * @param {Boolean} skipCanvas skip canvas checks because this object is painted\n       * on parent canvas.\n       */\n      isCacheDirty: function (skipCanvas) {\n        if (this.isNotVisible()) {\n          return false;\n        }\n        if (this._cacheCanvas && !skipCanvas && this._updateCacheCanvas()) {\n          // in this case the context is already cleared.\n          return true;\n        } else {\n          if (\n            this.dirty ||\n            (this.clipPath && this.clipPath.absolutePositioned) ||\n            (this.statefullCache && this.hasStateChanged('cacheProperties'))\n          ) {\n            if (this._cacheCanvas && !skipCanvas) {\n              var width = this.cacheWidth / this.zoomX;\n              var height = this.cacheHeight / this.zoomY;\n              this._cacheContext.clearRect(\n                -width / 2,\n                -height / 2,\n                width,\n                height\n              );\n            }\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Draws a background for the object big as its untransformed dimensions\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderBackground: function (ctx) {\n        if (!this.backgroundColor) {\n          return;\n        }\n        var dim = this._getNonTransformedDimensions();\n        ctx.fillStyle = this.backgroundColor;\n\n        ctx.fillRect(-dim.x / 2, -dim.y / 2, dim.x, dim.y);\n        // if there is background color no other shadows\n        // should be casted\n        this._removeShadow(ctx);\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _setOpacity: function (ctx) {\n        if (this.group && !this.group._transformDone) {\n          ctx.globalAlpha = this.getObjectOpacity();\n        } else {\n          ctx.globalAlpha *= this.opacity;\n        }\n      },\n\n      _setStrokeStyles: function (ctx, decl) {\n        if (decl.stroke) {\n          ctx.lineWidth = decl.strokeWidth;\n          ctx.lineCap = decl.strokeLineCap;\n          ctx.lineDashOffset = decl.strokeDashOffset;\n          ctx.lineJoin = decl.strokeLineJoin;\n          ctx.miterLimit = decl.strokeMiterLimit;\n          ctx.strokeStyle = decl.stroke.toLive\n            ? decl.stroke.toLive(ctx, this)\n            : decl.stroke;\n        }\n      },\n\n      _setFillStyles: function (ctx, decl) {\n        if (decl.fill) {\n          ctx.fillStyle = decl.fill.toLive\n            ? decl.fill.toLive(ctx, this)\n            : decl.fill;\n        }\n      },\n\n      _setClippingProperties: function (ctx) {\n        ctx.globalAlpha = 1;\n        ctx.strokeStyle = 'transparent';\n        ctx.fillStyle = '#000000';\n      },\n\n      /**\n       * @private\n       * Sets line dash\n       * @param {CanvasRenderingContext2D} ctx Context to set the dash line on\n       * @param {Array} dashArray array representing dashes\n       * @param {Function} alternative function to call if browser does not support lineDash\n       */\n      _setLineDash: function (ctx, dashArray, alternative) {\n        if (!dashArray || dashArray.length === 0) {\n          return;\n        }\n        // Spec requires the concatenation of two copies the dash list when the number of elements is odd\n        if (1 & dashArray.length) {\n          dashArray.push.apply(dashArray, dashArray);\n        }\n        if (supportsLineDash) {\n          ctx.setLineDash(dashArray);\n        } else {\n          alternative && alternative(ctx);\n        }\n      },\n\n      /**\n       * Renders controls and borders for the object\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Object} [styleOverride] properties to override the object style\n       */\n      _renderControls: function (ctx, styleOverride) {\n        var vpt = this.getViewportTransform(),\n          matrix = this.calcTransformMatrix(),\n          options,\n          drawBorders,\n          drawControls;\n        styleOverride = styleOverride || {};\n        drawBorders =\n          typeof styleOverride.hasBorders !== 'undefined'\n            ? styleOverride.hasBorders\n            : this.hasBorders;\n        drawControls =\n          typeof styleOverride.hasControls !== 'undefined'\n            ? styleOverride.hasControls\n            : this.hasControls;\n        matrix = fabric.util.multiplyTransformMatrices(vpt, matrix);\n        options = fabric.util.qrDecompose(matrix);\n        ctx.save();\n        ctx.translate(options.translateX, options.translateY);\n        ctx.lineWidth = 1 * this.borderScaleFactor;\n        if (!this.group) {\n          ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\n        }\n        if (styleOverride.forActiveSelection) {\n          ctx.rotate(degreesToRadians(options.angle));\n          drawBorders && this.drawBordersInGroup(ctx, options, styleOverride);\n        } else {\n          ctx.rotate(degreesToRadians(this.angle));\n          drawBorders && this.drawBorders(ctx, styleOverride);\n        }\n        drawControls && this.drawControls(ctx, styleOverride);\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _setShadow: function (ctx) {\n        if (!this.shadow) {\n          return;\n        }\n\n        var shadow = this.shadow,\n          canvas = this.canvas,\n          scaling,\n          multX = (canvas && canvas.viewportTransform[0]) || 1,\n          multY = (canvas && canvas.viewportTransform[3]) || 1;\n        if (shadow.nonScaling) {\n          scaling = { scaleX: 1, scaleY: 1 };\n        } else {\n          scaling = this.getObjectScaling();\n        }\n        if (canvas && canvas._isRetinaScaling()) {\n          multX *= fabric.devicePixelRatio;\n          multY *= fabric.devicePixelRatio;\n        }\n        ctx.shadowColor = shadow.color;\n        ctx.shadowBlur =\n          (shadow.blur *\n            fabric.browserShadowBlurConstant *\n            (multX + multY) *\n            (scaling.scaleX + scaling.scaleY)) /\n          4;\n        ctx.shadowOffsetX = shadow.offsetX * multX * scaling.scaleX;\n        ctx.shadowOffsetY = shadow.offsetY * multY * scaling.scaleY;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _removeShadow: function (ctx) {\n        if (!this.shadow) {\n          return;\n        }\n\n        ctx.shadowColor = '';\n        ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Object} filler fabric.Pattern or fabric.Gradient\n       * @return {Object} offset.offsetX offset for text rendering\n       * @return {Object} offset.offsetY offset for text rendering\n       */\n      _applyPatternGradientTransform: function (ctx, filler) {\n        if (!filler || !filler.toLive) {\n          return { offsetX: 0, offsetY: 0 };\n        }\n        var t = filler.gradientTransform || filler.patternTransform;\n        var offsetX = -this.width / 2 + filler.offsetX || 0,\n          offsetY = -this.height / 2 + filler.offsetY || 0;\n\n        if (filler.gradientUnits === 'percentage') {\n          ctx.transform(this.width, 0, 0, this.height, offsetX, offsetY);\n        } else {\n          ctx.transform(1, 0, 0, 1, offsetX, offsetY);\n        }\n        if (t) {\n          ctx.transform(t[0], t[1], t[2], t[3], t[4], t[5]);\n        }\n        return { offsetX: offsetX, offsetY: offsetY };\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderPaintInOrder: function (ctx) {\n        if (this.paintFirst === 'stroke') {\n          this._renderStroke(ctx);\n          this._renderFill(ctx);\n        } else {\n          this._renderFill(ctx);\n          this._renderStroke(ctx);\n        }\n      },\n\n      /**\n       * @private\n       * function that actually render something on the context.\n       * empty here to allow Obects to work on tests to benchmark fabric functionalites\n       * not related to rendering\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _render: function (/* ctx */) {},\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderFill: function (ctx) {\n        if (!this.fill) {\n          return;\n        }\n\n        ctx.save();\n        this._applyPatternGradientTransform(ctx, this.fill);\n        if (this.fillRule === 'evenodd') {\n          ctx.fill('evenodd');\n        } else {\n          ctx.fill();\n        }\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderStroke: function (ctx) {\n        if (!this.stroke || this.strokeWidth === 0) {\n          return;\n        }\n\n        if (this.shadow && !this.shadow.affectStroke) {\n          this._removeShadow(ctx);\n        }\n\n        ctx.save();\n        if (this.strokeUniform && this.group) {\n          var scaling = this.getObjectScaling();\n          ctx.scale(1 / scaling.scaleX, 1 / scaling.scaleY);\n        } else if (this.strokeUniform) {\n          ctx.scale(1 / this.scaleX, 1 / this.scaleY);\n        }\n        this._setLineDash(ctx, this.strokeDashArray, this._renderDashedStroke);\n        if (this.stroke.toLive && this.stroke.gradientUnits === 'percentage') {\n          // need to transform gradient in a pattern.\n          // this is a slow process. If you are hitting this codepath, and the object\n          // is not using caching, you should consider switching it on.\n          // we need a canvas as big as the current object caching canvas.\n          this._applyPatternForTransformedGradient(ctx, this.stroke);\n        } else {\n          this._applyPatternGradientTransform(ctx, this.stroke);\n        }\n        ctx.stroke();\n        ctx.restore();\n      },\n\n      /**\n       * This function try to patch the missing gradientTransform on canvas gradients.\n       * transforming a context to transform the gradient, is going to transform the stroke too.\n       * we want to transform the gradient but not the stroke operation, so we create\n       * a transformed gradient on a pattern and then we use the pattern instead of the gradient.\n       * this method has drwabacks: is slow, is in low resolution, needs a patch for when the size\n       * is limited.\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {fabric.Gradient} filler a fabric gradient instance\n       */\n      _applyPatternForTransformedGradient: function (ctx, filler) {\n        var dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          pCanvas = fabric.util.createCanvasElement(),\n          pCtx,\n          retinaScaling = this.canvas.getRetinaScaling(),\n          width = dims.x / this.scaleX / retinaScaling,\n          height = dims.y / this.scaleY / retinaScaling;\n        pCanvas.width = width;\n        pCanvas.height = height;\n        pCtx = pCanvas.getContext('2d');\n        pCtx.beginPath();\n        pCtx.moveTo(0, 0);\n        pCtx.lineTo(width, 0);\n        pCtx.lineTo(width, height);\n        pCtx.lineTo(0, height);\n        pCtx.closePath();\n        pCtx.translate(width / 2, height / 2);\n        pCtx.scale(\n          dims.zoomX / this.scaleX / retinaScaling,\n          dims.zoomY / this.scaleY / retinaScaling\n        );\n        this._applyPatternGradientTransform(pCtx, filler);\n        pCtx.fillStyle = filler.toLive(ctx);\n        pCtx.fill();\n        ctx.translate(\n          -this.width / 2 - this.strokeWidth / 2,\n          -this.height / 2 - this.strokeWidth / 2\n        );\n        ctx.scale(\n          (retinaScaling * this.scaleX) / dims.zoomX,\n          (retinaScaling * this.scaleY) / dims.zoomY\n        );\n        ctx.strokeStyle = pCtx.createPattern(pCanvas, 'no-repeat');\n      },\n\n      /**\n       * This function is an helper for svg import. it returns the center of the object in the svg\n       * untransformed coordinates\n       * @private\n       * @return {Object} center point from element coordinates\n       */\n      _findCenterFromElement: function () {\n        return { x: this.left + this.width / 2, y: this.top + this.height / 2 };\n      },\n\n      /**\n       * This function is an helper for svg import. it decompose the transformMatrix\n       * and assign properties to object.\n       * untransformed coordinates\n       * @private\n       * @chainable\n       */\n      _assignTransformMatrixProps: function () {\n        if (this.transformMatrix) {\n          var options = fabric.util.qrDecompose(this.transformMatrix);\n          this.flipX = false;\n          this.flipY = false;\n          this.set('scaleX', options.scaleX);\n          this.set('scaleY', options.scaleY);\n          this.angle = options.angle;\n          this.skewX = options.skewX;\n          this.skewY = 0;\n        }\n      },\n\n      /**\n       * This function is an helper for svg import. it removes the transform matrix\n       * and set to object properties that fabricjs can handle\n       * @private\n       * @param {Object} preserveAspectRatioOptions\n       * @return {thisArg}\n       */\n      _removeTransformMatrix: function (preserveAspectRatioOptions) {\n        var center = this._findCenterFromElement();\n        if (this.transformMatrix) {\n          this._assignTransformMatrixProps();\n          center = fabric.util.transformPoint(center, this.transformMatrix);\n        }\n        this.transformMatrix = null;\n        if (preserveAspectRatioOptions) {\n          this.scaleX *= preserveAspectRatioOptions.scaleX;\n          this.scaleY *= preserveAspectRatioOptions.scaleY;\n          this.cropX = preserveAspectRatioOptions.cropX;\n          this.cropY = preserveAspectRatioOptions.cropY;\n          center.x += preserveAspectRatioOptions.offsetLeft;\n          center.y += preserveAspectRatioOptions.offsetTop;\n          this.width = preserveAspectRatioOptions.width;\n          this.height = preserveAspectRatioOptions.height;\n        }\n        this.setPositionByOrigin(center, 'center', 'center');\n      },\n\n      /**\n       * Clones an instance, using a callback method will work for every object.\n       * @param {Function} callback Callback is invoked with a clone as a first argument\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       */\n      clone: function (callback, propertiesToInclude) {\n        var objectForm = this.toObject(propertiesToInclude);\n        if (this.constructor.fromObject) {\n          this.constructor.fromObject(objectForm, callback);\n        } else {\n          fabric.Object._fromObject('Object', objectForm, callback);\n        }\n      },\n\n      /**\n       * Creates an instance of fabric.Image out of an object\n       * could make use of both toDataUrl or toCanvasElement.\n       * @param {Function} callback callback, invoked with an instance as a first argument\n       * @param {Object} [options] for clone as image, passed to toDataURL\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {fabric.Object} thisArg\n       */\n      cloneAsImage: function (callback, options) {\n        var canvasEl = this.toCanvasElement(options);\n        if (callback) {\n          callback(new fabric.Image(canvasEl));\n        }\n        return this;\n      },\n\n      /**\n       * Converts an object into a HTMLCanvas element\n       * @param {Object} options Options object\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {HTMLCanvasElement} Returns DOM element <canvas> with the fabric.Object\n       */\n      toCanvasElement: function (options) {\n        options || (options = {});\n\n        var utils = fabric.util,\n          origParams = utils.saveObjectTransform(this),\n          originalGroup = this.group,\n          originalShadow = this.shadow,\n          abs = Math.abs,\n          multiplier =\n            (options.multiplier || 1) *\n            (options.enableRetinaScaling ? fabric.devicePixelRatio : 1);\n        delete this.group;\n        if (options.withoutTransform) {\n          utils.resetObjectTransform(this);\n        }\n        if (options.withoutShadow) {\n          this.shadow = null;\n        }\n\n        var el = fabric.util.createCanvasElement(),\n          // skip canvas zoom and calculate with setCoords now.\n          boundingRect = this.getBoundingRect(true, true),\n          shadow = this.shadow,\n          scaling,\n          shadowOffset = { x: 0, y: 0 },\n          shadowBlur,\n          width,\n          height;\n\n        if (shadow) {\n          shadowBlur = shadow.blur;\n          if (shadow.nonScaling) {\n            scaling = { scaleX: 1, scaleY: 1 };\n          } else {\n            scaling = this.getObjectScaling();\n          }\n          // consider non scaling shadow.\n          shadowOffset.x =\n            2 *\n            Math.round(abs(shadow.offsetX) + shadowBlur) *\n            abs(scaling.scaleX);\n          shadowOffset.y =\n            2 *\n            Math.round(abs(shadow.offsetY) + shadowBlur) *\n            abs(scaling.scaleY);\n        }\n        width = boundingRect.width + shadowOffset.x;\n        height = boundingRect.height + shadowOffset.y;\n        // if the current width/height is not an integer\n        // we need to make it so.\n        el.width = Math.ceil(width);\n        el.height = Math.ceil(height);\n        var canvas = new fabric.StaticCanvas(el, {\n          enableRetinaScaling: false,\n          renderOnAddRemove: false,\n          skipOffscreen: false,\n        });\n        if (options.format === 'jpeg') {\n          canvas.backgroundColor = '#fff';\n        }\n        this.setPositionByOrigin(\n          new fabric.Point(canvas.width / 2, canvas.height / 2),\n          'center',\n          'center'\n        );\n\n        var originalCanvas = this.canvas;\n        canvas.add(this);\n        var canvasEl = canvas.toCanvasElement(multiplier || 1, options);\n        this.shadow = originalShadow;\n        this.set('canvas', originalCanvas);\n        if (originalGroup) {\n          this.group = originalGroup;\n        }\n        this.set(origParams).setCoords();\n        // canvas.dispose will call image.dispose that will nullify the elements\n        // since this canvas is a simple element for the process, we remove references\n        // to objects in this way in order to avoid object trashing.\n        canvas._objects = [];\n        canvas.dispose();\n        canvas = null;\n\n        return canvasEl;\n      },\n\n      /**\n       * Converts an object into a data-url-like string\n       * @param {Object} options Options object\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n       */\n      toDataURL: function (options) {\n        options || (options = {});\n        return fabric.util.toDataURL(\n          this.toCanvasElement(options),\n          options.format || 'png',\n          options.quality || 1\n        );\n      },\n\n      /**\n       * Returns true if specified type is identical to the type of an instance\n       * @param {String} type Type to check against\n       * @return {Boolean}\n       */\n      isType: function (type) {\n        return this.type === type;\n      },\n\n      /**\n       * Returns complexity of an instance\n       * @return {Number} complexity of this instance (is 1 unless subclassed)\n       */\n      complexity: function () {\n        return 1;\n      },\n\n      /**\n       * Returns a JSON representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} JSON\n       */\n      toJSON: function (propertiesToInclude) {\n        // delegate, not alias\n        return this.toObject(propertiesToInclude);\n      },\n\n      /**\n       * Sets gradient (fill or stroke) of an object\n       * percentages for x1,x2,y1,y2,r1,r2 together with gradientUnits 'pixels', are not supported.\n       * <b>Backwards incompatibility note:</b> This method was named \"setGradientFill\" until v1.1.0\n       * @param {String} property Property name 'stroke' or 'fill'\n       * @param {Object} [options] Options object\n       * @param {String} [options.type] Type of gradient 'radial' or 'linear'\n       * @param {Number} [options.x1=0] x-coordinate of start point\n       * @param {Number} [options.y1=0] y-coordinate of start point\n       * @param {Number} [options.x2=0] x-coordinate of end point\n       * @param {Number} [options.y2=0] y-coordinate of end point\n       * @param {Number} [options.r1=0] Radius of start point (only for radial gradients)\n       * @param {Number} [options.r2=0] Radius of end point (only for radial gradients)\n       * @param {Object} [options.colorStops] Color stops object eg. {0: 'ff0000', 1: '000000'}\n       * @param {Object} [options.gradientTransform] transformMatrix for gradient\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.4.0\n       * @see {@link http://jsfiddle.net/fabricjs/58y8b/|jsFiddle demo}\n       * @example <caption>Set linear gradient</caption>\n       * object.setGradient('fill', {\n       *   type: 'linear',\n       *   x1: -object.width / 2,\n       *   y1: 0,\n       *   x2: object.width / 2,\n       *   y2: 0,\n       *   colorStops: {\n       *     0: 'red',\n       *     0.5: '#005555',\n       *     1: 'rgba(0,0,255,0.5)'\n       *   }\n       * });\n       * canvas.renderAll();\n       * @example <caption>Set radial gradient</caption>\n       * object.setGradient('fill', {\n       *   type: 'radial',\n       *   x1: 0,\n       *   y1: 0,\n       *   x2: 0,\n       *   y2: 0,\n       *   r1: object.width / 2,\n       *   r2: 10,\n       *   colorStops: {\n       *     0: 'red',\n       *     0.5: '#005555',\n       *     1: 'rgba(0,0,255,0.5)'\n       *   }\n       * });\n       * canvas.renderAll();\n       */\n      setGradient: function (property, options) {\n        options || (options = {});\n\n        var gradient = { colorStops: [] };\n\n        gradient.type =\n          options.type || (options.r1 || options.r2 ? 'radial' : 'linear');\n        gradient.coords = {\n          x1: options.x1,\n          y1: options.y1,\n          x2: options.x2,\n          y2: options.y2,\n        };\n        gradient.gradientUnits = options.gradientUnits || 'pixels';\n        if (options.r1 || options.r2) {\n          gradient.coords.r1 = options.r1;\n          gradient.coords.r2 = options.r2;\n        }\n\n        gradient.gradientTransform = options.gradientTransform;\n        fabric.Gradient.prototype.addColorStop.call(\n          gradient,\n          options.colorStops\n        );\n\n        return this.set(property, fabric.Gradient.forObject(this, gradient));\n      },\n\n      /**\n       * Sets pattern fill of an object\n       * @param {Object} options Options object\n       * @param {(String|HTMLImageElement)} options.source Pattern source\n       * @param {String} [options.repeat=repeat] Repeat property of a pattern (one of repeat, repeat-x, repeat-y or no-repeat)\n       * @param {Number} [options.offsetX=0] Pattern horizontal offset from object's left/top corner\n       * @param {Number} [options.offsetY=0] Pattern vertical offset from object's left/top corner\n       * @param {Function} [callback] Callback to invoke when image set as a pattern\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.5.0\n       * @see {@link http://jsfiddle.net/fabricjs/QT3pa/|jsFiddle demo}\n       * @example <caption>Set pattern</caption>\n       * object.setPatternFill({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat'\n       * },canvas.renderAll.bind(canvas));\n       */\n      setPatternFill: function (options, callback) {\n        return this.set('fill', new fabric.Pattern(options, callback));\n      },\n\n      /**\n       * Sets {@link fabric.Object#shadow|shadow} of an object\n       * @param {Object|String} [options] Options object or string (e.g. \"2px 2px 10px rgba(0,0,0,0.2)\")\n       * @param {String} [options.color=rgb(0,0,0)] Shadow color\n       * @param {Number} [options.blur=0] Shadow blur\n       * @param {Number} [options.offsetX=0] Shadow horizontal offset\n       * @param {Number} [options.offsetY=0] Shadow vertical offset\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.5.0\n       * @see {@link http://jsfiddle.net/fabricjs/7gvJG/|jsFiddle demo}\n       * @example <caption>Set shadow with string notation</caption>\n       * object.setShadow('2px 2px 10px rgba(0,0,0,0.2)');\n       * canvas.renderAll();\n       * @example <caption>Set shadow with object notation</caption>\n       * object.setShadow({\n       *   color: 'red',\n       *   blur: 10,\n       *   offsetX: 20,\n       *   offsetY: 20\n       * });\n       * canvas.renderAll();\n       */\n      setShadow: function (options) {\n        return this.set('shadow', options ? new fabric.Shadow(options) : null);\n      },\n\n      /**\n       * Sets \"color\" of an instance (alias of `set('fill', &hellip;)`)\n       * @param {String} color Color value\n       * @return {fabric.Object} thisArg\n       * @deprecated since 3.5.0\n       * @chainable\n       */\n      setColor: function (color) {\n        this.set('fill', color);\n        return this;\n      },\n\n      /**\n       * Sets \"angle\" of an instance with centered rotation\n       * @param {Number} angle Angle value (in degrees)\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      rotate: function (angle) {\n        var shouldCenterOrigin =\n          (this.originX !== 'center' || this.originY !== 'center') &&\n          this.centeredRotation;\n\n        if (shouldCenterOrigin) {\n          this._setOriginToCenter();\n        }\n\n        this.set('angle', angle);\n\n        if (shouldCenterOrigin) {\n          this._resetOrigin();\n        }\n\n        return this;\n      },\n\n      /**\n       * Centers object horizontally on canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      centerH: function () {\n        this.canvas && this.canvas.centerObjectH(this);\n        return this;\n      },\n\n      /**\n       * Centers object horizontally on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenterH: function () {\n        this.canvas && this.canvas.viewportCenterObjectH(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically on canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      centerV: function () {\n        this.canvas && this.canvas.centerObjectV(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenterV: function () {\n        this.canvas && this.canvas.viewportCenterObjectV(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically and horizontally on canvas to which is was added last\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      center: function () {\n        this.canvas && this.canvas.centerObject(this);\n        return this;\n      },\n\n      /**\n       * Centers object on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenter: function () {\n        this.canvas && this.canvas.viewportCenterObject(this);\n        return this;\n      },\n\n      /**\n       * Returns coordinates of a pointer relative to an object\n       * @param {Event} e Event to operate upon\n       * @param {Object} [pointer] Pointer to operate upon (instead of event)\n       * @return {Object} Coordinates of a pointer (x, y)\n       */\n      getLocalPointer: function (e, pointer) {\n        pointer = pointer || this.canvas.getPointer(e);\n        var pClicked = new fabric.Point(pointer.x, pointer.y),\n          objectLeftTop = this._getLeftTopCoords();\n        if (this.angle) {\n          pClicked = fabric.util.rotatePoint(\n            pClicked,\n            objectLeftTop,\n            degreesToRadians(-this.angle)\n          );\n        }\n        return {\n          x: pClicked.x - objectLeftTop.x,\n          y: pClicked.y - objectLeftTop.y,\n        };\n      },\n\n      /**\n       * Sets canvas globalCompositeOperation for specific object\n       * custom composition operation for the particular object can be specified using globalCompositeOperation property\n       * @param {CanvasRenderingContext2D} ctx Rendering canvas context\n       */\n      _setupCompositeOperation: function (ctx) {\n        if (this.globalCompositeOperation) {\n          ctx.globalCompositeOperation = this.globalCompositeOperation;\n        }\n      },\n    }\n  );\n\n  fabric.util.createAccessors && fabric.util.createAccessors(fabric.Object);\n\n  extend(fabric.Object.prototype, fabric.Observable);\n\n  /**\n   * Defines the number of fraction digits to use when serializing object values.\n   * You can use it to increase/decrease precision of such values like left, top, scaleX, scaleY, etc.\n   * @static\n   * @memberOf fabric.Object\n   * @constant\n   * @type Number\n   */\n  fabric.Object.NUM_FRACTION_DIGITS = 2;\n\n  fabric.Object._fromObject = function (\n    className,\n    object,\n    callback,\n    extraParam\n  ) {\n    var klass = fabric[className];\n    object = clone(object, true);\n    fabric.util.enlivenPatterns([object.fill, object.stroke], function (\n      patterns\n    ) {\n      if (typeof patterns[0] !== 'undefined') {\n        object.fill = patterns[0];\n      }\n      if (typeof patterns[1] !== 'undefined') {\n        object.stroke = patterns[1];\n      }\n      fabric.util.enlivenObjects([object.clipPath], function (enlivedProps) {\n        object.clipPath = enlivedProps[0];\n        var instance = extraParam\n          ? new klass(object[extraParam], object)\n          : new klass(object);\n        callback && callback(instance);\n      });\n    });\n  };\n\n  /**\n   * Unique id used internally when creating SVG elements\n   * @static\n   * @memberOf fabric.Object\n   * @type Number\n   */\n  fabric.Object.__uid = 0;\n})(typeof exports !== 'undefined' ? exports : this);\n(function initTranslations() {\n  var degreesToRadians = fabric.util.degreesToRadians,\n    originXOffset = {\n      left: -0.5,\n      center: 0,\n      right: 0.5,\n    },\n    originYOffset = {\n      top: -0.5,\n      center: 0,\n      bottom: 0.5,\n    };\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Translates the coordinates from a set of origin to another (based on the object's dimensions)\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @param {String} fromOriginX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} fromOriginY Vertical origin: 'top', 'center' or 'bottom'\n       * @param {String} toOriginX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} toOriginY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToGivenOrigin: function (\n        point,\n        fromOriginX,\n        fromOriginY,\n        toOriginX,\n        toOriginY\n      ) {\n        var x = point.x,\n          y = point.y,\n          offsetX,\n          offsetY,\n          dim;\n\n        if (typeof fromOriginX === 'string') {\n          fromOriginX = originXOffset[fromOriginX];\n        } else {\n          fromOriginX -= 0.5;\n        }\n\n        if (typeof toOriginX === 'string') {\n          toOriginX = originXOffset[toOriginX];\n        } else {\n          toOriginX -= 0.5;\n        }\n\n        offsetX = toOriginX - fromOriginX;\n\n        if (typeof fromOriginY === 'string') {\n          fromOriginY = originYOffset[fromOriginY];\n        } else {\n          fromOriginY -= 0.5;\n        }\n\n        if (typeof toOriginY === 'string') {\n          toOriginY = originYOffset[toOriginY];\n        } else {\n          toOriginY -= 0.5;\n        }\n\n        offsetY = toOriginY - fromOriginY;\n\n        if (offsetX || offsetY) {\n          dim = this._getTransformedDimensions();\n          x = point.x + offsetX * dim.x;\n          y = point.y + offsetY * dim.y;\n        }\n\n        return new fabric.Point(x, y);\n      },\n\n      /**\n       * Translates the coordinates from origin to center coordinates (based on the object's dimensions)\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToCenterPoint: function (point, originX, originY) {\n        var p = this.translateToGivenOrigin(\n          point,\n          originX,\n          originY,\n          'center',\n          'center'\n        );\n        if (this.angle) {\n          return fabric.util.rotatePoint(\n            p,\n            point,\n            degreesToRadians(this.angle)\n          );\n        }\n        return p;\n      },\n\n      /**\n       * Translates the coordinates from center to origin coordinates (based on the object's dimensions)\n       * @param {fabric.Point} center The point which corresponds to center of the object\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToOriginPoint: function (center, originX, originY) {\n        var p = this.translateToGivenOrigin(\n          center,\n          'center',\n          'center',\n          originX,\n          originY\n        );\n        if (this.angle) {\n          return fabric.util.rotatePoint(\n            p,\n            center,\n            degreesToRadians(this.angle)\n          );\n        }\n        return p;\n      },\n\n      /**\n       * Returns the real center coordinates of the object\n       * @return {fabric.Point}\n       */\n      getCenterPoint: function () {\n        var leftTop = new fabric.Point(this.left, this.top);\n        return this.translateToCenterPoint(leftTop, this.originX, this.originY);\n      },\n\n      /**\n       * Returns the coordinates of the object based on center coordinates\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @return {fabric.Point}\n       */\n      // getOriginPoint: function(center) {\n      //   return this.translateToOriginPoint(center, this.originX, this.originY);\n      // },\n\n      /**\n       * Returns the coordinates of the object as if it has a different origin\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      getPointByOrigin: function (originX, originY) {\n        var center = this.getCenterPoint();\n        return this.translateToOriginPoint(center, originX, originY);\n      },\n\n      /**\n       * Returns the point in local coordinates\n       * @param {fabric.Point} point The point relative to the global coordinate system\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      toLocalPoint: function (point, originX, originY) {\n        var center = this.getCenterPoint(),\n          p,\n          p2;\n\n        if (typeof originX !== 'undefined' && typeof originY !== 'undefined') {\n          p = this.translateToGivenOrigin(\n            center,\n            'center',\n            'center',\n            originX,\n            originY\n          );\n        } else {\n          p = new fabric.Point(this.left, this.top);\n        }\n\n        p2 = new fabric.Point(point.x, point.y);\n        if (this.angle) {\n          p2 = fabric.util.rotatePoint(\n            p2,\n            center,\n            -degreesToRadians(this.angle)\n          );\n        }\n        return p2.subtractEquals(p);\n      },\n\n      /**\n       * Returns the point in global coordinates\n       * @param {fabric.Point} The point relative to the local coordinate system\n       * @return {fabric.Point}\n       */\n      // toGlobalPoint: function(point) {\n      //   return fabric.util.rotatePoint(point, this.getCenterPoint(), degreesToRadians(this.angle)).addEquals(new fabric.Point(this.left, this.top));\n      // },\n\n      /**\n       * Sets the position of the object taking into consideration the object's origin\n       * @param {fabric.Point} pos The new position of the object\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {void}\n       */\n      setPositionByOrigin: function (pos, originX, originY) {\n        var center = this.translateToCenterPoint(pos, originX, originY),\n          position = this.translateToOriginPoint(\n            center,\n            this.originX,\n            this.originY\n          );\n        this.set('left', position.x);\n        this.set('top', position.y);\n      },\n\n      /**\n       * @param {String} to One of 'left', 'center', 'right'\n       */\n      adjustPosition: function (to) {\n        var angle = degreesToRadians(this.angle),\n          hypotFull = this.getScaledWidth(),\n          xFull = fabric.util.cos(angle) * hypotFull,\n          yFull = fabric.util.sin(angle) * hypotFull,\n          offsetFrom,\n          offsetTo;\n\n        //TODO: this function does not consider mixed situation like top, center.\n        if (typeof this.originX === 'string') {\n          offsetFrom = originXOffset[this.originX];\n        } else {\n          offsetFrom = this.originX - 0.5;\n        }\n        if (typeof to === 'string') {\n          offsetTo = originXOffset[to];\n        } else {\n          offsetTo = to - 0.5;\n        }\n        this.left += xFull * (offsetTo - offsetFrom);\n        this.top += yFull * (offsetTo - offsetFrom);\n        this.setCoords();\n        this.originX = to;\n      },\n\n      /**\n       * Sets the origin/position of the object to it's center point\n       * @private\n       * @return {void}\n       */\n      _setOriginToCenter: function () {\n        this._originalOriginX = this.originX;\n        this._originalOriginY = this.originY;\n\n        var center = this.getCenterPoint();\n\n        this.originX = 'center';\n        this.originY = 'center';\n\n        this.left = center.x;\n        this.top = center.y;\n      },\n\n      /**\n       * Resets the origin/position of the object to it's original origin\n       * @private\n       * @return {void}\n       */\n      _resetOrigin: function () {\n        var originPoint = this.translateToOriginPoint(\n          this.getCenterPoint(),\n          this._originalOriginX,\n          this._originalOriginY\n        );\n\n        this.originX = this._originalOriginX;\n        this.originY = this._originalOriginY;\n\n        this.left = originPoint.x;\n        this.top = originPoint.y;\n\n        this._originalOriginX = null;\n        this._originalOriginY = null;\n      },\n\n      /**\n       * @private\n       */\n      _getLeftTopCoords: function () {\n        return this.translateToOriginPoint(\n          this.getCenterPoint(),\n          'left',\n          'top'\n        );\n      },\n    }\n  );\n})();\n(function initIntersectionsAndScaling() {\n  // Also threw in drawSelectionBackground\n\n  function getCoords(coords) {\n    return [\n      new fabric.Point(coords.tl.x, coords.tl.y),\n      new fabric.Point(coords.tr.x, coords.tr.y),\n      new fabric.Point(coords.br.x, coords.br.y),\n      new fabric.Point(coords.bl.x, coords.bl.y),\n    ];\n  }\n\n  var degreesToRadians = fabric.util.degreesToRadians,\n    multiplyMatrices = fabric.util.multiplyTransformMatrices,\n    transformPoint = fabric.util.transformPoint;\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Draws a colored layer behind the object, inside its selection borders.\n       * Requires public options: padding, selectionBackgroundColor\n       * this function is called when the context is transformed\n       * has checks to be skipped when the object is on a staticCanvas\n       * @param {CanvasRenderingContext2D} ctx Context to draw on\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      drawSelectionBackground: function (ctx) {\n        if (\n          !this.selectionBackgroundColor ||\n          (this.canvas && !this.canvas.interactive) ||\n          (this.canvas && this.canvas._activeObject !== this)\n        ) {\n          return this;\n        }\n        ctx.save();\n        var center = this.getCenterPoint(),\n          wh = this._calculateCurrentDimensions(),\n          vpt = this.canvas.viewportTransform;\n        ctx.translate(center.x, center.y);\n        ctx.scale(1 / vpt[0], 1 / vpt[3]);\n        ctx.rotate(degreesToRadians(this.angle));\n        ctx.fillStyle = this.selectionBackgroundColor;\n        ctx.fillRect(-wh.x / 2, -wh.y / 2, wh.x, wh.y);\n        ctx.restore();\n        return this;\n      },\n\n      /**\n       * Describe object's corner position in canvas element coordinates.\n       * properties are tl,mt,tr,ml,mr,bl,mb,br,mtr for the main controls.\n       * each property is an object with x, y and corner.\n       * The `corner` property contains in a similar manner the 4 points of the\n       * interactive area of the corner.\n       * The coordinates depends from this properties: width, height, scaleX, scaleY\n       * skewX, skewY, angle, strokeWidth, viewportTransform, top, left, padding.\n       * The coordinates get updated with @method setCoords.\n       * You can calculate them without updating with @method calcCoords;\n       * @memberOf fabric.Object.prototype\n       */\n      oCoords: null,\n\n      /**\n       * Describe object's corner position in canvas object absolute coordinates\n       * properties are tl,tr,bl,br and describe the four main corner.\n       * each property is an object with x, y, instance of Fabric.Point.\n       * The coordinates depends from this properties: width, height, scaleX, scaleY\n       * skewX, skewY, angle, strokeWidth, top, left.\n       * Those coordinates are useful to understand where an object is. They get updated\n       * with oCoords but they do not need to be updated when zoom or panning change.\n       * The coordinates get updated with @method setCoords.\n       * You can calculate them without updating with @method calcCoords(true);\n       * @memberOf fabric.Object.prototype\n       */\n      aCoords: null,\n\n      /**\n       * storage for object transform matrix\n       */\n      ownMatrixCache: null,\n\n      /**\n       * storage for object full transform matrix\n       */\n      matrixCache: null,\n\n      /**\n       * return correct set of coordinates for intersection\n       */\n      getCoords: function (absolute, calculate) {\n        if (!this.oCoords) {\n          this.setCoords();\n        }\n        var coords = absolute ? this.aCoords : this.oCoords;\n        return getCoords(calculate ? this.calcCoords(absolute) : coords);\n      },\n\n      /**\n       * Checks if object intersects with an area formed by 2 points\n       * @param {Object} pointTL top-left point of area\n       * @param {Object} pointBR bottom-right point of area\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object intersects with an area formed by 2 points\n       */\n      intersectsWithRect: function (pointTL, pointBR, absolute, calculate) {\n        var coords = this.getCoords(absolute, calculate),\n          intersection = fabric.Intersection.intersectPolygonRectangle(\n            coords,\n            pointTL,\n            pointBR\n          );\n        return intersection.status === 'Intersection';\n      },\n\n      /**\n       * Checks if object intersects with another object\n       * @param {Object} other Object to test\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object intersects with another object\n       */\n      intersectsWithObject: function (other, absolute, calculate) {\n        var intersection = fabric.Intersection.intersectPolygonPolygon(\n          this.getCoords(absolute, calculate),\n          other.getCoords(absolute, calculate)\n        );\n\n        return (\n          intersection.status === 'Intersection' ||\n          other.isContainedWithinObject(this, absolute, calculate) ||\n          this.isContainedWithinObject(other, absolute, calculate)\n        );\n      },\n\n      /**\n       * Checks if object is fully contained within area of another object\n       * @param {Object} other Object to test\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is fully contained within area of another object\n       */\n      isContainedWithinObject: function (other, absolute, calculate) {\n        var points = this.getCoords(absolute, calculate),\n          i = 0,\n          lines = other._getImageLines(\n            calculate\n              ? other.calcCoords(absolute)\n              : absolute\n              ? other.aCoords\n              : other.oCoords\n          );\n        for (; i < 4; i++) {\n          if (!other.containsPoint(points[i], lines)) {\n            return false;\n          }\n        }\n        return true;\n      },\n\n      /**\n       * Checks if object is fully contained within area formed by 2 points\n       * @param {Object} pointTL top-left point of area\n       * @param {Object} pointBR bottom-right point of area\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is fully contained within area formed by 2 points\n       */\n      isContainedWithinRect: function (pointTL, pointBR, absolute, calculate) {\n        var boundingRect = this.getBoundingRect(absolute, calculate);\n\n        return (\n          boundingRect.left >= pointTL.x &&\n          boundingRect.left + boundingRect.width <= pointBR.x &&\n          boundingRect.top >= pointTL.y &&\n          boundingRect.top + boundingRect.height <= pointBR.y\n        );\n      },\n\n      /**\n       * Checks if point is inside the object\n       * @param {fabric.Point} point Point to check against\n       * @param {Object} [lines] object returned from @method _getImageLines\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if point is inside the object\n       */\n      containsPoint: function (point, lines, absolute, calculate) {\n        let objLines =\n            lines ||\n            this._getImageLines(\n              calculate\n                ? this.calcCoords(absolute)\n                : absolute\n                ? this.aCoords\n                : this.oCoords\n            ),\n          xPoints = this._findCrossPoints(point, objLines);\n\n        // if xPoints is odd then point is inside the object\n        return xPoints !== 0 && xPoints % 2 === 1;\n      },\n\n      /**\n       * Checks if object is contained within the canvas with current viewportTransform\n       * the check is done stopping at first point that appears on screen\n       * @param {Boolean} [calculate] use coordinates of current position instead of .aCoords\n       * @return {Boolean} true if object is fully or partially contained within canvas\n       */\n      isOnScreen: function (calculate) {\n        if (!this.canvas) {\n          return false;\n        }\n        var pointTL = this.canvas.vptCoords.tl,\n          pointBR = this.canvas.vptCoords.br;\n        var points = this.getCoords(true, calculate),\n          point;\n        for (var i = 0; i < 4; i++) {\n          point = points[i];\n          if (\n            point.x <= pointBR.x &&\n            point.x >= pointTL.x &&\n            point.y <= pointBR.y &&\n            point.y >= pointTL.y\n          ) {\n            return true;\n          }\n        }\n        // no points on screen, check intersection with absolute coordinates\n        if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n          return true;\n        }\n        return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n      },\n\n      /**\n       * Checks if the object contains the midpoint between canvas extremities\n       * Does not make sense outside the context of isOnScreen and isPartiallyOnScreen\n       * @private\n       * @param {Fabric.Point} pointTL Top Left point\n       * @param {Fabric.Point} pointBR Top Right point\n       * @param {Boolean} calculate use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if the object contains the point\n       */\n      _containsCenterOfCanvas: function (pointTL, pointBR, calculate) {\n        // worst case scenario the object is so big that contains the screen\n        var centerPoint = {\n          x: (pointTL.x + pointBR.x) / 2,\n          y: (pointTL.y + pointBR.y) / 2,\n        };\n        if (this.containsPoint(centerPoint, null, true, calculate)) {\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Checks if object is partially contained within the canvas with current viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is partially contained within canvas\n       */\n      isPartiallyOnScreen: function (calculate) {\n        if (!this.canvas) {\n          return false;\n        }\n        var pointTL = this.canvas.vptCoords.tl,\n          pointBR = this.canvas.vptCoords.br;\n        if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n          return true;\n        }\n        return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n      },\n\n      /**\n       * Method that returns an object with the object edges in it, given the coordinates of the corners\n       * @private\n       * @param {Object} oCoords Coordinates of the object corners\n       */\n      _getImageLines: function (oCoords) {\n        return {\n          topline: {\n            o: oCoords.tl,\n            d: oCoords.tr,\n          },\n          rightline: {\n            o: oCoords.tr,\n            d: oCoords.br,\n          },\n          bottomline: {\n            o: oCoords.br,\n            d: oCoords.bl,\n          },\n          leftline: {\n            o: oCoords.bl,\n            d: oCoords.tl,\n          },\n        };\n      },\n\n      /**\n       * Helper method to determine how many cross points are between the 4 object edges\n       * and the horizontal line determined by a point on canvas\n       * @private\n       * @param {fabric.Point} point Point to check\n       * @param {Object} lines Coordinates of the object being evaluated\n       */\n      // remove yi, not used but left code here just in case.\n      _findCrossPoints: function (point, lines) {\n        var b1,\n          b2,\n          a1,\n          a2,\n          xi, // yi,\n          xcount = 0,\n          iLine;\n\n        for (var lineKey in lines) {\n          iLine = lines[lineKey];\n          // optimisation 1: line below point. no cross\n          if (iLine.o.y < point.y && iLine.d.y < point.y) {\n            continue;\n          }\n          // optimisation 2: line above point. no cross\n          if (iLine.o.y >= point.y && iLine.d.y >= point.y) {\n            continue;\n          }\n          // optimisation 3: vertical line case\n          if (iLine.o.x === iLine.d.x && iLine.o.x >= point.x) {\n            xi = iLine.o.x;\n            // yi = point.y;\n          }\n          // calculate the intersection point\n          else {\n            b1 = 0;\n            b2 = (iLine.d.y - iLine.o.y) / (iLine.d.x - iLine.o.x);\n            a1 = point.y - b1 * point.x;\n            a2 = iLine.o.y - b2 * iLine.o.x;\n\n            xi = -(a1 - a2) / (b1 - b2);\n            // yi = a1 + b1 * xi;\n          }\n          // dont count xi < point.x cases\n          if (xi >= point.x) {\n            xcount += 1;\n          }\n          // optimisation 4: specific for square images\n          if (xcount === 2) {\n            break;\n          }\n        }\n        return xcount;\n      },\n\n      /**\n       * Returns coordinates of object's bounding rectangle (left, top, width, height)\n       * the box is intended as aligned to axis of canvas.\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords / .aCoords\n       * @return {Object} Object with left, top, width, height properties\n       */\n      getBoundingRect: function (absolute, calculate) {\n        var coords = this.getCoords(absolute, calculate);\n        return fabric.util.makeBoundingBoxFromPoints(coords);\n      },\n\n      /**\n       * Returns width of an object's bounding box counting transformations\n       * before 2.0 it was named getWidth();\n       * @return {Number} width value\n       */\n      getScaledWidth: function () {\n        return this._getTransformedDimensions().x;\n      },\n\n      /**\n       * Returns height of an object bounding box counting transformations\n       * before 2.0 it was named getHeight();\n       * @return {Number} height value\n       */\n      getScaledHeight: function () {\n        return this._getTransformedDimensions().y;\n      },\n\n      /**\n       * Makes sure the scale is valid and modifies it if necessary\n       * @private\n       * @param {Number} value\n       * @return {Number}\n       */\n      _constrainScale: function (value) {\n        if (Math.abs(value) < this.minScaleLimit) {\n          if (value < 0) {\n            return -this.minScaleLimit;\n          } else {\n            return this.minScaleLimit;\n          }\n        } else if (value === 0) {\n          return 0.0001;\n        }\n        return value;\n      },\n\n      /**\n       * Scales an object (equally by x and y)\n       * @param {Number} value Scale factor\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scale: function (value) {\n        this._set('scaleX', value);\n        this._set('scaleY', value);\n        return this.setCoords();\n      },\n\n      /**\n       * Scales an object to a given width, with respect to bounding box (scaling by x/y equally)\n       * @param {Number} value New width value\n       * @param {Boolean} absolute ignore viewport\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scaleToWidth: function (value, absolute) {\n        // adjust to bounding rect factor so that rotated shapes would fit as well\n        var boundingRectFactor =\n          this.getBoundingRect(absolute).width / this.getScaledWidth();\n        return this.scale(value / this.width / boundingRectFactor);\n      },\n\n      /**\n       * Scales an object to a given height, with respect to bounding box (scaling by x/y equally)\n       * @param {Number} value New height value\n       * @param {Boolean} absolute ignore viewport\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scaleToHeight: function (value, absolute) {\n        // adjust to bounding rect factor so that rotated shapes would fit as well\n        var boundingRectFactor =\n          this.getBoundingRect(absolute).height / this.getScaledHeight();\n        return this.scale(value / this.height / boundingRectFactor);\n      },\n\n      /**\n       * Calculates and returns the .coords of an object.\n       * @return {Object} Object with tl, tr, br, bl ....\n       * @chainable\n       */\n      calcCoords: function (absolute) {\n        var rotateMatrix = this._calcRotateMatrix(),\n          translateMatrix = this._calcTranslateMatrix(),\n          startMatrix = multiplyMatrices(translateMatrix, rotateMatrix),\n          vpt = this.getViewportTransform(),\n          finalMatrix = absolute\n            ? startMatrix\n            : multiplyMatrices(vpt, startMatrix),\n          dim = this._getTransformedDimensions(),\n          w = dim.x / 2,\n          h = dim.y / 2,\n          tl = transformPoint({ x: -w, y: -h }, finalMatrix),\n          tr = transformPoint({ x: w, y: -h }, finalMatrix),\n          bl = transformPoint({ x: -w, y: h }, finalMatrix),\n          br = transformPoint({ x: w, y: h }, finalMatrix);\n        if (!absolute) {\n          var padding = this.padding,\n            angle = degreesToRadians(this.angle),\n            cos = fabric.util.cos(angle),\n            sin = fabric.util.sin(angle),\n            cosP = cos * padding,\n            sinP = sin * padding,\n            cosPSinP = cosP + sinP,\n            cosPMinusSinP = cosP - sinP;\n          if (padding) {\n            tl.x -= cosPMinusSinP;\n            tl.y -= cosPSinP;\n            tr.x += cosPSinP;\n            tr.y -= cosPMinusSinP;\n            bl.x -= cosPSinP;\n            bl.y += cosPMinusSinP;\n            br.x += cosPMinusSinP;\n            br.y += cosPSinP;\n          }\n          var ml = new fabric.Point((tl.x + bl.x) / 2, (tl.y + bl.y) / 2),\n            mt = new fabric.Point((tr.x + tl.x) / 2, (tr.y + tl.y) / 2),\n            mr = new fabric.Point((br.x + tr.x) / 2, (br.y + tr.y) / 2),\n            mb = new fabric.Point((br.x + bl.x) / 2, (br.y + bl.y) / 2),\n            mtr = new fabric.Point(\n              mt.x + sin * this.rotatingPointOffset,\n              mt.y - cos * this.rotatingPointOffset\n            );\n        }\n\n        // if (!absolute) {\n        //   var canvas = this.canvas;\n        //   setTimeout(function() {\n        //     canvas.contextTop.clearRect(0, 0, 700, 700);\n        //     canvas.contextTop.fillStyle = 'green';\n        //     canvas.contextTop.fillRect(mb.x, mb.y, 3, 3);\n        //     canvas.contextTop.fillRect(bl.x, bl.y, 3, 3);\n        //     canvas.contextTop.fillRect(br.x, br.y, 3, 3);\n        //     canvas.contextTop.fillRect(tl.x, tl.y, 3, 3);\n        //     canvas.contextTop.fillRect(tr.x, tr.y, 3, 3);\n        //     canvas.contextTop.fillRect(ml.x, ml.y, 3, 3);\n        //     canvas.contextTop.fillRect(mr.x, mr.y, 3, 3);\n        //     canvas.contextTop.fillRect(mt.x, mt.y, 3, 3);\n        //     canvas.contextTop.fillRect(mtr.x, mtr.y, 3, 3);\n        //   }, 50);\n        // }\n\n        var coords = {\n          // corners\n          tl: tl,\n          tr: tr,\n          br: br,\n          bl: bl,\n        };\n        if (!absolute) {\n          // middle\n          coords.ml = ml;\n          coords.mt = mt;\n          coords.mr = mr;\n          coords.mb = mb;\n          // rotating point\n          coords.mtr = mtr;\n        }\n        return coords;\n      },\n\n      /**\n       * Sets corner position coordinates based on current angle, width and height.\n       * See {@link https://github.com/kangax/fabric.js/wiki/When-to-call-setCoords|When-to-call-setCoords}\n       * @param {Boolean} [ignoreZoom] set oCoords with or without the viewport transform.\n       * @param {Boolean} [skipAbsolute] skip calculation of aCoords, useful in setViewportTransform\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      setCoords: function (ignoreZoom, skipAbsolute) {\n        this.oCoords = this.calcCoords(ignoreZoom);\n        if (!skipAbsolute) {\n          this.aCoords = this.calcCoords(true);\n        }\n\n        // set coordinates of the draggable boxes in the corners used to scale/rotate the image\n        ignoreZoom || (this._setCornerCoords && this._setCornerCoords());\n\n        return this;\n      },\n\n      /**\n       * calculate rotation matrix of an object\n       * @return {Array} rotation matrix for the object\n       */\n      _calcRotateMatrix: function () {\n        return fabric.util.calcRotateMatrix(this);\n      },\n\n      /**\n       * calculate the translation matrix for an object transform\n       * @return {Array} rotation matrix for the object\n       */\n      _calcTranslateMatrix: function () {\n        var center = this.getCenterPoint();\n        return [1, 0, 0, 1, center.x, center.y];\n      },\n\n      transformMatrixKey: function (skipGroup) {\n        var sep = '_',\n          prefix = '';\n        if (!skipGroup && this.group) {\n          prefix = this.group.transformMatrixKey(skipGroup) + sep;\n        }\n        return (\n          prefix +\n          this.top +\n          sep +\n          this.left +\n          sep +\n          this.scaleX +\n          sep +\n          this.scaleY +\n          sep +\n          this.skewX +\n          sep +\n          this.skewY +\n          sep +\n          this.angle +\n          sep +\n          this.originX +\n          sep +\n          this.originY +\n          sep +\n          this.width +\n          sep +\n          this.height +\n          sep +\n          this.strokeWidth +\n          this.flipX +\n          this.flipY\n        );\n      },\n\n      /**\n       * calculate transform matrix that represents the current transformations from the\n       * object's properties.\n       * @param {Boolean} [skipGroup] return transform matrix for object not counting parent transformations\n       * @return {Array} transform matrix for the object\n       */\n      calcTransformMatrix: function (skipGroup) {\n        if (skipGroup) {\n          return this.calcOwnMatrix();\n        }\n        var key = this.transformMatrixKey(),\n          cache = this.matrixCache || (this.matrixCache = {});\n        if (cache.key === key) {\n          return cache.value;\n        }\n        var matrix = this.calcOwnMatrix();\n        if (this.group) {\n          matrix = multiplyMatrices(this.group.calcTransformMatrix(), matrix);\n        }\n        cache.key = key;\n        cache.value = matrix;\n        return matrix;\n      },\n\n      /**\n       * calculate transform matrix that represents the current transformations from the\n       * object's properties, this matrix does not include the group transformation\n       * @return {Array} transform matrix for the object\n       */\n      calcOwnMatrix: function () {\n        var key = this.transformMatrixKey(true),\n          cache = this.ownMatrixCache || (this.ownMatrixCache = {});\n        if (cache.key === key) {\n          return cache.value;\n        }\n        var tMatrix = this._calcTranslateMatrix();\n        this.translateX = tMatrix[4];\n        this.translateY = tMatrix[5];\n        cache.key = key;\n        cache.value = fabric.util.composeMatrix(this);\n        return cache.value;\n      },\n\n      /*\n       * Calculate object dimensions from its properties\n       * @private\n       * @deprecated since 3.4.0, please use fabric.util._calcDimensionsTransformMatrix\n       * not including or including flipX, flipY to emulate the flipping boolean\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _calcDimensionsTransformMatrix: function (skewX, skewY, flipping) {\n        return fabric.util.calcDimensionsMatrix({\n          skewX: skewX,\n          skewY: skewY,\n          scaleX: this.scaleX * (flipping && this.flipX ? -1 : 1),\n          scaleY: this.scaleY * (flipping && this.flipY ? -1 : 1),\n        });\n      },\n\n      /*\n       * Calculate object dimensions from its properties\n       * @private\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _getNonTransformedDimensions: function () {\n        var strokeWidth = this.strokeWidth,\n          w = this.width + strokeWidth,\n          h = this.height + strokeWidth;\n        return { x: w, y: h };\n      },\n\n      /*\n       * Calculate object bounding box dimensions from its properties scale, skew.\n       * The skewX and skewY parameters are used in the skewing logic path and\n       * do not provide something useful to common use cases.\n       * @param {Number} [skewX], a value to override current skewX\n       * @param {Number} [skewY], a value to override current skewY\n       * @private\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _getTransformedDimensions: function (skewX, skewY) {\n        if (typeof skewX === 'undefined') {\n          skewX = this.skewX;\n        }\n        if (typeof skewY === 'undefined') {\n          skewY = this.skewY;\n        }\n        var dimensions = this._getNonTransformedDimensions(),\n          dimX,\n          dimY,\n          noSkew = skewX === 0 && skewY === 0;\n\n        if (this.strokeUniform) {\n          dimX = this.width;\n          dimY = this.height;\n        } else {\n          dimX = dimensions.x;\n          dimY = dimensions.y;\n        }\n        if (noSkew) {\n          return this._finalizeDimensions(\n            dimX * this.scaleX,\n            dimY * this.scaleY\n          );\n        } else {\n          dimX /= 2;\n          dimY /= 2;\n        }\n        var points = [\n            {\n              x: -dimX,\n              y: -dimY,\n            },\n            {\n              x: dimX,\n              y: -dimY,\n            },\n            {\n              x: -dimX,\n              y: dimY,\n            },\n            {\n              x: dimX,\n              y: dimY,\n            },\n          ],\n          transformMatrix = fabric.util.calcDimensionsMatrix({\n            scaleX: this.scaleX,\n            scaleY: this.scaleY,\n            skewX: skewX,\n            skewY: skewY,\n          }),\n          bbox = fabric.util.makeBoundingBoxFromPoints(points, transformMatrix);\n        return this._finalizeDimensions(bbox.width, bbox.height);\n      },\n\n      /*\n       * Calculate object bounding box dimensions from its properties scale, skew.\n       * @param Number width width of the bbox\n       * @param Number height height of the bbox\n       * @private\n       * @return {Object} .x finalized width dimension\n       * @return {Object} .y finalized height dimension\n       */\n      _finalizeDimensions: function (width, height) {\n        return this.strokeUniform\n          ? { x: width + this.strokeWidth, y: height + this.strokeWidth }\n          : { x: width, y: height };\n      },\n      /*\n       * Calculate object dimensions for controls, including padding and canvas zoom.\n       * private\n       */\n      _calculateCurrentDimensions: function () {\n        var vpt = this.getViewportTransform(),\n          dim = this._getTransformedDimensions(),\n          p = fabric.util.transformPoint(dim, vpt, true);\n\n        return p.scalarAdd(2 * this.padding);\n      },\n    }\n  );\n})();\nfabric.util.object.extend(\n  fabric.Object.prototype,\n  /** @lends fabric.Object.prototype */ {\n    /**\n     * Moves an object to the bottom of the stack of drawn objects\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    sendToBack: function () {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.sendToBack.call(this.group, this);\n      } else if (this.canvas) {\n        this.canvas.sendToBack(this);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object to the top of the stack of drawn objects\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    bringToFront: function () {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.bringToFront.call(this.group, this);\n      } else if (this.canvas) {\n        this.canvas.bringToFront(this);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object down in stack of drawn objects\n     * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    sendBackwards: function (intersecting) {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.sendBackwards.call(\n          this.group,\n          this,\n          intersecting\n        );\n      } else if (this.canvas) {\n        this.canvas.sendBackwards(this, intersecting);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object up in stack of drawn objects\n     * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    bringForward: function (intersecting) {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.bringForward.call(\n          this.group,\n          this,\n          intersecting\n        );\n      } else if (this.canvas) {\n        this.canvas.bringForward(this, intersecting);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object to specified level in stack of drawn objects\n     * @param {Number} index New position of object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    moveTo: function (index) {\n      if (this.group && this.group.type !== 'activeSelection') {\n        fabric.StaticCanvas.prototype.moveTo.call(this.group, this, index);\n      } else if (this.canvas) {\n        this.canvas.moveTo(this, index);\n      }\n      return this;\n    },\n  }\n);\n/* _TO_SVG_START_ */\n(function () {\n  function getSvgColorString(prop, value) {\n    if (!value) {\n      return prop + ': none; ';\n    } else if (value.toLive) {\n      return prop + ': url(#SVGID_' + value.id + '); ';\n    } else {\n      var color = new fabric.Color(value),\n        str = prop + ': ' + color.toRgb() + '; ',\n        opacity = color.getAlpha();\n      if (opacity !== 1) {\n        //change the color in rgb + opacity\n        str += prop + '-opacity: ' + opacity.toString() + '; ';\n      }\n      return str;\n    }\n  }\n\n  var toFixed = fabric.util.toFixed;\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Returns styles-string for svg-export\n       * @param {Boolean} skipShadow a boolean to skip shadow filter output\n       * @return {String}\n       */\n      getSvgStyles: function (skipShadow) {\n        var fillRule = this.fillRule ? this.fillRule : 'nonzero',\n          strokeWidth = this.strokeWidth ? this.strokeWidth : '0',\n          strokeDashArray = this.strokeDashArray\n            ? this.strokeDashArray.join(' ')\n            : 'none',\n          strokeDashOffset = this.strokeDashOffset\n            ? this.strokeDashOffset\n            : '0',\n          strokeLineCap = this.strokeLineCap ? this.strokeLineCap : 'butt',\n          strokeLineJoin = this.strokeLineJoin ? this.strokeLineJoin : 'miter',\n          strokeMiterLimit = this.strokeMiterLimit\n            ? this.strokeMiterLimit\n            : '4',\n          opacity = typeof this.opacity !== 'undefined' ? this.opacity : '1',\n          visibility = this.visible ? '' : ' visibility: hidden;',\n          filter = skipShadow ? '' : this.getSvgFilter(),\n          fill = getSvgColorString('fill', this.fill),\n          stroke = getSvgColorString('stroke', this.stroke);\n\n        return [\n          stroke,\n          'stroke-width: ',\n          strokeWidth,\n          '; ',\n          'stroke-dasharray: ',\n          strokeDashArray,\n          '; ',\n          'stroke-linecap: ',\n          strokeLineCap,\n          '; ',\n          'stroke-dashoffset: ',\n          strokeDashOffset,\n          '; ',\n          'stroke-linejoin: ',\n          strokeLineJoin,\n          '; ',\n          'stroke-miterlimit: ',\n          strokeMiterLimit,\n          '; ',\n          fill,\n          'fill-rule: ',\n          fillRule,\n          '; ',\n          'opacity: ',\n          opacity,\n          ';',\n          filter,\n          visibility,\n        ].join('');\n      },\n\n      /**\n       * Returns styles-string for svg-export\n       * @param {Object} style the object from which to retrieve style properties\n       * @param {Boolean} useWhiteSpace a boolean to include an additional attribute in the style.\n       * @return {String}\n       */\n      getSvgSpanStyles: function (style, useWhiteSpace) {\n        var term = '; ';\n        var fontFamily = style.fontFamily\n          ? 'font-family: ' +\n            (style.fontFamily.indexOf(\"'\") === -1 &&\n            style.fontFamily.indexOf('\"') === -1\n              ? \"'\" + style.fontFamily + \"'\"\n              : style.fontFamily) +\n            term\n          : '';\n        var strokeWidth = style.strokeWidth\n            ? 'stroke-width: ' + style.strokeWidth + term\n            : '',\n          // fontFamily = fontFamily,\n          fontSize = style.fontSize\n            ? 'font-size: ' + style.fontSize + 'px' + term\n            : '',\n          fontStyle = style.fontStyle\n            ? 'font-style: ' + style.fontStyle + term\n            : '',\n          fontWeight = style.fontWeight\n            ? 'font-weight: ' + style.fontWeight + term\n            : '',\n          fill = style.fill ? getSvgColorString('fill', style.fill) : '',\n          stroke = style.stroke\n            ? getSvgColorString('stroke', style.stroke)\n            : '',\n          textDecoration = this.getSvgTextDecoration(style),\n          deltaY = style.deltaY\n            ? 'baseline-shift: ' + -style.deltaY + '; '\n            : '';\n        if (textDecoration) {\n          textDecoration = 'text-decoration: ' + textDecoration + term;\n        }\n\n        return [\n          stroke,\n          strokeWidth,\n          fontFamily,\n          fontSize,\n          fontStyle,\n          fontWeight,\n          textDecoration,\n          fill,\n          deltaY,\n          useWhiteSpace ? 'white-space: pre; ' : '',\n        ].join('');\n      },\n\n      /**\n       * Returns text-decoration property for svg-export\n       * @param {Object} style the object from which to retrieve style properties\n       * @return {String}\n       */\n      getSvgTextDecoration: function (style) {\n        return ['overline', 'underline', 'line-through']\n          .filter(function (decoration) {\n            return style[decoration.replace('-', '')];\n          })\n          .join(' ');\n      },\n\n      /**\n       * Returns filter for svg shadow\n       * @return {String}\n       */\n      getSvgFilter: function () {\n        return this.shadow ? 'filter: url(#SVGID_' + this.shadow.id + ');' : '';\n      },\n\n      /**\n       * Returns id attribute for svg output\n       * @return {String}\n       */\n      getSvgCommons: function () {\n        return [\n          this.id ? 'id=\"' + this.id + '\" ' : '',\n          this.clipPath\n            ? 'clip-path=\"url(#' + this.clipPath.clipPathId + ')\" '\n            : '',\n        ].join('');\n      },\n\n      /**\n       * Returns transform-string for svg-export\n       * @param {Boolean} use the full transform or the single object one.\n       * @return {String}\n       */\n      getSvgTransform: function (full, additionalTransform) {\n        var transform = full\n            ? this.calcTransformMatrix()\n            : this.calcOwnMatrix(),\n          svgTransform = 'transform=\"' + fabric.util.matrixToSVG(transform);\n        return (\n          svgTransform +\n          (additionalTransform || '') +\n          this.getSvgTransformMatrix() +\n          '\" '\n        );\n      },\n\n      /**\n       * Returns transform-string for svg-export from the transform matrix of single elements\n       * @return {String}\n       */\n      getSvgTransformMatrix: function () {\n        return this.transformMatrix\n          ? ' ' + fabric.util.matrixToSVG(this.transformMatrix)\n          : '';\n      },\n\n      _setSVGBg: function (textBgRects) {\n        if (this.backgroundColor) {\n          var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n          textBgRects.push(\n            '\\t\\t<rect ',\n            this._getFillAttributes(this.backgroundColor),\n            ' x=\"',\n            toFixed(-this.width / 2, NUM_FRACTION_DIGITS),\n            '\" y=\"',\n            toFixed(-this.height / 2, NUM_FRACTION_DIGITS),\n            '\" width=\"',\n            toFixed(this.width, NUM_FRACTION_DIGITS),\n            '\" height=\"',\n            toFixed(this.height, NUM_FRACTION_DIGITS),\n            '\"></rect>\\n'\n          );\n        }\n      },\n\n      /**\n       * Returns svg representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toSVG: function (reviver) {\n        return this._createBaseSVGMarkup(this._toSVG(reviver), {\n          reviver: reviver,\n        });\n      },\n\n      /**\n       * Returns svg clipPath representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toClipPathSVG: function (reviver) {\n        return (\n          '\\t' +\n          this._createBaseClipPathSVGMarkup(this._toSVG(reviver), {\n            reviver: reviver,\n          })\n        );\n      },\n\n      /**\n       * @private\n       */\n      _createBaseClipPathSVGMarkup: function (objectMarkup, options) {\n        options = options || {};\n        var reviver = options.reviver,\n          additionalTransform = options.additionalTransform || '',\n          commonPieces = [\n            this.getSvgTransform(true, additionalTransform),\n            this.getSvgCommons(),\n          ].join(''),\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS');\n        objectMarkup[index] = commonPieces;\n        return reviver ? reviver(objectMarkup.join('')) : objectMarkup.join('');\n      },\n\n      /**\n       * @private\n       */\n      _createBaseSVGMarkup: function (objectMarkup, options) {\n        options = options || {};\n        var noStyle = options.noStyle,\n          reviver = options.reviver,\n          styleInfo = noStyle ? '' : 'style=\"' + this.getSvgStyles() + '\" ',\n          shadowInfo = options.withShadow\n            ? 'style=\"' + this.getSvgFilter() + '\" '\n            : '',\n          clipPath = this.clipPath,\n          vectorEffect = this.strokeUniform\n            ? 'vector-effect=\"non-scaling-stroke\" '\n            : '',\n          absoluteClipPath = clipPath && clipPath.absolutePositioned,\n          stroke = this.stroke,\n          fill = this.fill,\n          shadow = this.shadow,\n          commonPieces,\n          markup = [],\n          clipPathMarkup,\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS'),\n          additionalTransform = options.additionalTransform;\n        if (clipPath) {\n          clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n          clipPathMarkup =\n            '<clipPath id=\"' +\n            clipPath.clipPathId +\n            '\" >\\n' +\n            clipPath.toClipPathSVG(reviver) +\n            '</clipPath>\\n';\n        }\n        if (absoluteClipPath) {\n          markup.push('<g ', shadowInfo, this.getSvgCommons(), ' >\\n');\n        }\n        markup.push(\n          '<g ',\n          this.getSvgTransform(false),\n          !absoluteClipPath ? shadowInfo + this.getSvgCommons() : '',\n          ' >\\n'\n        );\n        commonPieces = [\n          styleInfo,\n          vectorEffect,\n          noStyle ? '' : this.addPaintOrder(),\n          ' ',\n          additionalTransform ? 'transform=\"' + additionalTransform + '\" ' : '',\n        ].join('');\n        objectMarkup[index] = commonPieces;\n        if (fill && fill.toLive) {\n          markup.push(fill.toSVG(this));\n        }\n        if (stroke && stroke.toLive) {\n          markup.push(stroke.toSVG(this));\n        }\n        if (shadow) {\n          markup.push(shadow.toSVG(this));\n        }\n        if (clipPath) {\n          markup.push(clipPathMarkup);\n        }\n        markup.push(objectMarkup.join(''));\n        markup.push('</g>\\n');\n        absoluteClipPath && markup.push('</g>\\n');\n        return reviver ? reviver(markup.join('')) : markup.join('');\n      },\n\n      addPaintOrder: function () {\n        return this.paintFirst !== 'fill'\n          ? ' paint-order=\"' + this.paintFirst + '\" '\n          : '';\n      },\n    }\n  );\n})();\n/* _TO_SVG_END_ */\n(function () {\n  var extend = fabric.util.object.extend,\n    originalSet = 'stateProperties';\n\n  /*\n    Depends on `stateProperties`\n  */\n  function saveProps(origin, destination, props) {\n    var tmpObj = {},\n      deep = true;\n    props.forEach(function (prop) {\n      tmpObj[prop] = origin[prop];\n    });\n    extend(origin[destination], tmpObj, deep);\n  }\n\n  function _isEqual(origValue, currentValue, firstPass) {\n    if (origValue === currentValue) {\n      // if the objects are identical, return\n      return true;\n    } else if (Array.isArray(origValue)) {\n      if (\n        !Array.isArray(currentValue) ||\n        origValue.length !== currentValue.length\n      ) {\n        return false;\n      }\n      for (let i = 0, len = origValue.length; i < len; i++) {\n        if (!_isEqual(origValue[i], currentValue[i])) {\n          return false;\n        }\n      }\n      return true;\n    } else if (origValue && typeof origValue === 'object') {\n      var keys = Object.keys(origValue),\n        key;\n      if (\n        !currentValue ||\n        typeof currentValue !== 'object' ||\n        (!firstPass && keys.length !== Object.keys(currentValue).length)\n      ) {\n        return false;\n      }\n      for (let i = 0, len = keys.length; i < len; i++) {\n        key = keys[i];\n        // since clipPath is in the statefull cache list and the clipPath objects\n        // would be iterated as an object, this would lead to possible infinite recursion\n        if (key === 'canvas') {\n          continue;\n        }\n        if (!_isEqual(origValue[key], currentValue[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Returns true if object state (one of its state properties) was changed\n       * @param {String} [propertySet] optional name for the set of property we want to save\n       * @return {Boolean} true if instance' state has changed since `{@link fabric.Object#saveState}` was called\n       */\n      hasStateChanged: function (propertySet) {\n        propertySet = propertySet || originalSet;\n        var dashedPropertySet = '_' + propertySet;\n        if (\n          Object.keys(this[dashedPropertySet]).length < this[propertySet].length\n        ) {\n          return true;\n        }\n        return !_isEqual(this[dashedPropertySet], this, true);\n      },\n\n      /**\n       * Saves state of an object\n       * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n       * @return {fabric.Object} thisArg\n       */\n      saveState: function (options) {\n        var propertySet = (options && options.propertySet) || originalSet,\n          destination = '_' + propertySet;\n        if (!this[destination]) {\n          return this.setupState(options);\n        }\n        saveProps(this, destination, this[propertySet]);\n        if (options && options.stateProperties) {\n          saveProps(this, destination, options.stateProperties);\n        }\n        return this;\n      },\n\n      /**\n       * Setups state of an object\n       * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n       * @return {fabric.Object} thisArg\n       */\n      setupState: function (options) {\n        options = options || {};\n        var propertySet = options.propertySet || originalSet;\n        options.propertySet = propertySet;\n        this['_' + propertySet] = {};\n        this.saveState(options);\n        return this;\n      },\n    }\n  );\n})();\n\nfabric.util.object.extend(\n  fabric.Object.prototype,\n  /** @lends fabric.Object.prototype */ {\n    /**\n     * Animates object's properties\n     * @param {String|Object} property Property to animate (if string) or properties to animate (if object)\n     * @param {Number|Object} value Value to animate property to (if string was given first) or options object\n     * @return {fabric.Object} thisArg\n     * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#animation}\n     * @chainable\n     *\n     * As object — multiple properties\n     *\n     * object.animate({ left: ..., top: ... });\n     * object.animate({ left: ..., top: ... }, { duration: ... });\n     *\n     * As string — one property\n     *\n     * object.animate('left', ...);\n     * object.animate('left', { duration: ... });\n     *\n     */\n    animate: function () {\n      if (arguments[0] && typeof arguments[0] === 'object') {\n        var propsToAnimate = [],\n          prop,\n          skipCallbacks;\n        for (prop in arguments[0]) {\n          propsToAnimate.push(prop);\n        }\n        for (var i = 0, len = propsToAnimate.length; i < len; i++) {\n          prop = propsToAnimate[i];\n          skipCallbacks = i !== len - 1;\n          this._animate(prop, arguments[0][prop], arguments[1], skipCallbacks);\n        }\n      } else {\n        this._animate.apply(this, arguments);\n      }\n      return this;\n    },\n\n    /**\n     * @private\n     * @param {String} property Property to animate\n     * @param {String} to Value to animate to\n     * @param {Object} [options] Options object\n     * @param {Boolean} [skipCallbacks] When true, callbacks like onchange and oncomplete are not invoked\n     */\n    _animate: function (property, to, options, skipCallbacks) {\n      var _this = this,\n        propPair;\n\n      to = to.toString();\n\n      if (!options) {\n        options = {};\n      } else {\n        options = fabric.util.object.clone(options);\n      }\n\n      if (~property.indexOf('.')) {\n        propPair = property.split('.');\n      }\n\n      var currentValue = propPair\n        ? this.get(propPair[0])[propPair[1]]\n        : this.get(property);\n\n      if (!('from' in options)) {\n        options.from = currentValue;\n      }\n\n      if (~to.indexOf('=')) {\n        to = currentValue + parseFloat(to.replace('=', ''));\n      } else {\n        to = parseFloat(to);\n      }\n\n      fabric.util.animate({\n        startValue: options.from,\n        endValue: to,\n        byValue: options.by,\n        easing: options.easing,\n        duration: options.duration,\n        abort:\n          options.abort &&\n          function () {\n            return options.abort.call(_this);\n          },\n        onChange: function (value, valueProgress, timeProgress) {\n          if (propPair) {\n            _this[propPair[0]][propPair[1]] = value;\n          } else {\n            _this.set(property, value);\n          }\n          if (skipCallbacks) {\n            return;\n          }\n          options.onChange &&\n            options.onChange(value, valueProgress, timeProgress);\n        },\n        onComplete: function (value, valueProgress, timeProgress) {\n          if (skipCallbacks) {\n            return;\n          }\n\n          _this.setCoords();\n          options.onComplete &&\n            options.onComplete(value, valueProgress, timeProgress);\n        },\n      });\n    },\n  }\n);\n(function initGroup(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    min = fabric.util.array.min,\n    max = fabric.util.array.max;\n\n  if (fabric.Group) {\n    return;\n  }\n\n  /**\n   * Group class\n   * @class fabric.Group\n   * @extends fabric.Object\n   * @mixes fabric.Collection\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#groups}\n   * @see {@link fabric.Group#initialize} for constructor definition\n   */\n  fabric.Group = fabric.util.createClass(\n    fabric.Object,\n    fabric.Collection,\n    /** @lends fabric.Group.prototype */ {\n      /**\n       * Type of an object\n       * @type String\n       * @default\n       */\n      type: 'group',\n\n      /**\n       * Width of stroke\n       * @type Number\n       * @default\n       */\n      strokeWidth: 0,\n\n      /**\n       * Indicates if click, mouseover, mouseout events & hoverCursor should also check for subtargets\n       * @type Boolean\n       * @default\n       */\n      subTargetCheck: false,\n\n      /**\n       * Groups are container, do not render anything on theyr own, ence no cache properties\n       * @type Array\n       * @default\n       */\n      cacheProperties: [],\n\n      /**\n       * setOnGroup is a method used for TextBox that is no more used since 2.0.0 The behavior is still\n       * available setting this boolean to true.\n       * @type Boolean\n       * @since 2.0.0\n       * @default\n       */\n      useSetOnGroup: false,\n\n      /**\n       * Constructor\n       * @param {Object} objects Group objects\n       * @param {Object} [options] Options object\n       * @param {Boolean} [isAlreadyGrouped] if true, objects have been grouped already.\n       * @return {Object} thisArg\n       */\n      initialize: function (objects, options, isAlreadyGrouped) {\n        options = options || {};\n        this._objects = [];\n        // if objects enclosed in a group have been grouped already,\n        // we cannot change properties of objects.\n        // Thus we need to set options to group without objects,\n        isAlreadyGrouped && this.callSuper('initialize', options);\n        this._objects = objects || [];\n        for (var i = this._objects.length; i--; ) {\n          this._objects[i].group = this;\n        }\n\n        if (!isAlreadyGrouped) {\n          var center = options && options.centerPoint;\n          // we want to set origins before calculating the bounding box.\n          // so that the topleft can be set with that in mind.\n          // if specific top and left are passed, are overwritten later\n          // with the callSuper('initialize', options)\n          if (options.originX !== undefined) {\n            this.originX = options.originX;\n          }\n          if (options.originY !== undefined) {\n            this.originY = options.originY;\n          }\n          // if coming from svg i do not want to calc bounds.\n          // i assume width and height are passed along options\n          center || this._calcBounds();\n          this._updateObjectsCoords(center);\n          delete options.centerPoint;\n          this.callSuper('initialize', options);\n        } else {\n          this._updateObjectsACoords();\n        }\n\n        this.setCoords();\n      },\n\n      /**\n       * @private\n       * @param {Boolean} [skipCoordsChange] if true, coordinates of objects enclosed in a group do not change\n       */\n      _updateObjectsACoords: function () {\n        var ignoreZoom = true,\n          skipAbsolute = true;\n        for (var i = this._objects.length; i--; ) {\n          this._objects[i].setCoords(ignoreZoom, skipAbsolute);\n        }\n      },\n\n      /**\n       * @private\n       * @param {Boolean} [skipCoordsChange] if true, coordinates of objects enclosed in a group do not change\n       */\n      _updateObjectsCoords: function (center) {\n        var actualCenter = center || this.getCenterPoint();\n        for (var i = this._objects.length; i--; ) {\n          this._updateObjectCoords(this._objects[i], actualCenter);\n        }\n      },\n\n      /**\n       * @private\n       * @param {Object} object\n       * @param {fabric.Point} center, current center of group.\n       */\n      _updateObjectCoords: function (object, center) {\n        var objectLeft = object.left,\n          objectTop = object.top,\n          ignoreZoom = true,\n          skipAbsolute = true;\n\n        object.set({\n          left: objectLeft - center.x,\n          top: objectTop - center.y,\n        });\n        object.group = this;\n        object.setCoords(ignoreZoom, skipAbsolute);\n      },\n\n      /**\n       * Returns string represenation of a group\n       * @return {String}\n       */\n      toString: function () {\n        return '#<fabric.Group: (' + this.complexity() + ')>';\n      },\n\n      /**\n       * Adds an object to a group; Then recalculates group's dimension, position.\n       * @param {Object} object\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      addWithUpdate: function (object) {\n        this._restoreObjectsState();\n        fabric.util.resetObjectTransform(this);\n        if (object) {\n          this._objects.push(object);\n          object.group = this;\n          object._set('canvas', this.canvas);\n        }\n        this._calcBounds();\n        this._updateObjectsCoords();\n        this.setCoords();\n        this.dirty = true;\n        return this;\n      },\n\n      /**\n       * Removes an object from a group; Then recalculates group's dimension, position.\n       * @param {Object} object\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      removeWithUpdate: function (object) {\n        this._restoreObjectsState();\n        fabric.util.resetObjectTransform(this);\n\n        this.remove(object);\n        this._calcBounds();\n        this._updateObjectsCoords();\n        this.setCoords();\n        this.dirty = true;\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _onObjectAdded: function (object) {\n        this.dirty = true;\n        object.group = this;\n        object._set('canvas', this.canvas);\n      },\n\n      /**\n       * @private\n       */\n      _onObjectRemoved: function (object) {\n        this.dirty = true;\n        delete object.group;\n      },\n\n      /**\n       * @private\n       */\n      _set: function (key, value) {\n        var i = this._objects.length;\n        if (this.useSetOnGroup) {\n          while (i--) {\n            this._objects[i].setOnGroup(key, value);\n          }\n        }\n        if (key === 'canvas') {\n          while (i--) {\n            this._objects[i]._set(key, value);\n          }\n        }\n        fabric.Object.prototype._set.call(this, key, value);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var _includeDefaultValues = this.includeDefaultValues;\n        var objsToObject = this._objects.map(function (obj) {\n          var originalDefaults = obj.includeDefaultValues;\n          obj.includeDefaultValues = _includeDefaultValues;\n          var _obj = obj.toObject(propertiesToInclude);\n          obj.includeDefaultValues = originalDefaults;\n          return _obj;\n        });\n        var obj = fabric.Object.prototype.toObject.call(\n          this,\n          propertiesToInclude\n        );\n        obj.objects = objsToObject;\n        return obj;\n      },\n\n      /**\n       * Returns object representation of an instance, in dataless mode.\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        var objsToObject,\n          sourcePath = this.sourcePath;\n        if (sourcePath) {\n          objsToObject = sourcePath;\n        } else {\n          var _includeDefaultValues = this.includeDefaultValues;\n          objsToObject = this._objects.map(function (obj) {\n            var originalDefaults = obj.includeDefaultValues;\n            obj.includeDefaultValues = _includeDefaultValues;\n            var _obj = obj.toDatalessObject(propertiesToInclude);\n            obj.includeDefaultValues = originalDefaults;\n            return _obj;\n          });\n        }\n        var obj = fabric.Object.prototype.toDatalessObject.call(\n          this,\n          propertiesToInclude\n        );\n        obj.objects = objsToObject;\n        return obj;\n      },\n\n      /**\n       * Renders instance on a given context\n       * @param {CanvasRenderingContext2D} ctx context to render instance on\n       */\n      render: function (ctx) {\n        this._transformDone = true;\n        this.callSuper('render', ctx);\n        this._transformDone = false;\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group is already cached.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        var ownCache = fabric.Object.prototype.shouldCache.call(this);\n        if (ownCache) {\n          for (var i = 0, len = this._objects.length; i < len; i++) {\n            if (this._objects[i].willDrawShadow()) {\n              this.ownCaching = false;\n              return false;\n            }\n          }\n        }\n        return ownCache;\n      },\n\n      /**\n       * Check if this object or a child object will cast a shadow\n       * @return {Boolean}\n       */\n      willDrawShadow: function () {\n        if (fabric.Object.prototype.willDrawShadow.call(this)) {\n          return true;\n        }\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          if (this._objects[i].willDrawShadow()) {\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Check if this group or its parent group are caching, recursively up\n       * @return {Boolean}\n       */\n      isOnACache: function () {\n        return this.ownCaching || (this.group && this.group.isOnACache());\n      },\n\n      /**\n       * Execute the drawing operation for an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawObject: function (ctx) {\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          this._objects[i].render(ctx);\n        }\n        this._drawClipPath(ctx);\n      },\n\n      /**\n       * Check if cache is dirty\n       */\n      isCacheDirty: function (skipCanvas) {\n        if (this.callSuper('isCacheDirty', skipCanvas)) {\n          return true;\n        }\n        if (!this.statefullCache) {\n          return false;\n        }\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          if (this._objects[i].isCacheDirty(true)) {\n            if (this._cacheCanvas) {\n              // if this group has not a cache canvas there is nothing to clean\n              var x = this.cacheWidth / this.zoomX,\n                y = this.cacheHeight / this.zoomY;\n              this._cacheContext.clearRect(-x / 2, -y / 2, x, y);\n            }\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Retores original state of each of group objects (original state is that which was before group was created).\n       * @private\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      _restoreObjectsState: function () {\n        this._objects.forEach(this._restoreObjectState, this);\n        return this;\n      },\n\n      /**\n       * Realises the transform from this group onto the supplied object\n       * i.e. it tells you what would happen if the supplied object was in\n       * the group, and then the group was destroyed. It mutates the supplied\n       * object.\n       * @param {fabric.Object} object\n       * @return {fabric.Object} transformedObject\n       */\n      realizeTransform: function (object) {\n        var matrix = object.calcTransformMatrix(),\n          options = fabric.util.qrDecompose(matrix),\n          center = new fabric.Point(options.translateX, options.translateY);\n        object.flipX = false;\n        object.flipY = false;\n        object.set('scaleX', options.scaleX);\n        object.set('scaleY', options.scaleY);\n        object.skewX = options.skewX;\n        object.skewY = options.skewY;\n        object.angle = options.angle;\n        object.setPositionByOrigin(center, 'center', 'center');\n        return object;\n      },\n\n      /**\n       * Restores original state of a specified object in group\n       * @private\n       * @param {fabric.Object} object\n       * @return {fabric.Group} thisArg\n       */\n      _restoreObjectState: function (object) {\n        this.realizeTransform(object);\n        object.setCoords();\n        delete object.group;\n        return this;\n      },\n\n      /**\n       * Destroys a group (restoring state of its objects)\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      destroy: function () {\n        // when group is destroyed objects needs to get a repaint to be eventually\n        // displayed on canvas.\n        this._objects.forEach(function (object) {\n          object.set('dirty', true);\n        });\n        return this._restoreObjectsState();\n      },\n\n      /**\n       * make a group an active selection, remove the group from canvas\n       * the group has to be on canvas for this to work.\n       * @return {fabric.ActiveSelection} thisArg\n       * @chainable\n       */\n      toActiveSelection: function () {\n        if (!this.canvas) {\n          return;\n        }\n        var objects = this._objects,\n          canvas = this.canvas;\n        this._objects = [];\n        var options = this.toObject();\n        delete options.objects;\n        var activeSelection = new fabric.ActiveSelection([]);\n        activeSelection.set(options);\n        activeSelection.type = 'activeSelection';\n        canvas.remove(this);\n        objects.forEach(function (object) {\n          object.group = activeSelection;\n          object.dirty = true;\n          canvas.add(object);\n        });\n        activeSelection.canvas = canvas;\n        activeSelection._objects = objects;\n        canvas._activeObject = activeSelection;\n        activeSelection.setCoords();\n        return activeSelection;\n      },\n\n      /**\n       * Destroys a group (restoring state of its objects)\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      ungroupOnCanvas: function () {\n        return this._restoreObjectsState();\n      },\n\n      /**\n       * Sets coordinates of all objects inside group\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      setObjectsCoords: function () {\n        var ignoreZoom = true,\n          skipAbsolute = true;\n        this.forEachObject(function (object) {\n          object.setCoords(ignoreZoom, skipAbsolute);\n        });\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _calcBounds: function (onlyWidthHeight) {\n        var aX = [],\n          aY = [],\n          o,\n          prop,\n          props = ['tr', 'br', 'bl', 'tl'],\n          i = 0,\n          iLen = this._objects.length,\n          j,\n          jLen = props.length,\n          ignoreZoom = true;\n\n        for (; i < iLen; ++i) {\n          o = this._objects[i];\n          o.setCoords(ignoreZoom);\n          for (j = 0; j < jLen; j++) {\n            prop = props[j];\n            aX.push(o.oCoords[prop].x);\n            aY.push(o.oCoords[prop].y);\n          }\n        }\n\n        this._getBounds(aX, aY, onlyWidthHeight);\n      },\n\n      /**\n       * @private\n       */\n      _getBounds: function (aX, aY, onlyWidthHeight) {\n        var minXY = new fabric.Point(min(aX), min(aY)),\n          maxXY = new fabric.Point(max(aX), max(aY)),\n          top = minXY.y || 0,\n          left = minXY.x || 0,\n          width = maxXY.x - minXY.x || 0,\n          height = maxXY.y - minXY.y || 0;\n        this.width = width;\n        this.height = height;\n        if (!onlyWidthHeight) {\n          // the bounding box always finds the topleft most corner.\n          // whatever is the group origin, we set up here the left/top position.\n          this.setPositionByOrigin({ x: left, y: top }, 'left', 'top');\n        }\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * Returns svg representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      _toSVG: function (reviver) {\n        var svgString = ['<g ', 'COMMON_PARTS', ' >\\n'];\n\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          svgString.push('\\t\\t', this._objects[i].toSVG(reviver));\n        }\n        svgString.push('</g>\\n');\n        return svgString;\n      },\n\n      /**\n       * Returns styles-string for svg-export, specific version for group\n       * @return {String}\n       */\n      getSvgStyles: function () {\n        var opacity =\n            typeof this.opacity !== 'undefined' && this.opacity !== 1\n              ? 'opacity: ' + this.opacity + ';'\n              : '',\n          visibility = this.visible ? '' : ' visibility: hidden;';\n        return [opacity, this.getSvgFilter(), visibility].join('');\n      },\n\n      /**\n       * Returns svg clipPath representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toClipPathSVG: function (reviver) {\n        var svgString = [];\n\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          svgString.push('\\t', this._objects[i].toClipPathSVG(reviver));\n        }\n\n        return this._createBaseClipPathSVGMarkup(svgString, {\n          reviver: reviver,\n        });\n      },\n      /* _TO_SVG_END_ */\n    }\n  );\n\n  /**\n   * Returns {@link fabric.Group} instance from an object representation\n   * @static\n   * @memberOf fabric.Group\n   * @param {Object} object Object to create a group from\n   * @param {Function} [callback] Callback to invoke when an group instance is created\n   */\n  fabric.Group.fromObject = function (object, callback) {\n    var objects = object.objects,\n      options = fabric.util.object.clone(object, true);\n    delete options.objects;\n    if (typeof objects === 'string') {\n      // it has to be an url or something went wrong.\n      fabric.loadSVGFromURL(objects, function (elements) {\n        var group = fabric.util.groupSVGElements(elements, object, objects);\n        group.set(options);\n        callback && callback(group);\n      });\n      return;\n    }\n    fabric.util.enlivenObjects(objects, function (enlivenedObjects) {\n      fabric.util.enlivenObjects([object.clipPath], function (enlivedClipPath) {\n        var options = fabric.util.object.clone(object, true);\n        options.clipPath = enlivedClipPath[0];\n        delete options.objects;\n        callback && callback(new fabric.Group(enlivenedObjects, options, true));\n      });\n    });\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initImageClass(global) {\n  var extend = fabric.util.object.extend;\n\n  if (!global.fabric) {\n    global.fabric = {};\n  }\n\n  if (global.fabric.Image) {\n    fabric.warn('fabric.Image is already defined.');\n    return;\n  }\n\n  /**\n   * Image class\n   * @class fabric.Image\n   * @extends fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#images}\n   * @see {@link fabric.Image#initialize} for constructor definition\n   */\n  fabric.Image = fabric.util.createClass(\n    fabric.Object,\n    /** @lends fabric.Image.prototype */ {\n      /**\n       * Type of an object\n       * @type String\n       * @default\n       */\n      type: 'image',\n\n      /**\n       * crossOrigin value (one of \"\", \"anonymous\", \"use-credentials\")\n       * @see https://developer.mozilla.org/en-US/docs/HTML/CORS_settings_attributes\n       * @type String\n       * @default\n       */\n      crossOrigin: '',\n\n      /**\n       * Width of a stroke.\n       * For image quality a stroke multiple of 2 gives better results.\n       * @type Number\n       * @default\n       */\n      strokeWidth: 0,\n\n      /**\n       * When calling {@link fabric.Image.getSrc}, return value from element src with `element.getAttribute('src')`.\n       * This allows for relative urls as image src.\n       * @since 2.7.0\n       * @type Boolean\n       * @default\n       */\n      srcFromAttribute: false,\n\n      /**\n       * private\n       * contains last value of scaleX to detect\n       * if the Image got resized after the last Render\n       * @type Number\n       */\n      _lastScaleX: 1,\n\n      /**\n       * private\n       * contains last value of scaleY to detect\n       * if the Image got resized after the last Render\n       * @type Number\n       */\n      _lastScaleY: 1,\n\n      /**\n       * private\n       * contains last value of scaling applied by the apply filter chain\n       * @type Number\n       */\n      _filterScalingX: 1,\n\n      /**\n       * private\n       * contains last value of scaling applied by the apply filter chain\n       * @type Number\n       */\n      _filterScalingY: 1,\n\n      /**\n       * minimum scale factor under which any resizeFilter is triggered to resize the image\n       * 0 will disable the automatic resize. 1 will trigger automatically always.\n       * number bigger than 1 are not implemented yet.\n       * @type Number\n       */\n      minimumScaleTrigger: 0.5,\n\n      /**\n       * List of properties to consider when checking if\n       * state of an object is changed ({@link fabric.Object#hasStateChanged})\n       * as well as for history (undo/redo) purposes\n       * @type Array\n       */\n      stateProperties: fabric.Object.prototype.stateProperties.concat(\n        'cropX',\n        'cropY'\n      ),\n\n      /**\n       * key used to retrieve the texture representing this image\n       * @since 2.0.0\n       * @type String\n       * @default\n       */\n      cacheKey: '',\n\n      /**\n       * Image crop in pixels from original image size.\n       * @since 2.0.0\n       * @type Number\n       * @default\n       */\n      cropX: 0,\n\n      /**\n       * Image crop in pixels from original image size.\n       * @since 2.0.0\n       * @type Number\n       * @default\n       */\n      cropY: 0,\n\n      /**\n       * Constructor\n       * @param {HTMLImageElement | String} element Image element\n       * @param {Object} [options] Options object\n       * @param {function} [callback] callback function to call after eventual filters applied.\n       * @return {fabric.Image} thisArg\n       */\n      initialize: function (element, options) {\n        options || (options = {});\n        this.filters = [];\n        this.cacheKey = 'texture' + fabric.Object.__uid++;\n        this.callSuper('initialize', options);\n        this._initElement(element, options);\n      },\n\n      /**\n       * Returns image element which this instance if based on\n       * @return {HTMLImageElement} Image element\n       */\n      getElement: function () {\n        return this._element || {};\n      },\n\n      /**\n       * Sets image element for this instance to a specified one.\n       * If filters defined they are applied to new image.\n       * You might need to call `canvas.renderAll` and `object.setCoords` after replacing, to render new image and update controls area.\n       * @param {HTMLImageElement} element\n       * @param {Object} [options] Options object\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setElement: function (element, options) {\n        this.removeTexture(this.cacheKey);\n        this.removeTexture(this.cacheKey + '_filtered');\n        this._element = element;\n        this._originalElement = element;\n        this._initConfig(options);\n        if (this.filters.length !== 0) {\n          this.applyFilters();\n        }\n        // resizeFilters work on the already filtered copy.\n        // we need to apply resizeFilters AFTER normal filters.\n        // applyResizeFilters is run more often than normal fiters\n        // and is triggered by user interactions rather than dev code\n        if (this.resizeFilter) {\n          this.applyResizeFilters();\n        }\n        return this;\n      },\n\n      /**\n       * Delete a single texture if in webgl mode\n       */\n      removeTexture: function (key) {\n        var backend = fabric.filterBackend;\n        if (backend && backend.evictCachesForKey) {\n          backend.evictCachesForKey(key);\n        }\n      },\n\n      /**\n       * Delete textures, reference to elements and eventually JSDOM cleanup\n       */\n      dispose: function () {\n        this.removeTexture(this.cacheKey);\n        this.removeTexture(this.cacheKey + '_filtered');\n        this._cacheContext = undefined;\n        ['_originalElement', '_element', '_filteredEl', '_cacheCanvas'].forEach(\n          function (element) {\n            fabric.util.cleanUpJsdomNode(this[element]);\n            this[element] = undefined;\n          }.bind(this)\n        );\n      },\n\n      /**\n       * Sets crossOrigin value (on an instance and corresponding image element)\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setCrossOrigin: function (value) {\n        this.crossOrigin = value;\n        this._element.crossOrigin = value;\n\n        return this;\n      },\n\n      /**\n       * Returns original size of an image\n       * @return {Object} Object with \"width\" and \"height\" properties\n       */\n      getOriginalSize: function () {\n        var element = this.getElement();\n        return {\n          width: element.naturalWidth || element.width,\n          height: element.naturalHeight || element.height,\n        };\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _stroke: function (ctx) {\n        if (!this.stroke || this.strokeWidth === 0) {\n          return;\n        }\n        var w = this.width / 2,\n          h = this.height / 2;\n        ctx.beginPath();\n        ctx.moveTo(-w, -h);\n        ctx.lineTo(w, -h);\n        ctx.lineTo(w, h);\n        ctx.lineTo(-w, h);\n        ctx.lineTo(-w, -h);\n        ctx.closePath();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderDashedStroke: function (ctx) {\n        var x = -this.width / 2,\n          y = -this.height / 2,\n          w = this.width,\n          h = this.height;\n\n        ctx.save();\n        this._setStrokeStyles(ctx, this);\n\n        ctx.beginPath();\n        fabric.util.drawDashedLine(ctx, x, y, x + w, y, this.strokeDashArray);\n        fabric.util.drawDashedLine(\n          ctx,\n          x + w,\n          y,\n          x + w,\n          y + h,\n          this.strokeDashArray\n        );\n        fabric.util.drawDashedLine(\n          ctx,\n          x + w,\n          y + h,\n          x,\n          y + h,\n          this.strokeDashArray\n        );\n        fabric.util.drawDashedLine(ctx, x, y + h, x, y, this.strokeDashArray);\n        ctx.closePath();\n        ctx.restore();\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var filters = [];\n\n        this.filters.forEach(function (filterObj) {\n          if (filterObj) {\n            filters.push(filterObj.toObject());\n          }\n        });\n        var object = extend(\n          this.callSuper(\n            'toObject',\n            ['crossOrigin', 'cropX', 'cropY'].concat(propertiesToInclude)\n          ),\n          {\n            src: this.getSrc(),\n            filters: filters,\n          }\n        );\n        if (this.resizeFilter) {\n          object.resizeFilter = this.resizeFilter.toObject();\n        }\n        return object;\n      },\n\n      /**\n       * Returns true if an image has crop applied, inspecting values of cropX,cropY,width,hight.\n       * @return {Boolean}\n       */\n      hasCrop: function () {\n        return (\n          this.cropX ||\n          this.cropY ||\n          this.width < this._element.width ||\n          this.height < this._element.height\n        );\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * Returns svg representation of an instance\n       * @return {Array} an array of strings with the specific svg representation\n       * of the instance\n       */\n      _toSVG: function () {\n        var svgString = [],\n          imageMarkup = [],\n          strokeSvg,\n          x = -this.width / 2,\n          y = -this.height / 2,\n          clipPath = '';\n        if (this.hasCrop()) {\n          var clipPathId = fabric.Object.__uid++;\n          svgString.push(\n            '<clipPath id=\"imageCrop_' + clipPathId + '\">\\n',\n            '\\t<rect x=\"' +\n              x +\n              '\" y=\"' +\n              y +\n              '\" width=\"' +\n              this.width +\n              '\" height=\"' +\n              this.height +\n              '\" />\\n',\n            '</clipPath>\\n'\n          );\n          clipPath = ' clip-path=\"url(#imageCrop_' + clipPathId + ')\" ';\n        }\n        imageMarkup.push(\n          '\\t<image ',\n          'COMMON_PARTS',\n          'xlink:href=\"',\n          this.getSvgSrc(true),\n          '\" x=\"',\n          x - this.cropX,\n          '\" y=\"',\n          y - this.cropY,\n          // we're essentially moving origin of transformation from top/left corner to the center of the shape\n          // by wrapping it in container <g> element with actual transformation, then offsetting object to the top/left\n          // so that object's center aligns with container's left/top\n          '\" width=\"',\n          this._element.width || this._element.naturalWidth,\n          '\" height=\"',\n          this._element.height || this._element.height,\n          '\"',\n          clipPath,\n          '></image>\\n'\n        );\n\n        if (this.stroke || this.strokeDashArray) {\n          var origFill = this.fill;\n          this.fill = null;\n          strokeSvg = [\n            '\\t<rect ',\n            'x=\"',\n            x,\n            '\" y=\"',\n            y,\n            '\" width=\"',\n            this.width,\n            '\" height=\"',\n            this.height,\n            '\" style=\"',\n            this.getSvgStyles(),\n            '\"/>\\n',\n          ];\n          this.fill = origFill;\n        }\n        if (this.paintFirst !== 'fill') {\n          svgString = svgString.concat(strokeSvg, imageMarkup);\n        } else {\n          svgString = svgString.concat(imageMarkup, strokeSvg);\n        }\n        return svgString;\n      },\n      /* _TO_SVG_END_ */\n\n      /**\n       * Returns source of an image\n       * @param {Boolean} filtered indicates if the src is needed for svg\n       * @return {String} Source of an image\n       */\n      getSrc: function (filtered) {\n        var element = filtered ? this._element : this._originalElement;\n        if (element) {\n          if (element.toDataURL) {\n            return element.toDataURL();\n          }\n\n          if (this.srcFromAttribute) {\n            return element.getAttribute('src');\n          } else {\n            return element.src;\n          }\n        } else {\n          return this.src || '';\n        }\n      },\n\n      /**\n       * Sets source of an image\n       * @param {String} src Source string (URL)\n       * @param {Function} [callback] Callback is invoked when image has been loaded (and all filters have been applied)\n       * @param {Object} [options] Options object\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setSrc: function (src, callback, options) {\n        fabric.util.loadImage(\n          src,\n          function (img) {\n            this.setElement(img, options);\n            this._setWidthHeight();\n            callback && callback(this);\n          },\n          this,\n          options && options.crossOrigin\n        );\n        return this;\n      },\n\n      /**\n       * Returns string representation of an instance\n       * @return {String} String representation of an instance\n       */\n      toString: function () {\n        return '#<fabric.Image: { src: \"' + this.getSrc() + '\" }>';\n      },\n\n      applyResizeFilters: function () {\n        var filter = this.resizeFilter,\n          minimumScale = this.minimumScaleTrigger,\n          objectScale = this.getTotalObjectScaling(),\n          scaleX = objectScale.scaleX,\n          scaleY = objectScale.scaleY,\n          elementToFilter = this._filteredEl || this._originalElement;\n        if (this.group) {\n          this.set('dirty', true);\n        }\n        if (!filter || (scaleX > minimumScale && scaleY > minimumScale)) {\n          this._element = elementToFilter;\n          this._filterScalingX = 1;\n          this._filterScalingY = 1;\n          this._lastScaleX = scaleX;\n          this._lastScaleY = scaleY;\n          return;\n        }\n        if (!fabric.filterBackend) {\n          fabric.filterBackend = fabric.initFilterBackend();\n        }\n        var canvasEl = fabric.util.createCanvasElement(),\n          cacheKey = this._filteredEl\n            ? this.cacheKey + '_filtered'\n            : this.cacheKey,\n          sourceWidth = elementToFilter.width,\n          sourceHeight = elementToFilter.height;\n        canvasEl.width = sourceWidth;\n        canvasEl.height = sourceHeight;\n        this._element = canvasEl;\n        this._lastScaleX = filter.scaleX = scaleX;\n        this._lastScaleY = filter.scaleY = scaleY;\n        fabric.filterBackend.applyFilters(\n          [filter],\n          elementToFilter,\n          sourceWidth,\n          sourceHeight,\n          this._element,\n          cacheKey\n        );\n        this._filterScalingX = canvasEl.width / this._originalElement.width;\n        this._filterScalingY = canvasEl.height / this._originalElement.height;\n      },\n\n      /**\n       * Applies filters assigned to this image (from \"filters\" array) or from filter param\n       * @method applyFilters\n       * @param {Array} filters to be applied\n       * @param {Boolean} forResizing specify if the filter operation is a resize operation\n       * @return {thisArg} return the fabric.Image object\n       * @chainable\n       */\n      applyFilters: function (filters) {\n        filters = filters || this.filters || [];\n        filters = filters.filter(function (filter) {\n          return filter && !filter.isNeutralState();\n        });\n        this.set('dirty', true);\n\n        // needs to clear out or WEBGL will not resize correctly\n        this.removeTexture(this.cacheKey + '_filtered');\n\n        if (filters.length === 0) {\n          this._element = this._originalElement;\n          this._filteredEl = null;\n          this._filterScalingX = 1;\n          this._filterScalingY = 1;\n          return this;\n        }\n\n        var imgElement = this._originalElement,\n          sourceWidth = imgElement.naturalWidth || imgElement.width,\n          sourceHeight = imgElement.naturalHeight || imgElement.height;\n\n        if (this._element === this._originalElement) {\n          // if the element is the same we need to create a new element\n          var canvasEl = fabric.util.createCanvasElement();\n          canvasEl.width = sourceWidth;\n          canvasEl.height = sourceHeight;\n          this._element = canvasEl;\n          this._filteredEl = canvasEl;\n        } else {\n          // clear the existing element to get new filter data\n          // also dereference the eventual resized _element\n          this._element = this._filteredEl;\n          this._filteredEl\n            .getContext('2d')\n            .clearRect(0, 0, sourceWidth, sourceHeight);\n          // we also need to resize again at next renderAll, so remove saved _lastScaleX/Y\n          this._lastScaleX = 1;\n          this._lastScaleY = 1;\n        }\n        if (!fabric.filterBackend) {\n          fabric.filterBackend = fabric.initFilterBackend();\n        }\n        fabric.filterBackend.applyFilters(\n          filters,\n          this._originalElement,\n          sourceWidth,\n          sourceHeight,\n          this._element,\n          this.cacheKey\n        );\n        if (\n          this._originalElement.width !== this._element.width ||\n          this._originalElement.height !== this._element.height\n        ) {\n          this._filterScalingX =\n            this._element.width / this._originalElement.width;\n          this._filterScalingY =\n            this._element.height / this._originalElement.height;\n        }\n        return this;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _render: function (ctx) {\n        if (\n          this.isMoving !== true &&\n          this.resizeFilter &&\n          this._needsResize()\n        ) {\n          this.applyResizeFilters();\n        }\n        this._stroke(ctx);\n        this._renderPaintInOrder(ctx);\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group outside is cached.\n       * This is the special image version where we would like to avoid caching where possible.\n       * Essentially images do not benefit from caching. They may require caching, and in that\n       * case we do it. Also caching an image usually ends in a loss of details.\n       * A full performance audit should be done.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        return this.needsItsOwnCache();\n      },\n\n      _renderFill: function (ctx) {\n        var elementToDraw = this._element,\n          w = this.width,\n          h = this.height,\n          sW = Math.min(\n            elementToDraw.naturalWidth || elementToDraw.width,\n            w * this._filterScalingX\n          ),\n          sH = Math.min(\n            elementToDraw.naturalHeight || elementToDraw.height,\n            h * this._filterScalingY\n          ),\n          x = -w / 2,\n          y = -h / 2,\n          sX = Math.max(0, this.cropX * this._filterScalingX),\n          sY = Math.max(0, this.cropY * this._filterScalingY);\n\n        elementToDraw &&\n          ctx.drawImage(elementToDraw, sX, sY, sW, sH, x, y, w, h);\n      },\n\n      /**\n       * needed to check if image needs resize\n       * @private\n       */\n      _needsResize: function () {\n        var scale = this.getTotalObjectScaling();\n        return (\n          scale.scaleX !== this._lastScaleX || scale.scaleY !== this._lastScaleY\n        );\n      },\n\n      /**\n       * @private\n       */\n      _resetWidthHeight: function () {\n        this.set(this.getOriginalSize());\n      },\n\n      /**\n       * The Image class's initialization method. This method is automatically\n       * called by the constructor.\n       * @private\n       * @param {HTMLImageElement|String} element The element representing the image\n       * @param {Object} [options] Options object\n       */\n      _initElement: function (element, options) {\n        this.setElement(fabric.util.getById(element), options);\n        fabric.util.addClass(this.getElement(), fabric.Image.CSS_CANVAS);\n      },\n\n      /**\n       * @private\n       * @param {Object} [options] Options object\n       */\n      _initConfig: function (options) {\n        options || (options = {});\n        this.setOptions(options);\n        this._setWidthHeight(options);\n        if (this._element && this.crossOrigin) {\n          this._element.crossOrigin = this.crossOrigin;\n        }\n      },\n\n      /**\n       * @private\n       * @param {Array} filters to be initialized\n       * @param {Function} callback Callback to invoke when all fabric.Image.filters instances are created\n       */\n      _initFilters: function (filters, callback) {\n        if (filters && filters.length) {\n          fabric.util.enlivenObjects(\n            filters,\n            function (enlivenedObjects) {\n              callback && callback(enlivenedObjects);\n            },\n            'fabric.Image.filters'\n          );\n        } else {\n          callback && callback();\n        }\n      },\n\n      /**\n       * @private\n       * Set the width and the height of the image object, using the element or the\n       * options.\n       * @param {Object} [options] Object with width/height properties\n       */\n      _setWidthHeight: function (options) {\n        options || (options = {});\n        var el = this.getElement();\n        this.width = options.width || el.naturalWidth || el.width || 0;\n        this.height = options.height || el.naturalHeight || el.height || 0;\n      },\n\n      /**\n       * Calculate offset for center and scale factor for the image in order to respect\n       * the preserveAspectRatio attribute\n       * @private\n       * @return {Object}\n       */\n      parsePreserveAspectRatioAttribute: function () {\n        var pAR = fabric.util.parsePreserveAspectRatioAttribute(\n            this.preserveAspectRatio || ''\n          ),\n          rWidth = this._element.width,\n          rHeight = this._element.height,\n          scaleX = 1,\n          scaleY = 1,\n          offsetLeft = 0,\n          offsetTop = 0,\n          cropX = 0,\n          cropY = 0,\n          offset,\n          pWidth = this.width,\n          pHeight = this.height,\n          parsedAttributes = { width: pWidth, height: pHeight };\n        if (pAR && (pAR.alignX !== 'none' || pAR.alignY !== 'none')) {\n          if (pAR.meetOrSlice === 'meet') {\n            scaleX = scaleY = fabric.util.findScaleToFit(\n              this._element,\n              parsedAttributes\n            );\n            offset = (pWidth - rWidth * scaleX) / 2;\n            if (pAR.alignX === 'Min') {\n              offsetLeft = -offset;\n            }\n            if (pAR.alignX === 'Max') {\n              offsetLeft = offset;\n            }\n            offset = (pHeight - rHeight * scaleY) / 2;\n            if (pAR.alignY === 'Min') {\n              offsetTop = -offset;\n            }\n            if (pAR.alignY === 'Max') {\n              offsetTop = offset;\n            }\n          }\n          if (pAR.meetOrSlice === 'slice') {\n            scaleX = scaleY = fabric.util.findScaleToCover(\n              this._element,\n              parsedAttributes\n            );\n            offset = rWidth - pWidth / scaleX;\n            if (pAR.alignX === 'Mid') {\n              cropX = offset / 2;\n            }\n            if (pAR.alignX === 'Max') {\n              cropX = offset;\n            }\n            offset = rHeight - pHeight / scaleY;\n            if (pAR.alignY === 'Mid') {\n              cropY = offset / 2;\n            }\n            if (pAR.alignY === 'Max') {\n              cropY = offset;\n            }\n            rWidth = pWidth / scaleX;\n            rHeight = pHeight / scaleY;\n          }\n        } else {\n          scaleX = pWidth / rWidth;\n          scaleY = pHeight / rHeight;\n        }\n        return {\n          width: rWidth,\n          height: rHeight,\n          scaleX: scaleX,\n          scaleY: scaleY,\n          offsetLeft: offsetLeft,\n          offsetTop: offsetTop,\n          cropX: cropX,\n          cropY: cropY,\n        };\n      },\n    }\n  );\n\n  /**\n   * Default CSS class name for canvas\n   * @static\n   * @type String\n   * @default\n   */\n  fabric.Image.CSS_CANVAS = 'canvas-img';\n\n  /**\n   * Alias for getSrc\n   * @static\n   */\n  fabric.Image.prototype.getSvgSrc = fabric.Image.prototype.getSrc;\n\n  /**\n   * Creates an instance of fabric.Image from its object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} callback Callback to invoke when an image instance is created\n   */\n  fabric.Image.fromObject = function (_object, callback) {\n    var object = fabric.util.object.clone(_object);\n    fabric.util.loadImage(\n      object.src,\n      function (img, error) {\n        if (error) {\n          callback && callback(null, error);\n          return;\n        }\n        fabric.Image.prototype._initFilters.call(\n          object,\n          object.filters,\n          function (filters) {\n            object.filters = filters || [];\n            fabric.Image.prototype._initFilters.call(\n              object,\n              [object.resizeFilter],\n              function (resizeFilters) {\n                object.resizeFilter = resizeFilters[0];\n                fabric.util.enlivenObjects([object.clipPath], function (\n                  enlivedProps\n                ) {\n                  object.clipPath = enlivedProps[0];\n                  var image = new fabric.Image(img, object);\n                  callback(image);\n                });\n              }\n            );\n          }\n        );\n      },\n      null,\n      object.crossOrigin\n    );\n  };\n\n  /**\n   * Creates an instance of fabric.Image from an URL string\n   * @static\n   * @param {String} url URL to create an image from\n   * @param {Function} [callback] Callback to invoke when image is created (newly created image is passed as a first argument)\n   * @param {Object} [imgOptions] Options object\n   */\n  fabric.Image.fromURL = function (url, callback, imgOptions) {\n    fabric.util.loadImage(\n      url,\n      function (img) {\n        callback && callback(new fabric.Image(img, imgOptions));\n      },\n      null,\n      imgOptions && imgOptions.crossOrigin\n    );\n  };\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Image.fromElement})\n   * @static\n   * @see {@link http://www.w3.org/TR/SVG/struct.html#ImageElement}\n   */\n  fabric.Image.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(\n    'x y width height preserveAspectRatio xlink:href crossOrigin'.split(' ')\n  );\n\n  /**\n   * Returns {@link fabric.Image} instance from an SVG element\n   * @static\n   * @param {SVGElement} element Element to parse\n   * @param {Object} [options] Options object\n   * @param {Function} callback Callback to execute when fabric.Image object is created\n   * @return {fabric.Image} Instance of fabric.Image\n   */\n  fabric.Image.fromElement = function (element, callback, options) {\n    var parsedAttributes = fabric.parseAttributes(\n      element,\n      fabric.Image.ATTRIBUTE_NAMES\n    );\n    fabric.Image.fromURL(\n      parsedAttributes['xlink:href'],\n      callback,\n      extend(options ? fabric.util.object.clone(options) : {}, parsedAttributes)\n    );\n  };\n  /* _FROM_SVG_END_ */\n})(typeof exports !== 'undefined' ? exports : this);\n(function initTestWebGL() {\n  /**\n   * Tests if webgl supports certain precision\n   * @param {WebGL} Canvas WebGL context to test on\n   * @param {String} Precision to test can be any of following: 'lowp', 'mediump', 'highp'\n   * @returns {Boolean} Whether the user's browser WebGL supports given precision.\n   */\n  function testPrecision(gl, precision) {\n    var fragmentSource = 'precision ' + precision + ' float;\\nvoid main(){}';\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentSource);\n    gl.compileShader(fragmentShader);\n    if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Indicate whether this filtering backend is supported by the user's browser.\n   * @param {Number} tileSize check if the tileSize is supported\n   * @returns {Boolean} Whether the user's browser supports WebGL.\n   */\n  fabric.isWebglSupported = function (tileSize) {\n    if (fabric.isLikelyNode) {\n      return false;\n    }\n    tileSize = tileSize || fabric.WebglFilterBackend.prototype.tileSize;\n    var canvas = document.createElement('canvas');\n    var gl =\n      canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    var isSupported = false;\n    // eslint-disable-next-line\n    if (gl) {\n      fabric.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n      isSupported = fabric.maxTextureSize >= tileSize;\n      var precisions = ['highp', 'mediump', 'lowp'];\n      for (var i = 0; i < 3; i++) {\n        if (testPrecision(gl, precisions[i])) {\n          fabric.webGlPrecision = precisions[i];\n          break;\n        }\n      }\n    }\n    this.isSupported = isSupported;\n    return isSupported;\n  };\n\n  fabric.WebglFilterBackend = WebglFilterBackend;\n\n  /**\n   * WebGL filter backend.\n   */\n  function WebglFilterBackend(options) {\n    if (options && options.tileSize) {\n      this.tileSize = options.tileSize;\n    }\n    this.setupGLContext(this.tileSize, this.tileSize);\n    this.captureGPUInfo();\n  }\n\n  WebglFilterBackend.prototype = /** @lends fabric.WebglFilterBackend.prototype */ {\n    tileSize: 2048,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you problably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {},\n\n    /**\n     * Setup a WebGL context suitable for filtering, and bind any needed event handlers.\n     */\n    setupGLContext: function (width, height) {\n      this.dispose();\n      this.createWebGLCanvas(width, height);\n      // eslint-disable-next-line\n      this.aPosition = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\n      this.chooseFastestCopyGLTo2DMethod(width, height);\n    },\n\n    /**\n     * Pick a method to copy data from GL context to 2d canvas.  In some browsers using\n     * putImageData is faster than drawImage for that specific operation.\n     */\n    chooseFastestCopyGLTo2DMethod: function (width, height) {\n      var canMeasurePerf = typeof window.performance !== 'undefined',\n        canUseImageData;\n      try {\n        new ImageData(1, 1);\n        canUseImageData = true;\n      } catch (e) {\n        canUseImageData = false;\n      }\n      // eslint-disable-next-line no-undef\n      var canUseArrayBuffer = typeof ArrayBuffer !== 'undefined';\n      // eslint-disable-next-line no-undef\n      var canUseUint8Clamped = typeof Uint8ClampedArray !== 'undefined';\n\n      if (\n        !(\n          canMeasurePerf &&\n          canUseImageData &&\n          canUseArrayBuffer &&\n          canUseUint8Clamped\n        )\n      ) {\n        return;\n      }\n\n      var targetCanvas = fabric.util.createCanvasElement();\n      // eslint-disable-next-line no-undef\n      var imageBuffer = new ArrayBuffer(width * height * 4);\n      if (fabric.forceGLPutImageData) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n        return;\n      }\n      var testContext = {\n        imageBuffer: imageBuffer,\n        destinationWidth: width,\n        destinationHeight: height,\n        targetCanvas: targetCanvas,\n      };\n      var startTime, drawImageTime, putImageDataTime;\n      targetCanvas.width = width;\n      targetCanvas.height = height;\n\n      startTime = window.performance.now();\n      copyGLTo2DDrawImage.call(testContext, this.gl, testContext);\n      drawImageTime = window.performance.now() - startTime;\n\n      startTime = window.performance.now();\n      copyGLTo2DPutImageData.call(testContext, this.gl, testContext);\n      putImageDataTime = window.performance.now() - startTime;\n\n      if (drawImageTime > putImageDataTime) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n      } else {\n        this.copyGLTo2D = copyGLTo2DDrawImage;\n      }\n    },\n\n    /**\n     * Create a canvas element and associated WebGL context and attaches them as\n     * class properties to the GLFilterBackend class.\n     */\n    createWebGLCanvas: function (width, height) {\n      var canvas = fabric.util.createCanvasElement();\n      canvas.width = width;\n      canvas.height = height;\n      var glOptions = {\n          alpha: true,\n          premultipliedAlpha: false,\n          depth: false,\n          stencil: false,\n          antialias: false,\n        },\n        gl = canvas.getContext('webgl', glOptions);\n      if (!gl) {\n        gl = canvas.getContext('experimental-webgl', glOptions);\n      }\n      if (!gl) {\n        return;\n      }\n      gl.clearColor(0, 0, 0, 0);\n      // this canvas can fire webglcontextlost and webglcontextrestored\n      this.canvas = canvas;\n      this.gl = gl;\n    },\n\n    /**\n     * Attempts to apply the requested filters to the source provided, drawing the filtered output\n     * to the provided target canvas.\n     *\n     * @param {Array} filters The filters to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} source The source to be filtered.\n     * @param {Number} width The width of the source input.\n     * @param {Number} height The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     * @param {String|undefined} cacheKey A key used to cache resources related to the source. If\n     * omitted, caching will be skipped.\n     */\n    applyFilters: function (\n      filters,\n      source,\n      width,\n      height,\n      targetCanvas,\n      cacheKey\n    ) {\n      var gl = this.gl;\n      var cachedTexture;\n      if (cacheKey) {\n        cachedTexture = this.getCachedTexture(cacheKey, source);\n      }\n      var pipelineState = {\n        originalWidth: source.width || source.originalWidth,\n        originalHeight: source.height || source.originalHeight,\n        sourceWidth: width,\n        sourceHeight: height,\n        destinationWidth: width,\n        destinationHeight: height,\n        context: gl,\n        sourceTexture: this.createTexture(\n          gl,\n          width,\n          height,\n          !cachedTexture && source\n        ),\n        targetTexture: this.createTexture(gl, width, height),\n        originalTexture:\n          cachedTexture ||\n          this.createTexture(gl, width, height, !cachedTexture && source),\n        passes: filters.length,\n        webgl: true,\n        aPosition: this.aPosition,\n        programCache: this.programCache,\n        pass: 0,\n        filterBackend: this,\n        targetCanvas: targetCanvas,\n      };\n      var tempFbo = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, tempFbo);\n      filters.forEach(function (filter) {\n        filter && filter.applyTo(pipelineState);\n      });\n      resizeCanvasIfNeeded(pipelineState);\n      this.copyGLTo2D(gl, pipelineState);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n      gl.deleteTexture(pipelineState.sourceTexture);\n      gl.deleteTexture(pipelineState.targetTexture);\n      gl.deleteFramebuffer(tempFbo);\n      targetCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n      return pipelineState;\n    },\n\n    /**\n     * Detach event listeners, remove references, and clean up caches.\n     */\n    dispose: function () {\n      if (this.canvas) {\n        this.canvas = null;\n        this.gl = null;\n      }\n      this.clearWebGLCaches();\n    },\n\n    /**\n     * Wipe out WebGL-related caches.\n     */\n    clearWebGLCaches: function () {\n      this.programCache = {};\n      this.textureCache = {};\n    },\n\n    /**\n     * Create a WebGL texture object.\n     *\n     * Accepts specific dimensions to initialize the textuer to or a source image.\n     *\n     * @param {WebGLRenderingContext} gl The GL context to use for creating the texture.\n     * @param {Number} width The width to initialize the texture at.\n     * @param {Number} height The height to initialize the texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source for the texture data.\n     * @returns {WebGLTexture}\n     */\n    createTexture: function (gl, width, height, textureImageSource) {\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      if (textureImageSource) {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          textureImageSource\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          width,\n          height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          null\n        );\n      }\n      return texture;\n    },\n\n    /**\n     * Can be optionally used to get a texture from the cache array\n     *\n     * If an existing texture is not found, a new texture is created and cached.\n     *\n     * @param {String} uniqueId A cache key to use to find an existing texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source to use to create the\n     * texture cache entry if one does not already exist.\n     */\n    getCachedTexture: function (uniqueId, textureImageSource) {\n      if (this.textureCache[uniqueId]) {\n        return this.textureCache[uniqueId];\n      } else {\n        var texture = this.createTexture(\n          this.gl,\n          textureImageSource.width,\n          textureImageSource.height,\n          textureImageSource\n        );\n        this.textureCache[uniqueId] = texture;\n        return texture;\n      }\n    },\n\n    /**\n     * Clear out cached resources related to a source image that has been\n     * filtered previously.\n     *\n     * @param {String} cacheKey The cache key provided when the source image was filtered.\n     */\n    evictCachesForKey: function (cacheKey) {\n      if (this.textureCache[cacheKey]) {\n        this.gl.deleteTexture(this.textureCache[cacheKey]);\n        delete this.textureCache[cacheKey];\n      }\n    },\n\n    copyGLTo2D: copyGLTo2DDrawImage,\n\n    /**\n     * Attempt to extract GPU information strings from a WebGL context.\n     *\n     * Useful information when debugging or blacklisting specific GPUs.\n     *\n     * @returns {Object} A GPU info object with renderer and vendor strings.\n     */\n    captureGPUInfo: function () {\n      if (this.gpuInfo) {\n        return this.gpuInfo;\n      }\n      var gl = this.gl,\n        gpuInfo = { renderer: '', vendor: '' };\n      if (!gl) {\n        return gpuInfo;\n      }\n      var ext = gl.getExtension('WEBGL_debug_renderer_info');\n      if (ext) {\n        var renderer = gl.getParameter(ext.UNMASKED_RENDERER_WEBGL);\n        var vendor = gl.getParameter(ext.UNMASKED_VENDOR_WEBGL);\n        if (renderer) {\n          gpuInfo.renderer = renderer.toLowerCase();\n        }\n        if (vendor) {\n          gpuInfo.vendor = vendor.toLowerCase();\n        }\n      }\n      this.gpuInfo = gpuInfo;\n      return gpuInfo;\n    },\n  };\n})();\n\nfunction resizeCanvasIfNeeded(pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas,\n    width = targetCanvas.width,\n    height = targetCanvas.height,\n    dWidth = pipelineState.destinationWidth,\n    dHeight = pipelineState.destinationHeight;\n\n  if (width !== dWidth || height !== dHeight) {\n    targetCanvas.width = dWidth;\n    targetCanvas.height = dHeight;\n  }\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas.\n *\n * The WebGL canvas is assumed to be upside down, with the top-left pixel of the\n * desired output image appearing in the bottom-left corner of the WebGL canvas.\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DDrawImage(gl, pipelineState) {\n  var glCanvas = gl.canvas,\n    targetCanvas = pipelineState.targetCanvas,\n    ctx = targetCanvas.getContext('2d');\n  ctx.translate(0, targetCanvas.height); // move it down again\n  ctx.scale(1, -1); // vertical flip\n  // where is my image on the big glcanvas?\n  var sourceY = glCanvas.height - targetCanvas.height;\n  ctx.drawImage(\n    glCanvas,\n    0,\n    sourceY,\n    targetCanvas.width,\n    targetCanvas.height,\n    0,\n    0,\n    targetCanvas.width,\n    targetCanvas.height\n  );\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas using 2d canvas' putImageData\n * API. Measurably faster than using ctx.drawImage in Firefox (version 54 on OSX Sierra).\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DPutImageData(gl, pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas,\n    ctx = targetCanvas.getContext('2d'),\n    dWidth = pipelineState.destinationWidth,\n    dHeight = pipelineState.destinationHeight,\n    numBytes = dWidth * dHeight * 4;\n\n  // eslint-disable-next-line no-undef\n  var u8 = new Uint8Array(this.imageBuffer, 0, numBytes);\n  // eslint-disable-next-line no-undef\n  var u8Clamped = new Uint8ClampedArray(this.imageBuffer, 0, numBytes);\n\n  gl.readPixels(0, 0, dWidth, dHeight, gl.RGBA, gl.UNSIGNED_BYTE, u8);\n  var imgData = new ImageData(u8Clamped, dWidth, dHeight);\n  ctx.putImageData(imgData, 0, 0);\n}\n(function initCanvas2dFilterBackend() {\n  var noop = function () {};\n\n  fabric.Canvas2dFilterBackend = Canvas2dFilterBackend;\n\n  /**\n   * Canvas 2D filter backend.\n   */\n  function Canvas2dFilterBackend() {}\n\n  Canvas2dFilterBackend.prototype = /** @lends fabric.Canvas2dFilterBackend.prototype */ {\n    evictCachesForKey: noop,\n    dispose: noop,\n    clearWebGLCaches: noop,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you probably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {},\n\n    /**\n     * Apply a set of filters against a source image and draw the filtered output\n     * to the provided destination canvas.\n     *\n     * @param {EnhancedFilter} filters The filter to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} sourceElement The source to be filtered.\n     * @param {Number} sourceWidth The width of the source input.\n     * @param {Number} sourceHeight The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     */\n    applyFilters: function (\n      filters,\n      sourceElement,\n      sourceWidth,\n      sourceHeight,\n      targetCanvas\n    ) {\n      var ctx = targetCanvas.getContext('2d');\n      ctx.drawImage(sourceElement, 0, 0, sourceWidth, sourceHeight);\n      var imageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var originalImageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var pipelineState = {\n        sourceWidth: sourceWidth,\n        sourceHeight: sourceHeight,\n        imageData: imageData,\n        originalEl: sourceElement,\n        originalImageData: originalImageData,\n        canvasEl: targetCanvas,\n        ctx: ctx,\n        filterBackend: this,\n      };\n      filters.forEach(function (filter) {\n        filter.applyTo(pipelineState);\n      });\n      if (\n        pipelineState.imageData.width !== sourceWidth ||\n        pipelineState.imageData.height !== sourceHeight\n      ) {\n        targetCanvas.width = pipelineState.imageData.width;\n        targetCanvas.height = pipelineState.imageData.height;\n      }\n      ctx.putImageData(pipelineState.imageData, 0, 0);\n      return pipelineState;\n    },\n  };\n})();\n/**\n * @namespace fabric.Image.filters\n * @memberOf fabric.Image\n * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#image_filters}\n * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n */\nfabric.Image = fabric.Image || {};\nfabric.Image.filters = fabric.Image.filters || {};\n\n/**\n * Root filter class from which all filter classes inherit from\n * @class fabric.Image.filters.BaseFilter\n * @memberOf fabric.Image.filters\n */\nfabric.Image.filters.BaseFilter = fabric.util.createClass(\n  /** @lends fabric.Image.filters.BaseFilter.prototype */ {\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'BaseFilter',\n\n    /**\n     * Array of attributes to send with buffers. do not modify\n     * @private\n     */\n\n    vertexSource:\n      'attribute vec2 aPosition;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n      'vTexCoord = aPosition;\\n' +\n      'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n      '}',\n\n    fragmentSource:\n      'precision highp float;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'void main() {\\n' +\n      'gl_FragColor = texture2D(uTexture, vTexCoord);\\n' +\n      '}',\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function (options) {\n      if (options) {\n        this.setOptions(options);\n      }\n    },\n\n    /**\n     * Sets filter's properties from options\n     * @param {Object} [options] Options object\n     */\n    setOptions: function (options) {\n      for (var prop in options) {\n        this[prop] = options[prop];\n      }\n    },\n\n    /**\n     * Compile this filter's shader program.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context to use for shader compilation.\n     * @param {String} fragmentSource fragmentShader source for compilation\n     * @param {String} vertexSource vertexShader source for compilation\n     */\n    createProgram: function (gl, fragmentSource, vertexSource) {\n      fragmentSource = fragmentSource || this.fragmentSource;\n      vertexSource = vertexSource || this.vertexSource;\n      if (fabric.webGlPrecision !== 'highp') {\n        fragmentSource = fragmentSource.replace(\n          /precision highp float/g,\n          'precision ' + fabric.webGlPrecision + ' float'\n        );\n      }\n      var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n      gl.shaderSource(vertexShader, vertexSource);\n      gl.compileShader(vertexShader);\n      if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n        throw new Error(\n          // eslint-disable-next-line prefer-template\n          'Vertex shader compile error for ' +\n            this.type +\n            ': ' +\n            gl.getShaderInfoLog(vertexShader)\n        );\n      }\n\n      var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n      gl.shaderSource(fragmentShader, fragmentSource);\n      gl.compileShader(fragmentShader);\n      if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n        throw new Error(\n          // eslint-disable-next-line prefer-template\n          'Fragment shader compile error for ' +\n            this.type +\n            ': ' +\n            gl.getShaderInfoLog(fragmentShader)\n        );\n      }\n\n      var program = gl.createProgram();\n      gl.attachShader(program, vertexShader);\n      gl.attachShader(program, fragmentShader);\n      gl.linkProgram(program);\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        throw new Error(\n          `Shader link error for \\\\\"\\${this.type}\\\\\" ${gl.getProgramInfoLog(\n            program\n          )}`\n        );\n      }\n\n      var attributeLocations = this.getAttributeLocations(gl, program);\n      var uniformLocations = this.getUniformLocations(gl, program) || {};\n      uniformLocations.uStepW = gl.getUniformLocation(program, 'uStepW');\n      uniformLocations.uStepH = gl.getUniformLocation(program, 'uStepH');\n      return {\n        program: program,\n        attributeLocations: attributeLocations,\n        uniformLocations: uniformLocations,\n      };\n    },\n\n    /**\n     * Return a map of attribute names to WebGLAttributeLocation objects.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {WebGLShaderProgram} program The shader program from which to take attribute locations.\n     * @returns {Object} A map of attribute names to attribute locations.\n     */\n    getAttributeLocations: function (gl, program) {\n      return {\n        aPosition: gl.getAttribLocation(program, 'aPosition'),\n      };\n    },\n\n    /**\n     * Return a map of uniform names to WebGLUniformLocation objects.\n     *\n     * Intended to be overridden by subclasses.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {WebGLShaderProgram} program The shader program from which to take uniform locations.\n     * @returns {Object} A map of uniform names to uniform locations.\n     */\n    getUniformLocations: function (/* gl, program */) {\n      // in case i do not need any special uniform i need to return an empty object\n      return {};\n    },\n\n    /**\n     * Send attribute data from this filter to its shader program on the GPU.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {Object} attributeLocations A map of shader attribute names to their locations.\n     */\n    sendAttributeData: function (gl, attributeLocations, aPositionData) {\n      var attributeLocation = attributeLocations.aPosition;\n      var buffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.enableVertexAttribArray(attributeLocation);\n      gl.vertexAttribPointer(attributeLocation, 2, gl.FLOAT, false, 0, 0);\n      gl.bufferData(gl.ARRAY_BUFFER, aPositionData, gl.STATIC_DRAW);\n    },\n\n    _setupFrameBuffer: function (options) {\n      var gl = options.context,\n        width,\n        height;\n      if (options.passes > 1) {\n        width = options.destinationWidth;\n        height = options.destinationHeight;\n        if (options.sourceWidth !== width || options.sourceHeight !== height) {\n          gl.deleteTexture(options.targetTexture);\n          options.targetTexture = options.filterBackend.createTexture(\n            gl,\n            width,\n            height\n          );\n        }\n        gl.framebufferTexture2D(\n          gl.FRAMEBUFFER,\n          gl.COLOR_ATTACHMENT0,\n          gl.TEXTURE_2D,\n          options.targetTexture,\n          0\n        );\n      } else {\n        // draw last filter on canvas and not to framebuffer.\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.finish();\n      }\n    },\n\n    _swapTextures: function (options) {\n      options.passes--;\n      options.pass++;\n      var temp = options.targetTexture;\n      options.targetTexture = options.sourceTexture;\n      options.sourceTexture = temp;\n    },\n\n    /**\n     * Generic isNeutral implementation for one parameter based filters.\n     * Used only in image applyFilters to discard filters that will not have an effect\n     * on the image\n     * Other filters may need their own verison ( ColorMatrix, HueRotation, gamma, ComposedFilter )\n     * @param {Object} options\n     **/\n    isNeutralState: function (/* options */) {\n      var main = this.mainParameter,\n        _class = fabric.Image.filters[this.type].prototype;\n      if (main) {\n        if (Array.isArray(_class[main])) {\n          for (var i = _class[main].length; i--; ) {\n            if (this[main][i] !== _class[main][i]) {\n              return false;\n            }\n          }\n          return true;\n        } else {\n          return _class[main] === this[main];\n        }\n      } else {\n        return false;\n      }\n    },\n\n    /**\n     * Apply this filter to the input image data provided.\n     *\n     * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyTo: function (options) {\n      if (options.webgl) {\n        this._setupFrameBuffer(options);\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n      } else {\n        this.applyTo2d(options);\n      }\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function (options) {\n      if (!options.programCache.hasOwnProperty(this.type)) {\n        options.programCache[this.type] = this.createProgram(options.context);\n      }\n      return options.programCache[this.type];\n    },\n\n    /**\n     * Apply this filter using webgl.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.originalTexture The texture of the original input image.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyToWebGL: function (options) {\n      var gl = options.context;\n      var shader = this.retrieveShader(options);\n      if (options.pass === 0 && options.originalTexture) {\n        gl.bindTexture(gl.TEXTURE_2D, options.originalTexture);\n      } else {\n        gl.bindTexture(gl.TEXTURE_2D, options.sourceTexture);\n      }\n      gl.useProgram(shader.program);\n      this.sendAttributeData(gl, shader.attributeLocations, options.aPosition);\n\n      gl.uniform1f(shader.uniformLocations.uStepW, 1 / options.sourceWidth);\n      gl.uniform1f(shader.uniformLocations.uStepH, 1 / options.sourceHeight);\n\n      this.sendUniformData(gl, shader.uniformLocations);\n      gl.viewport(0, 0, options.destinationWidth, options.destinationHeight);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    },\n\n    bindAdditionalTexture: function (gl, texture, textureUnit) {\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      // reset active texture to 0 as usual\n      gl.activeTexture(gl.TEXTURE0);\n    },\n\n    unbindAdditionalTexture: function (gl, textureUnit) {\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n      gl.activeTexture(gl.TEXTURE0);\n    },\n\n    getMainParameter: function () {\n      return this[this.mainParameter];\n    },\n\n    setMainParameter: function (value) {\n      this[this.mainParameter] = value;\n    },\n\n    /**\n     * Send uniform data from this filter to its shader program on the GPU.\n     *\n     * Intended to be overridden by subclasses.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {Object} uniformLocations A map of shader uniform names to their locations.\n     */\n    sendUniformData: function (/* gl, uniformLocations */) {\n      // Intentionally left blank.  Override me in subclasses.\n    },\n\n    /**\n     * If needed by a 2d filter, this functions can create an helper canvas to be used\n     * remember that options.targetCanvas is available for use till end of chain.\n     */\n    createHelpLayer: function (options) {\n      if (!options.helpLayer) {\n        var helpLayer = document.createElement('canvas');\n        helpLayer.width = options.sourceWidth;\n        helpLayer.height = options.sourceHeight;\n        options.helpLayer = helpLayer;\n      }\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function () {\n      var object = { type: this.type },\n        mainP = this.mainParameter;\n      if (mainP) {\n        object[mainP] = this[mainP];\n      }\n      return object;\n    },\n\n    /**\n     * Returns a JSON representation of an instance\n     * @return {Object} JSON\n     */\n    toJSON: function () {\n      // delegate, not alias\n      return this.toObject();\n    },\n  }\n);\n\nfabric.Image.filters.BaseFilter.fromObject = function (object, callback) {\n  var filter = new fabric.Image.filters[object.type](object);\n  callback && callback(filter);\n  return filter;\n};\n(function initColorBlendFilter(global) {\n  var fabric = global.fabric,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Color Blend filter class\n   * @class fabric.Image.filter.BlendColor\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendColor = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.Blend.prototype */ {\n      type: 'BlendColor',\n\n      /**\n       * Color to make the blend operation with. default to a reddish color since black or white\n       * gives always strong result.\n       **/\n      color: '#F95C63',\n\n      /**\n       * Blend mode for the filter: one of multiply, add, diff, screen, subtract,\n       * darken, lighten, overlay, exclusion, tint.\n       **/\n      mode: 'multiply',\n\n      /**\n       * alpha value. represent the strength of the blend color operation.\n       **/\n      alpha: 1,\n\n      /**\n       * Fragment source for the Multiply program\n       */\n      fragmentSource: {\n        multiply: 'gl_FragColor.rgb *= uColor.rgb;\\n',\n        screen:\n          'gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\\n',\n        add: 'gl_FragColor.rgb += uColor.rgb;\\n',\n        diff: 'gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\\n',\n        subtract: 'gl_FragColor.rgb -= uColor.rgb;\\n',\n        lighten: 'gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\\n',\n        darken: 'gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\\n',\n        exclusion:\n          'gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\\n',\n        overlay:\n          'if (uColor.r < 0.5) {\\n' +\n          'gl_FragColor.r *= 2.0 * uColor.r;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\\n' +\n          '}\\n' +\n          'if (uColor.g < 0.5) {\\n' +\n          'gl_FragColor.g *= 2.0 * uColor.g;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\\n' +\n          '}\\n' +\n          'if (uColor.b < 0.5) {\\n' +\n          'gl_FragColor.b *= 2.0 * uColor.b;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\\n' +\n          '}\\n',\n        tint:\n          'gl_FragColor.rgb *= (1.0 - uColor.a);\\n' +\n          'gl_FragColor.rgb += uColor.rgb;\\n',\n      },\n\n      /**\n       * build the fragment source for the filters, joining the common part with\n       * the specific one.\n       * @param {String} mode the mode of the filter, a key of this.fragmentSource\n       * @return {String} the source to be compiled\n       * @private\n       */\n      buildSource: function (mode) {\n        return (\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'gl_FragColor = color;\\n' +\n          'if (color.a > 0.0) {\\n' +\n          this.fragmentSource[mode] +\n          '}\\n' +\n          '}'\n        );\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var cacheKey = this.type + '_' + this.mode,\n          shaderSource;\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          shaderSource = this.buildSource(this.mode);\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            shaderSource\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      /**\n       * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n       *\n       * @param {Object} options\n       * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          data = imageData.data,\n          iLen = data.length,\n          tr,\n          tg,\n          tb,\n          r,\n          g,\n          b,\n          source,\n          alpha1 = 1 - this.alpha;\n\n        source = new fabric.Color(this.color).getSource();\n        tr = source[0] * this.alpha;\n        tg = source[1] * this.alpha;\n        tb = source[2] * this.alpha;\n\n        for (var i = 0; i < iLen; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n\n          switch (this.mode) {\n            case 'multiply':\n              data[i] = (r * tr) / 255;\n              data[i + 1] = (g * tg) / 255;\n              data[i + 2] = (b * tb) / 255;\n              break;\n            case 'screen':\n              data[i] = 255 - ((255 - r) * (255 - tr)) / 255;\n              data[i + 1] = 255 - ((255 - g) * (255 - tg)) / 255;\n              data[i + 2] = 255 - ((255 - b) * (255 - tb)) / 255;\n              break;\n            case 'add':\n              data[i] = r + tr;\n              data[i + 1] = g + tg;\n              data[i + 2] = b + tb;\n              break;\n            case 'diff':\n            case 'difference':\n              data[i] = Math.abs(r - tr);\n              data[i + 1] = Math.abs(g - tg);\n              data[i + 2] = Math.abs(b - tb);\n              break;\n            case 'subtract':\n              data[i] = r - tr;\n              data[i + 1] = g - tg;\n              data[i + 2] = b - tb;\n              break;\n            case 'darken':\n              data[i] = Math.min(r, tr);\n              data[i + 1] = Math.min(g, tg);\n              data[i + 2] = Math.min(b, tb);\n              break;\n            case 'lighten':\n              data[i] = Math.max(r, tr);\n              data[i + 1] = Math.max(g, tg);\n              data[i + 2] = Math.max(b, tb);\n              break;\n            case 'overlay':\n              data[i] =\n                tr < 128\n                  ? (2 * r * tr) / 255\n                  : 255 - (2 * (255 - r) * (255 - tr)) / 255;\n              data[i + 1] =\n                tg < 128\n                  ? (2 * g * tg) / 255\n                  : 255 - (2 * (255 - g) * (255 - tg)) / 255;\n              data[i + 2] =\n                tb < 128\n                  ? (2 * b * tb) / 255\n                  : 255 - (2 * (255 - b) * (255 - tb)) / 255;\n              break;\n            case 'exclusion':\n              data[i] = tr + r - (2 * tr * r) / 255;\n              data[i + 1] = tg + g - (2 * tg * g) / 255;\n              data[i + 2] = tb + b - (2 * tb * b) / 255;\n              break;\n            case 'tint':\n              data[i] = tr + r * alpha1;\n              data[i + 1] = tg + g * alpha1;\n              data[i + 2] = tb + b * alpha1;\n              break;\n            default:\n              break;\n          }\n        }\n      },\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uColor: gl.getUniformLocation(program, 'uColor'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        var source = new fabric.Color(this.color).getSource();\n        source[0] = (this.alpha * source[0]) / 255;\n        source[1] = (this.alpha * source[1]) / 255;\n        source[2] = (this.alpha * source[2]) / 255;\n        source[3] = this.alpha;\n        gl.uniform4fv(uniformLocations.uColor, source);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          color: this.color,\n          mode: this.mode,\n          alpha: this.alpha,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendColor} Instance of fabric.Image.filters.BlendColor\n   */\n  fabric.Image.filters.BlendColor.fromObject =\n    fabric.Image.filters.BaseFilter.fromObject;\n})(typeof exports !== 'undefined' ? exports : this);\n(function initImageBlendFilter(global) {\n  var fabric = global.fabric,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Image Blend filter class\n   * @class fabric.Image.filter.BlendImage\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendImage = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.BlendImage.prototype */ {\n      type: 'BlendImage',\n\n      /**\n       * Color to make the blend operation with. default to a reddish color since black or white\n       * gives always strong result.\n       **/\n      image: null,\n\n      /**\n       * Blend mode for the filter: one of multiply, add, diff, screen, subtract,\n       * darken, lighten, overlay, exclusion, tint.\n       **/\n      mode: 'multiply',\n\n      /**\n       * alpha value. represent the strength of the blend image operation.\n       * not implemented.\n       **/\n      alpha: 1,\n\n      vertexSource:\n        'attribute vec2 aPosition;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'varying vec2 vTexCoord2;\\n' +\n        'uniform mat3 uTransformMatrix;\\n' +\n        'void main() {\\n' +\n        'vTexCoord = aPosition;\\n' +\n        'vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\\n' +\n        'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n        '}',\n\n      /**\n       * Fragment source for the Multiply program\n       */\n      fragmentSource: {\n        multiply:\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform sampler2D uImage;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'varying vec2 vTexCoord2;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.rgba *= color2.rgba;\\n' +\n          'gl_FragColor = color;\\n' +\n          '}',\n        mask:\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform sampler2D uImage;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'varying vec2 vTexCoord2;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.a = color2.a;\\n' +\n          'gl_FragColor = color;\\n' +\n          '}',\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var cacheKey = this.type + '_' + this.mode;\n        var shaderSource = this.fragmentSource[this.mode];\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            shaderSource\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      applyToWebGL: function (options) {\n        // load texture to blend.\n        var gl = options.context,\n          texture = this.createTexture(options.filterBackend, this.image);\n        this.bindAdditionalTexture(gl, texture, gl.TEXTURE1);\n        this.callSuper('applyToWebGL', options);\n        this.unbindAdditionalTexture(gl, gl.TEXTURE1);\n      },\n\n      createTexture: function (backend, image) {\n        return backend.getCachedTexture(image.cacheKey, image._element);\n      },\n\n      /**\n       * Calculate a transformMatrix to adapt the image to blend over\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      calculateMatrix: function () {\n        var image = this.image,\n          width = image._element.width,\n          height = image._element.height;\n        return [\n          1 / image.scaleX,\n          0,\n          0,\n          0,\n          1 / image.scaleY,\n          0,\n          -image.left / width,\n          -image.top / height,\n          1,\n        ];\n      },\n\n      /**\n       * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n       *\n       * @param {Object} options\n       * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          resources = options.filterBackend.resources,\n          data = imageData.data,\n          iLen = data.length,\n          width = imageData.width,\n          height = imageData.height,\n          tr,\n          tg,\n          tb,\n          ta,\n          r,\n          g,\n          b,\n          a,\n          canvas1,\n          context,\n          image = this.image,\n          blendData;\n\n        if (!resources.blendImage) {\n          resources.blendImage = fabric.util.createCanvasElement();\n        }\n        canvas1 = resources.blendImage;\n        context = canvas1.getContext('2d');\n        if (canvas1.width !== width || canvas1.height !== height) {\n          canvas1.width = width;\n          canvas1.height = height;\n        } else {\n          context.clearRect(0, 0, width, height);\n        }\n        context.setTransform(\n          image.scaleX,\n          0,\n          0,\n          image.scaleY,\n          image.left,\n          image.top\n        );\n        context.drawImage(image._element, 0, 0, width, height);\n        blendData = context.getImageData(0, 0, width, height).data;\n        for (var i = 0; i < iLen; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n          a = data[i + 3];\n\n          tr = blendData[i];\n          tg = blendData[i + 1];\n          tb = blendData[i + 2];\n          ta = blendData[i + 3];\n\n          switch (this.mode) {\n            case 'multiply':\n              data[i] = (r * tr) / 255;\n              data[i + 1] = (g * tg) / 255;\n              data[i + 2] = (b * tb) / 255;\n              data[i + 3] = (a * ta) / 255;\n              break;\n            case 'mask':\n              data[i + 3] = ta;\n              break;\n            default:\n              break;\n          }\n        }\n      },\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uTransformMatrix: gl.getUniformLocation(program, 'uTransformMatrix'),\n          uImage: gl.getUniformLocation(program, 'uImage'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        var matrix = this.calculateMatrix();\n        gl.uniform1i(uniformLocations.uImage, 1); // texture unit 1.\n        gl.uniformMatrix3fv(uniformLocations.uTransformMatrix, false, matrix);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          image: this.image && this.image.toObject(),\n          mode: this.mode,\n          alpha: this.alpha,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} callback to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendImage} Instance of fabric.Image.filters.BlendImage\n   */\n  fabric.Image.filters.BlendImage.fromObject = function (object, callback) {\n    fabric.Image.fromObject(object.image, function (image) {\n      var options = fabric.util.object.clone(object);\n      options.image = image;\n      callback(new fabric.Image.filters.BlendImage(options));\n    });\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initResizeImageFilter(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    pow = Math.pow,\n    floor = Math.floor,\n    sqrt = Math.sqrt,\n    abs = Math.abs,\n    round = Math.round,\n    sin = Math.sin,\n    ceil = Math.ceil,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Resize image filter class\n   * @class fabric.Image.filters.Resize\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Resize();\n   * object.filters.push(filter);\n   * object.applyFilters(canvas.renderAll.bind(canvas));\n   */\n  filters.Resize = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.Resize.prototype */ {\n      /**\n       * Filter type\n       * @param {String} type\n       * @default\n       */\n      type: 'Resize',\n\n      /**\n       * Resize type\n       * for webgl resizeType is just lanczos, for canvas2d can be:\n       * bilinear, hermite, sliceHack, lanczos.\n       * @param {String} resizeType\n       * @default\n       */\n      resizeType: 'hermite',\n\n      /**\n       * Scale factor for resizing, x axis\n       * @param {Number} scaleX\n       * @default\n       */\n      scaleX: 1,\n\n      /**\n       * Scale factor for resizing, y axis\n       * @param {Number} scaleY\n       * @default\n       */\n      scaleY: 1,\n\n      /**\n       * LanczosLobes parameter for lanczos filter, valid for resizeType lanczos\n       * @param {Number} lanczosLobes\n       * @default\n       */\n      lanczosLobes: 3,\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uDelta: gl.getUniformLocation(program, 'uDelta'),\n          uTaps: gl.getUniformLocation(program, 'uTaps'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        gl.uniform2fv(\n          uniformLocations.uDelta,\n          this.horizontal ? [1 / this.width, 0] : [0, 1 / this.height]\n        );\n        gl.uniform1fv(uniformLocations.uTaps, this.taps);\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var filterWindow = this.getFilterWindow(),\n          cacheKey = this.type + '_' + filterWindow;\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          var fragmentShader = this.generateShader(filterWindow);\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            fragmentShader\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      getFilterWindow: function () {\n        var scale = this.tempScale;\n        return Math.ceil(this.lanczosLobes / scale);\n      },\n\n      getTaps: function () {\n        var lobeFunction = this.lanczosCreate(this.lanczosLobes),\n          scale = this.tempScale,\n          filterWindow = this.getFilterWindow(),\n          taps = new Array(filterWindow);\n        for (var i = 1; i <= filterWindow; i++) {\n          taps[i - 1] = lobeFunction(i * scale);\n        }\n        return taps;\n      },\n\n      /**\n       * Generate vertex and shader sources from the necessary steps numbers\n       * @param {Number} filterWindow\n       */\n      generateShader: function (filterWindow) {\n        var offsets = new Array(filterWindow),\n          fragmentShader = this.fragmentSourceTOP;\n        // filterWindow;\n\n        for (var i = 1; i <= filterWindow; i++) {\n          offsets[i - 1] = i + '.0 * uDelta';\n        }\n\n        fragmentShader += 'uniform float uTaps[' + filterWindow + '];\\n';\n        fragmentShader += 'void main() {\\n';\n        fragmentShader += '  vec4 color = texture2D(uTexture, vTexCoord);\\n';\n        fragmentShader += '  float sum = 1.0;\\n';\n\n        offsets.forEach(function (offset, i) {\n          fragmentShader +=\n            '  color += texture2D(uTexture, vTexCoord + ' +\n            offset +\n            ') * uTaps[' +\n            i +\n            '];\\n';\n          fragmentShader +=\n            '  color += texture2D(uTexture, vTexCoord - ' +\n            offset +\n            ') * uTaps[' +\n            i +\n            '];\\n';\n          fragmentShader += '  sum += 2.0 * uTaps[' + i + '];\\n';\n        });\n        fragmentShader += '  gl_FragColor = color / sum;\\n';\n        fragmentShader += '}';\n        return fragmentShader;\n      },\n\n      fragmentSourceTOP:\n        'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform vec2 uDelta;\\n' +\n        'varying vec2 vTexCoord;\\n',\n\n      /**\n       * Apply the resize filter to the image\n       * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n       *\n       * @param {Object} options\n       * @param {Number} options.passes The number of filters remaining to be executed\n       * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n       * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n       * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      applyTo: function (options) {\n        if (options.webgl) {\n          options.passes++;\n          this.width = options.sourceWidth;\n          this.horizontal = true;\n          this.dW = Math.round(this.width * this.scaleX);\n          this.dH = options.sourceHeight;\n          this.tempScale = this.dW / this.width;\n          this.taps = this.getTaps();\n          options.destinationWidth = this.dW;\n          this._setupFrameBuffer(options);\n          this.applyToWebGL(options);\n          this._swapTextures(options);\n          options.sourceWidth = options.destinationWidth;\n\n          this.height = options.sourceHeight;\n          this.horizontal = false;\n          this.dH = Math.round(this.height * this.scaleY);\n          this.tempScale = this.dH / this.height;\n          this.taps = this.getTaps();\n          options.destinationHeight = this.dH;\n          this._setupFrameBuffer(options);\n          this.applyToWebGL(options);\n          this._swapTextures(options);\n          options.sourceHeight = options.destinationHeight;\n        } else {\n          this.applyTo2d(options);\n        }\n      },\n\n      isNeutralState: function () {\n        return this.scaleX === 1 && this.scaleY === 1;\n      },\n\n      lanczosCreate: function (lobes) {\n        return function (x) {\n          if (x >= lobes || x <= -lobes) {\n            return 0.0;\n          }\n          if (x < 1.1920929e-7 && x > -1.1920929e-7) {\n            return 1.0;\n          }\n          x *= Math.PI;\n          var xx = x / lobes;\n          return ((sin(x) / x) * sin(xx)) / xx;\n        };\n      },\n\n      /**\n       * Applies filter to canvas element\n       * @memberOf fabric.Image.filters.Resize.prototype\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} scaleX\n       * @param {Number} scaleY\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          scaleX = this.scaleX,\n          scaleY = this.scaleY;\n\n        this.rcpScaleX = 1 / scaleX;\n        this.rcpScaleY = 1 / scaleY;\n\n        var oW = imageData.width,\n          oH = imageData.height,\n          dW = round(oW * scaleX),\n          dH = round(oH * scaleY),\n          newData;\n\n        if (this.resizeType === 'sliceHack') {\n          newData = this.sliceByTwo(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'hermite') {\n          newData = this.hermiteFastResize(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'bilinear') {\n          newData = this.bilinearFiltering(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'lanczos') {\n          newData = this.lanczosResize(options, oW, oH, dW, dH);\n        }\n        options.imageData = newData;\n      },\n\n      /**\n       * Filter sliceByTwo\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      sliceByTwo: function (options, oW, oH, dW, dH) {\n        var imageData = options.imageData,\n          mult = 0.5,\n          doneW = false,\n          doneH = false,\n          stepW = oW * mult,\n          stepH = oH * mult,\n          resources = fabric.filterBackend.resources,\n          tmpCanvas,\n          ctx,\n          sX = 0,\n          sY = 0,\n          dX = oW,\n          dY = 0;\n        if (!resources.sliceByTwo) {\n          resources.sliceByTwo = document.createElement('canvas');\n        }\n        tmpCanvas = resources.sliceByTwo;\n        if (tmpCanvas.width < oW * 1.5 || tmpCanvas.height < oH) {\n          tmpCanvas.width = oW * 1.5;\n          tmpCanvas.height = oH;\n        }\n        ctx = tmpCanvas.getContext('2d');\n        ctx.clearRect(0, 0, oW * 1.5, oH);\n        ctx.putImageData(imageData, 0, 0);\n\n        dW = floor(dW);\n        dH = floor(dH);\n\n        while (!doneW || !doneH) {\n          oW = stepW;\n          oH = stepH;\n          if (dW < floor(stepW * mult)) {\n            stepW = floor(stepW * mult);\n          } else {\n            stepW = dW;\n            doneW = true;\n          }\n          if (dH < floor(stepH * mult)) {\n            stepH = floor(stepH * mult);\n          } else {\n            stepH = dH;\n            doneH = true;\n          }\n          ctx.drawImage(tmpCanvas, sX, sY, oW, oH, dX, dY, stepW, stepH);\n          sX = dX;\n          sY = dY;\n          dY += stepH;\n        }\n        return ctx.getImageData(sX, sY, dW, dH);\n      },\n\n      /**\n       * Filter lanczosResize\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      lanczosResize: function (options, oW, oH, dW, dH) {\n        function process(u) {\n          var v, i, weight, idx, a, red, green, blue, alpha, fX, fY;\n          center.x = (u + 0.5) * ratioX;\n          icenter.x = floor(center.x);\n          for (v = 0; v < dH; v++) {\n            center.y = (v + 0.5) * ratioY;\n            icenter.y = floor(center.y);\n            a = 0;\n            red = 0;\n            green = 0;\n            blue = 0;\n            alpha = 0;\n            for (i = icenter.x - range2X; i <= icenter.x + range2X; i++) {\n              if (i < 0 || i >= oW) {\n                continue;\n              }\n              fX = floor(1000 * abs(i - center.x));\n              if (!cacheLanc[fX]) {\n                cacheLanc[fX] = {};\n              }\n              for (var j = icenter.y - range2Y; j <= icenter.y + range2Y; j++) {\n                if (j < 0 || j >= oH) {\n                  continue;\n                }\n                fY = floor(1000 * abs(j - center.y));\n                if (!cacheLanc[fX][fY]) {\n                  cacheLanc[fX][fY] = lanczos(\n                    sqrt(pow(fX * rcpRatioX, 2) + pow(fY * rcpRatioY, 2)) / 1000\n                  );\n                }\n                weight = cacheLanc[fX][fY];\n                if (weight > 0) {\n                  idx = (j * oW + i) * 4;\n                  a += weight;\n                  red += weight * srcData[idx];\n                  green += weight * srcData[idx + 1];\n                  blue += weight * srcData[idx + 2];\n                  alpha += weight * srcData[idx + 3];\n                }\n              }\n            }\n            idx = (v * dW + u) * 4;\n            destData[idx] = red / a;\n            destData[idx + 1] = green / a;\n            destData[idx + 2] = blue / a;\n            destData[idx + 3] = alpha / a;\n          }\n\n          if (++u < dW) {\n            return process(u);\n          } else {\n            return destImg;\n          }\n        }\n\n        var srcData = options.imageData.data,\n          destImg = options.ctx.createImageData(dW, dH),\n          destData = destImg.data,\n          lanczos = this.lanczosCreate(this.lanczosLobes),\n          ratioX = this.rcpScaleX,\n          ratioY = this.rcpScaleY,\n          rcpRatioX = 2 / this.rcpScaleX,\n          rcpRatioY = 2 / this.rcpScaleY,\n          range2X = ceil((ratioX * this.lanczosLobes) / 2),\n          range2Y = ceil((ratioY * this.lanczosLobes) / 2),\n          cacheLanc = {},\n          center = {},\n          icenter = {};\n\n        return process(0);\n      },\n\n      /**\n       * bilinearFiltering\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      bilinearFiltering: function (options, oW, oH, dW, dH) {\n        var a,\n          b,\n          c,\n          d,\n          x,\n          y,\n          i,\n          j,\n          xDiff,\n          yDiff,\n          chnl,\n          color,\n          offset = 0,\n          origPix,\n          ratioX = this.rcpScaleX,\n          ratioY = this.rcpScaleY,\n          w4 = 4 * (oW - 1),\n          img = options.imageData,\n          pixels = img.data,\n          destImage = options.ctx.createImageData(dW, dH),\n          destPixels = destImage.data;\n        for (i = 0; i < dH; i++) {\n          for (j = 0; j < dW; j++) {\n            x = floor(ratioX * j);\n            y = floor(ratioY * i);\n            xDiff = ratioX * j - x;\n            yDiff = ratioY * i - y;\n            origPix = 4 * (y * oW + x);\n\n            for (chnl = 0; chnl < 4; chnl++) {\n              a = pixels[origPix + chnl];\n              b = pixels[origPix + 4 + chnl];\n              c = pixels[origPix + w4 + chnl];\n              d = pixels[origPix + w4 + 4 + chnl];\n              color =\n                a * (1 - xDiff) * (1 - yDiff) +\n                b * xDiff * (1 - yDiff) +\n                c * yDiff * (1 - xDiff) +\n                d * xDiff * yDiff;\n              destPixels[offset++] = color;\n            }\n          }\n        }\n        return destImage;\n      },\n\n      /**\n       * hermiteFastResize\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      hermiteFastResize: function (options, oW, oH, dW, dH) {\n        var ratioW = this.rcpScaleX,\n          ratioH = this.rcpScaleY,\n          ratioWHalf = ceil(ratioW / 2),\n          ratioHHalf = ceil(ratioH / 2),\n          img = options.imageData,\n          data = img.data,\n          img2 = options.ctx.createImageData(dW, dH),\n          data2 = img2.data;\n        for (var j = 0; j < dH; j++) {\n          for (var i = 0; i < dW; i++) {\n            var x2 = (i + j * dW) * 4,\n              weight = 0,\n              weights = 0,\n              weightsAlpha = 0,\n              gxR = 0,\n              gxG = 0,\n              gxB = 0,\n              gxA = 0,\n              centerY = (j + 0.5) * ratioH;\n            for (var yy = floor(j * ratioH); yy < (j + 1) * ratioH; yy++) {\n              var dy = abs(centerY - (yy + 0.5)) / ratioHHalf,\n                centerX = (i + 0.5) * ratioW,\n                w0 = dy * dy;\n              for (var xx = floor(i * ratioW); xx < (i + 1) * ratioW; xx++) {\n                var dx = abs(centerX - (xx + 0.5)) / ratioWHalf,\n                  w = sqrt(w0 + dx * dx);\n                /* eslint-disable max-depth */\n                if (w > 1 && w < -1) {\n                  continue;\n                }\n                //hermite filter\n                weight = 2 * w * w * w - 3 * w * w + 1;\n                if (weight > 0) {\n                  dx = 4 * (xx + yy * oW);\n                  //alpha\n                  gxA += weight * data[dx + 3];\n                  weightsAlpha += weight;\n                  //colors\n                  if (data[dx + 3] < 255) {\n                    weight = (weight * data[dx + 3]) / 250;\n                  }\n                  gxR += weight * data[dx];\n                  gxG += weight * data[dx + 1];\n                  gxB += weight * data[dx + 2];\n                  weights += weight;\n                }\n                /* eslint-enable max-depth */\n              }\n            }\n            data2[x2] = gxR / weights;\n            data2[x2 + 1] = gxG / weights;\n            data2[x2 + 2] = gxB / weights;\n            data2[x2 + 3] = gxA / weightsAlpha;\n          }\n        }\n        return img2;\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          scaleX: this.scaleX,\n          scaleY: this.scaleY,\n          resizeType: this.resizeType,\n          lanczosLobes: this.lanczosLobes,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Resize} Instance of fabric.Image.filters.Resize\n   */\n  fabric.Image.filters.Resize.fromObject =\n    fabric.Image.filters.BaseFilter.fromObject;\n})(typeof exports !== 'undefined' ? exports : this);\n","module.exports = __webpack_public_path__ + \"static/media/chevron_right-18dp.9f30b281.svg\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAABvhJREFUeNrt3U2MnVUdx/HvYaBIM8VWUxlfSAfFUINiSWlCTGtKDCYmwoamMRqjJm67MC582Zi4kQXGNxI3RBNZwKIuNESoFtLaahs1FCQNWMGU17aWFinj1M505ufiOXfuM3duZefb+X6Smzv33tX8c/7P/zznnOcckCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ/xuKIVgpyeRSgEqZMSLtutwQrEiOrcDHgSngMeBBo2KCaOgzwKeBq4CnDEfbLjMES5VjKskPgTuAq4FzwKyRkcmRbE9yX5Jz6SwmeSTJtNFR68kxneR7We7VJF80OjJBkq1JTtSqMage+/sjWfIepGVvA1YzHPIO8KjDuzJBOieA873PF4AJwyITpPMicLT3eaImjWSClFJOAgdqFZkFTltBZIIsd3N9X1XvRU4ZEoEz6QNX0s2c03uXrCDVDLBY/34LcK0hkaokdyY525sHedSoSMMEmUzy295M+okktxsZ2cVi6ZmPx4Cz9av1wOdci6XmEyTJ5iTbgb3Az4A36IZ5bwPeYxNR68lxf5LXkvw0yZYkB2o3629J7m4sHtNJPlVfW20hDQ/z1sWIXwB20s1/bABeA34NbAbWAOsaC8stwDeAdwA/SfJSKeW4Xaw2faJ2o1bRLVBcVb/fBzxSY/N6YxeM7cB1wFrg88CXW68klzeeIDfU5IBuBn2mlPKrJPPA9xuMyXXAFfXi8NZaYY8leaLV1c1NJki9Wm6qN+OpybGWboLwZCllX6MXjePAPN3KgkI3aXor8GO7WG3ZUK+Qg8oB8E7gm0m2tRiQWiGOAH8dqarX2MVqz2a6jRnSS5AJuu1+ziWZLKU83OgF87KRzxdbfnisuQSpk3931i7VuAayE5hIcr7BrtZ6uv3ASr14zNWKYgVpyDSw9U3+97uAM0lOl1KONhSbNcBCraYzwLeAX5ogbdnEcEj3X9kJHGL504b/716uN+nPA08CD7Q+D9JigizQTQD27z/GWQvsTLKvoUbyFPA14FnggBtXNKguo3ixt7R9VP+7U0nuaCg2k4OXLWV4U9qaw3Qz5Sdrd2Jx5PfBDeqgimxuJTCllJnBy9Rou4pMJ9mR5EtJnklycUwVGVSSh124p5aT5cYk99ZEOZtkrpcoC0neSLLLbodaTpLJurv7rUkOj1STuSQPJJkyUu1xVxOWllnMACeT/A64ieHuJqEb/pRU70/29O5BDtXjEexiWUFUSjme5H66h6fWAXsbXt1rezAEl74vGemCSZIkSZIkSZIkSZIkSZIkSZL+bVzufglJNtMdJANwpJRy0qhIwwS5N8lskheSfNsnCqXlCfJ4b+OG3yS50ai0x2OgL61/LsZNwCcNiQkilh63neh9NQm813PTTRB1NtCd1TcwR3e4zi2GxgQRvI/hEQmh2/1lCviYoTFBBNez8iiyK+kOmJEJ0rwphuenDywalva4cdx419BNopaRBDllaKwggtNjkmMeeM7QmCCCY3QbVgeYBf4O7Ab+aGjsYgl+DmwEPlwT5RfAS6WUg4amLS5WHCPJKuBd9eNcKeUVoyJJkiRJkvQf5ChWo5JsX2oEHjEnrUiQe+rTkg8m2WZEpOUJ8oOaIPNJ9ib5rFFZyZn0dj0HPA7cDNwGrElyvpSy29CYIIL76NbiXQF8iO5pyV1JXgcOAR8AVtOtRXvak37ValfrK0mO1+7WxSS/T7Kn7upypr7fU/cJk5pMkoeSLGa5xSQL9e9/JPlRi7FxuXvXQCYHr0ZDsA+4OPLdHN00QOgeN35/i7u6lMYTYyOwHthE97z5EeBAa/3tuinefuDt/a977SPAGWBLKeW4l9R2qsauJK8kOZ3kQpInkny9xStlkv21SzXa1Rp4yH3B2moQW5Ic7vWzB2aTHEyyo7F47EjynSSv1iTpJ8pMkrtbbCctD/NuBG4Ycx92FfAR4M90j9m20dcuZXeSPwAv0M2NfBC4GjgBPAl818tqW1fMr9bRmUt1KV5udcPq2v2cqq+md7VvuYKsfpPfp4C7gKOtBaYOUjgxSNvDvPN02/mU+r44JjYf9VwQE6RVk3TDl6lxKGOS5Fq6jaxlF6tJEwzH+kd3UgRYZxOxgrTq3SNdq4ypIE/TbRonE6Q56+mWUFxgOGtcet2ueeAvzhybIK0q9f+fGakiC/W354E9NhHvQVr1J+B24BlgW60kF+v3B4FngcM2kbY1u1ixt2nBJrqHgq6vVeMYcMgHhCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ/3X+CWYLDJCcVFCCAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/lineart.39ddec09.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAclJREFUeNrt2r/LTnEYx/HryPgsTIrBYLBYTRSDyV9gtvoHjMpgk9EfYBFGu4EMlJTZjwwGyVNE+fE23Hc9jwwok/v1Ws45ne1Tn66+1zkzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwzywi+Fl1YmYOrR8fLsvyQiqwKsdWdaV6Xz2vLkoFdgpypHpUfW/laXVeMrBTkJf97FV1udovITa9IAequ/3qdXVJQptnrwh2LMvypro3M/tm5vjM7Fm/OjgzZ6uZmZvLsjyTFps8SU5Ut6qv6wnyZX19W91Yb7pgo0tysrq9Lsb36vP6fru6VG1JiU0vyanq+q4J8qn6Vj2ozkgIJVlNkie7Duxfqg/VBVMEViW5Wr3b9X3kY3W/OiWd/5st1p+5NjPbM3N6Zo7Nast1VCz/P/9i/d0kOTwz52a19t2emTvLsjyWDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwOz8A+z4Ss9550f4AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAfxJREFUeNrt27+rT3EcBvDnIAbXJLkDuumWkoGyKspqu4NZBpu/gEH5C6wmk8WoTCaD0h0xKJlZlOl29X0M9+h+L+Iipe95vaZzPuNTT+/P5/xIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAID/1yCCP9d2Kcn58fbTMAzrUoHtgqy2fdj2fdtbElk8e0TwV1aTnE1yOMkpcSgIOx1NciTJLMlBcSgIOx2au94Qh4KAgrCrA/pSknNJDow5Hm97QTKwVZCLbd9222bbe21XpGOCTL0cK0kuJTkxt7w3yVqSKxJSkKk7luTqN/kNSZaTnBGPgkzd9SQn8/2XCLOxJCyIfSL47e3VkySXxy3Vj7yWkgkyyXNH28e/KMeHJC+lxRQLcrftRn/u1fj4FxNkMsVYansjybUk+78uJ/mY5FmSzbm1NxJjagVZbvt8bkrM2q6PW67TbZ/OvQe5IzGH9En3ZZwSN4dheDcW6MHcueOFiBaLH6Z2scVKcjtbn5V8TvJoGIb7kgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAf+MLY8y7iYFLHuwAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAvhJREFUeNrt3btqVUEUBuA13iBgY6dokSZWYmMt2Nn7BKl8AsHKMmCeQIiFtvoKFmqRQsTGxhsBEQzEJqioMcnJssiOHPQk8dyQPfv74EAuMCGL+bNm9t4nEwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABdV5SAf5WZc78nTinvVISuB2I+M59k5mpmfsvMn5m5mZm95rWdmS/7gwOd6BSZ+SAz15oQHGYnM19l5rzq0YWAPMvMjRzeWmYuqSC1BuNmZq43HWFU6ypJrcuqDzm+Xk17kiOmBo3ZiDi3X36GnFMLykltHeTpARvwYX3SQajNhQFf64041kkBoar9R0ScGvCtzRjtZvIJAaEm1wcEYTsiZkYc76iAUJOrAzblYz2GVMtNQwEhImJuCl1AQKhi/zE/YM8wiYdYL9dQH0/zCshqRJyZ0vDn2/7Urw7S7XDMRcTpKf6IWUss2mxhyquIswJCm11RAgFhf9O+4/1RQGiz45Pe1vzx+fu2F8hVrG5v0nvT/CNZSmn9/NJBuq0M0Q3G7SYCAn02BIQ2L68Oe9ffuMuj5wJCm12b8vj3BIQ2uzTNBhURywJCm11sJnLG7hujJul7Lf95UUC6rUTETkQcm/C4K7UUSEA6vldvQjLJedCLiBsCQtut9XWRSXpRSnkkIPC37Yi4U9MvJCBMdO9RSrkvINS0xNq7kjWurYi4XVuRBMQmfe9K1jh2IuJWbd1DQChNSL6OOc7bUspijQUSkO763Pfxj2aDPWoXWqy1SALSXcsR8aWZAzNNSEYJx5sal1YQmfm478Cc3gjngNxVRboQki8jHHEgHHQiIHPNmYSbQ4TjocrRtaAsNcc9H7TU2nbkMzrK7mulLyxbmfladQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA/+kX8LLTex9Q0nAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAqVJREFUeNrt2TGLHlUUBuD3LpFYbK0iCouki4JgIoJbCP4B7SxiJekszA8QWwtb/4FNFBFFiVopClGIAZVgkyKBNBZCAtGNmv1eC+czn2F3kbCbgfg8MMwMTHE5d87cc+4kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwlyEE97a260nWp9vrY4zrovLfHRKCe96xJC9O158mOSMkEsSqkbyZZCPJA0meSLKW5Om262OM90SJ/3OCHG97uX/bbrs1XS/afth2U5SsIHfzhTya5OEkzyS5L8lWkrNJzs1U8z+W5MGVPvNwkk73zyc53/bKGOOS2ZMgd6OceSvJ5pQch5LcSPJ2knMzDWsryfZKgnTlfDjJySRrbb9J8pXGnYNKjpfaft32z96yaPt72zem5JllRWv72TSWRf9t0fbmVHa93/YhM8lBvISbbb/tzv5o+1PbU203ZhrfK23P7pIkS9+3PWI22feyqu2ZqQHuDl/o5fli29dmXElOtP2iu7skQfa2JgR35PUkz+0Sv+XP1+0kjyZ5ZK5BjjHeSfJlkmvTeHrbIzeS6D806fv6Vd5I8lSS+/d47GaSn5OcnrFRX3o3yW9JXp4S5PGVMf4gQSTIQTiSWztDt7ua5IPp+HHurdQxxoW2vyb5OMnxJE9Oq9qVJJ/YwWLfV5Bph+rqSgO8aPtL28/bvjpXz8EBfGCE4I7LrBeSPDvF8EKS78YYH4mOBCH//CBcljHKFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHbyF/YSmR4SGmT4AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAABkNJREFUeNrt3Uuo1FUcwPHvUW9qVy3toUnSzZJeC4vKhETKHgQ9oVpUEhb02LRrYUEQRLuojbS2Fla0qOhhZsgtKwqTgrLSMs2sTLOH3jJT+7U4Z2iKud7RO/+ZUb8fGJwZZ5j//Z/zm/M7j/8ZkCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJUgckT8HhJyLGARcAU4AJwDpgY0ppo2dHR3xwRMSCiHg5InZGxNqI6I+Iczw7B26Up+CwcwpwFzC7PD4d2A5cGBEnADtTSqs9Tari2/mS2q2LW48lEbE7GtsWEQ9Zkqqi8k2JiKdKRVvUpcf4cEQMxP49Z2maYlXlIiCAuRFxH/ArsAHY3MkOcERMAR4EbgV6h3j5uRajqmpB3infwntLurI2Ij6IiAci4tqI6OtASrUwIlZFxB/RnB122G1BWi6ltCUi9gH7gJHAJOD3cv9+4AdgRUSsBJamlAYqCoo+8hDuZcAc4MwDLMexwGnAGkvVAGm1keUG8AfwNvAtMB24CrgHOBUYAJZWdAyzgUfIo1U9B/k3PBARJ6eUnrRIDZBW+qvu/hjgDOAZoL+0LDcBVwLTImIhsBl4D3h1OH2UMvF3Xvm8S4Bpwyi7BMwC1kfEBw75GiCttLEuxRoJjC/p1/KIGFFaj9nAzLr3XAfcEBGvAeuBz0oLM9BMGlaGlM8t6dQ84Chgd/n3YI0AbgQ+jIjtzrAbIK2yqaRWqaQ3m4C95f/eBd4kj3TVGwdcCswFvikp2XpgCdBfWodxDT6rF7gdOB+4ugRFLaAmDHJ8+0rlb2YJ0RjgFmBLRPxUVZ/JADnyWpCfgcnAtlJRvy+tyEBEfFUq8tGD9F1OL7e5wNURsaM8fxwwulRuyEPJqZRPT3k8utyG6l8ciFnAbeSZ9uUWb+OmVs1bBTxbvn17gcXkkayaL4aopKmu4k8lj0DNII+I9ZJHmMaWABtb1wmvclHpXPKiRtmCDE9KaU1EvAVsKU+tbpC/by2d6EPF2BKoMkBaEiRLGXwI93NgRcntRwBrgT1AX+mrpLoWolv0ACdZsgZIO4JnoKx1+q30Td4rnfLeEhTzS8d7TJelt8dYegZIu6wsN+pHhiJiPnA5cGwXHvM+i80AaVsrUv+4LA25A7gZOKtLD3u0JWeAtF1ZFHgveSh14iDf3CO74FD3WFoGSCeC405gAY0nAumS4AD40xIzQNoZHOPIl73eTR616urDBXZZao05UViNycD1h0Bw2AcxQDpiBofO7HQCetp9sZcBcmSrrbo9VMxk6Et1DRC1zIUtOrfRpuMdT3fN7hsgh3EHfUpJsVqV/lTVMbceGCAd0Udevt6p1uBgAu9Ti60xh3mH11rMAU7+39OTurT/EftpkT4hrxmTAdKy4OgDriHPlNcW+30NfNmgIgad3Sh8f5+/CHiFf69WlAHSMtfw35Ww02k8a97pXfQbff4K4HXg05RSv0VpgFSh0UTgpBYFRFWtzifA48CPwEqvRTdA2n3+WnVOqwiO34AXgH53MmmOo1jD81GTr9tbd3/3IK+p+pqMDcDzwHKDwwCpPqnPlezjJiv2qP+lTY3e08qVvQP8dzOJdcATwKMppXcsPVOsdlldKl+zF0Ilqh8C/g5YRr4+fnPd8+/bcqitIqKv7Oy+M7rD7oh4zIWHpljdlGa9Qd4fqxssBl6ypTDF6qYgWR0RM8i7mEwn76E7lTwfUtso7kDUfmJhF3kBYU+T73kaeDGltNJSaWH5egpamnLVJgnnAWeTN2SbChxPXk4+gTx3Ur/NaP12o3vI+/buIm9ROgn4e4iWfivwHHkH+WWWggFyOARR7TaxLoh6gV+AHeWlJwIXkze+brQU/W/y75O8ATxjWmWAHInBNIf8S1JXAOeUlmcP8BV5s+nn/X0PA8RAyaNS9Vf8/W6LIUmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJElS1f4BaTCvT3PF7TUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAwpJREFUeNrt3T+LXFUYB+Df2UQkSqISlRAIWTvRwiIYEqJFKouQRkTwM+SLpEwTy7TB2iK1aKH2YhFIIhIIhAVj1oTsn3kt7h3m7t1ZBNvzPDDszkx1Lu9vz3nPnjuTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwf7QeB11Vm0k2x6ePWmuPlAKsAnKjqn6vqodVdbOqLrgqsArI7araq6pFVb2qqrtVdd2VYe54p+M+keTY+PtrSb5OcraqzrXWvlUWLG10Ou6tJC+TLJLU2It9nuTLsT+BrgOyk+TVGJKNMSAtyadJvlIW9B6Q7SRvr3n9VJJvqkpI6Dogu0meJnlzzXufJLliqUXPAfkryckj3lskuXZEeBCQLnyQYfdqrjLsbm0pDZJ+t3m/yGqbd2p5suBZkj+UB93NIFX18TiDzJdV05CcS3JeedDjEutyDu5g7c4CkjEcZ5UHPQbkag4e0twfH1N7SoNeA/LhLCDrepFfk9xXHnTVpFfVmSTvTl8a/0hMQ/IiyR1H4OlxBrmY5J1Zc95mM8pvSX5WGvQYkI8ynOSdziDz3uOe2YNeA/LebLbYyMEdrJ0kPykLeg3IGzl8m/G0/3imOafngJyYBWQelueWV/QckLfWhKKNvcj+2KBDtwF5/YhwtAxnr+4qCQRkZT+rbd4nSe4pCXoOyNQ/Ge4LqfHxsrW2rSToOSAvZg37cvyLDLfhQvczSE3GfmpcXm0kOa0cMIMcbtKXP3eVA70H5HEOHy9ZNutPlQO9B+SXDP8tn88ge0l+VA70HpAfMmznzgOyyPoPcUBAurKd5Ls1/cbxJH8qB7pXVZvjVx9MPaiqz1wdGEJyq6q2q+rvqtqpqjuuCuv0+g1TF5K8n+RSkodJtlpr3ysHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA//AvL7PBruluyaUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/lineart.58993160.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.7fdc069a.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.c35fe11b.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.3456d47e.png\";"],"sourceRoot":""}