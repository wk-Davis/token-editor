{"version":3,"sources":["envvars.ts","assets/index.ts","features/canvas/Canvas.tsx","features/editor/editorUtil.tsx","features/colorPicker/colorUtil.tsx","features/colorPicker/hue/Hue.tsx","features/colorPicker/hue/hueUtil.tsx","features/colorPicker/saturation/Saturation.tsx","features/colorPicker/saturation/saturationUtil.tsx","features/colorPicker/ColorPicker.tsx","features/editor/EditorHeader.tsx","features/menu/Menu.tsx","features/listItem/ListItem.tsx","features/editor/Editor.tsx","features/grid/GridHeader.tsx","features/grid/Grid.tsx","App.tsx","serviceWorker.ts","index.tsx","assets/icons/chevron_right-black-18dp.svg","features/canvas/fabric.js","assets/tokens/cleric/cloak.png","assets/tokens/cleric/hair.png","assets/tokens/cleric/lineart.png","assets/tokens/cleric/mace_handle.png","assets/tokens/cleric/mace_head.png","assets/tokens/cleric/shield.png","assets/tokens/cleric/shoes.png","assets/tokens/cleric/skin.png","assets/tokens/cleric/skirt.png","assets/tokens/cleric/sleeves.png","assets/tokens/cleric/top.png","assets/tokens/inquisitor/lineart.png","assets/tokens/gunslinger/lineart.png","assets/tokens/monk/lineart.png","assets/tokens/ranger/lineart.png","assets/icons/save_alt-black-18dp.svg"],"names":["envvars","REACT_APP_DELIMITER","REACT_APP_BASE","REACT_APP_FILETYPE","REACT_APP_TOKEN_PATH","process","config","cleric","cloak","color","src","cleric_cloak","hair","cleric_hair","lineart","cleric_lineart","mace_handle","cleric_mace_handle","mace_head","cleric_mace_head","shield","cleric_shield","shoes","cleric_shoes","skin","cleric_skin","skirt","cleric_skirt","sleeves","cleric_sleeves","top","cleric_top","gunslinger","gunslinger_lineart","inquisitor","inquisitor_lineart","monk","monk_lineart","ranger","ranger_lineart","Canvas","saveCanvas","state","token","canvasRef","useRef","fabricCanvas","useEffect","current","fabric","StaticCanvas","data","toDataURL","format","multiplier","enableRetinaScaling","saveAs","sources","tokenConfig","Object","keys","reduce","srcs","filename","getSources","forEach","key","Image","fromURL","img","filter","filters","BlendColor","mode","alpha","applyFilters","add","name","bringToFront","sendToBack","clear","getObjects","renderAll","height","ref","width","simpleCheckForValidColor","checked","passed","letter","isNaN","test","toState","oldHue","tinycolor","hex","hsl","toHsl","hsv","toHsv","rgb","toRgb","toHex","s","h","a","Hue","onChange","container","pointerPosition","left","handleChange","e","change","containerWidth","clientWidth","pageX","touches","getBoundingClientRect","window","pageXOffset","l","calculateChange","className","onClick","onMouseDown","onTouchMove","onTouchStart","draggable","onDrag","onDragEnd","style","Saturation","v","backgroundColor","background","containerHeight","pageY","x","y","pageYOffset","saturation","bright","ColorPicker","stateColor","setColor","useState","isOpen","setIsOpen","utils","ownColor","setOwnColor","newColor","iconColor","mostReadable","level","size","transform","title","alt","chevron_right","EditorHeader","unsetToken","icon","alignEnd","save_icon","GroupHandle","props","ripple","Menu","prevGroup","listItems","filenames","sort","comps","delimiterIndex","indexOf","groupName","substring","groupKeys","startsWith","push","handle","map","Fragment","InputListItem","selectComponent","selected","styles","toHexString","tabIndex","newVal","currentTarget","value","replace","slice","onFocus","toUpperCase","Editor","selectedComponent","getState","tokenState","setTokenState","callback","timeout","debouncedFunction","cancelDebouncedCallback","useCallback","clearTimeout","args","setTimeout","useDebouncedCallback","prevState","componentNames","getComponentNames","items","GridHeader","Grid","setToken","tokenNames","tag","use","withTextProtection","isAvailable","App","selectedToken","setSelectedToken","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message","module","exports","version","HTMLDocument","Document","implementation","createHTMLDocument","virtualWindow","require","JSDOM","decodeURIComponent","features","FetchExternalResources","resources","jsdomImplForWrapper","implForWrapper","nodeCanvas","copyGLTo2DDrawImage","gl","pipelineState","glCanvas","canvas","targetCanvas","ctx","getContext","translate","scale","sourceY","drawImage","copyGLTo2DPutImageData","dWidth","destinationWidth","dHeight","destinationHeight","numBytes","u8","Uint8Array","this","imageBuffer","u8Clamped","Uint8ClampedArray","readPixels","RGBA","UNSIGNED_BYTE","imgData","ImageData","putImageData","isTouchSupported","maxTouchPoints","isLikelyNode","Buffer","SHARED_ATTRIBUTES","DPI","reNum","rePathCommand","reNonWord","fontPaths","iMatrix","svgNS","perfLimitSizeTotal","maxCacheSideLimit","minCacheSideLimit","charWidthsCache","textureSize","disableStyleCopyPaste","enableGLFiltering","devicePixelRatio","webkitDevicePixelRatio","mozDevicePixelRatio","browserShadowBlurConstant","arcToSegmentsCache","boundsOfCurveCache","cachesBoundsOfCurve","forceGLPutImageData","initFilterBackend","isWebglSupported","log","maxTextureSize","WebglFilterBackend","tileSize","Canvas2dFilterBackend","_removeEventListener","eventName","handler","__eventListeners","eventListener","util","array","fill","observe","arguments","length","prop","on","stopObserving","call","fire","options","listenersForEvent","i","len","Observable","off","trigger","Collection","_objects","apply","_onObjectAdded","renderOnAddRemove","requestRenderAll","insertAt","object","index","nonSplicing","objects","splice","remove","somethingRemoved","_onObjectRemoved","forEachObject","context","type","concat","o","item","isEmpty","contains","complexity","memo","CommonMethods","_setOptions","set","_initGradient","filler","property","colorStops","Gradient","_initPattern","source","Pattern","_initClipping","clipTo","functionBody","getFunctionBody","_setObject","obj","_set","get","toggle","global","sqrt","Math","atan2","pow","PiBy180","PI","PiBy2","cos","angle","sin","sign","removeFromArray","idx","getRandomInt","min","max","floor","random","degreesToRadians","degrees","radiansToDegrees","radians","rotatePoint","point","origin","subtractEquals","rotateVector","Point","addEquals","vector","transformPoint","p","t","ignoreOffset","makeBoundingBoxFromPoints","points","xPoints","minX","yPoints","minY","invertTransform","r","toFixed","number","fractionDigits","parseFloat","Number","parseUnit","fontSize","unit","exec","Text","DEFAULT_SVG_FONT_SIZE","falseFunction","getKlass","namespace","string","camelize","charAt","resolveNamespace","getSvgAttributes","attributes","parts","split","loadImage","url","crossOrigin","createImage","onLoadCallback","onload","onerror","loadImageInDom","div","createElement","position","appendChild","querySelector","parentNode","removeChild","enlivenObjects","reviver","enlivenedObjects","numLoadedObjects","numTotalObjects","onLoaded","fromObject","enlivenPatterns","patterns","numLoadedPatterns","numPatterns","enlivenedPatterns","pattern","groupSVGElements","elements","path","centerPoint","Group","sourcePath","populateWithProperties","destination","properties","prototype","toString","drawDashedLine","x2","y2","da","dx","dy","rot","dc","di","draw","save","moveTo","rotate","restore","createCanvasElement","copyCanvasElement","newCanvas","canvasEl","quality","clipContext","receiver","beginPath","clip","multiplyTransformMatrices","b","is2x2","qrDecompose","denom","scaleX","scaleY","skewX","skewY","translateX","translateY","calcRotateMatrix","theta","calcDimensionsMatrix","scaleMatrix","flipX","flipY","multiply","tan","composeMatrix","matrix","customTransformMatrix","resetObjectTransform","target","saveObjectTransform","fn","String","isTransparent","tolerance","_isTransparent","imageData","getImageData","parsePreserveAspectRatioAttribute","attribute","align","meetOrSlice","aspectRatioAttrs","pop","alignX","alignY","clearFabricFontCache","fontFamily","toLowerCase","limitDimsByArea","ar","maximumArea","roughWidth","perfLimitSizeY","capValue","findScaleToFit","findScaleToCover","matrixToSVG","NUM_FRACTION_DIGITS","join","_join","Array","arcToSegments","toX","toY","rx","ry","large","sweep","rotateX","argsString","th","sinTh","cosTh","fromX","fromY","px","py","rx2","abs","ry2","py2","px2","pl","root","cx","cy","cx1","cy1","mTheta","calcVectorAngle","dtheta","segments","ceil","result","mDelta","mT","th3","segmentToBezier","th2","costh2","sinth2","costh3","sinth3","ux","uy","vx","vy","ta","tb","getBoundsOfCurve","x0","y0","x1","y1","x3","y3","c","t1","t2","b2ac","sqrtb2ac","tvalues","bounds","mt","j","jlen","drawArc","fx","fy","coords","segs","segsNorm","bezierCurveTo","getBoundsOfArc","tx","ty","bound","find","byProperty","condition","k","invoke","method","value1","value2","extend","deep","Element","hasOwnProperty","clone","getWholeChar","str","code","charCodeAt","Error","next","prev","character","capitalize","firstLetterOnly","escapeXml","graphemeSplit","textstring","chr","graphemes","emptyFunction","IS_DONTENUM_BUGGY","addMethods","klass","parent","superclass","constructor","returnValue","valueOf","Subclass","callSuper","methodName","parentMethod","_this","superClassMethod","createClass","initialize","shift","subclasses","parseEl","supportsOpacity","opacity","supportsFilters","reOpacity","setOpacity","element","es","currentStyle","hasLayout","zoom","setStyle","elementStyle","cssText","styleFloat","_slice","sliceCanConvertNodelists","getElementStyle","toArray","arrayLike","childNodes","err","makeElement","tagName","el","htmlFor","setAttribute","getScrollLeftTop","docElement","documentElement","body","scrollLeft","scrollTop","host","nodeType","arr","defaultView","getComputedStyle","attr","undefined","selectProp","makeElementUnselectable","onselectstart","unselectable","makeElementSelectable","getScript","headEl","getElementsByTagName","scriptEl","loading","onreadystatechange","readyState","event","getById","id","addClass","wrapElement","wrapper","replaceChild","getElementOffset","docElem","scrollLeftTop","doc","ownerDocument","box","offset","offsetAttributes","borderLeftWidth","borderTopWidth","paddingLeft","paddingTop","parseInt","clientLeft","clientTop","getNodeCanvas","impl","_canvas","_image","cleanUpJsdomNode","_currentSrc","_attributes","_classList","warn","noop","defaultEasing","d","_requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","_cancelAnimFrame","cancelAnimationFrame","requestAnimFrame","animate","timestamp","time","start","Date","duration","finish","abort","onComplete","easing","startValue","endValue","byValue","onStart","tick","ticktime","currentTime","timePerc","valuePerc","cancelAnimFrame","animateColor","fromColor","toColor","startColor","Color","getSource","endColor","begin","end","pos","calculateColor","colorEasing","normalize","asin","elastic","opts","easeInBounce","easeOutBounce","ease","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInOutBounce","that","scalarAdd","scalar","scalarAddEquals","subtract","scalarSubtract","scalarSubtractEquals","multiplyEquals","divide","divideEquals","eq","lt","lte","gt","gte","lerp","distanceFrom","midPointFrom","setXY","setX","setY","setFromPoint","swap","Intersection","status","appendPoint","appendPoints","intersectLineLine","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","intersectLinePolygon","inter","intersectPolygonPolygon","points1","points2","intersectPolygonRectangle","r1","r2","topRight","bottomLeft","inter1","inter2","inter3","inter4","_tryParsingColor","setSource","hue2rgb","q","colorNameMap","sourceFromHex","sourceFromRgb","sourceFromHsl","_rgbToHsl","g","round","_source","toRgba","toHsla","toHexa","getAlpha","setAlpha","toGrayscale","average","currentAlpha","toBlackWhite","threshold","overlayWith","otherColor","otherSource","reRGBa","reHSLa","reHex","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","fromRgb","fromSource","fromRgba","fromHsl","fromHsla","fromHex","isShortNotation","isRGBa","oColor","CANVAS_INIT_ERROR","renderAndResetBound","renderAndReset","bind","requestRenderAllBound","_initStatic","backgroundImage","overlayColor","overlayImage","includeDefaultValues","stateful","controlsAboveOverlay","allowTouchScrolling","imageSmoothingEnabled","viewportTransform","backgroundVpt","overlayVpt","onBeforeScaleRotate","vptCoords","skipOffscreen","clipPath","cb","_createLowerCanvas","_initOptions","_setImageSmoothing","interactive","_initRetinaScaling","setOverlayImage","setBackgroundImage","setBackgroundColor","setOverlayColor","calcOffset","_isRetinaScaling","getRetinaScaling","scaleRatio","__initRetinaScaling","lowerCanvasEl","contextContainer","upperCanvasEl","contextTop","_offset","image","__setBgOverlayImage","__setBgOverlayColor","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","oImageSmoothingEnabled","instance","setOptions","_createCanvasElement","_applyCanvasStyle","getWidth","getHeight","setWidth","setDimensions","setHeight","dimensions","cssValue","cssOnly","_setBackstoreDimension","hasLostContext","backstoreOnly","_setCssDimension","_isCurrentlyDrawing","freeDrawingBrush","_setBrushStyles","cacheCanvasEl","wrapperEl","getZoom","setViewportTransform","vpt","activeObject","_activeObject","group","setCoords","calcViewportBoundaries","zoomToPoint","before","after","setZoom","absolutePan","relativePan","getElement","setupState","clearContext","clearRect","_hasITextHandlers","_mouseUpITextHandler","_iTextInstances","canvasToDrawOn","renderCanvas","isRendering","iVpt","tl","br","tr","bl","cancelRequestedRender","_renderBackground","_renderObjects","drawControls","shouldCache","_transformDone","renderCache","forClipping","drawClipPathOnCanvas","_renderOverlay","globalCompositeOperation","zoomX","zoomY","_cacheCanvas","cacheTranslationX","cacheTranslationY","_renderBackgroundOrOverlay","needsVpt","lineTo","closePath","fillStyle","toLive","offsetX","offsetY","m","gradientTransform","patternTransform","getCenter","centerObjectH","_centerObject","getCenterPoint","centerObjectV","centerObject","center","viewportCenterObject","vpCenter","getVpCenter","viewportCenterObjectH","viewportCenterObjectV","setPositionByOrigin","toDatalessJSON","propertiesToInclude","toDatalessObject","toObject","_toObjectMethod","_toObjects","_toObject","__serializeBgOverlay","excludeFromExport","originalValue","bgImage","overlay","svgViewportTransformation","toSVG","markup","_setSVGPreamble","_setSVGHeader","clipPathId","_setSVGBgOverlayColor","_setSVGBgOverlayImage","_setSVGObjects","suppressPreamble","encoding","viewBox","createSVGFontFacesMarkup","createSVGRefElementsMarkup","createSVGClipPathMarkup","__uid","toClipPathSVG","shouldTransform","additionalTransform","row","rowIndex","charIndex","fontList","_setSVGObject","finalWidth","finalHeight","repeat","objs","activeSelection","unshift","sendBackwards","intersecting","newIdx","objsMoved","_findNewLowerIndex","intersectsWithObject","isContainedWithinObject","bringForward","_findNewUpperIndex","dispose","DataURLExporter","EMPTY_JSON","supports","setLineDash","toJSON","createPNGStream","createJPEGStream","toCanvasElement","cropping","scaledWidth","scaledHeight","originalWidth","originalHeight","newZoom","vp","originalInteractive","newVp","originalRetina","originalContextTop","supportsLineDash","objectCaching","originX","originY","cornerSize","transparentCorners","hoverCursor","moveCursor","padding","borderColor","borderDashArray","cornerColor","cornerStrokeColor","cornerStyle","cornerDashArray","centeredScaling","centeredRotation","fillRule","selectionBackgroundColor","stroke","strokeWidth","strokeDashArray","strokeDashOffset","strokeLineCap","strokeLineJoin","strokeMiterLimit","shadow","borderOpacityWhenMoving","borderScaleFactor","transformMatrix","minScaleLimit","selectable","evented","visible","hasControls","hasBorders","hasRotatingPoint","rotatingPointOffset","perPixelTargetFind","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockUniScaling","lockSkewingX","lockSkewingY","lockScalingFlip","statefullCache","noScaleCache","strokeUniform","dirty","__corner","paintFirst","stateProperties","cacheProperties","inverted","absolutePositioned","_createCacheCanvas","_cacheProperties","_cacheContext","_updateCacheCanvas","_limitCacheSize","dims","limitedDims","capped","_getCacheCanvasDimensions","objectScale","getTotalObjectScaling","dim","_getTransformedDimensions","neededX","neededY","_currentTransform","action","drawingWidth","drawingHeight","minCacheSize","dimensionsChanged","cacheWidth","cacheHeight","zoomChanged","shouldRedraw","additionalWidth","additionalHeight","shouldResizeCanvas","canvasWidth","canvasHeight","sizeGrowing","setTransform","calcTransformMatrix","calcOwnMatrix","_removeDefaultValues","getObjectScaling","retina","getObjectOpacity","shouldConstrainValue","isChanged","groupNeedsUpdate","_constrainScale","Shadow","isOnACache","setOnGroup","getViewportTransform","isNotVisible","isOnScreen","_setupCompositeOperation","drawSelectionBackground","_setOpacity","_setShadow","drawCacheOnCanvas","_removeCacheCanvas","drawObject","saveState","propertySet","isCacheDirty","hasStroke","hasFill","needsItsOwnCache","ownCaching","willDrawShadow","drawClipPathOnCache","originalFill","originalStroke","_setClippingProperties","_setStrokeStyles","_setFillStyles","_render","_drawClipPath","skipCanvas","hasStateChanged","_getNonTransformedDimensions","fillRect","_removeShadow","globalAlpha","decl","lineWidth","lineCap","lineDashOffset","lineJoin","miterLimit","strokeStyle","_setLineDash","dashArray","alternative","_renderControls","styleOverride","drawBorders","isMoving","forActiveSelection","drawBordersInGroup","scaling","multX","multY","nonScaling","shadowColor","shadowBlur","blur","shadowOffsetX","shadowOffsetY","_applyPatternGradientTransform","gradientUnits","_renderPaintInOrder","_renderStroke","_renderFill","affectStroke","_renderDashedStroke","_applyPatternForTransformedGradient","pCtx","pCanvas","retinaScaling","createPattern","_findCenterFromElement","_assignTransformMatrixProps","_removeTransformMatrix","preserveAspectRatioOptions","cropX","cropY","offsetLeft","offsetTop","objectForm","_fromObject","cloneAsImage","origParams","originalGroup","originalShadow","withoutTransform","withoutShadow","boundingRect","getBoundingRect","shadowOffset","originalCanvas","isType","setGradient","gradient","addColorStop","forObject","setPatternFill","setShadow","shouldCenterOrigin","_setOriginToCenter","_resetOrigin","centerH","viewportCenterH","centerV","viewportCenterV","viewportCenter","getLocalPointer","pointer","getPointer","pClicked","objectLeftTop","_getLeftTopCoords","createAccessors","extraParam","enlivedProps","originXOffset","right","originYOffset","bottom","translateToGivenOrigin","fromOriginX","fromOriginY","toOriginX","toOriginY","translateToCenterPoint","translateToOriginPoint","leftTop","getPointByOrigin","toLocalPoint","p2","adjustPosition","to","offsetFrom","offsetTo","hypotFull","getScaledWidth","xFull","yFull","_originalOriginX","_originalOriginY","originPoint","multiplyMatrices","wh","_calculateCurrentDimensions","oCoords","aCoords","ownMatrixCache","matrixCache","getCoords","absolute","calculate","calcCoords","intersectsWithRect","pointTL","pointBR","other","lines","_getImageLines","containsPoint","isContainedWithinRect","objLines","_findCrossPoints","_containsCenterOfCanvas","isPartiallyOnScreen","topline","rightline","bottomline","leftline","xi","iLine","xcount","lineKey","getScaledHeight","scaleToWidth","boundingRectFactor","scaleToHeight","rotateMatrix","_calcRotateMatrix","translateMatrix","_calcTranslateMatrix","startMatrix","finalMatrix","w","cosP","sinP","cosPSinP","cosPMinusSinP","ml","mr","mb","mtr","ignoreZoom","skipAbsolute","_setCornerCoords","transformMatrixKey","skipGroup","prefix","cache","tMatrix","_calcDimensionsTransformMatrix","flipping","dimX","dimY","noSkew","_finalizeDimensions","bbox","getSvgColorString","getSvgStyles","skipShadow","visibility","getSvgFilter","getSvgSpanStyles","useWhiteSpace","fontStyle","fontWeight","textDecoration","getSvgTextDecoration","deltaY","decoration","getSvgCommons","getSvgTransform","full","getSvgTransformMatrix","_setSVGBg","textBgRects","_getFillAttributes","_createBaseSVGMarkup","_toSVG","_createBaseClipPathSVGMarkup","objectMarkup","commonPieces","clipPathMarkup","noStyle","styleInfo","shadowInfo","withShadow","vectorEffect","absoluteClipPath","addPaintOrder","saveProps","tmpObj","dashedPropertySet","_isEqual","origValue","currentValue","firstPass","isArray","skipCallbacks","propsToAnimate","_animate","propPair","from","by","valueProgress","timeProgress","subTargetCheck","useSetOnGroup","isAlreadyGrouped","_updateObjectsACoords","_calcBounds","_updateObjectsCoords","actualCenter","_updateObjectCoords","objectLeft","objectTop","addWithUpdate","_restoreObjectsState","removeWithUpdate","_includeDefaultValues","objsToObject","originalDefaults","_obj","ownCache","_restoreObjectState","realizeTransform","destroy","toActiveSelection","ActiveSelection","ungroupOnCanvas","setObjectsCoords","onlyWidthHeight","aX","aY","iLen","jLen","_getBounds","minXY","maxXY","svgString","enlivedClipPath","loadSVGFromURL","srcFromAttribute","_lastScaleX","_lastScaleY","_filterScalingX","_filterScalingY","minimumScaleTrigger","cacheKey","_initElement","_element","setElement","removeTexture","_originalElement","_initConfig","resizeFilter","applyResizeFilters","backend","filterBackend","evictCachesForKey","setCrossOrigin","getOriginalSize","naturalWidth","naturalHeight","_stroke","filterObj","getSrc","hasCrop","strokeSvg","imageMarkup","getSvgSrc","origFill","filtered","getAttribute","setSrc","_setWidthHeight","minimumScale","elementToFilter","_filteredEl","sourceWidth","sourceHeight","isNeutralState","imgElement","_needsResize","elementToDraw","sW","sH","sX","sY","_resetWidthHeight","CSS_CANVAS","_initFilters","pAR","preserveAspectRatio","rWidth","rHeight","pWidth","pHeight","parsedAttributes","_object","resizeFilters","imgOptions","ATTRIBUTE_NAMES","fromElement","parseAttributes","testPrecision","precision","fragmentSource","fragmentShader","createShader","FRAGMENT_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","setupGLContext","captureGPUInfo","isSupported","getParameter","MAX_TEXTURE_SIZE","precisions","webGlPrecision","createWebGLCanvas","aPosition","Float32Array","chooseFastestCopyGLTo2DMethod","canUseImageData","canMeasurePerf","performance","canUseArrayBuffer","ArrayBuffer","canUseUint8Clamped","copyGLTo2D","startTime","drawImageTime","testContext","now","glOptions","premultipliedAlpha","depth","stencil","antialias","clearColor","cachedTexture","getCachedTexture","sourceTexture","createTexture","targetTexture","originalTexture","passes","webgl","programCache","pass","tempFbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","applyTo","resizeCanvasIfNeeded","bindTexture","TEXTURE_2D","deleteTexture","deleteFramebuffer","clearWebGLCaches","textureCache","textureImageSource","texture","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","uniqueId","gpuInfo","renderer","vendor","ext","getExtension","UNMASKED_RENDERER_WEBGL","UNMASKED_VENDOR_WEBGL","sourceElement","originalEl","originalImageData","BaseFilter","vertexSource","createProgram","vertexShader","VERTEX_SHADER","getShaderInfoLog","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","attributeLocations","getAttributeLocations","uniformLocations","getUniformLocations","uStepW","getUniformLocation","uStepH","getAttribLocation","sendAttributeData","aPositionData","attributeLocation","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","FLOAT","bufferData","STATIC_DRAW","_setupFrameBuffer","framebufferTexture2D","COLOR_ATTACHMENT0","_swapTextures","temp","main","mainParameter","_class","applyToWebGL","applyTo2d","retrieveShader","shader","useProgram","uniform1f","sendUniformData","viewport","drawArrays","TRIANGLE_STRIP","bindAdditionalTexture","textureUnit","activeTexture","TEXTURE0","unbindAdditionalTexture","getMainParameter","setMainParameter","createHelpLayer","helpLayer","mainP","screen","diff","lighten","darken","exclusion","tint","buildSource","tg","alpha1","uColor","uniform4fv","BlendImage","mask","TEXTURE1","calculateMatrix","canvas1","blendData","blendImage","uTransformMatrix","uImage","uniform1i","uniformMatrix3fv","Resize","resizeType","lanczosLobes","uDelta","uTaps","uniform2fv","horizontal","uniform1fv","taps","filterWindow","getFilterWindow","generateShader","tempScale","getTaps","lobeFunction","lanczosCreate","offsets","fragmentSourceTOP","dW","dH","lobes","xx","rcpScaleX","rcpScaleY","newData","oW","oH","sliceByTwo","hermiteFastResize","bilinearFiltering","lanczosResize","tmpCanvas","doneW","doneH","stepW","stepH","dX","dY","srcData","destImg","createImageData","destData","lanczos","ratioX","ratioY","rcpRatioX","rcpRatioY","range2X","range2Y","cacheLanc","icenter","u","weight","fX","fY","xDiff","yDiff","chnl","origPix","w4","pixels","destImage","destPixels","ratioW","ratioH","ratioWHalf","ratioHHalf","img2","data2","weights","weightsAlpha","gxR","gxG","gxB","gxA","centerY","yy","centerX","w0"],"mappings":"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","file":"static/js/main.105aa797.chunk.js","sourcesContent":["const envvars = {\n  REACT_APP_DELIMITER: '_',\n  REACT_APP_BASE: 'lineart',\n  REACT_APP_FILETYPE: 'png',\n  REACT_APP_TOKEN_PATH: 'src/assets/tokens',\n  ...process.env,\n};\n\nexport default envvars;\n","import cleric_cloak from './tokens/cleric/cloak.png';\nimport cleric_hair from './tokens/cleric/hair.png';\nimport cleric_lineart from './tokens/cleric/lineart.png';\nimport cleric_mace_handle from './tokens/cleric/mace_handle.png';\nimport cleric_mace_head from './tokens/cleric/mace_head.png';\nimport cleric_shield from './tokens/cleric/shield.png';\nimport cleric_shoes from './tokens/cleric/shoes.png';\nimport cleric_skin from './tokens/cleric/skin.png';\nimport cleric_skirt from './tokens/cleric/skirt.png';\nimport cleric_sleeves from './tokens/cleric/sleeves.png';\nimport cleric_top from './tokens/cleric/top.png';\nimport inquisitor_lineart from './tokens/inquisitor/lineart.png';\nimport gunslinger_lineart from './tokens/gunslinger/lineart.png';\nimport monk_lineart from './tokens/monk/lineart.png';\nimport ranger_lineart from './tokens/ranger/lineart.png';\n    \ninterface Config {\n    [tokenName: string]: {\n      [filename: string]: {\n        color: string;\n        src: string;\n      };\n    };\n  }  \n    \nconst config: Config = {cleric:{cloak:{ color: '#EEEEEE', src: cleric_cloak },hair:{ color: '#EEEEEE', src: cleric_hair },lineart:{ color: '#000000', src: cleric_lineart },mace_handle:{ color: '#EEEEEE', src: cleric_mace_handle },mace_head:{ color: '#EEEEEE', src: cleric_mace_head },shield:{ color: '#EEEEEE', src: cleric_shield },shoes:{ color: '#EEEEEE', src: cleric_shoes },skin:{ color: '#EEEEEE', src: cleric_skin },skirt:{ color: '#EEEEEE', src: cleric_skirt },sleeves:{ color: '#EEEEEE', src: cleric_sleeves },top:{ color: '#EEEEEE', src: cleric_top }},gunslinger:{lineart:{ color: '#000000', src: gunslinger_lineart }},inquisitor:{lineart:{ color: '#000000', src: inquisitor_lineart }},monk:{lineart:{ color: '#000000', src: monk_lineart }},ranger:{lineart:{ color: '#000000', src: ranger_lineart }}};\n    \nexport default config;","import React, { MutableRefObject, useEffect, useRef } from 'react';\nimport { fabric } from './fabric.js';\nimport { saveAs } from 'file-saver';\n\nimport './Canvas.css';\nimport envvars from '../../envvars';\nimport { getSources } from '../editor/editorUtil';\n\ninterface Props {\n  saveCanvas: MutableRefObject<(() => void) | null>;\n  state: { [filename: string]: string };\n  token: string;\n}\n\nconst Canvas: React.FunctionComponent<Props> = ({\n  saveCanvas,\n  state,\n  token,\n}) => {\n  const canvasRef: MutableRefObject<HTMLCanvasElement | null> = useRef(null);\n  const fabricCanvas: MutableRefObject<fabric.StaticCanvas | null> = useRef(\n    null\n  );\n\n  useEffect(() => {\n    fabricCanvas.current = new fabric.StaticCanvas(canvasRef.current);\n  }, []);\n\n  useEffect(() => {\n    if (saveCanvas)\n      saveCanvas.current = () => {\n        if (fabricCanvas.current) {\n          const data = fabricCanvas.current.toDataURL({\n            format: 'png',\n            multiplier: 1,\n            enableRetinaScaling: true,\n          });\n          saveAs(data, 'token.png');\n        }\n      };\n  }, [saveCanvas]);\n\n  useEffect(() => {\n    if (fabricCanvas.current && token) {\n      const sources = getSources(token);\n      Object.keys(sources).forEach((key: string) => {\n        fabric.Image.fromURL(\n          sources[key],\n          (img: fabric.Image) => {\n            const filter = new fabric.Image.filters.BlendColor({\n              color: key === envvars.REACT_APP_BASE ? '#000000' : '#EEEEEE',\n              mode: 'tint',\n              alpha: 1,\n            });\n            img.filters = [filter];\n            img.applyFilters();\n            fabricCanvas.current?.add(img);\n            if (img.name === envvars.REACT_APP_BASE)\n              fabricCanvas.current?.bringToFront(img);\n            else fabricCanvas.current?.sendToBack(img);\n          },\n          { name: key }\n        );\n      });\n      return function clear() {\n        fabricCanvas.current?.clear();\n      };\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (fabricCanvas.current && token) {\n      const images: fabric.Object[] = fabricCanvas.current.getObjects('image');\n      images.forEach((img) => {\n        const filter = new fabric.Image.filters.BlendColor({\n          color: state[img.name as string],\n          mode: 'tint',\n          alpha: 1,\n        });\n        (img as fabric.Image).filters = [filter];\n        (img as fabric.Image).applyFilters();\n      });\n      fabricCanvas.current.renderAll();\n    }\n  }, [state, token]);\n\n  return <canvas height={200} ref={canvasRef} width={200}></canvas>;\n};\n\nexport default Canvas;\n","import { MutableRefObject, useCallback, useRef } from 'react';\nimport config from '../../assets';\n\nconst DEBOUNCE_RATE = 100;\n\nexport interface TokenState {\n  [filename: string]: HexStr;\n}\n\nexport const getState = (token: string) => {\n  const tokenConfig: Token = config[token];\n  return Object.keys(tokenConfig).reduce(\n    (state: TokenState, filename: string) => {\n      state[filename] = tokenConfig[filename].color;\n      return state;\n    },\n    {}\n  );\n};\n\nexport const getSources = (token: string) => {\n  const tokenConfig: Token = config[token];\n  return Object.keys(tokenConfig).reduce(\n    (srcs: { [filename: string]: string }, filename: string) => {\n      srcs[filename] = tokenConfig[filename].src;\n      return srcs;\n    },\n    {}\n  );\n};\n\nexport const getComponentNames = (token: string) => Object.keys(config[token]);\n\nexport function useDebouncedCallback<T extends unknown[]>(\n  callback: (...args: T) => unknown\n): (...args: T) => void {\n  const timeout: MutableRefObject<NodeJS.Timeout | null> = useRef(null);\n  const debouncedFunction = useRef(callback);\n  debouncedFunction.current = callback;\n\n  const cancelDebouncedCallback: () => void = useCallback(() => {\n    clearTimeout(timeout.current as NodeJS.Timeout);\n    timeout.current = null;\n  }, []);\n\n  const debouncedCallback = useCallback(\n    (...args: T) => {\n      clearTimeout(timeout.current as NodeJS.Timeout);\n      timeout.current = setTimeout(() => {\n        cancelDebouncedCallback();\n\n        debouncedFunction.current(...args);\n      }, DEBOUNCE_RATE);\n    },\n    [cancelDebouncedCallback]\n  );\n\n  return debouncedCallback;\n}\n","import tinycolor from 'tinycolor2';\nimport { PickerColor } from './ColorPicker';\n\nexport const simpleCheckForValidColor = (data: any) => {\n  const keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  let checked = 0;\n  let passed = 0;\n  keysToCheck.forEach((letter) => {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        const percentExpr = /^\\d+%$/;\n        if (percentExpr.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport const toState = (data: any, oldHue?: number): PickerColor => {\n  const color =\n    typeof data !== 'string' && 'hex' in data\n      ? tinycolor(data.hex)\n      : tinycolor(data);\n  const hsl = color.toHsl();\n  const hsv = color.toHsv();\n  const rgb = color.toRgb();\n  const hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  const transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl,\n    hex: transparent ? 'transparent' : `#${hex}`,\n    hsv,\n    oldHue: data.h || oldHue || hsl.h,\n  };\n};\n\nexport default {\n  simpleCheckForValidColor,\n  toState,\n};\n","import React, { MutableRefObject, useRef } from 'react';\nimport { ColorChangeEvent } from '../ColorPicker';\nimport { calculateChange } from './hueUtil';\n\ninterface Props {\n  hsl: tinycolor.ColorFormats.HSLA;\n  onChange: (change: tinycolor.ColorFormats.HSLA, e: ColorChangeEvent) => void;\n}\n\nconst Hue: React.FunctionComponent<Props> = ({ hsl, onChange }) => {\n  const container: MutableRefObject<HTMLDivElement | null> = useRef(null);\n  const pointerPosition = { left: `${(hsl.h * 100) / 360}%` };\n\n  const handleChange = (e: ColorChangeEvent) => {\n    const change = calculateChange(e, hsl, container.current as HTMLDivElement);\n    if (change) onChange(change, e);\n  };\n\n  return (\n    <div className='hue-selector'>\n      <div\n        className={`hue-selector__bar`}\n        onClick={handleChange}\n        onMouseDown={handleChange}\n        onTouchMove={handleChange}\n        onTouchStart={handleChange}\n        ref={container}\n      >\n        <style>{`\n            .hue-selector__bar {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          `}</style>\n        <div\n          className='hue-selector__pointer'\n          draggable\n          onDrag={handleChange}\n          onDragEnd={handleChange}\n          style={pointerPosition}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default Hue;\n","import { ColorChangeEvent } from '../ColorPicker';\n\nexport const calculateChange = (\n  e: ColorChangeEvent,\n  hsl: tinycolor.ColorFormats.HSLA,\n  container: HTMLDivElement\n): tinycolor.ColorFormats.HSLA | null => {\n  const containerWidth = container.clientWidth;\n  const x = 'pageX' in e ? e.pageX : e.touches[0].pageX;\n  const left =\n    x - (container.getBoundingClientRect().left + window.pageXOffset);\n\n  let h: number;\n  if (left < 0) {\n    h = 0;\n  } else if (left > containerWidth) {\n    h = 359;\n  } else {\n    const percent = (left * 100) / containerWidth;\n    h = (360 * percent) / 100;\n  }\n\n  if (hsl.h !== h) {\n    return {\n      h,\n      s: hsl.s,\n      l: hsl.l,\n      a: hsl.a,\n    };\n  }\n\n  return null;\n};\n","import React, { MutableRefObject, useRef } from 'react';\nimport { ColorChangeEvent } from '../ColorPicker';\nimport { calculateChange } from './saturationUtil';\n\ninterface Props {\n  hsv: tinycolor.ColorFormats.HSVA;\n  hsl: tinycolor.ColorFormats.HSLA;\n  onChange: (change: tinycolor.ColorFormats.HSVA, e: ColorChangeEvent) => void;\n}\n\nconst Saturation: React.FunctionComponent<Props> = ({ hsv, hsl, onChange }) => {\n  const container: MutableRefObject<HTMLDivElement | null> = useRef(null);\n  const pointerPosition = {\n    top: `${-(hsv.v * 100) + 100}%`,\n    left: `${hsv.s * 100}%`,\n  };\n  const backgroundColor = {\n    background: `hsl(${hsl.h},100%, 50%)`,\n  };\n\n  const handleChange = (e: ColorChangeEvent) => {\n    const change = calculateChange(e, hsl, container.current as HTMLDivElement);\n    onChange(change, e);\n  };\n\n  return (\n    <div className='saturation-selector'>\n      <div\n        className='saturation-selector__color'\n        onClick={handleChange}\n        onMouseDown={handleChange}\n        onTouchMove={handleChange}\n        onTouchStart={handleChange}\n        ref={container}\n        style={backgroundColor}\n      >\n        <style>{`\n            .saturation-selector__white {\n              background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n              background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n            }\n            .saturation-selector__black {\n              background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n              background: linear-gradient(to top, #000, rgba(0,0,0,0));\n            }\n          `}</style>\n        <div className='saturation-selector__white'>\n          <div className='saturation-selector__black' />\n          <div\n            className='saturation-selector__pointer'\n            draggable\n            onDrag={handleChange}\n            onDragEnd={handleChange}\n            style={pointerPosition}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default Saturation;\n","import { ColorChangeEvent } from '../ColorPicker';\n\nexport const calculateChange = (\n  e: ColorChangeEvent,\n  hsl: tinycolor.ColorFormats.HSLA,\n  container: HTMLDivElement\n): tinycolor.ColorFormats.HSVA => {\n  const {\n    width: containerWidth,\n    height: containerHeight,\n  } = container.getBoundingClientRect();\n  const [x, y] =\n    'pageY' in e\n      ? [e.pageX, e.pageY]\n      : [e.touches[0].pageX, e.touches[0].pageY];\n  let left: number =\n    x - (container.getBoundingClientRect().left + window.pageXOffset);\n  let top: number =\n    y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  const saturation = left / containerWidth;\n  const bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n  };\n};\n","import React, { Dispatch, useEffect, useState } from 'react';\nimport tinycolor from 'tinycolor2';\n\nimport * as utils from './colorUtil';\nimport Hue from './hue/Hue';\nimport Saturation from './saturation/Saturation';\nimport chevron_right from '../../assets/icons/chevron_right-black-18dp.svg';\n\nimport './ColorPicker.css';\n\nexport type ColorChangeEvent =\n  | React.MouseEvent<HTMLDivElement, MouseEvent>\n  | React.TouchEvent<HTMLDivElement>;\n\nexport type PickerColor = {\n  hex: HexStr;\n  hsl: tinycolor.ColorFormats.HSLA;\n  hsv: tinycolor.ColorFormats.HSVA;\n  oldHue?: number;\n};\n\ninterface Props {\n  color: string;\n  setColor: (arg: string) => void;\n}\n\nconst ColorPicker: React.FunctionComponent<Props> = ({\n  color: stateColor,\n  setColor,\n}) => {\n  const [isOpen, setIsOpen]: [boolean, Dispatch<any>] = useState(true);\n  const [ownColor, setOwnColor]: [\n    PickerColor,\n    Dispatch<PickerColor>\n  ] = useState(utils.toState(stateColor));\n\n  useEffect(() => {\n    setOwnColor(utils.toState(stateColor));\n  }, [stateColor]);\n\n  const handleChange = (\n    color: tinycolor.ColorFormats.HSLA | tinycolor.ColorFormats.HSVA\n  ): void => {\n    const isValidColor: boolean = utils.simpleCheckForValidColor(color);\n    if (isValidColor) {\n      const newColor = utils.toState(color, color.h || ownColor.oldHue);\n      setOwnColor(newColor);\n      setColor(newColor.hex);\n    }\n  };\n\n  const togglePicker = (): void => {\n    setIsOpen(!isOpen);\n  };\n\n  const iconColor: string = tinycolor\n    .mostReadable(ownColor.hex, ['#000000', '#ffffff'], {\n      level: 'AAA',\n      size: 'small',\n    })\n    .toHex();\n\n  return (\n    <>\n      <button\n        className='color-toggle'\n        onClick={togglePicker}\n        style={{\n          backgroundColor: ownColor.hex,\n          transform: isOpen ? 'rotate(90deg)' : 'rotate(0deg)',\n        }}\n        title={`${isOpen ? 'Hide' : 'Show'} Color Picker`}\n      >\n        <img\n          alt='arrow indicator'\n          src={chevron_right}\n          style={{\n            filter: `invert(${iconColor === '000000' ? '0%' : '100%'})`,\n          }}\n        />\n      </button>\n      {isOpen && (\n        <div className='picker'>\n          <Saturation {...ownColor} onChange={handleChange} />\n          <Hue {...ownColor} onChange={handleChange} />\n        </div>\n      )}\n    </>\n  );\n};\nexport default ColorPicker;\n","import React from 'react';\nimport {\n  TopAppBar,\n  TopAppBarActionItem,\n  TopAppBarFixedAdjust,\n  TopAppBarNavigationIcon,\n  TopAppBarRow,\n  TopAppBarSection,\n  TopAppBarTitle,\n} from '@rmwc/top-app-bar';\n\nimport chevron_right from '../../assets/icons/chevron_right-black-18dp.svg';\nimport save_icon from '../../assets/icons/save_alt-black-18dp.svg';\n\nconst EditorHeader: React.FunctionComponent<{\n  saveCanvas: () => void;\n  unsetToken: () => void;\n}> = ({ saveCanvas, unsetToken }) => {\n  return (\n    <>\n      <TopAppBar>\n        <TopAppBarRow>\n          <TopAppBarSection>\n            <TopAppBarNavigationIcon\n              icon={chevron_right}\n              className={`flipx white`}\n              onClick={unsetToken}\n            />\n            <TopAppBarTitle>Token Editor</TopAppBarTitle>\n          </TopAppBarSection>\n          <TopAppBarSection alignEnd>\n            <TopAppBarActionItem\n              className='white'\n              icon={save_icon}\n              onClick={saveCanvas}\n              title='Save'\n            />\n          </TopAppBarSection>\n        </TopAppBarRow>\n      </TopAppBar>\n      <TopAppBarFixedAdjust />\n    </>\n  );\n};\n\nexport default EditorHeader;\n","import React from 'react';\nimport { CollapsibleList, List, ListItem, ListItemMeta } from '@rmwc/list';\n\nimport chevron_right from '../../assets/icons/chevron_right-black-18dp.svg';\nimport envvars from '../../envvars';\nimport { ListItemsIndex } from '../editor/Editor';\n\nimport './Menu.css';\n\nconst GroupHandle: React.FunctionComponent<{ title: string }> = ({\n  title,\n  ...props\n}) => (\n  <ListItem ripple={false} {...props}>\n    {title}\n    <ListItemMeta icon={chevron_right} />\n  </ListItem>\n);\n\ninterface Props {\n  listItems: ListItemsIndex;\n  filenames: string[];\n}\n\nconst Menu: React.FunctionComponent<Props> = ({ listItems, filenames }) => {\n  const keys: string[] = filenames?.sort();\n\n  let prevGroup: string;\n  return (\n    <List>\n      {keys.reduce((comps: Array<React.ReactNode>, name) => {\n        const delimiterIndex: number = name.indexOf(\n          envvars.REACT_APP_DELIMITER\n        );\n        if (delimiterIndex >= 0) {\n          const groupName = name.substring(0, delimiterIndex);\n          if (groupName === prevGroup) return comps;\n\n          prevGroup = groupName;\n          const groupKeys = keys.filter((key) =>\n            key.startsWith(`${groupName}_`)\n          );\n          comps.push(\n            <CollapsibleList\n              handle={<GroupHandle title={groupName} />}\n              key={groupName}\n            >\n              {groupKeys.map((key) => {\n                return (\n                  <React.Fragment key={key}>{listItems[key]}</React.Fragment>\n                );\n              })}\n            </CollapsibleList>\n          );\n        } else {\n          comps.push(\n            <React.Fragment key={name}>{listItems[name]}</React.Fragment>\n          );\n        }\n        return comps;\n      }, [])}\n    </List>\n  );\n};\n\nexport default Menu;\n","import React, { useState, useEffect, FormEvent } from 'react';\nimport { ListItem, ListItemMeta } from '@rmwc/list';\nimport envvars from '../../envvars';\nimport tinycolor from 'tinycolor2';\n\nimport './ListItem.css';\n\ninterface Props {\n  color: string;\n  filename: string;\n  selectComponent: () => void;\n  selected: boolean;\n  setColor: (color: HexStr) => void;\n}\n\nconst InputListItem: React.FunctionComponent<Props> = ({\n  color,\n  filename,\n  selectComponent,\n  selected,\n  setColor,\n}) => {\n  const [ownColor, setOwnColor] = useState(color);\n  const delimiterIndex: number = filename.indexOf(envvars.REACT_APP_DELIMITER);\n  const name: string =\n    delimiterIndex >= 0 ? filename.substring(delimiterIndex + 1) : filename;\n\n  useEffect(() => {\n    setOwnColor(color);\n  }, [color]);\n\n  const handleChange = (e: FormEvent<HTMLInputElement>) => {\n    const newVal = `#${e.currentTarget.value\n      .replace(/[^a-fA-F\\d]/g, '')\n      .slice(0, 6)}`;\n    setOwnColor(newVal);\n    setColor(newVal);\n  };\n\n  const styles = {\n    backgroundColor: tinycolor(color).toHexString(),\n    color: tinycolor\n      .mostReadable(color, ['#000000', '#ffffff'], {\n        level: 'AAA',\n        size: 'small',\n      })\n      .toHexString(),\n  };\n\n  return (\n    <ListItem onClick={selectComponent} selected={selected} tabIndex={-1}>\n      {name}\n      <ListItemMeta>\n        <input\n          className={`input-chip`}\n          name={name}\n          onChange={handleChange}\n          onFocus={selectComponent}\n          style={styles}\n          value={ownColor?.toUpperCase()}\n        />\n      </ListItemMeta>\n    </ListItem>\n  );\n};\n\nexport default InputListItem;\n","import React, { Dispatch, MutableRefObject, useRef, useState } from 'react';\n\nimport Canvas from '../canvas/Canvas';\nimport ColorPicker from '../colorPicker/ColorPicker';\nimport EditorHeader from './EditorHeader';\nimport Menu from '../menu/Menu';\nimport {\n  TokenState,\n  getState,\n  useDebouncedCallback,\n  getComponentNames,\n} from './editorUtil';\n\nimport './Editor.css';\nimport InputListItem from '../listItem/ListItem';\n\ninterface Props {\n  token: string;\n  unsetToken: () => void;\n}\n\nexport interface ListItemsIndex {\n  [filename: string]: JSX.Element;\n}\n\nconst Editor: React.FunctionComponent<Props> = ({ token, unsetToken }) => {\n  const saveCanvas: MutableRefObject<(() => void) | null> = useRef(null);\n  const [selectedComponent, selectComponent]: [\n    string | null,\n    Dispatch<any>\n  ] = useState(null);\n  const [tokenState, setTokenState]: [TokenState, Dispatch<any>] = useState(\n    getState(token)\n  );\n  const setColor = useDebouncedCallback((color) => {\n    if (selectedComponent)\n      setTokenState((prevState: TokenState) => ({\n        ...prevState,\n        [selectedComponent]: color,\n      }));\n  });\n\n  if (!token) return null;\n\n  const componentNames = getComponentNames(token);\n  const listItems: ListItemsIndex = componentNames.reduce(\n    (items: ListItemsIndex, name) => {\n      items[name] = (\n        <InputListItem\n          color={tokenState[name]}\n          filename={name}\n          selectComponent={() => selectComponent(name)}\n          selected={selectedComponent === name}\n          setColor={setColor}\n        />\n      );\n      return items;\n    },\n    {}\n  );\n  return (\n    <>\n      <EditorHeader\n        saveCanvas={saveCanvas.current as () => void}\n        unsetToken={unsetToken}\n      />\n      <div className='editor'>\n        <div className='col-1'>\n          <Canvas saveCanvas={saveCanvas} state={tokenState} token={token} />\n          {selectedComponent && (\n            <ColorPicker\n              color={tokenState[selectedComponent]}\n              setColor={setColor}\n            />\n          )}\n        </div>\n        <div className='col-2'>\n          {componentNames && (\n            <Menu listItems={listItems} filenames={componentNames} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Editor;\n","import React from 'react';\nimport {\n  TopAppBar,\n  TopAppBarFixedAdjust,\n  TopAppBarRow,\n  TopAppBarSection,\n  TopAppBarTitle,\n} from '@rmwc/top-app-bar';\n\nconst GridHeader: React.FunctionComponent<{}> = () => {\n  return (\n    <>\n      <TopAppBar>\n        <TopAppBarRow>\n          <TopAppBarSection>\n            <TopAppBarTitle>Token Editor</TopAppBarTitle>\n          </TopAppBarSection>\n        </TopAppBarRow>\n      </TopAppBar>\n      <TopAppBarFixedAdjust />\n    </>\n  );\n};\n\nexport default GridHeader;\n","import React from 'react';\nimport {\n  ImageList,\n  ImageListImage,\n  ImageListItem,\n  ImageListLabel,\n  ImageListSupporting,\n} from '@rmwc/image-list';\nimport { Typography } from '@rmwc/typography';\n\nimport GridHeader from './GridHeader';\nimport config from '../../assets';\nimport envvars from '../../envvars';\n\nimport './Grid.css';\nimport '@rmwc/image-list/styles';\n\nconst Grid: React.FunctionComponent<{\n  setToken: (arg: string) => any;\n}> = ({ setToken }) => {\n  const tokenNames: string[] = Object.keys(config);\n  return (\n    <>\n      <GridHeader />\n      <div className='token-grid'>\n        <Typography className='text-center' tag='p' use='subtitle1'>\n          Select a token:\n        </Typography>\n        <ImageList withTextProtection>\n          {tokenNames.map((ref: string) => {\n            const isAvailable: boolean = ref === 'cleric';\n            const src: string = config[ref][envvars.REACT_APP_BASE].src;\n            return (\n              <ImageListItem\n                className={isAvailable ? '' : 'no-hover'}\n                key={ref}\n                onClick={() => {\n                  isAvailable && setToken(ref);\n                }}\n              >\n                <ImageListImage src={src} alt={`${ref} token`} />\n                {!isAvailable && (\n                  <ImageListSupporting>\n                    <ImageListLabel>Available Soon!</ImageListLabel>\n                  </ImageListSupporting>\n                )}\n              </ImageListItem>\n            );\n          })}\n        </ImageList>\n      </div>\n    </>\n  );\n};\n\nexport default Grid;\n","import React, { useState, Dispatch } from 'react';\n\nimport Editor from './features/editor/Editor';\nimport TokenGrid from './features/grid/Grid';\n\nimport './App.css';\nimport '@rmwc/top-app-bar/styles';\nimport '@rmwc/typography/styles';\nimport '@rmwc/list/styles';\n\nconst App: React.FunctionComponent<{}> = () => {\n  const [selectedToken, setSelectedToken]: [\n    string | null,\n    Dispatch<any>\n  ] = useState(null);\n\n  return (\n    <div className='app'>\n      {selectedToken ? (\n        <Editor\n          token={selectedToken}\n          unsetToken={() => {\n            setSelectedToken(null);\n          }}\n        />\n      ) : (\n        <TokenGrid setToken={setSelectedToken} />\n      )}\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/chevron_right-black-18dp.0c12c3a8.svg\";","/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */\n\nlet define;\n// eslint-disable-next-line\nvar fabric = fabric || { version: '3.6.3' };\nif (typeof exports !== 'undefined') {\n  exports.fabric = fabric;\n} else if (typeof define === 'function' && define.amd) {\n  /* _AMD_START_ */\n  define([], function () {\n    return fabric;\n  });\n}\n/* _AMD_END_ */\nif (typeof document !== 'undefined' && typeof window !== 'undefined') {\n  if (\n    document instanceof\n    (typeof HTMLDocument !== 'undefined' ? HTMLDocument : Document)\n  ) {\n    fabric.document = document;\n  } else {\n    fabric.document = document.implementation.createHTMLDocument('');\n  }\n  fabric.window = window;\n} else {\n  // assume we're running under node.js when document/window are not present\n  var jsdom = require('jsdom');\n  var virtualWindow = new jsdom.JSDOM(\n    decodeURIComponent(\n      '%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E'\n    ),\n    {\n      features: {\n        FetchExternalResources: ['img'],\n      },\n      resources: 'usable',\n    }\n  ).window;\n  fabric.document = virtualWindow.document;\n  fabric.jsdomImplForWrapper = require('jsdom/lib/jsdom/living/generated/utils').implForWrapper;\n  fabric.nodeCanvas = require('jsdom/lib/jsdom/utils').Canvas;\n  fabric.window = virtualWindow;\n  // DOMParser = fabric.window.DOMParser;\n}\n\n/**\n * True when in environment that supports touch events\n * @type boolean\n */\nfabric.isTouchSupported =\n  'ontouchstart' in fabric.window ||\n  'ontouchstart' in fabric.document ||\n  (fabric.window &&\n    fabric.window.navigator &&\n    fabric.window.navigator.maxTouchPoints > 0);\n\n/**\n * True when in environment that's probably Node.js\n * @type boolean\n */\nfabric.isLikelyNode =\n  typeof Buffer !== 'undefined' && typeof window === 'undefined';\n\n/* _FROM_SVG_START_ */\n/**\n * Attributes parsed from all SVG elements\n * @type array\n */\nfabric.SHARED_ATTRIBUTES = [\n  'display',\n  'transform',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'opacity',\n  'stroke',\n  'stroke-dasharray',\n  'stroke-linecap',\n  'stroke-dashoffset',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke-width',\n  'id',\n  'paint-order',\n  'vector-effect',\n  'instantiated_by_use',\n  'clip-path',\n];\n/* _FROM_SVG_END_ */\n\n/**\n * Pixel per Inch as a default value set to 96. Can be changed for more realistic conversion.\n */\nfabric.DPI = 96;\nfabric.reNum = '(?:[-+]?(?:\\\\d+|\\\\d*\\\\.\\\\d+)(?:[eE][-+]?\\\\d+)?)';\nfabric.rePathCommand = /([-+]?((\\d+\\.\\d+)|((\\d+)|(\\.\\d+)))(?:[eE][-+]?\\d+)?)/gi;\nfabric.reNonWord = /[ \\n.,;!?-]/;\nfabric.fontPaths = {};\nfabric.iMatrix = [1, 0, 0, 1, 0, 0];\nfabric.svgNS = 'http://www.w3.org/2000/svg';\n\n/**\n * Pixel limit for cache canvases. 1Mpx , 4Mpx should be fine.\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.perfLimitSizeTotal = 2097152;\n\n/**\n * Pixel limit for cache canvases width or height. IE fixes the maximum at 5000\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.maxCacheSideLimit = 4096;\n\n/**\n * Lowest pixel limit for cache canvases, set at 256PX\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.minCacheSideLimit = 256;\n\n/**\n * Cache Object for widths of chars in text rendering.\n */\nfabric.charWidthsCache = {};\n\n/**\n * if webgl is enabled and available, textureSize will determine the size\n * of the canvas backend\n * @since 2.0.0\n * @type Number\n * @default\n */\nfabric.textureSize = 2048;\n\n/**\n * When 'true', style information is not retained when copy/pasting text, making\n * pasted text use destination style.\n * Defaults to 'false'.\n * @type Boolean\n * @default\n */\nfabric.disableStyleCopyPaste = false;\n\n/**\n * Enable webgl for filtering picture is available\n * A filtering backend will be initialized, this will both take memory and\n * time since a default 2048x2048 canvas will be created for the gl context\n * @since 2.0.0\n * @type Boolean\n * @default\n */\nfabric.enableGLFiltering = true;\n\n/**\n * Device Pixel Ratio\n * @see https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/HTML-canvas-guide/SettingUptheCanvas/SettingUptheCanvas.html\n */\nfabric.devicePixelRatio =\n  fabric.window.devicePixelRatio ||\n  fabric.window.webkitDevicePixelRatio ||\n  fabric.window.mozDevicePixelRatio ||\n  1;\n/**\n * Browser-specific constant to adjust CanvasRenderingContext2D.shadowBlur value,\n * which is unitless and not rendered equally across browsers.\n *\n * Values that work quite well (as of October 2017) are:\n * - Chrome: 1.5\n * - Edge: 1.75\n * - Firefox: 0.9\n * - Safari: 0.95\n *\n * @since 2.0.0\n * @type Number\n * @default 1\n */\nfabric.browserShadowBlurConstant = 1;\n\n/**\n * This object contains the result of arc to beizer conversion for faster retrieving if the same arc needs to be converted again.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.arcToSegmentsCache = {};\n\n/**\n * This object keeps the results of the boundsOfCurve calculation mapped by the joined arguments necessary to calculate it.\n * It does speed up calculation, if you parse and add always the same paths, but in case of heavy usage of freedrawing\n * you do not get any speed benefit and you get a big object in memory.\n * The object was a private variable before, while now is appended to the lib so that you have access to it and you\n * can eventually clear it.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.boundsOfCurveCache = {};\n\n/**\n * If disabled boundsOfCurveCache is not used. For apps that make heavy usage of pencil drawing probably disabling it is better\n * @default true\n */\nfabric.cachesBoundsOfCurve = true;\n\n/**\n * Skip performance testing of setupGLContext and force the use of putImageData that seems to be the one that works best on\n * Chrome + old hardware. if your users are experiencing empty images after filtering you may try to force this to true\n * this has to be set before instantiating the filtering backend ( before filtering the first image )\n * @type Boolean\n * @default false\n */\nfabric.forceGLPutImageData = false;\n\nfabric.initFilterBackend = function () {\n  if (\n    fabric.enableGLFiltering &&\n    fabric.isWebglSupported &&\n    fabric.isWebglSupported(fabric.textureSize)\n  ) {\n    console.log('max texture size: ' + fabric.maxTextureSize);\n    return new fabric.WebglFilterBackend({ tileSize: fabric.textureSize });\n  } else if (fabric.Canvas2dFilterBackend) {\n    return new fabric.Canvas2dFilterBackend();\n  }\n};\n(function () {\n  /**\n   * @private\n   * @param {String} eventName\n   * @param {Function} handler\n   */\n  function _removeEventListener(eventName, handler) {\n    if (!this.__eventListeners[eventName]) {\n      return;\n    }\n    var eventListener = this.__eventListeners[eventName];\n    if (handler) {\n      eventListener[eventListener.indexOf(handler)] = false;\n    } else {\n      fabric.util.array.fill(eventListener, false);\n    }\n  }\n\n  /**\n   * Observes specified event\n   * @deprecated `observe` deprecated since 0.8.34 (use `on` instead)\n   * @memberOf fabric.Observable\n   * @alias on\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function that receives a notification when an event of the specified type occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function observe(eventName, handler) {\n    if (!this.__eventListeners) {\n      this.__eventListeners = {};\n    }\n    // one object with key/value pairs was passed\n    if (arguments.length === 1) {\n      for (var prop in eventName) {\n        this.on(prop, eventName[prop]);\n      }\n    } else {\n      if (!this.__eventListeners[eventName]) {\n        this.__eventListeners[eventName] = [];\n      }\n      this.__eventListeners[eventName].push(handler);\n    }\n    return this;\n  }\n\n  /**\n   * Stops event observing for a particular event handler. Calling this method\n   * without arguments removes all handlers for all events\n   * @deprecated `stopObserving` deprecated since 0.8.34 (use `off` instead)\n   * @memberOf fabric.Observable\n   * @alias off\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function to be deleted from EventListeners\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function stopObserving(eventName, handler) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    // remove all key/value pairs (event name -> event handler)\n    if (arguments.length === 0) {\n      for (eventName in this.__eventListeners) {\n        _removeEventListener.call(this, eventName);\n      }\n    }\n    // one object with key/value pairs was passed\n    else if (arguments.length === 1 && typeof arguments[0] === 'object') {\n      for (var prop in eventName) {\n        _removeEventListener.call(this, prop, eventName[prop]);\n      }\n    } else {\n      _removeEventListener.call(this, eventName, handler);\n    }\n    return this;\n  }\n\n  /**\n   * Fires event with an optional options object\n   * @deprecated `fire` deprecated since 1.0.7 (use `trigger` instead)\n   * @memberOf fabric.Observable\n   * @alias trigger\n   * @param {String} eventName Event name to fire\n   * @param {Object} [options] Options object\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function fire(eventName, options) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    var listenersForEvent = this.__eventListeners[eventName];\n    if (!listenersForEvent) {\n      return this;\n    }\n\n    for (var i = 0, len = listenersForEvent.length; i < len; i++) {\n      listenersForEvent[i] && listenersForEvent[i].call(this, options || {});\n    }\n    this.__eventListeners[eventName] = listenersForEvent.filter(function (\n      value\n    ) {\n      return value !== false;\n    });\n    return this;\n  }\n\n  /**\n   * @namespace fabric.Observable\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#events}\n   * @see {@link http://fabricjs.com/events|Events demo}\n   */\n  fabric.Observable = {\n    observe: observe,\n    stopObserving: stopObserving,\n    fire: fire,\n\n    on: observe,\n    off: stopObserving,\n    trigger: fire,\n  };\n})();\n/**\n * @namespace fabric.Collection\n */\nfabric.Collection = {\n  _objects: [],\n\n  /**\n   * Adds objects to collection, Canvas or Group, then renders canvas\n   * (if `renderOnAddRemove` is not `false`).\n   * in case of Group no changes to bounding box are made.\n   * Objects should be instances of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the add method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  add: function () {\n    this._objects.push.apply(this._objects, arguments);\n    if (this._onObjectAdded) {\n      for (var i = 0, length = arguments.length; i < length; i++) {\n        this._onObjectAdded(arguments[i]);\n      }\n    }\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Inserts an object into collection at specified index, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * An object should be an instance of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the insertAt method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {Object} object Object to insert\n   * @param {Number} index Index to insert object at\n   * @param {Boolean} nonSplicing When `true`, no splicing (shifting) of objects occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  insertAt: function (object, index, nonSplicing) {\n    var objects = this._objects;\n    if (nonSplicing) {\n      objects[index] = object;\n    } else {\n      objects.splice(index, 0, object);\n    }\n    this._onObjectAdded && this._onObjectAdded(object);\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Removes objects from a collection, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  remove: function () {\n    var objects = this._objects,\n      index,\n      somethingRemoved = false;\n\n    for (var i = 0, length = arguments.length; i < length; i++) {\n      index = objects.indexOf(arguments[i]);\n\n      // only call onObjectRemoved if an object was actually removed\n      if (index !== -1) {\n        somethingRemoved = true;\n        objects.splice(index, 1);\n        this._onObjectRemoved && this._onObjectRemoved(arguments[i]);\n      }\n    }\n\n    this.renderOnAddRemove && somethingRemoved && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Executes given function for each object in this group\n   * @param {Function} callback\n   *                   Callback invoked with current object as first argument,\n   *                   index - as second and an array of all objects - as third.\n   *                   Callback is invoked in a context of Global Object (e.g. `window`)\n   *                   when no `context` argument is given\n   *\n   * @param {Object} context Context (aka thisObject)\n   * @return {Self} thisArg\n   * @chainable\n   */\n  forEachObject: function (callback, context) {\n    var objects = this.getObjects();\n    for (var i = 0, len = objects.length; i < len; i++) {\n      callback.call(context, objects[i], i, objects);\n    }\n    return this;\n  },\n\n  /**\n   * Returns an array of children objects of this instance\n   * Type parameter introduced in 1.3.10\n   * since 2.3.5 this method return always a COPY of the array;\n   * @param {String} [type] When specified, only objects of this type are returned\n   * @return {Array}\n   */\n  getObjects: function (type) {\n    if (typeof type === 'undefined') {\n      return this._objects.concat();\n    }\n    return this._objects.filter(function (o) {\n      return o.type === type;\n    });\n  },\n\n  /**\n   * Returns object at specified index\n   * @param {Number} index\n   * @return {Self} thisArg\n   */\n  item: function (index) {\n    return this._objects[index];\n  },\n\n  /**\n   * Returns true if collection contains no objects\n   * @return {Boolean} true if collection is empty\n   */\n  isEmpty: function () {\n    return this._objects.length === 0;\n  },\n\n  /**\n   * Returns a size of a collection (i.e: length of an array containing its objects)\n   * @return {Number} Collection size\n   */\n  size: function () {\n    return this._objects.length;\n  },\n\n  /**\n   * Returns true if collection contains an object\n   * @param {Object} object Object to check against\n   * @return {Boolean} `true` if collection contains an object\n   */\n  contains: function (object) {\n    return this._objects.indexOf(object) > -1;\n  },\n\n  /**\n   * Returns number representation of a collection complexity\n   * @return {Number} complexity\n   */\n  complexity: function () {\n    return this._objects.reduce(function (memo, current) {\n      memo += current.complexity ? current.complexity() : 0;\n      return memo;\n    }, 0);\n  },\n};\n/**\n * @namespace fabric.CommonMethods\n */\nfabric.CommonMethods = {\n  /**\n   * Sets object's properties from options\n   * @param {Object} [options] Options object\n   */\n  _setOptions: function (options) {\n    for (var prop in options) {\n      this.set(prop, options[prop]);\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Gradient to\n   */\n  _initGradient: function (filler, property) {\n    if (filler && filler.colorStops && !(filler instanceof fabric.Gradient)) {\n      this.set(property, new fabric.Gradient(filler));\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Pattern to\n   * @param {Function} [callback] callback to invoke after pattern load\n   */\n  _initPattern: function (filler, property, callback) {\n    if (filler && filler.source && !(filler instanceof fabric.Pattern)) {\n      this.set(property, new fabric.Pattern(filler, callback));\n    } else {\n      callback && callback();\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [options] Options object\n   */\n  _initClipping: function (options) {\n    if (!options.clipTo || typeof options.clipTo !== 'string') {\n      return;\n    }\n\n    // var functionBody = fabric.util.getFunctionBody(options.clipTo);\n    if (typeof functionBody !== 'undefined') {\n      this.clipTo = function (ctx) {\n        fabric.util.getFunctionBody(options.clipTo);\n      };\n      // this.clipTo = new Function('ctx', functionBody);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _setObject: function (obj) {\n    for (var prop in obj) {\n      this._set(prop, obj[prop]);\n    }\n  },\n\n  /**\n   * Sets property to a given value. When changing position/dimension -related properties (left, top, scale, angle, etc.) `set` does not update position of object's borders/controls. If you need to update those, call `setCoords()`.\n   * @param {String|Object} key Property name or object (if object, iterate over the object properties)\n   * @param {Object|Function} value Property value (if function, the value is passed into it and its return value is used as a new one)\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  set: function (key, value) {\n    if (typeof key === 'object') {\n      this._setObject(key);\n    } else {\n      if (typeof value === 'function' && key !== 'clipTo') {\n        this._set(key, value(this.get(key)));\n      } else {\n        this._set(key, value);\n      }\n    }\n    return this;\n  },\n\n  _set: function (key, value) {\n    this[key] = value;\n  },\n\n  /**\n   * Toggles specified property from `true` to `false` or from `false` to `true`\n   * @param {String} property Property to toggle\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  toggle: function (property) {\n    var value = this.get(property);\n    if (typeof value === 'boolean') {\n      this.set(property, !value);\n    }\n    return this;\n  },\n\n  /**\n   * Basic getter\n   * @param {String} property Property name\n   * @return {*} value of a property\n   */\n  get: function (property) {\n    return this[property];\n  },\n};\n(function initUtilities(global) {\n  var sqrt = Math.sqrt,\n    atan2 = Math.atan2,\n    pow = Math.pow,\n    PiBy180 = Math.PI / 180,\n    PiBy2 = Math.PI / 2;\n\n  /**\n   * @namespace fabric.util\n   */\n  fabric.util = {\n    /**\n     * Calculate the cos of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    cos: function (angle) {\n      if (angle === 0) {\n        return 1;\n      }\n      if (angle < 0) {\n        // cos(a) = cos(-a)\n        angle = -angle;\n      }\n      var angleSlice = angle / PiBy2;\n      switch (angleSlice) {\n        case 1:\n        case 3:\n          return 0;\n        case 2:\n          return -1;\n        default:\n      }\n      return Math.cos(angle);\n    },\n\n    /**\n     * Calculate the sin of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    sin: function (angle) {\n      if (angle === 0) {\n        return 0;\n      }\n      var angleSlice = angle / PiBy2,\n        sign = 1;\n      if (angle < 0) {\n        // sin(-a) = -sin(a)\n        sign = -1;\n      }\n      switch (angleSlice) {\n        case 1:\n          return sign;\n        case 2:\n          return 0;\n        case 3:\n          return -sign;\n        default:\n      }\n      return Math.sin(angle);\n    },\n\n    /**\n     * Removes value from an array.\n     * Presence of value (and its position in an array) is determined via `Array.prototype.indexOf`\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} array\n     * @param {*} value\n     * @return {Array} original array\n     */\n    removeFromArray: function (array, value) {\n      var idx = array.indexOf(value);\n      if (idx !== -1) {\n        array.splice(idx, 1);\n      }\n      return array;\n    },\n\n    /**\n     * Returns random number between 2 specified ones.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} min lower limit\n     * @param {Number} max upper limit\n     * @return {Number} random value (between min and max)\n     */\n    getRandomInt: function (min, max) {\n      return Math.floor(Math.random() * (max - min + 1)) + min;\n    },\n\n    /**\n     * Transforms degrees to radians.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} degrees value in degrees\n     * @return {Number} value in radians\n     */\n    degreesToRadians: function (degrees) {\n      return degrees * PiBy180;\n    },\n\n    /**\n     * Transforms radians to degrees.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} radians value in radians\n     * @return {Number} value in degrees\n     */\n    radiansToDegrees: function (radians) {\n      return radians / PiBy180;\n    },\n\n    /**\n     * Rotates `point` around `origin` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {fabric.Point} point The point to rotate\n     * @param {fabric.Point} origin The origin of the rotation\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {fabric.Point} The new rotated point\n     */\n    rotatePoint: function (point, origin, radians) {\n      point.subtractEquals(origin);\n      var v = fabric.util.rotateVector(point, radians);\n      return new fabric.Point(v.x, v.y).addEquals(origin);\n    },\n\n    /**\n     * Rotates `vector` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} vector The vector to rotate (x and y)\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {Object} The new rotated point\n     */\n    rotateVector: function (vector, radians) {\n      var sin = fabric.util.sin(radians),\n        cos = fabric.util.cos(radians),\n        rx = vector.x * cos - vector.y * sin,\n        ry = vector.x * sin + vector.y * cos;\n      return {\n        x: rx,\n        y: ry,\n      };\n    },\n\n    /**\n     * Apply transform t to point p\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Point} p The point to transform\n     * @param  {Array} t The transform\n     * @param  {Boolean} [ignoreOffset] Indicates that the offset should not be applied\n     * @return {fabric.Point} The transformed point\n     */\n    transformPoint: function (p, t, ignoreOffset) {\n      if (ignoreOffset) {\n        return new fabric.Point(\n          t[0] * p.x + t[2] * p.y,\n          t[1] * p.x + t[3] * p.y\n        );\n      }\n      return new fabric.Point(\n        t[0] * p.x + t[2] * p.y + t[4],\n        t[1] * p.x + t[3] * p.y + t[5]\n      );\n    },\n\n    /**\n     * Returns coordinates of points's bounding rectangle (left, top, width, height)\n     * @param {Array} points 4 points array\n     * @param {Array} [transform] an array of 6 numbers representing a 2x3 transform matrix\n     * @return {Object} Object with left, top, width, height properties\n     */\n    makeBoundingBoxFromPoints: function (points, transform) {\n      if (transform) {\n        for (var i = 0; i < points.length; i++) {\n          points[i] = fabric.util.transformPoint(points[i], transform);\n        }\n      }\n      var xPoints = [points[0].x, points[1].x, points[2].x, points[3].x],\n        minX = fabric.util.array.min(xPoints),\n        maxX = fabric.util.array.max(xPoints),\n        width = maxX - minX,\n        yPoints = [points[0].y, points[1].y, points[2].y, points[3].y],\n        minY = fabric.util.array.min(yPoints),\n        maxY = fabric.util.array.max(yPoints),\n        height = maxY - minY;\n\n      return {\n        left: minX,\n        top: minY,\n        width: width,\n        height: height,\n      };\n    },\n\n    /**\n     * Invert transformation t\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} t The transform\n     * @return {Array} The inverted transform\n     */\n    invertTransform: function (t) {\n      var a = 1 / (t[0] * t[3] - t[1] * t[2]),\n        r = [a * t[3], -a * t[1], -a * t[2], a * t[0]],\n        o = fabric.util.transformPoint({ x: t[4], y: t[5] }, r, true);\n      r[4] = -o.x;\n      r[5] = -o.y;\n      return r;\n    },\n\n    /**\n     * A wrapper around Number#toFixed, which contrary to native method returns number, not string.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number|String} number number to operate on\n     * @param {Number} fractionDigits number of fraction digits to \"leave\"\n     * @return {Number}\n     */\n    toFixed: function (number, fractionDigits) {\n      return parseFloat(Number(number).toFixed(fractionDigits));\n    },\n\n    /**\n     * Converts from attribute value to pixel value if applicable.\n     * Returns converted pixels or original value not converted.\n     * @param {Number|String} value number to operate on\n     * @param {Number} fontSize\n     * @return {Number|String}\n     */\n    parseUnit: function (value, fontSize) {\n      var unit = /\\D{0,2}$/.exec(value),\n        number = parseFloat(value);\n      if (!fontSize) {\n        fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\n      }\n      switch (unit[0]) {\n        case 'mm':\n          return (number * fabric.DPI) / 25.4;\n\n        case 'cm':\n          return (number * fabric.DPI) / 2.54;\n\n        case 'in':\n          return number * fabric.DPI;\n\n        case 'pt':\n          return (number * fabric.DPI) / 72; // or * 4 / 3\n\n        case 'pc':\n          return ((number * fabric.DPI) / 72) * 12; // or * 16\n\n        case 'em':\n          return number * fontSize;\n\n        default:\n          return number;\n      }\n    },\n\n    /**\n     * Function which always returns `false`.\n     * @static\n     * @memberOf fabric.util\n     * @return {Boolean}\n     */\n    falseFunction: function () {\n      return false;\n    },\n\n    /**\n     * Returns klass \"Class\" object of given namespace\n     * @memberOf fabric.util\n     * @param {String} type Type of object (eg. 'circle')\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @return {Object} klass \"Class\"\n     */\n    getKlass: function (type, namespace) {\n      // capitalize first letter only\n      type = fabric.util.string.camelize(\n        type.charAt(0).toUpperCase() + type.slice(1)\n      );\n      return fabric.util.resolveNamespace(namespace)[type];\n    },\n\n    /**\n     * Returns array of attributes for given svg that fabric parses\n     * @memberOf fabric.util\n     * @param {String} type Type of svg element (eg. 'circle')\n     * @return {Array} string names of supported attributes\n     */\n    getSvgAttributes: function (type) {\n      var attributes = ['instantiated_by_use', 'style', 'id', 'class'];\n      switch (type) {\n        case 'linearGradient':\n          attributes = attributes.concat([\n            'x1',\n            'y1',\n            'x2',\n            'y2',\n            'gradientUnits',\n            'gradientTransform',\n          ]);\n          break;\n        case 'radialGradient':\n          attributes = attributes.concat([\n            'gradientUnits',\n            'gradientTransform',\n            'cx',\n            'cy',\n            'r',\n            'fx',\n            'fy',\n            'fr',\n          ]);\n          break;\n        case 'stop':\n          attributes = attributes.concat([\n            'offset',\n            'stop-color',\n            'stop-opacity',\n          ]);\n          break;\n        default:\n          break;\n      }\n      return attributes;\n    },\n\n    /**\n     * Returns object of given namespace\n     * @memberOf fabric.util\n     * @param {String} namespace Namespace string e.g. 'fabric.Image.filter' or 'fabric'\n     * @return {Object} Object for given namespace (default fabric)\n     */\n    resolveNamespace: function (namespace) {\n      if (!namespace) {\n        return fabric;\n      }\n\n      var parts = namespace.split('.'),\n        len = parts.length,\n        i,\n        obj = global || fabric.window;\n\n      for (i = 0; i < len; ++i) {\n        obj = obj[parts[i]];\n      }\n\n      return obj;\n    },\n\n    /**\n     * Loads image element from given url and passes it to a callback\n     * @memberOf fabric.util\n     * @param {String} url URL representing an image\n     * @param {Function} callback Callback; invoked with loaded image\n     * @param {*} [context] Context to invoke callback in\n     * @param {Object} [crossOrigin] crossOrigin value to set image element to\n     */\n    loadImage: function (url, callback, context, crossOrigin) {\n      if (!url) {\n        callback && callback.call(context, url);\n        return;\n      }\n\n      var img = fabric.util.createImage();\n\n      /** @ignore */\n      var onLoadCallback = function () {\n        callback && callback.call(context, img);\n        img = img.onload = img.onerror = null;\n      };\n\n      img.onload = onLoadCallback;\n      /** @ignore */\n      img.onerror = function () {\n        fabric.log('Error loading ' + img.src);\n        callback && callback.call(context, null, true);\n        img = img.onload = img.onerror = null;\n      };\n\n      // data-urls appear to be buggy with crossOrigin\n      // https://github.com/kangax/fabric.js/commit/d0abb90f1cd5c5ef9d2a94d3fb21a22330da3e0a#commitcomment-4513767\n      // see https://code.google.com/p/chromium/issues/detail?id=315152\n      //     https://bugzilla.mozilla.org/show_bug.cgi?id=935069\n      if (url.indexOf('data') !== 0 && crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      // IE10 / IE11-Fix: SVG contents from data: URI\n      // will only be available if the IMG is present\n      // in the DOM (and visible)\n      if (url.substring(0, 14) === 'data:image/svg') {\n        img.onload = null;\n        fabric.util.loadImageInDom(img, onLoadCallback);\n      }\n\n      img.src = url;\n    },\n\n    /**\n     * Attaches SVG image with data: URL to the dom\n     * @memberOf fabric.util\n     * @param {Object} img Image object with data:image/svg src\n     * @param {Function} callback Callback; invoked with loaded image\n     * @return {Object} DOM element (div containing the SVG image)\n     */\n    loadImageInDom: function (img, onLoadCallback) {\n      var div = fabric.document.createElement('div');\n      div.style.width = div.style.height = '1px';\n      div.style.left = div.style.top = '-100%';\n      div.style.position = 'absolute';\n      div.appendChild(img);\n      fabric.document.querySelector('body').appendChild(div);\n      /**\n       * Wrap in function to:\n       *   1. Call existing callback\n       *   2. Cleanup DOM\n       */\n      img.onload = function () {\n        onLoadCallback();\n        div.parentNode.removeChild(div);\n        div = null;\n      };\n    },\n\n    /**\n     * Creates corresponding fabric instances from their object representations\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} objects Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @param {Function} reviver Method for further parsing of object elements,\n     * called after each fabric object created.\n     */\n    enlivenObjects: function (objects, callback, namespace, reviver) {\n      objects = objects || [];\n\n      var enlivenedObjects = [],\n        numLoadedObjects = 0,\n        numTotalObjects = objects.length;\n\n      function onLoaded() {\n        if (++numLoadedObjects === numTotalObjects) {\n          callback &&\n            callback(\n              enlivenedObjects.filter(function (obj) {\n                // filter out undefined objects (objects that gave error)\n                return obj;\n              })\n            );\n        }\n      }\n\n      if (!numTotalObjects) {\n        callback && callback(enlivenedObjects);\n        return;\n      }\n\n      objects.forEach(function (o, index) {\n        // if sparse array\n        if (!o || !o.type) {\n          onLoaded();\n          return;\n        }\n        var klass = fabric.util.getKlass(o.type, namespace);\n        klass.fromObject(o, function (obj, error) {\n          error || (enlivenedObjects[index] = obj);\n          reviver && reviver(o, obj, error);\n          onLoaded();\n        });\n      });\n    },\n\n    /**\n     * Create and wait for loading of patterns\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} patterns Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * called after each fabric object created.\n     */\n    enlivenPatterns: function (patterns, callback) {\n      patterns = patterns || [];\n\n      function onLoaded() {\n        if (++numLoadedPatterns === numPatterns) {\n          callback && callback(enlivenedPatterns);\n        }\n      }\n\n      var enlivenedPatterns = [],\n        numLoadedPatterns = 0,\n        numPatterns = patterns.length;\n\n      if (!numPatterns) {\n        callback && callback(enlivenedPatterns);\n        return;\n      }\n\n      patterns.forEach(function (p, index) {\n        if (p && p.source) {\n          new fabric.Pattern(p, function (pattern) {\n            enlivenedPatterns[index] = pattern;\n            onLoaded();\n          });\n        } else {\n          enlivenedPatterns[index] = p;\n          onLoaded();\n        }\n      });\n    },\n\n    /**\n     * Groups SVG elements (usually those retrieved from SVG document)\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} elements SVG elements to group\n     * @param {Object} [options] Options object\n     * @param {String} path Value to set sourcePath to\n     * @return {fabric.Object|fabric.Group}\n     */\n    groupSVGElements: function (elements, options, path) {\n      var object;\n      if (elements && elements.length === 1) {\n        return elements[0];\n      }\n      if (options) {\n        if (options.width && options.height) {\n          options.centerPoint = {\n            x: options.width / 2,\n            y: options.height / 2,\n          };\n        } else {\n          delete options.width;\n          delete options.height;\n        }\n      }\n      object = new fabric.Group(elements, options);\n      if (typeof path !== 'undefined') {\n        object.sourcePath = path;\n      }\n      return object;\n    },\n\n    /**\n     * Populates an object with properties of another object\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} source Source object\n     * @param {Object} destination Destination object\n     * @return {Array} properties Properties names to include\n     */\n    populateWithProperties: function (source, destination, properties) {\n      if (\n        properties &&\n        Object.prototype.toString.call(properties) === '[object Array]'\n      ) {\n        for (var i = 0, len = properties.length; i < len; i++) {\n          if (properties[i] in source) {\n            destination[properties[i]] = source[properties[i]];\n          }\n        }\n      }\n    },\n\n    /**\n     * Draws a dashed line between two points\n     *\n     * This method is used to draw dashed line around selection area.\n     * See <a href=\"http://stackoverflow.com/questions/4576724/dotted-stroke-in-canvas\">dotted stroke in canvas</a>\n     *\n     * @param {CanvasRenderingContext2D} ctx context\n     * @param {Number} x  start x coordinate\n     * @param {Number} y start y coordinate\n     * @param {Number} x2 end x coordinate\n     * @param {Number} y2 end y coordinate\n     * @param {Array} da dash array pattern\n     */\n    drawDashedLine: function (ctx, x, y, x2, y2, da) {\n      var dx = x2 - x,\n        dy = y2 - y,\n        len = sqrt(dx * dx + dy * dy),\n        rot = atan2(dy, dx),\n        dc = da.length,\n        di = 0,\n        draw = true;\n\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.moveTo(0, 0);\n      ctx.rotate(rot);\n\n      x = 0;\n      while (len > x) {\n        x += da[di++ % dc];\n        if (x > len) {\n          x = len;\n        }\n        ctx[draw ? 'lineTo' : 'moveTo'](x, 0);\n        draw = !draw;\n      }\n\n      ctx.restore();\n    },\n\n    /**\n     * Creates canvas element\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    createCanvasElement: function () {\n      return fabric.document.createElement('canvas');\n    },\n\n    /**\n     * Creates a canvas element that is a copy of another and is also painted\n     * @param {CanvasElement} canvas to copy size and content of\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    copyCanvasElement: function (canvas) {\n      var newCanvas = fabric.util.createCanvasElement();\n      newCanvas.width = canvas.width;\n      newCanvas.height = canvas.height;\n      newCanvas.getContext('2d').drawImage(canvas, 0, 0);\n      return newCanvas;\n    },\n\n    /**\n     * since 2.6.0 moved from canvas instance to utility.\n     * @param {CanvasElement} canvasEl to copy size and content of\n     * @param {String} format 'jpeg' or 'png', in some browsers 'webp' is ok too\n     * @param {Number} quality <= 1 and > 0\n     * @static\n     * @memberOf fabric.util\n     * @return {String} data url\n     */\n    toDataURL: function (canvasEl, format, quality) {\n      return canvasEl.toDataURL('image/' + format, quality);\n    },\n\n    /**\n     * Creates image element (works on client and node)\n     * @static\n     * @memberOf fabric.util\n     * @return {HTMLImageElement} HTML image element\n     */\n    createImage: function () {\n      return fabric.document.createElement('img');\n    },\n\n    /**\n     * @static\n     * @memberOf fabric.util\n     * @deprecated since 2.0.0\n     * @param {fabric.Object} receiver Object implementing `clipTo` method\n     * @param {CanvasRenderingContext2D} ctx Context to clip\n     */\n    clipContext: function (receiver, ctx) {\n      ctx.save();\n      ctx.beginPath();\n      receiver.clipTo(ctx);\n      ctx.clip();\n    },\n\n    /**\n     * Multiply matrix A by matrix B to nest transformations\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a First transformMatrix\n     * @param  {Array} b Second transformMatrix\n     * @param  {Boolean} is2x2 flag to multiply matrices as 2x2 matrices\n     * @return {Array} The product of the two transform matrices\n     */\n    multiplyTransformMatrices: function (a, b, is2x2) {\n      // Matrix multiply a * b\n      return [\n        a[0] * b[0] + a[2] * b[1],\n        a[1] * b[0] + a[3] * b[1],\n        a[0] * b[2] + a[2] * b[3],\n        a[1] * b[2] + a[3] * b[3],\n        is2x2 ? 0 : a[0] * b[4] + a[2] * b[5] + a[4],\n        is2x2 ? 0 : a[1] * b[4] + a[3] * b[5] + a[5],\n      ];\n    },\n\n    /**\n     * Decomposes standard 2x3 matrix into transform components\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a transformMatrix\n     * @return {Object} Components of transform\n     */\n    qrDecompose: function (a) {\n      var angle = atan2(a[1], a[0]),\n        denom = pow(a[0], 2) + pow(a[1], 2),\n        scaleX = sqrt(denom),\n        scaleY = (a[0] * a[3] - a[2] * a[1]) / scaleX,\n        skewX = atan2(a[0] * a[2] + a[1] * a[3], denom);\n      return {\n        angle: angle / PiBy180,\n        scaleX: scaleX,\n        scaleY: scaleY,\n        skewX: skewX / PiBy180,\n        skewY: 0,\n        translateX: a[4],\n        translateY: a[5],\n      };\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle] angle in degrees\n     * @return {Number[]} transform matrix\n     */\n    calcRotateMatrix: function (options) {\n      if (!options.angle) {\n        return fabric.iMatrix.concat();\n      }\n      var theta = fabric.util.degreesToRadians(options.angle),\n        cos = fabric.util.cos(theta),\n        sin = fabric.util.sin(theta);\n      return [cos, sin, -sin, cos, 0, 0];\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet.\n     * is called DimensionsTransformMatrix because those properties are the one that influence\n     * the size of the resulting box of the object.\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewX]\n     * @return {Number[]} transform matrix\n     */\n    calcDimensionsMatrix: function (options) {\n      var scaleX = typeof options.scaleX === 'undefined' ? 1 : options.scaleX,\n        scaleY = typeof options.scaleY === 'undefined' ? 1 : options.scaleY,\n        scaleMatrix = [\n          options.flipX ? -scaleX : scaleX,\n          0,\n          0,\n          options.flipY ? -scaleY : scaleY,\n          0,\n          0,\n        ],\n        multiply = fabric.util.multiplyTransformMatrices,\n        degreesToRadians = fabric.util.degreesToRadians;\n      if (options.skewX) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, 0, Math.tan(degreesToRadians(options.skewX)), 1],\n          true\n        );\n      }\n      if (options.skewY) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, Math.tan(degreesToRadians(options.skewY)), 0, 1],\n          true\n        );\n      }\n      return scaleMatrix;\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle]\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.translateX]\n     * @param  {Number} [options.translateY]\n     * @return {Number[]} transform matrix\n     */\n    composeMatrix: function (options) {\n      var matrix = [\n          1,\n          0,\n          0,\n          1,\n          options.translateX || 0,\n          options.translateY || 0,\n        ],\n        multiply = fabric.util.multiplyTransformMatrices;\n      if (options.angle) {\n        matrix = multiply(matrix, fabric.util.calcRotateMatrix(options));\n      }\n      if (\n        options.scaleX ||\n        options.scaleY ||\n        options.skewX ||\n        options.skewY ||\n        options.flipX ||\n        options.flipY\n      ) {\n        matrix = multiply(matrix, fabric.util.calcDimensionsMatrix(options));\n      }\n      return matrix;\n    },\n\n    /**\n     * Returns a transform matrix that has the same effect of scaleX, scaleY and skewX.\n     * Is deprecated for composeMatrix. Please do not use it.\n     * @static\n     * @deprecated since 3.4.0\n     * @memberOf fabric.util\n     * @param  {Number} scaleX\n     * @param  {Number} scaleY\n     * @param  {Number} skewX\n     * @return {Number[]} transform matrix\n     */\n    customTransformMatrix: function (scaleX, scaleY, skewX) {\n      return fabric.util.composeMatrix({\n        scaleX: scaleX,\n        scaleY: scaleY,\n        skewX: skewX,\n      });\n    },\n\n    /**\n     * reset an object transform state to neutral. Top and left are not accounted for\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to transform\n     */\n    resetObjectTransform: function (target) {\n      target.scaleX = 1;\n      target.scaleY = 1;\n      target.skewX = 0;\n      target.skewY = 0;\n      target.flipX = false;\n      target.flipY = false;\n      target.rotate(0);\n    },\n\n    /**\n     * Extract Object transform values\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to read from\n     * @return {Object} Components of transform\n     */\n    saveObjectTransform: function (target) {\n      return {\n        scaleX: target.scaleX,\n        scaleY: target.scaleY,\n        skewX: target.skewX,\n        skewY: target.skewY,\n        angle: target.angle,\n        left: target.left,\n        flipX: target.flipX,\n        flipY: target.flipY,\n        top: target.top,\n      };\n    },\n\n    /**\n     * Returns string representation of function body\n     * @param {Function} fn Function to get body of\n     * @return {String} Function body\n     */\n    getFunctionBody: function (fn) {\n      return (String(fn).match(/function[^{]*\\{([\\s\\S]*)\\}/) || {})[1];\n    },\n\n    /**\n     * Returns true if context has transparent pixel\n     * at specified location (taking tolerance into account)\n     * @param {CanvasRenderingContext2D} ctx context\n     * @param {Number} x x coordinate\n     * @param {Number} y y coordinate\n     * @param {Number} tolerance Tolerance\n     */\n    isTransparent: function (ctx, x, y, tolerance) {\n      // If tolerance is > 0 adjust start coords to take into account.\n      // If moves off Canvas fix to 0\n      if (tolerance > 0) {\n        if (x > tolerance) {\n          x -= tolerance;\n        } else {\n          x = 0;\n        }\n        if (y > tolerance) {\n          y -= tolerance;\n        } else {\n          y = 0;\n        }\n      }\n\n      var _isTransparent = true,\n        i,\n        temp,\n        imageData = ctx.getImageData(\n          x,\n          y,\n          tolerance * 2 || 1,\n          tolerance * 2 || 1\n        ),\n        l = imageData.data.length;\n\n      // Split image data - for tolerance > 1, pixelDataSize = 4;\n      for (i = 3; i < l; i += 4) {\n        temp = imageData.data[i];\n        _isTransparent = temp <= 0;\n        if (_isTransparent === false) {\n          break; // Stop if colour found\n        }\n      }\n\n      imageData = null;\n\n      return _isTransparent;\n    },\n\n    /**\n     * Parse preserveAspectRatio attribute from element\n     * @param {string} attribute to be parsed\n     * @return {Object} an object containing align and meetOrSlice attribute\n     */\n    parsePreserveAspectRatioAttribute: function (attribute) {\n      var meetOrSlice = 'meet',\n        alignX = 'Mid',\n        alignY = 'Mid',\n        aspectRatioAttrs = attribute.split(' '),\n        align;\n\n      if (aspectRatioAttrs && aspectRatioAttrs.length) {\n        meetOrSlice = aspectRatioAttrs.pop();\n        if (meetOrSlice !== 'meet' && meetOrSlice !== 'slice') {\n          align = meetOrSlice;\n          meetOrSlice = 'meet';\n        } else if (aspectRatioAttrs.length) {\n          align = aspectRatioAttrs.pop();\n        }\n      }\n      //divide align in alignX and alignY\n      alignX = align !== 'none' ? align.slice(1, 4) : 'none';\n      alignY = align !== 'none' ? align.slice(5, 8) : 'none';\n      return {\n        meetOrSlice: meetOrSlice,\n        alignX: alignX,\n        alignY: alignY,\n      };\n    },\n\n    /**\n     * Clear char widths cache for the given font family or all the cache if no\n     * fontFamily is specified.\n     * Use it if you know you are loading fonts in a lazy way and you are not waiting\n     * for custom fonts to load properly when adding text objects to the canvas.\n     * If a text object is added when its own font is not loaded yet, you will get wrong\n     * measurement and so wrong bounding boxes.\n     * After the font cache is cleared, either change the textObject text content or call\n     * initDimensions() to trigger a recalculation\n     * @memberOf fabric.util\n     * @param {String} [fontFamily] font family to clear\n     */\n    clearFabricFontCache: function (fontFamily) {\n      fontFamily = (fontFamily || '').toLowerCase();\n      if (!fontFamily) {\n        fabric.charWidthsCache = {};\n      } else if (fabric.charWidthsCache[fontFamily]) {\n        delete fabric.charWidthsCache[fontFamily];\n      }\n    },\n\n    /**\n     * Given current aspect ratio, determines the max width and height that can\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Number} ar aspect ratio\n     * @param {Number} maximumArea Maximum area you want to achieve\n     * @return {Object.x} Limited dimensions by X\n     * @return {Object.y} Limited dimensions by Y\n     */\n    limitDimsByArea: function (ar, maximumArea) {\n      var roughWidth = Math.sqrt(maximumArea * ar),\n        perfLimitSizeY = Math.floor(maximumArea / roughWidth);\n      return { x: Math.floor(roughWidth), y: perfLimitSizeY };\n    },\n\n    capValue: function (min, value, max) {\n      return Math.max(min, Math.min(value, max));\n    },\n\n    /**\n     * Finds the scale for the object source to fit inside the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to fit into destination\n     */\n    findScaleToFit: function (source, destination) {\n      return Math.min(\n        destination.width / source.width,\n        destination.height / source.height\n      );\n    },\n\n    /**\n     * Finds the scale for the object source to cover entirely the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to cover destination\n     */\n    findScaleToCover: function (source, destination) {\n      return Math.max(\n        destination.width / source.width,\n        destination.height / source.height\n      );\n    },\n\n    /**\n     * given an array of 6 number returns something like `\"matrix(...numbers)\"`\n     * @memberOf fabric.util\n     * @param {Array} trasnform an array with 6 numbers\n     * @return {String} transform matrix for svg\n     * @return {Object.y} Limited dimensions by Y\n     */\n    matrixToSVG: function (transform) {\n      return (\n        'matrix(' +\n        transform\n          .map(function (value) {\n            return fabric.util.toFixed(\n              value,\n              fabric.Object.NUM_FRACTION_DIGITS\n            );\n          })\n          .join(' ') +\n        ')'\n      );\n    },\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function nsSVGPathDataParser() {\n  var _join = Array.prototype.join;\n\n  /* Adapted from http://dxr.mozilla.org/mozilla-central/source/content/svg/content/src/nsSVGPathDataParser.cpp\n   * by Andrea Bogazzi code is under MPL. if you don't have a copy of the license you can take it here\n   * http://mozilla.org/MPL/2.0/\n   */\n  function arcToSegments(toX, toY, rx, ry, large, sweep, rotateX) {\n    var argsString = _join.call(arguments);\n    if (fabric.arcToSegmentsCache[argsString]) {\n      return fabric.arcToSegmentsCache[argsString];\n    }\n\n    var PI = Math.PI,\n      th = (rotateX * PI) / 180,\n      sinTh = fabric.util.sin(th),\n      cosTh = fabric.util.cos(th),\n      fromX = 0,\n      fromY = 0;\n\n    rx = Math.abs(rx);\n    ry = Math.abs(ry);\n\n    var px = -cosTh * toX * 0.5 - sinTh * toY * 0.5,\n      py = -cosTh * toY * 0.5 + sinTh * toX * 0.5,\n      rx2 = rx * rx,\n      ry2 = ry * ry,\n      py2 = py * py,\n      px2 = px * px,\n      pl = rx2 * ry2 - rx2 * py2 - ry2 * px2,\n      root = 0;\n\n    if (pl < 0) {\n      var s = Math.sqrt(1 - pl / (rx2 * ry2));\n      rx *= s;\n      ry *= s;\n    } else {\n      root =\n        (large === sweep ? -1.0 : 1.0) *\n        Math.sqrt(pl / (rx2 * py2 + ry2 * px2));\n    }\n\n    var cx = (root * rx * py) / ry,\n      cy = (-root * ry * px) / rx,\n      cx1 = cosTh * cx - sinTh * cy + toX * 0.5,\n      cy1 = sinTh * cx + cosTh * cy + toY * 0.5,\n      mTheta = calcVectorAngle(1, 0, (px - cx) / rx, (py - cy) / ry),\n      dtheta = calcVectorAngle(\n        (px - cx) / rx,\n        (py - cy) / ry,\n        (-px - cx) / rx,\n        (-py - cy) / ry\n      );\n\n    if (sweep === 0 && dtheta > 0) {\n      dtheta -= 2 * PI;\n    } else if (sweep === 1 && dtheta < 0) {\n      dtheta += 2 * PI;\n    }\n\n    // Convert into cubic bezier segments <= 90deg\n    var segments = Math.ceil(Math.abs((dtheta / PI) * 2)),\n      result = [],\n      mDelta = dtheta / segments,\n      mT =\n        ((8 / 3) * Math.sin(mDelta / 4) * Math.sin(mDelta / 4)) /\n        Math.sin(mDelta / 2),\n      th3 = mTheta + mDelta;\n\n    for (var i = 0; i < segments; i++) {\n      result[i] = segmentToBezier(\n        mTheta,\n        th3,\n        cosTh,\n        sinTh,\n        rx,\n        ry,\n        cx1,\n        cy1,\n        mT,\n        fromX,\n        fromY\n      );\n      fromX = result[i][4];\n      fromY = result[i][5];\n      mTheta = th3;\n      th3 += mDelta;\n    }\n    fabric.arcToSegmentsCache[argsString] = result;\n    return result;\n  }\n\n  function segmentToBezier(\n    th2,\n    th3,\n    cosTh,\n    sinTh,\n    rx,\n    ry,\n    cx1,\n    cy1,\n    mT,\n    fromX,\n    fromY\n  ) {\n    var costh2 = fabric.util.cos(th2),\n      sinth2 = fabric.util.sin(th2),\n      costh3 = fabric.util.cos(th3),\n      sinth3 = fabric.util.sin(th3),\n      toX = cosTh * rx * costh3 - sinTh * ry * sinth3 + cx1,\n      toY = sinTh * rx * costh3 + cosTh * ry * sinth3 + cy1,\n      cp1X = fromX + mT * (-cosTh * rx * sinth2 - sinTh * ry * costh2),\n      cp1Y = fromY + mT * (-sinTh * rx * sinth2 + cosTh * ry * costh2),\n      cp2X = toX + mT * (cosTh * rx * sinth3 + sinTh * ry * costh3),\n      cp2Y = toY + mT * (sinTh * rx * sinth3 - cosTh * ry * costh3);\n\n    return [cp1X, cp1Y, cp2X, cp2Y, toX, toY];\n  }\n\n  /*\n   * Private\n   */\n  function calcVectorAngle(ux, uy, vx, vy) {\n    var ta = Math.atan2(uy, ux),\n      tb = Math.atan2(vy, vx);\n    if (tb >= ta) {\n      return tb - ta;\n    } else {\n      return 2 * Math.PI - (ta - tb);\n    }\n  }\n\n  /**\n   * Draws arc\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {Number} fx\n   * @param {Number} fy\n   * @param {Array} coords\n   */\n  fabric.util.drawArc = function (ctx, fx, fy, coords) {\n    var rx = coords[0],\n      ry = coords[1],\n      rot = coords[2],\n      large = coords[3],\n      sweep = coords[4],\n      tx = coords[5],\n      ty = coords[6],\n      segs = [[], [], [], []],\n      segsNorm = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\n\n    for (var i = 0, len = segsNorm.length; i < len; i++) {\n      segs[i][0] = segsNorm[i][0] + fx;\n      segs[i][1] = segsNorm[i][1] + fy;\n      segs[i][2] = segsNorm[i][2] + fx;\n      segs[i][3] = segsNorm[i][3] + fy;\n      segs[i][4] = segsNorm[i][4] + fx;\n      segs[i][5] = segsNorm[i][5] + fy;\n      ctx.bezierCurveTo.apply(ctx, segs[i]);\n    }\n  };\n\n  /**\n   * Calculate bounding box of a elliptic-arc\n   * @param {Number} fx start point of arc\n   * @param {Number} fy\n   * @param {Number} rx horizontal radius\n   * @param {Number} ry vertical radius\n   * @param {Number} rot angle of horizontal axe\n   * @param {Number} large 1 or 0, whatever the arc is the big or the small on the 2 points\n   * @param {Number} sweep 1 or 0, 1 clockwise or counterclockwise direction\n   * @param {Number} tx end point of arc\n   * @param {Number} ty\n   */\n  fabric.util.getBoundsOfArc = function (\n    fx,\n    fy,\n    rx,\n    ry,\n    rot,\n    large,\n    sweep,\n    tx,\n    ty\n  ) {\n    var fromX = 0,\n      fromY = 0,\n      bound,\n      bounds = [],\n      segs = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\n\n    for (var i = 0, len = segs.length; i < len; i++) {\n      bound = getBoundsOfCurve(\n        fromX,\n        fromY,\n        segs[i][0],\n        segs[i][1],\n        segs[i][2],\n        segs[i][3],\n        segs[i][4],\n        segs[i][5]\n      );\n      bounds.push({ x: bound[0].x + fx, y: bound[0].y + fy });\n      bounds.push({ x: bound[1].x + fx, y: bound[1].y + fy });\n      fromX = segs[i][4];\n      fromY = segs[i][5];\n    }\n    return bounds;\n  };\n\n  /**\n   * Calculate bounding box of a beziercurve\n   * @param {Number} x0 starting point\n   * @param {Number} y0\n   * @param {Number} x1 first control point\n   * @param {Number} y1\n   * @param {Number} x2 secondo control point\n   * @param {Number} y2\n   * @param {Number} x3 end of beizer\n   * @param {Number} y3\n   */\n  // taken from http://jsbin.com/ivomiq/56/edit  no credits available for that.\n  function getBoundsOfCurve(x0, y0, x1, y1, x2, y2, x3, y3) {\n    var argsString;\n    if (fabric.cachesBoundsOfCurve) {\n      argsString = _join.call(arguments);\n      if (fabric.boundsOfCurveCache[argsString]) {\n        return fabric.boundsOfCurveCache[argsString];\n      }\n    }\n\n    var sqrt = Math.sqrt,\n      min = Math.min,\n      max = Math.max,\n      abs = Math.abs,\n      tvalues = [],\n      bounds = [[], []],\n      a,\n      b,\n      c,\n      t,\n      t1,\n      t2,\n      b2ac,\n      sqrtb2ac;\n\n    b = 6 * x0 - 12 * x1 + 6 * x2;\n    a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n    c = 3 * x1 - 3 * x0;\n\n    for (var i = 0; i < 2; ++i) {\n      if (i > 0) {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n\n      if (abs(a) < 1e-12) {\n        if (abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      if (b2ac < 0) {\n        continue;\n      }\n      sqrtb2ac = sqrt(b2ac);\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    var x,\n      y,\n      j = tvalues.length,\n      jlen = j,\n      mt;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      x =\n        mt * mt * mt * x0 +\n        3 * mt * mt * t * x1 +\n        3 * mt * t * t * x2 +\n        t * t * t * x3;\n      bounds[0][j] = x;\n\n      y =\n        mt * mt * mt * y0 +\n        3 * mt * mt * t * y1 +\n        3 * mt * t * t * y2 +\n        t * t * t * y3;\n      bounds[1][j] = y;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    var result = [\n      {\n        x: min.apply(null, bounds[0]),\n        y: min.apply(null, bounds[1]),\n      },\n      {\n        x: max.apply(null, bounds[0]),\n        y: max.apply(null, bounds[1]),\n      },\n    ];\n    if (fabric.cachesBoundsOfCurve) {\n      fabric.boundsOfCurveCache[argsString] = result;\n    }\n    return result;\n  }\n\n  fabric.util.getBoundsOfCurve = getBoundsOfCurve;\n})();\n(function initArrayUtilities() {\n  var slice = Array.prototype.slice;\n\n  /**\n   * Invokes method on all items in a given array\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} method Name of a method to invoke\n   * @return {Array}\n   */\n  function invoke(array, method) {\n    var args = slice.call(arguments, 2),\n      result = [];\n    for (var i = 0, len = array.length; i < len; i++) {\n      result[i] = args.length\n        ? array[i][method].apply(array[i], args)\n        : array[i][method].call(array[i]);\n    }\n    return result;\n  }\n\n  /**\n   * Finds maximum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function max(array, byProperty) {\n    return find(array, byProperty, function (value1, value2) {\n      return value1 >= value2;\n    });\n  }\n\n  /**\n   * Finds minimum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function min(array, byProperty) {\n    return find(array, byProperty, function (value1, value2) {\n      return value1 < value2;\n    });\n  }\n\n  /**\n   * @private\n   */\n  function fill(array, value) {\n    var k = array.length;\n    while (k--) {\n      array[k] = value;\n    }\n    return array;\n  }\n\n  /**\n   * @private\n   */\n  function find(array, byProperty, condition) {\n    if (!array || array.length === 0) {\n      return;\n    }\n\n    var i = array.length - 1,\n      result = byProperty ? array[i][byProperty] : array[i];\n    if (byProperty) {\n      while (i--) {\n        if (condition(array[i][byProperty], result)) {\n          result = array[i][byProperty];\n        }\n      }\n    } else {\n      while (i--) {\n        if (condition(array[i], result)) {\n          result = array[i];\n        }\n      }\n    }\n    return result;\n  }\n\n  /**\n   * @namespace fabric.util.array\n   */\n  fabric.util.array = {\n    fill: fill,\n    invoke: invoke,\n    min: min,\n    max: max,\n  };\n})();\n(function () {\n  /**\n   * Copies all enumerable properties of one js object to another\n   * this does not and cannot compete with generic utils.\n   * Does not clone or extend fabric.Object subclasses.\n   * This is mostly for internal use and has extra handling for fabricJS objects\n   * it skips the canvas property in deep cloning.\n   * @memberOf fabric.util.object\n   * @param {Object} destination Where to copy to\n   * @param {Object} source Where to copy from\n   * @return {Object}\n   */\n\n  function extend(destination, source, deep) {\n    // JScript DontEnum bug is not taken care of\n    // the deep clone is for internal use, is not meant to avoid\n    // javascript traps or cloning html element or self referenced objects.\n    if (deep) {\n      if (!fabric.isLikelyNode && source instanceof Element) {\n        // avoid cloning deep images, canvases,\n        destination = source;\n      } else if (source instanceof Array) {\n        destination = [];\n        for (let i = 0, len = source.length; i < len; i++) {\n          destination[i] = extend({}, source[i], deep);\n        }\n      } else if (source && typeof source === 'object') {\n        for (let property in source) {\n          if (property === 'canvas') {\n            destination[property] = extend({}, source[property]);\n          } else if (source.hasOwnProperty(property)) {\n            destination[property] = extend({}, source[property], deep);\n          }\n        }\n      } else {\n        // this sounds odd for an extend but is ok for recursive use\n        destination = source;\n      }\n    } else {\n      for (let property in source) {\n        destination[property] = source[property];\n      }\n    }\n    return destination;\n  }\n\n  /**\n   * Creates an empty object and copies all enumerable properties of another object to it\n   * @memberOf fabric.util.object\n   * TODO: this function return an empty object if you try to clone null\n   * @param {Object} object Object to clone\n   * @return {Object}\n   */\n  function clone(object, deep) {\n    return extend({}, object, deep);\n  }\n\n  /** @namespace fabric.util.object */\n  fabric.util.object = {\n    extend: extend,\n    clone: clone,\n  };\n  fabric.util.object.extend(fabric.util, fabric.Observable);\n})();\n(function initStringUtilities() {\n  /**\n   * Camelizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to camelize\n   * @return {String} Camelized version of a string\n   */\n  function camelize(string) {\n    return string.replace(/-+(.)?/g, function (match, character) {\n      return character ? character.toUpperCase() : '';\n    });\n  }\n\n  /**\n   * Capitalizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to capitalize\n   * @param {Boolean} [firstLetterOnly] If true only first letter is capitalized\n   * and other letters stay untouched, if false first letter is capitalized\n   * and other letters are converted to lowercase.\n   * @return {String} Capitalized version of a string\n   */\n  function capitalize(string, firstLetterOnly) {\n    return (\n      string.charAt(0).toUpperCase() +\n      (firstLetterOnly ? string.slice(1) : string.slice(1).toLowerCase())\n    );\n  }\n\n  /**\n   * Escapes XML in a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to escape\n   * @return {String} Escaped version of a string\n   */\n  function escapeXml(string) {\n    return string\n      .replace(/&/g, '&amp;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;');\n  }\n\n  /**\n   * Divide a string in the user perceived single units\n   * @memberOf fabric.util.string\n   * @param {String} textstring String to escape\n   * @return {Array} array containing the graphemes\n   */\n  function graphemeSplit(textstring) {\n    var i = 0,\n      chr,\n      graphemes = [];\n    for (i = 0, chr; i < textstring.length; i++) {\n      if ((chr = getWholeChar(textstring, i)) === false) {\n        continue;\n      }\n      graphemes.push(chr);\n    }\n    return graphemes;\n  }\n\n  // taken from mdn in the charAt doc page.\n  function getWholeChar(str, i) {\n    var code = str.charCodeAt(i);\n\n    if (isNaN(code)) {\n      return ''; // Position not found\n    }\n    if (code < 0xd800 || code > 0xdfff) {\n      return str.charAt(i);\n    }\n\n    // High surrogate (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xd800 <= code && code <= 0xdbff) {\n      if (str.length <= i + 1) {\n        throw new Error('High surrogate without following low surrogate');\n      }\n      var next = str.charCodeAt(i + 1);\n      if (0xdc00 > next || next > 0xdfff) {\n        throw new Error('High surrogate without following low surrogate');\n      }\n      return str.charAt(i) + str.charAt(i + 1);\n    }\n    // Low surrogate (0xDC00 <= code && code <= 0xDFFF)\n    if (i === 0) {\n      throw new Error('Low surrogate without preceding high surrogate');\n    }\n    var prev = str.charCodeAt(i - 1);\n\n    // (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xd800 > prev || prev > 0xdbff) {\n      throw new Error('Low surrogate without preceding high surrogate');\n    }\n    // We can pass over low surrogates now as the second component\n    // in a pair which we have already processed\n    return false;\n  }\n\n  /**\n   * String utilities\n   * @namespace fabric.util.string\n   */\n  fabric.util.string = {\n    camelize: camelize,\n    capitalize: capitalize,\n    escapeXml: escapeXml,\n    graphemeSplit: graphemeSplit,\n  };\n})();\n(function () {\n  var slice = Array.prototype.slice,\n    emptyFunction = function () {},\n    IS_DONTENUM_BUGGY = (function () {\n      for (var p in { toString: 1 }) {\n        if (p === 'toString') {\n          return false;\n        }\n      }\n      return true;\n    })(),\n    /** @ignore */\n    addMethods = function (klass, source, parent) {\n      for (var property in source) {\n        if (\n          property in klass.prototype &&\n          typeof klass.prototype[property] === 'function' &&\n          (source[property] + '').indexOf('callSuper') > -1\n        ) {\n          klass.prototype[property] = (function (property) {\n            return function () {\n              var superclass = this.constructor.superclass;\n              this.constructor.superclass = parent;\n              var returnValue = source[property].apply(this, arguments);\n              this.constructor.superclass = superclass;\n\n              if (property !== 'initialize') {\n                return returnValue;\n              }\n            };\n          })(property);\n        } else {\n          klass.prototype[property] = source[property];\n        }\n\n        if (IS_DONTENUM_BUGGY) {\n          if (source.toString !== Object.prototype.toString) {\n            klass.prototype.toString = source.toString;\n          }\n          if (source.valueOf !== Object.prototype.valueOf) {\n            klass.prototype.valueOf = source.valueOf;\n          }\n        }\n      }\n    };\n\n  function Subclass() {}\n\n  function callSuper(methodName) {\n    var parentMethod = null,\n      _this = this;\n\n    // climb prototype chain to find method not equal to callee's method\n    while (_this.constructor.superclass) {\n      var superClassMethod = _this.constructor.superclass.prototype[methodName];\n      if (_this[methodName] !== superClassMethod) {\n        parentMethod = superClassMethod;\n        break;\n      }\n      // eslint-disable-next-line\n      _this = _this.constructor.superclass.prototype;\n    }\n\n    if (!parentMethod) {\n      return console.log(\n        'tried to callSuper ' +\n          methodName +\n          ', method not found in prototype chain',\n        this\n      );\n    }\n\n    return arguments.length > 1\n      ? parentMethod.apply(this, slice.call(arguments, 1))\n      : parentMethod.call(this);\n  }\n\n  /**\n   * Helper for creation of \"classes\".\n   * @memberOf fabric.util\n   * @param {Function} [parent] optional \"Class\" to inherit from\n   * @param {Object} [properties] Properties shared by all instances of this class\n   *                  (be careful modifying objects defined here as this would affect all instances)\n   */\n  function createClass() {\n    var parent = null,\n      properties = slice.call(arguments, 0);\n\n    if (typeof properties[0] === 'function') {\n      parent = properties.shift();\n    }\n    function klass() {\n      this.initialize.apply(this, arguments);\n    }\n\n    klass.superclass = parent;\n    klass.subclasses = [];\n\n    if (parent) {\n      Subclass.prototype = parent.prototype;\n      klass.prototype = new Subclass();\n      parent.subclasses.push(klass);\n    }\n    for (var i = 0, length = properties.length; i < length; i++) {\n      addMethods(klass, properties[i], parent);\n    }\n    if (!klass.prototype.initialize) {\n      klass.prototype.initialize = emptyFunction;\n    }\n    klass.prototype.constructor = klass;\n    klass.prototype.callSuper = callSuper;\n    return klass;\n  }\n\n  fabric.util.createClass = createClass;\n})();\n(function initStyles() {\n  /**\n   * Cross-browser wrapper for setting element's style\n   * @memberOf fabric.util\n   * @param {HTMLElement} element\n   * @param {Object} styles\n   * @return {HTMLElement} Element that was passed as a first argument\n   */\n  function setStyle(element, styles) {\n    var elementStyle = element.style;\n    if (!elementStyle) {\n      return element;\n    }\n    if (typeof styles === 'string') {\n      element.style.cssText += ';' + styles;\n      return styles.indexOf('opacity') > -1\n        ? setOpacity(element, styles.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1])\n        : element;\n    }\n    for (var property in styles) {\n      if (property === 'opacity') {\n        setOpacity(element, styles[property]);\n      } else {\n        var normalizedProperty =\n          property === 'float' || property === 'cssFloat'\n            ? typeof elementStyle.styleFloat === 'undefined'\n              ? 'cssFloat'\n              : 'styleFloat'\n            : property;\n        elementStyle[normalizedProperty] = styles[property];\n      }\n    }\n    return element;\n  }\n\n  var parseEl = fabric.document.createElement('div'),\n    supportsOpacity = typeof parseEl.style.opacity === 'string',\n    supportsFilters = typeof parseEl.style.filter === 'string',\n    reOpacity = /alpha\\s*\\(\\s*opacity\\s*=\\s*([^)]+)\\)/,\n    /** @ignore */\n    setOpacity = function (element) {\n      return element;\n    };\n\n  if (supportsOpacity) {\n    /** @ignore */\n    setOpacity = function (element, value) {\n      element.style.opacity = value;\n      return element;\n    };\n  } else if (supportsFilters) {\n    /** @ignore */\n    setOpacity = function (element, value) {\n      var es = element.style;\n      if (element.currentStyle && !element.currentStyle.hasLayout) {\n        es.zoom = 1;\n      }\n      if (reOpacity.test(es.filter)) {\n        value = value >= 0.9999 ? '' : 'alpha(opacity=' + value * 100 + ')';\n        es.filter = es.filter.replace(reOpacity, value);\n      } else {\n        es.filter += ' alpha(opacity=' + value * 100 + ')';\n      }\n      return element;\n    };\n  }\n\n  fabric.util.setStyle = setStyle;\n})();\n(function () {\n  var _slice = Array.prototype.slice;\n\n  /**\n   * Takes id and returns an element with that id (if one exists in a document)\n   * @memberOf fabric.util\n   * @param {String|HTMLElement} id\n   * @return {HTMLElement|null}\n   */\n  function getById(id) {\n    return typeof id === 'string' ? fabric.document.getElementById(id) : id;\n  }\n\n  var sliceCanConvertNodelists,\n    /**\n     * Converts an array-like object (e.g. arguments or NodeList) to an array\n     * @memberOf fabric.util\n     * @param {Object} arrayLike\n     * @return {Array}\n     */\n    toArray = function (arrayLike) {\n      return _slice.call(arrayLike, 0);\n    };\n\n  try {\n    sliceCanConvertNodelists =\n      toArray(fabric.document.childNodes) instanceof Array;\n  } catch (err) {}\n\n  if (!sliceCanConvertNodelists) {\n    toArray = function (arrayLike) {\n      var arr = new Array(arrayLike.length),\n        i = arrayLike.length;\n      while (i--) {\n        arr[i] = arrayLike[i];\n      }\n      return arr;\n    };\n  }\n\n  /**\n   * Creates specified element with specified attributes\n   * @memberOf fabric.util\n   * @param {String} tagName Type of an element to create\n   * @param {Object} [attributes] Attributes to set on an element\n   * @return {HTMLElement} Newly created element\n   */\n  function makeElement(tagName, attributes) {\n    var el = fabric.document.createElement(tagName);\n    for (var prop in attributes) {\n      if (prop === 'class') {\n        el.className = attributes[prop];\n      } else if (prop === 'for') {\n        el.htmlFor = attributes[prop];\n      } else {\n        el.setAttribute(prop, attributes[prop]);\n      }\n    }\n    return el;\n  }\n\n  /**\n   * Adds class to an element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to add class to\n   * @param {String} className Class to add to an element\n   */\n  function addClass(element, className) {\n    if (\n      element &&\n      (' ' + element.className + ' ').indexOf(' ' + className + ' ') === -1\n    ) {\n      element.className += (element.className ? ' ' : '') + className;\n    }\n  }\n\n  /**\n   * Wraps element with another element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to wrap\n   * @param {HTMLElement|String} wrapper Element to wrap with\n   * @param {Object} [attributes] Attributes to set on a wrapper\n   * @return {HTMLElement} wrapper\n   */\n  function wrapElement(element, wrapper, attributes) {\n    if (typeof wrapper === 'string') {\n      wrapper = makeElement(wrapper, attributes);\n    }\n    if (element.parentNode) {\n      element.parentNode.replaceChild(wrapper, element);\n    }\n    wrapper.appendChild(element);\n    return wrapper;\n  }\n\n  /**\n   * Returns element scroll offsets\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to operate on\n   * @return {Object} Object with left/top values\n   */\n  function getScrollLeftTop(element) {\n    var left = 0,\n      top = 0,\n      docElement = fabric.document.documentElement,\n      body = fabric.document.body || {\n        scrollLeft: 0,\n        scrollTop: 0,\n      };\n\n    // While loop checks (and then sets element to) .parentNode OR .host\n    //  to account for ShadowDOM. We still want to traverse up out of ShadowDOM,\n    //  but the .parentNode of a root ShadowDOM node will always be null, instead\n    //  it should be accessed through .host. See http://stackoverflow.com/a/24765528/4383938\n    while (element && (element.parentNode || element.host)) {\n      // Set element to element parent, or 'host' in case of ShadowDOM\n      element = element.parentNode || element.host;\n\n      if (element === fabric.document) {\n        left = body.scrollLeft || docElement.scrollLeft || 0;\n        top = body.scrollTop || docElement.scrollTop || 0;\n      } else {\n        left += element.scrollLeft || 0;\n        top += element.scrollTop || 0;\n      }\n\n      if (element.nodeType === 1 && element.style.position === 'fixed') {\n        break;\n      }\n    }\n\n    return { left: left, top: top };\n  }\n\n  /**\n   * Returns offset for a given element\n   * @function\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get offset for\n   * @return {Object} Object with \"left\" and \"top\" properties\n   */\n  function getElementOffset(element) {\n    var docElem,\n      doc = element && element.ownerDocument,\n      box = { left: 0, top: 0 },\n      offset = { left: 0, top: 0 },\n      scrollLeftTop,\n      offsetAttributes = {\n        borderLeftWidth: 'left',\n        borderTopWidth: 'top',\n        paddingLeft: 'left',\n        paddingTop: 'top',\n      };\n\n    if (!doc) {\n      return offset;\n    }\n\n    for (var attr in offsetAttributes) {\n      offset[offsetAttributes[attr]] +=\n        parseInt(getElementStyle(element, attr), 10) || 0;\n    }\n\n    docElem = doc.documentElement;\n    if (typeof element.getBoundingClientRect !== 'undefined') {\n      box = element.getBoundingClientRect();\n    }\n\n    scrollLeftTop = getScrollLeftTop(element);\n\n    return {\n      left:\n        box.left + scrollLeftTop.left - (docElem.clientLeft || 0) + offset.left,\n      top: box.top + scrollLeftTop.top - (docElem.clientTop || 0) + offset.top,\n    };\n  }\n\n  /**\n   * Returns style attribute value of a given element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get style attribute for\n   * @param {String} attr Style attribute to get for element\n   * @return {String} Style attribute value of the given element.\n   */\n  var getElementStyle;\n  if (\n    fabric.document.defaultView &&\n    fabric.document.defaultView.getComputedStyle\n  ) {\n    getElementStyle = function (element, attr) {\n      var style = fabric.document.defaultView.getComputedStyle(element, null);\n      return style ? style[attr] : undefined;\n    };\n  } else {\n    getElementStyle = function (element, attr) {\n      var value = element.style[attr];\n      if (!value && element.currentStyle) {\n        value = element.currentStyle[attr];\n      }\n      return value;\n    };\n  }\n\n  (function () {\n    var style = fabric.document.documentElement.style,\n      selectProp =\n        'userSelect' in style\n          ? 'userSelect'\n          : 'MozUserSelect' in style\n          ? 'MozUserSelect'\n          : 'WebkitUserSelect' in style\n          ? 'WebkitUserSelect'\n          : 'KhtmlUserSelect' in style\n          ? 'KhtmlUserSelect'\n          : '';\n\n    /**\n     * Makes element unselectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make unselectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementUnselectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = fabric.util.falseFunction;\n      }\n      if (selectProp) {\n        element.style[selectProp] = 'none';\n      } else if (typeof element.unselectable === 'string') {\n        element.unselectable = 'on';\n      }\n      return element;\n    }\n\n    /**\n     * Makes element selectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make selectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementSelectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = null;\n      }\n      if (selectProp) {\n        element.style[selectProp] = '';\n      } else if (typeof element.unselectable === 'string') {\n        element.unselectable = '';\n      }\n      return element;\n    }\n\n    fabric.util.makeElementUnselectable = makeElementUnselectable;\n    fabric.util.makeElementSelectable = makeElementSelectable;\n  })();\n\n  (function () {\n    /**\n     * Inserts a script element with a given url into a document; invokes callback, when that script is finished loading\n     * @memberOf fabric.util\n     * @param {String} url URL of a script to load\n     * @param {Function} callback Callback to execute when script is finished loading\n     */\n    function getScript(url, callback) {\n      var headEl = fabric.document.getElementsByTagName('head')[0],\n        scriptEl = fabric.document.createElement('script'),\n        loading = true;\n\n      /** @ignore */\n      scriptEl.onload = /** @ignore */ scriptEl.onreadystatechange = function (\n        e\n      ) {\n        if (loading) {\n          if (\n            typeof this.readyState === 'string' &&\n            this.readyState !== 'loaded' &&\n            this.readyState !== 'complete'\n          ) {\n            return;\n          }\n          loading = false;\n          callback(e || fabric.window.event);\n          scriptEl = scriptEl.onload = scriptEl.onreadystatechange = null;\n        }\n      };\n      scriptEl.src = url;\n      headEl.appendChild(scriptEl);\n      // causes issue in Opera\n      // headEl.removeChild(scriptEl);\n    }\n\n    fabric.util.getScript = getScript;\n  })();\n\n  function getNodeCanvas(element) {\n    var impl = fabric.jsdomImplForWrapper(element);\n    return impl._canvas || impl._image;\n  }\n\n  function cleanUpJsdomNode(element) {\n    if (!fabric.isLikelyNode) {\n      return;\n    }\n    var impl = fabric.jsdomImplForWrapper(element);\n    if (impl) {\n      impl._image = null;\n      impl._canvas = null;\n      // unsure if necessary\n      impl._currentSrc = null;\n      impl._attributes = null;\n      impl._classList = null;\n    }\n  }\n\n  fabric.util.getById = getById;\n  fabric.util.toArray = toArray;\n  fabric.util.makeElement = makeElement;\n  fabric.util.addClass = addClass;\n  fabric.util.wrapElement = wrapElement;\n  fabric.util.getScrollLeftTop = getScrollLeftTop;\n  fabric.util.getElementOffset = getElementOffset;\n  fabric.util.getElementStyle = getElementStyle;\n  fabric.util.getNodeCanvas = getNodeCanvas;\n  fabric.util.cleanUpJsdomNode = cleanUpJsdomNode;\n})();\n/**\n * Wrapper around `console.log` (when available)\n * @param {*} [values] Values to log\n */\nfabric.log = console.log;\n\n/**\n * Wrapper around `console.warn` (when available)\n * @param {*} [values] Values to log as a warning\n */\nfabric.warn = console.warn;\n(function () {\n  function noop() {\n    return false;\n  }\n\n  function defaultEasing(t, b, c, d) {\n    return -c * Math.cos((t / d) * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Changes value from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {Object} [options] Animation options\n   * @param {Function} [options.onChange] Callback; invoked on every value change\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\n   * @param {Number} [options.startValue=0] Starting value\n   * @param {Number} [options.endValue=100] Ending value\n   * @param {Number} [options.byValue=100] Value to modify the property by\n   * @param {Function} [options.easing] Easing function\n   * @param {Number} [options.duration=500] Duration of change (in ms)\n   * @param {Function} [options.abort] Additional function with logic. If returns true, onComplete is called.\n   */\n  function animate(options) {\n    requestAnimFrame(function (timestamp) {\n      options || (options = {});\n\n      var start = timestamp || +new Date(),\n        duration = options.duration || 500,\n        finish = start + duration,\n        time,\n        onChange = options.onChange || noop,\n        abort = options.abort || noop,\n        onComplete = options.onComplete || noop,\n        easing = options.easing || defaultEasing,\n        startValue = 'startValue' in options ? options.startValue : 0,\n        endValue = 'endValue' in options ? options.endValue : 100,\n        byValue = options.byValue || endValue - startValue;\n\n      options.onStart && options.onStart();\n\n      (function tick(ticktime) {\n        // TODO: move abort call after calculation\n        // and pass (current,valuePerc, timePerc) as arguments\n        time = ticktime || +new Date();\n        var currentTime = time > finish ? duration : time - start,\n          timePerc = currentTime / duration,\n          current = easing(currentTime, startValue, byValue, duration),\n          valuePerc = Math.abs((current - startValue) / byValue);\n        if (abort()) {\n          onComplete(endValue, 1, 1);\n          return;\n        }\n        if (time > finish) {\n          onChange(endValue, 1, 1);\n          onComplete(endValue, 1, 1);\n          return;\n        } else {\n          onChange(current, valuePerc, timePerc);\n          requestAnimFrame(tick);\n        }\n      })(start);\n    });\n  }\n\n  var _requestAnimFrame =\n    fabric.window.requestAnimationFrame ||\n    fabric.window.webkitRequestAnimationFrame ||\n    fabric.window.mozRequestAnimationFrame ||\n    fabric.window.oRequestAnimationFrame ||\n    fabric.window.msRequestAnimationFrame ||\n    function (callback) {\n      return fabric.window.setTimeout(callback, 1000 / 60);\n    };\n\n  var _cancelAnimFrame =\n    fabric.window.cancelAnimationFrame || fabric.window.clearTimeout;\n\n  /**\n   * requestAnimationFrame polyfill based on http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   * In order to get a precise start time, `requestAnimFrame` should be called as an entry into the method\n   * @memberOf fabric.util\n   * @param {Function} callback Callback to invoke\n   * @param {DOMElement} element optional Element to associate with animation\n   */\n  function requestAnimFrame() {\n    return _requestAnimFrame.apply(fabric.window, arguments);\n  }\n\n  function cancelAnimFrame() {\n    return _cancelAnimFrame.apply(fabric.window, arguments);\n  }\n\n  fabric.util.animate = animate;\n  fabric.util.requestAnimFrame = requestAnimFrame;\n  fabric.util.cancelAnimFrame = cancelAnimFrame;\n})();\n(function () {\n  // Calculate an in-between color. Returns a \"rgba()\" string.\n  // Credit: Edwin Martin <edwin@bitstorm.org>\n  //         http://www.bitstorm.org/jquery/color-animation/jquery.animate-colors.js\n  function calculateColor(begin, end, pos) {\n    var color =\n      'rgba(' +\n      parseInt(begin[0] + pos * (end[0] - begin[0]), 10) +\n      ',' +\n      parseInt(begin[1] + pos * (end[1] - begin[1]), 10) +\n      ',' +\n      parseInt(begin[2] + pos * (end[2] - begin[2]), 10);\n\n    color +=\n      ',' +\n      (begin && end ? parseFloat(begin[3] + pos * (end[3] - begin[3])) : 1);\n    color += ')';\n    return color;\n  }\n\n  /**\n   * Changes the color from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {String} fromColor The starting color in hex or rgb(a) format.\n   * @param {String} toColor The starting color in hex or rgb(a) format.\n   * @param {Number} [duration] Duration of change (in ms).\n   * @param {Object} [options] Animation options\n   * @param {Function} [options.onChange] Callback; invoked on every value change\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\n   * @param {Function} [options.colorEasing] Easing function. Note that this function only take two arguments (currentTime, duration). Thus the regular animation easing functions cannot be used.\n   * @param {Function} [options.abort] Additional function with logic. If returns true, onComplete is called.\n   */\n  function animateColor(fromColor, toColor, duration, options) {\n    var startColor = new fabric.Color(fromColor).getSource(),\n      endColor = new fabric.Color(toColor).getSource();\n\n    options = options || {};\n\n    fabric.util.animate(\n      fabric.util.object.extend(options, {\n        duration: duration || 500,\n        startValue: startColor,\n        endValue: endColor,\n        byValue: endColor,\n        easing: function (currentTime, startValue, byValue, duration) {\n          var posValue = options.colorEasing\n            ? options.colorEasing(currentTime, duration)\n            : 1 - Math.cos((currentTime / duration) * (Math.PI / 2));\n          return calculateColor(startValue, byValue, posValue);\n        },\n      })\n    );\n  }\n\n  fabric.util.animateColor = animateColor;\n})();\n(function initEasingUtilities() {\n  function normalize(a, c, p, s) {\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      //handle the 0/0 case:\n      if (c === 0 && a === 0) {\n        s = (p / (2 * Math.PI)) * Math.asin(1);\n      } else {\n        s = (p / (2 * Math.PI)) * Math.asin(c / a);\n      }\n    }\n    return { a: a, c: c, p: p, s: s };\n  }\n\n  function elastic(opts, t, d) {\n    return (\n      opts.a *\n      Math.pow(2, 10 * (t -= 1)) *\n      Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p)\n    );\n  }\n\n  /**\n   * Cubic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCubic(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t + 1) + b;\n  }\n\n  /**\n   * Cubic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCubic(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t + b;\n    }\n    return (c / 2) * ((t -= 2) * t * t + 2) + b;\n  }\n\n  /**\n   * Quartic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuart(t, b, c, d) {\n    return c * (t /= d) * t * t * t + b;\n  }\n\n  /**\n   * Quartic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuart(t, b, c, d) {\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n  }\n\n  /**\n   * Quartic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuart(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t * t + b;\n    }\n    return (-c / 2) * ((t -= 2) * t * t * t - 2) + b;\n  }\n\n  /**\n   * Quintic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuint(t, b, c, d) {\n    return c * (t /= d) * t * t * t * t + b;\n  }\n\n  /**\n   * Quintic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuint(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  }\n\n  /**\n   * Quintic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuint(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * t * t * t * t * t + b;\n    }\n    return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n  }\n\n  /**\n   * Sinusoidal easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInSine(t, b, c, d) {\n    return -c * Math.cos((t / d) * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Sinusoidal easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutSine(t, b, c, d) {\n    return c * Math.sin((t / d) * (Math.PI / 2)) + b;\n  }\n\n  /**\n   * Sinusoidal easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutSine(t, b, c, d) {\n    return (-c / 2) * (Math.cos((Math.PI * t) / d) - 1) + b;\n  }\n\n  /**\n   * Exponential easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInExpo(t, b, c, d) {\n    return t === 0 ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n  }\n\n  /**\n   * Exponential easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutExpo(t, b, c, d) {\n    return t === d ? b + c : c * (-Math.pow(2, (-10 * t) / d) + 1) + b;\n  }\n\n  /**\n   * Exponential easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutExpo(t, b, c, d) {\n    if (t === 0) {\n      return b;\n    }\n    if (t === d) {\n      return b + c;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * Math.pow(2, 10 * (t - 1)) + b;\n    }\n    return (c / 2) * (-Math.pow(2, -10 * --t) + 2) + b;\n  }\n\n  /**\n   * Circular easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInCirc(t, b, c, d) {\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n  }\n\n  /**\n   * Circular easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCirc(t, b, c, d) {\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n  }\n\n  /**\n   * Circular easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCirc(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return (-c / 2) * (Math.sqrt(1 - t * t) - 1) + b;\n    }\n    return (c / 2) * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n  }\n\n  /**\n   * Elastic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return -elastic(opts, t, d) + b;\n  }\n\n  /**\n   * Elastic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return (\n      opts.a *\n        Math.pow(2, -10 * t) *\n        Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p) +\n      opts.c +\n      b\n    );\n  }\n\n  /**\n   * Elastic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutElastic(t, b, c, d) {\n    var s = 1.70158,\n      p = 0,\n      a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d / 2;\n    if (t === 2) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n    var opts = normalize(a, c, p, s);\n    if (t < 1) {\n      return -0.5 * elastic(opts, t, d) + b;\n    }\n    return (\n      opts.a *\n        Math.pow(2, -10 * (t -= 1)) *\n        Math.sin(((t * d - opts.s) * (2 * Math.PI)) / opts.p) *\n        0.5 +\n      opts.c +\n      b\n    );\n  }\n\n  /**\n   * Backwards easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  }\n\n  /**\n   * Backwards easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  }\n\n  /**\n   * Backwards easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    }\n    return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n  }\n\n  /**\n   * Bouncing easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBounce(t, b, c, d) {\n    return c - easeOutBounce(d - t, 0, c, d) + b;\n  }\n\n  /**\n   * Bouncing easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBounce(t, b, c, d) {\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  }\n\n  /**\n   * Bouncing easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBounce(t, b, c, d) {\n    if (t < d / 2) {\n      return easeInBounce(t * 2, 0, c, d) * 0.5 + b;\n    }\n    return easeOutBounce(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n  }\n\n  /**\n   * Easing functions\n   * See <a href=\"http://gizma.com/easing/\">Easing Equations by Robert Penner</a>\n   * @namespace fabric.util.ease\n   */\n  fabric.util.ease = {\n    /**\n     * Quadratic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInQuad: function (t, b, c, d) {\n      return c * (t /= d) * t + b;\n    },\n\n    /**\n     * Quadratic easing out\n     * @memberOf fabric.util.ease\n     */\n    easeOutQuad: function (t, b, c, d) {\n      return -c * (t /= d) * (t - 2) + b;\n    },\n\n    /**\n     * Quadratic easing in and out\n     * @memberOf fabric.util.ease\n     */\n    easeInOutQuad: function (t, b, c, d) {\n      t /= d / 2;\n      if (t < 1) {\n        return (c / 2) * t * t + b;\n      }\n      return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n\n    /**\n     * Cubic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInCubic: function (t, b, c, d) {\n      return c * (t /= d) * t * t + b;\n    },\n\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n    easeInSine: easeInSine,\n    easeOutSine: easeOutSine,\n    easeInOutSine: easeInOutSine,\n    easeInExpo: easeInExpo,\n    easeOutExpo: easeOutExpo,\n    easeInOutExpo: easeInOutExpo,\n    easeInCirc: easeInCirc,\n    easeOutCirc: easeOutCirc,\n    easeInOutCirc: easeInOutCirc,\n    easeInElastic: easeInElastic,\n    easeOutElastic: easeOutElastic,\n    easeInOutElastic: easeInOutElastic,\n    easeInBack: easeInBack,\n    easeOutBack: easeOutBack,\n    easeInOutBack: easeInOutBack,\n    easeInBounce: easeInBounce,\n    easeOutBounce: easeOutBounce,\n    easeInOutBounce: easeInOutBounce,\n  };\n})();\n(function initPoint(global) {\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Point) {\n    fabric.warn('fabric.Point is already defined');\n    return;\n  }\n\n  fabric.Point = Point;\n\n  /**\n   * Point class\n   * @class fabric.Point\n   * @memberOf fabric\n   * @constructor\n   * @param {Number} x\n   * @param {Number} y\n   * @return {fabric.Point} thisArg\n   */\n  function Point(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  Point.prototype = /** @lends fabric.Point.prototype */ {\n    type: 'point',\n\n    constructor: Point,\n\n    /**\n     * Adds another point to this one and returns another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point instance with added values\n     */\n    add: function (that) {\n      return new Point(this.x + that.x, this.y + that.y);\n    },\n\n    /**\n     * Adds another point to this one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    addEquals: function (that) {\n      this.x += that.x;\n      this.y += that.y;\n      return this;\n    },\n\n    /**\n     * Adds value to this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point} new Point with added value\n     */\n    scalarAdd: function (scalar) {\n      return new Point(this.x + scalar, this.y + scalar);\n    },\n\n    /**\n     * Adds value to this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarAddEquals: function (scalar) {\n      this.x += scalar;\n      this.y += scalar;\n      return this;\n    },\n\n    /**\n     * Subtracts another point from this point and returns a new one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point object with subtracted values\n     */\n    subtract: function (that) {\n      return new Point(this.x - that.x, this.y - that.y);\n    },\n\n    /**\n     * Subtracts another point from this point\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    subtractEquals: function (that) {\n      this.x -= that.x;\n      this.y -= that.y;\n      return this;\n    },\n\n    /**\n     * Subtracts value from this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    scalarSubtract: function (scalar) {\n      return new Point(this.x - scalar, this.y - scalar);\n    },\n\n    /**\n     * Subtracts value from this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarSubtractEquals: function (scalar) {\n      this.x -= scalar;\n      this.y -= scalar;\n      return this;\n    },\n\n    /**\n     * Multiplies this point by a value and returns a new one\n     * TODO: rename in scalarMultiply in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    multiply: function (scalar) {\n      return new Point(this.x * scalar, this.y * scalar);\n    },\n\n    /**\n     * Multiplies this point by a value\n     * TODO: rename in scalarMultiplyEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    multiplyEquals: function (scalar) {\n      this.x *= scalar;\n      this.y *= scalar;\n      return this;\n    },\n\n    /**\n     * Divides this point by a value and returns a new one\n     * TODO: rename in scalarDivide in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    divide: function (scalar) {\n      return new Point(this.x / scalar, this.y / scalar);\n    },\n\n    /**\n     * Divides this point by a value\n     * TODO: rename in scalarDivideEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    divideEquals: function (scalar) {\n      this.x /= scalar;\n      this.y /= scalar;\n      return this;\n    },\n\n    /**\n     * Returns true if this point is equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    eq: function (that) {\n      return this.x === that.x && this.y === that.y;\n    },\n\n    /**\n     * Returns true if this point is less than another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lt: function (that) {\n      return this.x < that.x && this.y < that.y;\n    },\n\n    /**\n     * Returns true if this point is less than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lte: function (that) {\n      return this.x <= that.x && this.y <= that.y;\n    },\n\n    /**\n\n     * Returns true if this point is greater another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gt: function (that) {\n      return this.x > that.x && this.y > that.y;\n    },\n\n    /**\n     * Returns true if this point is greater than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gte: function (that) {\n      return this.x >= that.x && this.y >= that.y;\n    },\n\n    /**\n     * Returns new point which is the result of linear interpolation with this one and another one\n     * @param {fabric.Point} that\n     * @param {Number} t , position of interpolation, between 0 and 1 default 0.5\n     * @return {fabric.Point}\n     */\n    lerp: function (that, t) {\n      if (typeof t === 'undefined') {\n        t = 0.5;\n      }\n      t = Math.max(Math.min(1, t), 0);\n      return new Point(\n        this.x + (that.x - this.x) * t,\n        this.y + (that.y - this.y) * t\n      );\n    },\n\n    /**\n     * Returns distance from this point and another one\n     * @param {fabric.Point} that\n     * @return {Number}\n     */\n    distanceFrom: function (that) {\n      var dx = this.x - that.x,\n        dy = this.y - that.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    },\n\n    /**\n     * Returns the point between this point and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    midPointFrom: function (that) {\n      return this.lerp(that);\n    },\n\n    /**\n     * Returns a new point which is the min of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    min: function (that) {\n      return new Point(Math.min(this.x, that.x), Math.min(this.y, that.y));\n    },\n\n    /**\n     * Returns a new point which is the max of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    max: function (that) {\n      return new Point(Math.max(this.x, that.x), Math.max(this.y, that.y));\n    },\n\n    /**\n     * Returns string representation of this point\n     * @return {String}\n     */\n    toString: function () {\n      return this.x + ',' + this.y;\n    },\n\n    /**\n     * Sets x/y of this point\n     * @param {Number} x\n     * @param {Number} y\n     * @chainable\n     */\n    setXY: function (x, y) {\n      this.x = x;\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x of this point\n     * @param {Number} x\n     * @chainable\n     */\n    setX: function (x) {\n      this.x = x;\n      return this;\n    },\n\n    /**\n     * Sets y of this point\n     * @param {Number} y\n     * @chainable\n     */\n    setY: function (y) {\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x/y of this point from another point\n     * @param {fabric.Point} that\n     * @chainable\n     */\n    setFromPoint: function (that) {\n      this.x = that.x;\n      this.y = that.y;\n      return this;\n    },\n\n    /**\n     * Swaps x/y of this point and another point\n     * @param {fabric.Point} that\n     */\n    swap: function (that) {\n      var x = this.x,\n        y = this.y;\n      this.x = that.x;\n      this.y = that.y;\n      that.x = x;\n      that.y = y;\n    },\n\n    /**\n     * return a cloned instance of the point\n     * @return {fabric.Point}\n     */\n    clone: function () {\n      return new Point(this.x, this.y);\n    },\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initIntersection(global) {\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Intersection) {\n    fabric.warn('fabric.Intersection is already defined');\n    return;\n  }\n\n  /**\n   * Intersection class\n   * @class fabric.Intersection\n   * @memberOf fabric\n   * @constructor\n   */\n  function Intersection(status) {\n    this.status = status;\n    this.points = [];\n  }\n\n  fabric.Intersection = Intersection;\n\n  fabric.Intersection.prototype = /** @lends fabric.Intersection.prototype */ {\n    constructor: Intersection,\n\n    /**\n     * Appends a point to intersection\n     * @param {fabric.Point} point\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoint: function (point) {\n      this.points.push(point);\n      return this;\n    },\n\n    /**\n     * Appends points to intersection\n     * @param {Array} points\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoints: function (points) {\n      this.points = this.points.concat(points);\n      return this;\n    },\n  };\n\n  /**\n   * Checks if one line intersects another\n   * TODO: rename in intersectSegmentSegment\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {fabric.Point} b1\n   * @param {fabric.Point} b2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLineLine = function (a1, a2, b1, b2) {\n    var result,\n      uaT = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),\n      ubT = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),\n      uB = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n    if (uB !== 0) {\n      var ua = uaT / uB,\n        ub = ubT / uB;\n      if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\n        result = new Intersection('Intersection');\n        result.appendPoint(\n          new fabric.Point(a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y))\n        );\n      } else {\n        result = new Intersection();\n      }\n    } else {\n      if (uaT === 0 || ubT === 0) {\n        result = new Intersection('Coincident');\n      } else {\n        result = new Intersection('Parallel');\n      }\n    }\n    return result;\n  };\n\n  /**\n   * Checks if line intersects polygon\n   * TODO: rename in intersectSegmentPolygon\n   * fix detection of coincident\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {Array} points\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLinePolygon = function (a1, a2, points) {\n    var result = new Intersection(),\n      length = points.length,\n      b1,\n      b2,\n      inter,\n      i;\n\n    for (i = 0; i < length; i++) {\n      b1 = points[i];\n      b2 = points[(i + 1) % length];\n      inter = Intersection.intersectLineLine(a1, a2, b1, b2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects another polygon\n   * @static\n   * @param {Array} points1\n   * @param {Array} points2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonPolygon = function (points1, points2) {\n    var result = new Intersection(),\n      length = points1.length,\n      i;\n\n    for (i = 0; i < length; i++) {\n      var a1 = points1[i],\n        a2 = points1[(i + 1) % length],\n        inter = Intersection.intersectLinePolygon(a1, a2, points2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects rectangle\n   * @static\n   * @param {Array} points\n   * @param {fabric.Point} r1\n   * @param {fabric.Point} r2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonRectangle = function (points, r1, r2) {\n    var min = r1.min(r2),\n      max = r1.max(r2),\n      topRight = new fabric.Point(max.x, min.y),\n      bottomLeft = new fabric.Point(min.x, max.y),\n      inter1 = Intersection.intersectLinePolygon(min, topRight, points),\n      inter2 = Intersection.intersectLinePolygon(topRight, max, points),\n      inter3 = Intersection.intersectLinePolygon(max, bottomLeft, points),\n      inter4 = Intersection.intersectLinePolygon(bottomLeft, min, points),\n      result = new Intersection();\n\n    result.appendPoints(inter1.points);\n    result.appendPoints(inter2.points);\n    result.appendPoints(inter3.points);\n    result.appendPoints(inter4.points);\n\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initColor(global) {\n  var fabric = global.fabric || (global.fabric = {});\n\n  if (fabric.Color) {\n    fabric.warn('fabric.Color is already defined.');\n    return;\n  }\n\n  /**\n   * Color class\n   * The purpose of {@link fabric.Color} is to abstract and encapsulate common color operations;\n   * {@link fabric.Color} is a constructor and creates instances of {@link fabric.Color} objects.\n   *\n   * @class fabric.Color\n   * @param {String} color optional in hex or rgb(a) or hsl format or from known color list\n   * @return {fabric.Color} thisArg\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#colors}\n   */\n  function Color(color) {\n    if (!color) {\n      this.setSource([0, 0, 0, 1]);\n    } else {\n      this._tryParsingColor(color);\n    }\n  }\n\n  fabric.Color = Color;\n\n  fabric.Color.prototype = /** @lends fabric.Color.prototype */ {\n    /**\n     * @private\n     * @param {String|Array} color Color value to parse\n     */\n    _tryParsingColor: function (color) {\n      var source;\n\n      if (color in Color.colorNameMap) {\n        color = Color.colorNameMap[color];\n      }\n\n      if (color === 'transparent') {\n        source = [255, 255, 255, 0];\n      }\n\n      if (!source) {\n        source = Color.sourceFromHex(color);\n      }\n      if (!source) {\n        source = Color.sourceFromRgb(color);\n      }\n      if (!source) {\n        source = Color.sourceFromHsl(color);\n      }\n      if (!source) {\n        //if color is not recognize let's make black as canvas does\n        source = [0, 0, 0, 1];\n      }\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n    /**\n     * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n     * @private\n     * @param {Number} r Red color value\n     * @param {Number} g Green color value\n     * @param {Number} b Blue color value\n     * @return {Array} Hsl color\n     */\n    _rgbToHsl: function (r, g, b) {\n      r /= 255;\n      g /= 255;\n      b /= 255;\n\n      var h,\n        s,\n        l,\n        max = fabric.util.array.max([r, g, b]),\n        min = fabric.util.array.min([r, g, b]);\n\n      l = (max + min) / 2;\n\n      if (max === min) {\n        h = s = 0; // achromatic\n      } else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n          case r:\n            h = (g - b) / d + (g < b ? 6 : 0);\n            break;\n          case g:\n            h = (b - r) / d + 2;\n            break;\n          case b:\n            h = (r - g) / d + 4;\n            break;\n          default:\n            break;\n        }\n        h /= 6;\n      }\n\n      return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];\n    },\n\n    /**\n     * Returns source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @return {Array}\n     */\n    getSource: function () {\n      return this._source;\n    },\n\n    /**\n     * Sets source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @param {Array} source\n     */\n    setSource: function (source) {\n      this._source = source;\n    },\n\n    /**\n     * Returns color representation in RGB format\n     * @return {String} ex: rgb(0-255,0-255,0-255)\n     */\n    toRgb: function () {\n      var source = this.getSource();\n      return 'rgb(' + source[0] + ',' + source[1] + ',' + source[2] + ')';\n    },\n\n    /**\n     * Returns color representation in RGBA format\n     * @return {String} ex: rgba(0-255,0-255,0-255,0-1)\n     */\n    toRgba: function () {\n      var source = this.getSource();\n      return (\n        'rgba(' +\n        source[0] +\n        ',' +\n        source[1] +\n        ',' +\n        source[2] +\n        ',' +\n        source[3] +\n        ')'\n      );\n    },\n\n    /**\n     * Returns color representation in HSL format\n     * @return {String} ex: hsl(0-360,0%-100%,0%-100%)\n     */\n    toHsl: function () {\n      var source = this.getSource(),\n        hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return 'hsl(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%)';\n    },\n\n    /**\n     * Returns color representation in HSLA format\n     * @return {String} ex: hsla(0-360,0%-100%,0%-100%,0-1)\n     */\n    toHsla: function () {\n      var source = this.getSource(),\n        hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return (\n        'hsla(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%,' + source[3] + ')'\n      );\n    },\n\n    /**\n     * Returns color representation in HEX format\n     * @return {String} ex: FF5555\n     */\n    toHex: function () {\n      var source = this.getSource(),\n        r,\n        g,\n        b;\n\n      r = source[0].toString(16);\n      r = r.length === 1 ? '0' + r : r;\n\n      g = source[1].toString(16);\n      g = g.length === 1 ? '0' + g : g;\n\n      b = source[2].toString(16);\n      b = b.length === 1 ? '0' + b : b;\n\n      return r.toUpperCase() + g.toUpperCase() + b.toUpperCase();\n    },\n\n    /**\n     * Returns color representation in HEXA format\n     * @return {String} ex: FF5555CC\n     */\n    toHexa: function () {\n      var source = this.getSource(),\n        a;\n\n      a = Math.round(source[3] * 255);\n      a = a.toString(16);\n      a = a.length === 1 ? '0' + a : a;\n\n      return this.toHex() + a.toUpperCase();\n    },\n\n    /**\n     * Gets value of alpha channel for this color\n     * @return {Number} 0-1\n     */\n    getAlpha: function () {\n      return this.getSource()[3];\n    },\n\n    /**\n     * Sets value of alpha channel for this color\n     * @param {Number} alpha Alpha value 0-1\n     * @return {fabric.Color} thisArg\n     */\n    setAlpha: function (alpha) {\n      var source = this.getSource();\n      source[3] = alpha;\n      this.setSource(source);\n      return this;\n    },\n\n    /**\n     * Transforms color to its grayscale representation\n     * @return {fabric.Color} thisArg\n     */\n    toGrayscale: function () {\n      var source = this.getSource(),\n        average = parseInt(\n          (source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0),\n          10\n        ),\n        currentAlpha = source[3];\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Transforms color to its black and white representation\n     * @param {Number} threshold\n     * @return {fabric.Color} thisArg\n     */\n    toBlackWhite: function (threshold) {\n      var source = this.getSource(),\n        average = (\n          source[0] * 0.3 +\n          source[1] * 0.59 +\n          source[2] * 0.11\n        ).toFixed(0),\n        currentAlpha = source[3];\n\n      threshold = threshold || 127;\n\n      average = Number(average) < Number(threshold) ? 0 : 255;\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Overlays color with another color\n     * @param {String|fabric.Color} otherColor\n     * @return {fabric.Color} thisArg\n     */\n    overlayWith: function (otherColor) {\n      if (!(otherColor instanceof Color)) {\n        otherColor = new Color(otherColor);\n      }\n\n      var result = [],\n        alpha = this.getAlpha(),\n        otherAlpha = 0.5,\n        source = this.getSource(),\n        otherSource = otherColor.getSource(),\n        i;\n\n      for (i = 0; i < 3; i++) {\n        result.push(\n          Math.round(source[i] * (1 - otherAlpha) + otherSource[i] * otherAlpha)\n        );\n      }\n\n      result[3] = alpha;\n      this.setSource(result);\n      return this;\n    },\n  };\n\n  /**\n   * Regex matching color in RGB or RGBA formats (ex: rgb(0, 0, 0), rgba(255, 100, 10, 0.5), rgba( 255 , 100 , 10 , 0.5 ), rgb(1,1,1), rgba(100%, 60%, 10%, 0.5))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  // eslint-disable-next-line max-len\n  fabric.Color.reRGBa = /^rgba?\\(\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?%?)\\s*(?:\\s*,\\s*((?:\\d*\\.?\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HSL or HSLA formats (ex: hsl(200, 80%, 10%), hsla(300, 50%, 80%, 0.5), hsla( 300 , 50% , 80% , 0.5 ))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHSLa = /^hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}%)\\s*,\\s*(\\d{1,3}%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HEX format (ex: #FF5544CC, #FF5555, 010155, aff)\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHex = /^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i;\n\n  /**\n   * Map of the 148 color names with HEX code\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   * @see: https://www.w3.org/TR/css3-color/#svg-color\n   */\n  fabric.Color.colorNameMap = {\n    aliceblue: '#F0F8FF',\n    antiquewhite: '#FAEBD7',\n    aqua: '#00FFFF',\n    aquamarine: '#7FFFD4',\n    azure: '#F0FFFF',\n    beige: '#F5F5DC',\n    bisque: '#FFE4C4',\n    black: '#000000',\n    blanchedalmond: '#FFEBCD',\n    blue: '#0000FF',\n    blueviolet: '#8A2BE2',\n    brown: '#A52A2A',\n    burlywood: '#DEB887',\n    cadetblue: '#5F9EA0',\n    chartreuse: '#7FFF00',\n    chocolate: '#D2691E',\n    coral: '#FF7F50',\n    cornflowerblue: '#6495ED',\n    cornsilk: '#FFF8DC',\n    crimson: '#DC143C',\n    cyan: '#00FFFF',\n    darkblue: '#00008B',\n    darkcyan: '#008B8B',\n    darkgoldenrod: '#B8860B',\n    darkgray: '#A9A9A9',\n    darkgrey: '#A9A9A9',\n    darkgreen: '#006400',\n    darkkhaki: '#BDB76B',\n    darkmagenta: '#8B008B',\n    darkolivegreen: '#556B2F',\n    darkorange: '#FF8C00',\n    darkorchid: '#9932CC',\n    darkred: '#8B0000',\n    darksalmon: '#E9967A',\n    darkseagreen: '#8FBC8F',\n    darkslateblue: '#483D8B',\n    darkslategray: '#2F4F4F',\n    darkslategrey: '#2F4F4F',\n    darkturquoise: '#00CED1',\n    darkviolet: '#9400D3',\n    deeppink: '#FF1493',\n    deepskyblue: '#00BFFF',\n    dimgray: '#696969',\n    dimgrey: '#696969',\n    dodgerblue: '#1E90FF',\n    firebrick: '#B22222',\n    floralwhite: '#FFFAF0',\n    forestgreen: '#228B22',\n    fuchsia: '#FF00FF',\n    gainsboro: '#DCDCDC',\n    ghostwhite: '#F8F8FF',\n    gold: '#FFD700',\n    goldenrod: '#DAA520',\n    gray: '#808080',\n    grey: '#808080',\n    green: '#008000',\n    greenyellow: '#ADFF2F',\n    honeydew: '#F0FFF0',\n    hotpink: '#FF69B4',\n    indianred: '#CD5C5C',\n    indigo: '#4B0082',\n    ivory: '#FFFFF0',\n    khaki: '#F0E68C',\n    lavender: '#E6E6FA',\n    lavenderblush: '#FFF0F5',\n    lawngreen: '#7CFC00',\n    lemonchiffon: '#FFFACD',\n    lightblue: '#ADD8E6',\n    lightcoral: '#F08080',\n    lightcyan: '#E0FFFF',\n    lightgoldenrodyellow: '#FAFAD2',\n    lightgray: '#D3D3D3',\n    lightgrey: '#D3D3D3',\n    lightgreen: '#90EE90',\n    lightpink: '#FFB6C1',\n    lightsalmon: '#FFA07A',\n    lightseagreen: '#20B2AA',\n    lightskyblue: '#87CEFA',\n    lightslategray: '#778899',\n    lightslategrey: '#778899',\n    lightsteelblue: '#B0C4DE',\n    lightyellow: '#FFFFE0',\n    lime: '#00FF00',\n    limegreen: '#32CD32',\n    linen: '#FAF0E6',\n    magenta: '#FF00FF',\n    maroon: '#800000',\n    mediumaquamarine: '#66CDAA',\n    mediumblue: '#0000CD',\n    mediumorchid: '#BA55D3',\n    mediumpurple: '#9370DB',\n    mediumseagreen: '#3CB371',\n    mediumslateblue: '#7B68EE',\n    mediumspringgreen: '#00FA9A',\n    mediumturquoise: '#48D1CC',\n    mediumvioletred: '#C71585',\n    midnightblue: '#191970',\n    mintcream: '#F5FFFA',\n    mistyrose: '#FFE4E1',\n    moccasin: '#FFE4B5',\n    navajowhite: '#FFDEAD',\n    navy: '#000080',\n    oldlace: '#FDF5E6',\n    olive: '#808000',\n    olivedrab: '#6B8E23',\n    orange: '#FFA500',\n    orangered: '#FF4500',\n    orchid: '#DA70D6',\n    palegoldenrod: '#EEE8AA',\n    palegreen: '#98FB98',\n    paleturquoise: '#AFEEEE',\n    palevioletred: '#DB7093',\n    papayawhip: '#FFEFD5',\n    peachpuff: '#FFDAB9',\n    peru: '#CD853F',\n    pink: '#FFC0CB',\n    plum: '#DDA0DD',\n    powderblue: '#B0E0E6',\n    purple: '#800080',\n    rebeccapurple: '#663399',\n    red: '#FF0000',\n    rosybrown: '#BC8F8F',\n    royalblue: '#4169E1',\n    saddlebrown: '#8B4513',\n    salmon: '#FA8072',\n    sandybrown: '#F4A460',\n    seagreen: '#2E8B57',\n    seashell: '#FFF5EE',\n    sienna: '#A0522D',\n    silver: '#C0C0C0',\n    skyblue: '#87CEEB',\n    slateblue: '#6A5ACD',\n    slategray: '#708090',\n    slategrey: '#708090',\n    snow: '#FFFAFA',\n    springgreen: '#00FF7F',\n    steelblue: '#4682B4',\n    tan: '#D2B48C',\n    teal: '#008080',\n    thistle: '#D8BFD8',\n    tomato: '#FF6347',\n    turquoise: '#40E0D0',\n    violet: '#EE82EE',\n    wheat: '#F5DEB3',\n    white: '#FFFFFF',\n    whitesmoke: '#F5F5F5',\n    yellow: '#FFFF00',\n    yellowgreen: '#9ACD32',\n  };\n\n  /**\n   * @private\n   * @param {Number} p\n   * @param {Number} q\n   * @param {Number} t\n   * @return {Number}\n   */\n  function hue2rgb(p, q, t) {\n    if (t < 0) {\n      t += 1;\n    }\n    if (t > 1) {\n      t -= 1;\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n    if (t < 1 / 2) {\n      return q;\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n  }\n\n  /**\n   * Returns new color object, when given a color in RGB format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255)\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgb = function (color) {\n    return Color.fromSource(Color.sourceFromRgb(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in RGB or RGBA format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255), rgb(0%-100%,0%-100%,0%-100%)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromRgb = function (color) {\n    var match = color.match(Color.reRGBa);\n    if (match) {\n      var r =\n          (parseInt(match[1], 10) / (/%$/.test(match[1]) ? 100 : 1)) *\n          (/%$/.test(match[1]) ? 255 : 1),\n        g =\n          (parseInt(match[2], 10) / (/%$/.test(match[2]) ? 100 : 1)) *\n          (/%$/.test(match[2]) ? 255 : 1),\n        b =\n          (parseInt(match[3], 10) / (/%$/.test(match[3]) ? 100 : 1)) *\n          (/%$/.test(match[3]) ? 255 : 1);\n\n      return [\n        parseInt(r, 10),\n        parseInt(g, 10),\n        parseInt(b, 10),\n        match[4] ? parseFloat(match[4]) : 1,\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given a color in RGBA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgba = Color.fromRgb;\n\n  /**\n   * Returns new color object, when given a color in HSL format\n   * @param {String} color Color value ex: hsl(0-260,0%-100%,0%-100%)\n   * @memberOf fabric.Color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsl = function (color) {\n    return Color.fromSource(Color.sourceFromHsl(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HSL or HSLA format.\n   * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: hsl(0-360,0%-100%,0%-100%) or hsla(0-360,0%-100%,0%-100%, 0-1)\n   * @return {Array} source\n   * @see http://http://www.w3.org/TR/css3-color/#hsl-color\n   */\n  fabric.Color.sourceFromHsl = function (color) {\n    var match = color.match(Color.reHSLa);\n    if (!match) {\n      return;\n    }\n\n    var h = (((parseFloat(match[1]) % 360) + 360) % 360) / 360,\n      s = parseFloat(match[2]) / (/%$/.test(match[2]) ? 100 : 1),\n      l = parseFloat(match[3]) / (/%$/.test(match[3]) ? 100 : 1),\n      r,\n      g,\n      b;\n\n    if (s === 0) {\n      r = g = b = l;\n    } else {\n      var q = l <= 0.5 ? l * (s + 1) : l + s - l * s,\n        p = l * 2 - q;\n\n      r = hue2rgb(p, q, h + 1 / 3);\n      g = hue2rgb(p, q, h);\n      b = hue2rgb(p, q, h - 1 / 3);\n    }\n\n    return [\n      Math.round(r * 255),\n      Math.round(g * 255),\n      Math.round(b * 255),\n      match[4] ? parseFloat(match[4]) : 1,\n    ];\n  };\n\n  /**\n   * Returns new color object, when given a color in HSLA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsla = Color.fromHsl;\n\n  /**\n   * Returns new color object, when given a color in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: FF5555\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHex = function (color) {\n    return Color.fromSource(Color.sourceFromHex(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color ex: FF5555 or FF5544CC (RGBa)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromHex = function (color) {\n    if (color.match(Color.reHex)) {\n      var value = color.slice(color.indexOf('#') + 1),\n        isShortNotation = value.length === 3 || value.length === 4,\n        isRGBa = value.length === 8 || value.length === 4,\n        r = isShortNotation\n          ? value.charAt(0) + value.charAt(0)\n          : value.substring(0, 2),\n        g = isShortNotation\n          ? value.charAt(1) + value.charAt(1)\n          : value.substring(2, 4),\n        b = isShortNotation\n          ? value.charAt(2) + value.charAt(2)\n          : value.substring(4, 6),\n        a = isRGBa\n          ? isShortNotation\n            ? value.charAt(3) + value.charAt(3)\n            : value.substring(6, 8)\n          : 'FF';\n\n      return [\n        parseInt(r, 16),\n        parseInt(g, 16),\n        parseInt(b, 16),\n        parseFloat((parseInt(a, 16) / 255).toFixed(2)),\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given color in array representation (ex: [200, 100, 100, 0.5])\n   * @static\n   * @memberOf fabric.Color\n   * @param {Array} source\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromSource = function (source) {\n    var oColor = new Color();\n    oColor.setSource(source);\n    return oColor;\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initStaticCanvas() {\n  if (fabric.StaticCanvas) {\n    fabric.warn('fabric.StaticCanvas is already defined.');\n    return;\n  }\n\n  // aliases for faster resolution\n  var extend = fabric.util.object.extend,\n    getElementOffset = fabric.util.getElementOffset,\n    removeFromArray = fabric.util.removeFromArray,\n    toFixed = fabric.util.toFixed,\n    transformPoint = fabric.util.transformPoint,\n    invertTransform = fabric.util.invertTransform,\n    getNodeCanvas = fabric.util.getNodeCanvas,\n    createCanvasElement = fabric.util.createCanvasElement,\n    CANVAS_INIT_ERROR = new Error('Could not initialize `canvas` element');\n\n  /**\n   * Static canvas class\n   * @class fabric.StaticCanvas\n   * @mixes fabric.Collection\n   * @mixes fabric.Observable\n   * @see {@link http://fabricjs.com/static_canvas|StaticCanvas demo}\n   * @see {@link fabric.StaticCanvas#initialize} for constructor definition\n   * @fires before:render\n   * @fires after:render\n   * @fires canvas:cleared\n   * @fires object:added\n   * @fires object:removed\n   */\n  fabric.StaticCanvas = fabric.util.createClass(\n    fabric.CommonMethods,\n    /** @lends fabric.StaticCanvas.prototype */ {\n      /**\n       * Constructor\n       * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n       * @param {Object} [options] Options object\n       * @return {Object} thisArg\n       */\n      initialize: function (el, options) {\n        options || (options = {});\n        this.renderAndResetBound = this.renderAndReset.bind(this);\n        this.requestRenderAllBound = this.requestRenderAll.bind(this);\n        this._initStatic(el, options);\n      },\n\n      /**\n       * Background color of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setBackgroundColor}.\n       * @type {(String|fabric.Pattern)}\n       * @default\n       */\n      backgroundColor: '',\n\n      /**\n       * Background image of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setBackgroundImage}.\n       * <b>Backwards incompatibility note:</b> The \"backgroundImageOpacity\"\n       * and \"backgroundImageStretch\" properties are deprecated since 1.3.9.\n       * Use {@link fabric.Image#opacity}, {@link fabric.Image#width} and {@link fabric.Image#height}.\n       * since 2.4.0 image caching is active, please when putting an image as background, add to the\n       * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n       * vale. As an alternative you can disable image objectCaching\n       * @type fabric.Image\n       * @default\n       */\n      backgroundImage: null,\n\n      /**\n       * Overlay color of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setOverlayColor}\n       * @since 1.3.9\n       * @type {(String|fabric.Pattern)}\n       * @default\n       */\n      overlayColor: '',\n\n      /**\n       * Overlay image of canvas instance.\n       * Should be set via {@link fabric.StaticCanvas#setOverlayImage}.\n       * <b>Backwards incompatibility note:</b> The \"overlayImageLeft\"\n       * and \"overlayImageTop\" properties are deprecated since 1.3.9.\n       * Use {@link fabric.Image#left} and {@link fabric.Image#top}.\n       * since 2.4.0 image caching is active, please when putting an image as overlay, add to the\n       * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n       * vale. As an alternative you can disable image objectCaching\n       * @type fabric.Image\n       * @default\n       */\n      overlayImage: null,\n\n      /**\n       * Indicates whether toObject/toDatalessObject should include default values\n       * if set to false, takes precedence over the object value.\n       * @type Boolean\n       * @default\n       */\n      includeDefaultValues: true,\n\n      /**\n       * Indicates whether objects' state should be saved\n       * @type Boolean\n       * @default\n       */\n      stateful: false,\n\n      /**\n       * Indicates whether {@link fabric.Collection.add}, {@link fabric.Collection.insertAt} and {@link fabric.Collection.remove},\n       * {@link fabric.StaticCanvas.moveTo}, {@link fabric.StaticCanvas.clear} and many more, should also re-render canvas.\n       * Disabling this option will not give a performance boost when adding/removing a lot of objects to/from canvas at once\n       * since the renders are quequed and executed one per frame.\n       * Disabling is suggested anyway and managing the renders of the app manually is not a big effort ( canvas.requestRenderAll() )\n       * Left default to true to do not break documentation and old app, fiddles.\n       * @type Boolean\n       * @default\n       */\n      renderOnAddRemove: true,\n\n      /**\n       * Function that determines clipping of entire canvas area\n       * Being passed context as first argument.\n       * If you are using code minification, ctx argument can be minified/manglied you should use\n       * as a workaround `var ctx = arguments[0];` in the function;\n       * See clipping canvas area in {@link https://github.com/kangax/fabric.js/wiki/FAQ}\n       * @deprecated since 2.0.0\n       * @type Function\n       * @default\n       */\n      clipTo: null,\n\n      /**\n       * Indicates whether object controls (borders/controls) are rendered above overlay image\n       * @type Boolean\n       * @default\n       */\n      controlsAboveOverlay: false,\n\n      /**\n       * Indicates whether the browser can be scrolled when using a touchscreen and dragging on the canvas\n       * @type Boolean\n       * @default\n       */\n      allowTouchScrolling: false,\n\n      /**\n       * Indicates whether this canvas will use image smoothing, this is on by default in browsers\n       * @type Boolean\n       * @default\n       */\n      imageSmoothingEnabled: true,\n\n      /**\n       * The transformation (in the format of Canvas transform) which focuses the viewport\n       * @type Array\n       * @default\n       */\n      viewportTransform: fabric.iMatrix.concat(),\n\n      /**\n       * if set to false background image is not affected by viewport transform\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      backgroundVpt: true,\n\n      /**\n       * if set to false overlya image is not affected by viewport transform\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      overlayVpt: true,\n\n      /**\n       * Callback; invoked right before object is about to be scaled/rotated\n       * @deprecated since 2.3.0\n       * Use before:transform event\n       */\n      onBeforeScaleRotate: function () {\n        /* NOOP */\n      },\n\n      /**\n       * When true, canvas is scaled by devicePixelRatio for better rendering on retina screens\n       * @type Boolean\n       * @default\n       */\n      enableRetinaScaling: true,\n\n      /**\n       * Describe canvas element extension over design\n       * properties are tl,tr,bl,br.\n       * if canvas is not zoomed/panned those points are the four corner of canvas\n       * if canvas is viewportTransformed you those points indicate the extension\n       * of canvas element in plain untrasformed coordinates\n       * The coordinates get updated with @method calcViewportBoundaries.\n       * @memberOf fabric.StaticCanvas.prototype\n       */\n      vptCoords: {},\n\n      /**\n       * Based on vptCoords and object.aCoords, skip rendering of objects that\n       * are not included in current viewport.\n       * May greatly help in applications with crowded canvas and use of zoom/pan\n       * If One of the corner of the bounding box of the object is on the canvas\n       * the objects get rendered.\n       * @memberOf fabric.StaticCanvas.prototype\n       * @type Boolean\n       * @default\n       */\n      skipOffscreen: true,\n\n      /**\n       * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n       * the clipPath object gets used when the canvas has rendered, and the context is placed in the\n       * top left corner of the canvas.\n       * clipPath will clip away controls, if you do not want this to happen use controlsAboveOverlay = true\n       * @type fabric.Object\n       */\n      clipPath: undefined,\n\n      /**\n       * @private\n       * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n       * @param {Object} [options] Options object\n       */\n      _initStatic: function (el, options) {\n        var cb = this.requestRenderAllBound;\n        this._objects = [];\n        this._createLowerCanvas(el);\n        this._initOptions(options);\n        this._setImageSmoothing();\n        // only initialize retina scaling once\n        if (!this.interactive) {\n          this._initRetinaScaling();\n        }\n\n        if (options.overlayImage) {\n          this.setOverlayImage(options.overlayImage, cb);\n        }\n        if (options.backgroundImage) {\n          this.setBackgroundImage(options.backgroundImage, cb);\n        }\n        if (options.backgroundColor) {\n          this.setBackgroundColor(options.backgroundColor, cb);\n        }\n        if (options.overlayColor) {\n          this.setOverlayColor(options.overlayColor, cb);\n        }\n        this.calcOffset();\n      },\n\n      /**\n       * @private\n       */\n      _isRetinaScaling: function () {\n        return fabric.devicePixelRatio !== 1 && this.enableRetinaScaling;\n      },\n\n      /**\n       * @private\n       * @return {Number} retinaScaling if applied, otherwise 1;\n       */\n      getRetinaScaling: function () {\n        return this._isRetinaScaling() ? fabric.devicePixelRatio : 1;\n      },\n\n      /**\n       * @private\n       */\n      _initRetinaScaling: function () {\n        if (!this._isRetinaScaling()) {\n          return;\n        }\n        var scaleRatio = fabric.devicePixelRatio;\n        this.__initRetinaScaling(\n          scaleRatio,\n          this.lowerCanvasEl,\n          this.contextContainer\n        );\n        if (this.upperCanvasEl) {\n          this.__initRetinaScaling(\n            scaleRatio,\n            this.upperCanvasEl,\n            this.contextTop\n          );\n        }\n      },\n\n      __initRetinaScaling: function (scaleRatio, canvas, context) {\n        canvas.setAttribute('width', this.width * scaleRatio);\n        canvas.setAttribute('height', this.height * scaleRatio);\n        context.scale(scaleRatio, scaleRatio);\n      },\n\n      /**\n       * Calculates canvas element offset relative to the document\n       * This method is also attached as \"resize\" event handler of window\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      calcOffset: function () {\n        this._offset = getElementOffset(this.lowerCanvasEl);\n        return this;\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#overlayImage|overlay image} for this canvas\n       * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set overlay to\n       * @param {Function} callback callback to invoke when image is loaded and set as an overlay\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|overlay image}.\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/MnzHT/|jsFiddle demo}\n       * @example <caption>Normal overlayImage with left/top = 0</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   // Needed to position overlayImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>overlayImage with different properties</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>Stretched overlayImage #1 - width/height correspond to canvas width/height</caption>\n       * fabric.Image.fromURL('http://fabricjs.com/assets/jail_cell_bars.png', function(img) {\n       *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n       *    canvas.setOverlayImage(img, canvas.renderAll.bind(canvas));\n       * });\n       * @example <caption>Stretched overlayImage #2 - width/height correspond to canvas width/height</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   width: canvas.width,\n       *   height: canvas.height,\n       *   // Needed to position overlayImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>overlayImage loaded from cross-origin</caption>\n       * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top',\n       *   crossOrigin: 'anonymous'\n       * });\n       */\n      setOverlayImage: function (image, callback, options) {\n        return this.__setBgOverlayImage(\n          'overlayImage',\n          image,\n          callback,\n          options\n        );\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#backgroundImage|background image} for this canvas\n       * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set background to\n       * @param {Function} callback Callback to invoke when image is loaded and set as background\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|background image}.\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/djnr8o7a/28/|jsFiddle demo}\n       * @example <caption>Normal backgroundImage with left/top = 0</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   // Needed to position backgroundImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>backgroundImage with different properties</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>Stretched backgroundImage #1 - width/height correspond to canvas width/height</caption>\n       * fabric.Image.fromURL('http://fabricjs.com/assets/honey_im_subtle.png', function(img) {\n       *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n       *    canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));\n       * });\n       * @example <caption>Stretched backgroundImage #2 - width/height correspond to canvas width/height</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   width: canvas.width,\n       *   height: canvas.height,\n       *   // Needed to position backgroundImage at 0/0\n       *   originX: 'left',\n       *   originY: 'top'\n       * });\n       * @example <caption>backgroundImage loaded from cross-origin</caption>\n       * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n       *   opacity: 0.5,\n       *   angle: 45,\n       *   left: 400,\n       *   top: 400,\n       *   originX: 'left',\n       *   originY: 'top',\n       *   crossOrigin: 'anonymous'\n       * });\n       */\n      // TODO: fix stretched examples\n      setBackgroundImage: function (image, callback, options) {\n        return this.__setBgOverlayImage(\n          'backgroundImage',\n          image,\n          callback,\n          options\n        );\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#overlayColor|foreground color} for this canvas\n       * @param {(String|fabric.Pattern)} overlayColor Color or pattern to set foreground color to\n       * @param {Function} callback Callback to invoke when foreground color is set\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/pB55h/|jsFiddle demo}\n       * @example <caption>Normal overlayColor - color value</caption>\n       * canvas.setOverlayColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as overlayColor</caption>\n       * canvas.setOverlayColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n       * }, canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as overlayColor with repeat and offset</caption>\n       * canvas.setOverlayColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat',\n       *   offsetX: 200,\n       *   offsetY: 100\n       * }, canvas.renderAll.bind(canvas));\n       */\n      setOverlayColor: function (overlayColor, callback) {\n        return this.__setBgOverlayColor('overlayColor', overlayColor, callback);\n      },\n\n      /**\n       * Sets {@link fabric.StaticCanvas#backgroundColor|background color} for this canvas\n       * @param {(String|fabric.Pattern)} backgroundColor Color or pattern to set background color to\n       * @param {Function} callback Callback to invoke when background color is set\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       * @see {@link http://jsfiddle.net/fabricjs/hXzvk/|jsFiddle demo}\n       * @example <caption>Normal backgroundColor - color value</caption>\n       * canvas.setBackgroundColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as backgroundColor</caption>\n       * canvas.setBackgroundColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n       * }, canvas.renderAll.bind(canvas));\n       * @example <caption>fabric.Pattern used as backgroundColor with repeat and offset</caption>\n       * canvas.setBackgroundColor({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat',\n       *   offsetX: 200,\n       *   offsetY: 100\n       * }, canvas.renderAll.bind(canvas));\n       */\n      setBackgroundColor: function (backgroundColor, callback) {\n        return this.__setBgOverlayColor(\n          'backgroundColor',\n          backgroundColor,\n          callback\n        );\n      },\n\n      /**\n       * @private\n       * @see {@link http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled|WhatWG Canvas Standard}\n       */\n      _setImageSmoothing: function () {\n        var ctx = this.getContext();\n\n        ctx.imageSmoothingEnabled =\n          ctx.imageSmoothingEnabled ||\n          ctx.webkitImageSmoothingEnabled ||\n          ctx.mozImageSmoothingEnabled ||\n          ctx.msImageSmoothingEnabled ||\n          ctx.oImageSmoothingEnabled;\n        ctx.imageSmoothingEnabled = this.imageSmoothingEnabled;\n      },\n\n      /**\n       * @private\n       * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundImage|backgroundImage}\n       * or {@link fabric.StaticCanvas#overlayImage|overlayImage})\n       * @param {(fabric.Image|String|null)} image fabric.Image instance, URL of an image or null to set background or overlay to\n       * @param {Function} callback Callback to invoke when image is loaded and set as background or overlay\n       * @param {Object} [options] Optional options to set for the {@link fabric.Image|image}.\n       */\n      __setBgOverlayImage: function (property, image, callback, options) {\n        if (typeof image === 'string') {\n          fabric.util.loadImage(\n            image,\n            function (img) {\n              if (img) {\n                var instance = new fabric.Image(img, options);\n                this[property] = instance;\n                instance.canvas = this;\n              }\n              callback && callback(img);\n            },\n            this,\n            options && options.crossOrigin\n          );\n        } else {\n          options && image.setOptions(options);\n          this[property] = image;\n          image && (image.canvas = this);\n          callback && callback(image);\n        }\n\n        return this;\n      },\n\n      /**\n       * @private\n       * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundColor|backgroundColor}\n       * or {@link fabric.StaticCanvas#overlayColor|overlayColor})\n       * @param {(Object|String|null)} color Object with pattern information, color value or null\n       * @param {Function} [callback] Callback is invoked when color is set\n       */\n      __setBgOverlayColor: function (property, color, callback) {\n        this[property] = color;\n        this._initGradient(color, property);\n        this._initPattern(color, property, callback);\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _createCanvasElement: function () {\n        var element = createCanvasElement();\n        if (!element) {\n          throw CANVAS_INIT_ERROR;\n        }\n        if (!element.style) {\n          element.style = {};\n        }\n        if (typeof element.getContext === 'undefined') {\n          throw CANVAS_INIT_ERROR;\n        }\n        return element;\n      },\n\n      /**\n       * @private\n       * @param {Object} [options] Options object\n       */\n      _initOptions: function (options) {\n        var lowerCanvasEl = this.lowerCanvasEl;\n        this._setOptions(options);\n\n        this.width = this.width || parseInt(lowerCanvasEl.width, 10) || 0;\n        this.height = this.height || parseInt(lowerCanvasEl.height, 10) || 0;\n\n        if (!this.lowerCanvasEl.style) {\n          return;\n        }\n\n        lowerCanvasEl.width = this.width;\n        lowerCanvasEl.height = this.height;\n\n        lowerCanvasEl.style.width = this.width + 'px';\n        lowerCanvasEl.style.height = this.height + 'px';\n\n        this.viewportTransform = this.viewportTransform.slice();\n      },\n\n      /**\n       * Creates a bottom canvas\n       * @private\n       * @param {HTMLElement} [canvasEl]\n       */\n      _createLowerCanvas: function (canvasEl) {\n        // canvasEl === 'HTMLCanvasElement' does not work on jsdom/node\n        if (canvasEl && canvasEl.getContext) {\n          this.lowerCanvasEl = canvasEl;\n        } else {\n          this.lowerCanvasEl =\n            fabric.util.getById(canvasEl) || this._createCanvasElement();\n        }\n\n        fabric.util.addClass(this.lowerCanvasEl, 'lower-canvas');\n\n        if (this.interactive) {\n          this._applyCanvasStyle(this.lowerCanvasEl);\n        }\n\n        this.contextContainer = this.lowerCanvasEl.getContext('2d');\n      },\n\n      /**\n       * Returns canvas width (in px)\n       * @return {Number}\n       */\n      getWidth: function () {\n        return this.width;\n      },\n\n      /**\n       * Returns canvas height (in px)\n       * @return {Number}\n       */\n      getHeight: function () {\n        return this.height;\n      },\n\n      /**\n       * Sets width of this canvas instance\n       * @param {Number|String} value                         Value to set width to\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setWidth: function (value, options) {\n        return this.setDimensions({ width: value }, options);\n      },\n\n      /**\n       * Sets height of this canvas instance\n       * @param {Number|String} value                         Value to set height to\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setHeight: function (value, options) {\n        return this.setDimensions({ height: value }, options);\n      },\n\n      /**\n       * Sets dimensions (width, height) of this canvas instance. when options.cssOnly flag active you should also supply the unit of measure (px/%/em)\n       * @param {Object}        dimensions                    Object with width/height properties\n       * @param {Number|String} [dimensions.width]            Width of canvas element\n       * @param {Number|String} [dimensions.height]           Height of canvas element\n       * @param {Object}        [options]                     Options object\n       * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n       * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      setDimensions: function (dimensions, options) {\n        var cssValue;\n\n        options = options || {};\n\n        for (var prop in dimensions) {\n          cssValue = dimensions[prop];\n\n          if (!options.cssOnly) {\n            this._setBackstoreDimension(prop, dimensions[prop]);\n            cssValue += 'px';\n            this.hasLostContext = true;\n          }\n\n          if (!options.backstoreOnly) {\n            this._setCssDimension(prop, cssValue);\n          }\n        }\n        if (this._isCurrentlyDrawing) {\n          this.freeDrawingBrush && this.freeDrawingBrush._setBrushStyles();\n        }\n        this._initRetinaScaling();\n        this._setImageSmoothing();\n        this.calcOffset();\n\n        if (!options.cssOnly) {\n          this.requestRenderAll();\n        }\n\n        return this;\n      },\n\n      /**\n       * Helper for setting width/height\n       * @private\n       * @param {String} prop property (width|height)\n       * @param {Number} value value to set property to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      _setBackstoreDimension: function (prop, value) {\n        this.lowerCanvasEl[prop] = value;\n\n        if (this.upperCanvasEl) {\n          this.upperCanvasEl[prop] = value;\n        }\n\n        if (this.cacheCanvasEl) {\n          this.cacheCanvasEl[prop] = value;\n        }\n\n        this[prop] = value;\n\n        return this;\n      },\n\n      /**\n       * Helper for setting css width/height\n       * @private\n       * @param {String} prop property (width|height)\n       * @param {String} value value to set property to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      _setCssDimension: function (prop, value) {\n        this.lowerCanvasEl.style[prop] = value;\n\n        if (this.upperCanvasEl) {\n          this.upperCanvasEl.style[prop] = value;\n        }\n\n        if (this.wrapperEl) {\n          this.wrapperEl.style[prop] = value;\n        }\n\n        return this;\n      },\n\n      /**\n       * Returns canvas zoom level\n       * @return {Number}\n       */\n      getZoom: function () {\n        return this.viewportTransform[0];\n      },\n\n      /**\n       * Sets viewport transform of this canvas instance\n       * @param {Array} vpt the transform in the form of context.transform\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setViewportTransform: function (vpt) {\n        var activeObject = this._activeObject,\n          object,\n          ignoreVpt = false,\n          skipAbsolute = true,\n          i,\n          len;\n        this.viewportTransform = vpt;\n        for (i = 0, len = this._objects.length; i < len; i++) {\n          object = this._objects[i];\n          object.group || object.setCoords(ignoreVpt, skipAbsolute);\n        }\n        if (activeObject && activeObject.type === 'activeSelection') {\n          activeObject.setCoords(ignoreVpt, skipAbsolute);\n        }\n        this.calcViewportBoundaries();\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Sets zoom level of this canvas instance, zoom centered around point\n       * @param {fabric.Point} point to zoom with respect to\n       * @param {Number} value to set zoom to, less than 1 zooms out\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      zoomToPoint: function (point, value) {\n        // TODO: just change the scale, preserve other transformations\n        var before = point,\n          vpt = this.viewportTransform.slice(0);\n        point = transformPoint(point, invertTransform(this.viewportTransform));\n        vpt[0] = value;\n        vpt[3] = value;\n        var after = transformPoint(point, vpt);\n        vpt[4] += before.x - after.x;\n        vpt[5] += before.y - after.y;\n        return this.setViewportTransform(vpt);\n      },\n\n      /**\n       * Sets zoom level of this canvas instance\n       * @param {Number} value to set zoom to, less than 1 zooms out\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      setZoom: function (value) {\n        this.zoomToPoint(new fabric.Point(0, 0), value);\n        return this;\n      },\n\n      /**\n       * Pan viewport so as to place point at top left corner of canvas\n       * @param {fabric.Point} point to move to\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      absolutePan: function (point) {\n        var vpt = this.viewportTransform.slice(0);\n        vpt[4] = -point.x;\n        vpt[5] = -point.y;\n        return this.setViewportTransform(vpt);\n      },\n\n      /**\n       * Pans viewpoint relatively\n       * @param {fabric.Point} point (position vector) to move by\n       * @return {fabric.Canvas} instance\n       * @chainable true\n       */\n      relativePan: function (point) {\n        return this.absolutePan(\n          new fabric.Point(\n            -point.x - this.viewportTransform[4],\n            -point.y - this.viewportTransform[5]\n          )\n        );\n      },\n\n      /**\n       * Returns &lt;canvas> element corresponding to this instance\n       * @return {HTMLCanvasElement}\n       */\n      getElement: function () {\n        return this.lowerCanvasEl;\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} obj Object that was added\n       */\n      _onObjectAdded: function (obj) {\n        this.stateful && obj.setupState();\n        obj._set('canvas', this);\n        obj.setCoords();\n        this.fire('object:added', { target: obj });\n        obj.fire('added');\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} obj Object that was removed\n       */\n      _onObjectRemoved: function (obj) {\n        this.fire('object:removed', { target: obj });\n        obj.fire('removed');\n        delete obj.canvas;\n      },\n\n      /**\n       * Clears specified context of canvas element\n       * @param {CanvasRenderingContext2D} ctx Context to clear\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      clearContext: function (ctx) {\n        ctx.clearRect(0, 0, this.width, this.height);\n        return this;\n      },\n\n      /**\n       * Returns context of canvas where objects are drawn\n       * @return {CanvasRenderingContext2D}\n       */\n      getContext: function () {\n        return this.contextContainer;\n      },\n\n      /**\n       * Clears all contexts (background, main, top) of an instance\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      clear: function () {\n        this._objects.length = 0;\n        this.backgroundImage = null;\n        this.overlayImage = null;\n        this.backgroundColor = '';\n        this.overlayColor = '';\n        if (this._hasITextHandlers) {\n          this.off('mouse:up', this._mouseUpITextHandler);\n          this._iTextInstances = null;\n          this._hasITextHandlers = false;\n        }\n        this.clearContext(this.contextContainer);\n        this.fire('canvas:cleared');\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Renders the canvas\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderAll: function () {\n        var canvasToDrawOn = this.contextContainer;\n        this.renderCanvas(canvasToDrawOn, this._objects);\n        return this;\n      },\n\n      /**\n       * Function created to be instance bound at initialization\n       * used in requestAnimationFrame rendering\n       * Let the fabricJS call it. If you call it manually you could have more\n       * animationFrame stacking on to of each other\n       * for an imperative rendering, use canvas.renderAll\n       * @private\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderAndReset: function () {\n        this.isRendering = 0;\n        this.renderAll();\n      },\n\n      /**\n       * Append a renderAll request to next animation frame.\n       * unless one is already in progress, in that case nothing is done\n       * a boolean flag will avoid appending more.\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      requestRenderAll: function () {\n        if (!this.isRendering) {\n          this.isRendering = fabric.util.requestAnimFrame(\n            this.renderAndResetBound\n          );\n        }\n        return this;\n      },\n\n      /**\n       * Calculate the position of the 4 corner of canvas with current viewportTransform.\n       * helps to determinate when an object is in the current rendering viewport using\n       * object absolute coordinates ( aCoords )\n       * @return {Object} points.tl\n       * @chainable\n       */\n      calcViewportBoundaries: function () {\n        var points = {},\n          width = this.width,\n          height = this.height,\n          iVpt = invertTransform(this.viewportTransform);\n        points.tl = transformPoint({ x: 0, y: 0 }, iVpt);\n        points.br = transformPoint({ x: width, y: height }, iVpt);\n        points.tr = new fabric.Point(points.br.x, points.tl.y);\n        points.bl = new fabric.Point(points.tl.x, points.br.y);\n        this.vptCoords = points;\n        return points;\n      },\n\n      cancelRequestedRender: function () {\n        if (this.isRendering) {\n          fabric.util.cancelAnimFrame(this.isRendering);\n          this.isRendering = 0;\n        }\n      },\n\n      /**\n       * Renders background, objects, overlay and controls.\n       * @param {CanvasRenderingContext2D} ctx\n       * @param {Array} objects to render\n       * @return {fabric.Canvas} instance\n       * @chainable\n       */\n      renderCanvas: function (ctx, objects) {\n        var v = this.viewportTransform,\n          path = this.clipPath;\n        this.cancelRequestedRender();\n        this.calcViewportBoundaries();\n        this.clearContext(ctx);\n        this.fire('before:render', { ctx: ctx });\n        if (this.clipTo) {\n          fabric.util.clipContext(this, ctx);\n        }\n        this._renderBackground(ctx);\n\n        ctx.save();\n        //apply viewport transform once for all rendering process\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        this._renderObjects(ctx, objects);\n        ctx.restore();\n        if (!this.controlsAboveOverlay && this.interactive) {\n          this.drawControls(ctx);\n        }\n        if (this.clipTo) {\n          ctx.restore();\n        }\n        if (path) {\n          path.canvas = this;\n          // needed to setup a couple of variables\n          path.shouldCache();\n          path._transformDone = true;\n          path.renderCache({ forClipping: true });\n          this.drawClipPathOnCanvas(ctx);\n        }\n        this._renderOverlay(ctx);\n        if (this.controlsAboveOverlay && this.interactive) {\n          this.drawControls(ctx);\n        }\n        this.fire('after:render', { ctx: ctx });\n      },\n\n      /**\n       * Paint the cached clipPath on the lowerCanvasEl\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawClipPathOnCanvas: function (ctx) {\n        var v = this.viewportTransform,\n          path = this.clipPath;\n        ctx.save();\n        ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        // DEBUG: uncomment this line, comment the following\n        // ctx.globalAlpha = 0.4;\n        ctx.globalCompositeOperation = 'destination-in';\n        path.transform(ctx);\n        ctx.scale(1 / path.zoomX, 1 / path.zoomY);\n        ctx.drawImage(\n          path._cacheCanvas,\n          -path.cacheTranslationX,\n          -path.cacheTranslationY\n        );\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Array} objects to render\n       */\n      _renderObjects: function (ctx, objects) {\n        var i, len;\n        for (i = 0, len = objects.length; i < len; ++i) {\n          objects[i] && objects[i].render(ctx);\n        }\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {string} property 'background' or 'overlay'\n       */\n      _renderBackgroundOrOverlay: function (ctx, property) {\n        var fill = this[property + 'Color'],\n          object = this[property + 'Image'],\n          v = this.viewportTransform,\n          needsVpt = this[property + 'Vpt'];\n        if (!fill && !object) {\n          return;\n        }\n        if (fill) {\n          ctx.save();\n          ctx.beginPath();\n          ctx.moveTo(0, 0);\n          ctx.lineTo(this.width, 0);\n          ctx.lineTo(this.width, this.height);\n          ctx.lineTo(0, this.height);\n          ctx.closePath();\n          ctx.fillStyle = fill.toLive ? fill.toLive(ctx, this) : fill;\n          if (needsVpt) {\n            ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n          }\n          ctx.transform(1, 0, 0, 1, fill.offsetX || 0, fill.offsetY || 0);\n          var m = fill.gradientTransform || fill.patternTransform;\n          m && ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n          ctx.fill();\n          ctx.restore();\n        }\n        if (object) {\n          ctx.save();\n          if (needsVpt) {\n            ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n          }\n          object.render(ctx);\n          ctx.restore();\n        }\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderBackground: function (ctx) {\n        this._renderBackgroundOrOverlay(ctx, 'background');\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderOverlay: function (ctx) {\n        this._renderBackgroundOrOverlay(ctx, 'overlay');\n      },\n\n      /**\n       * Returns coordinates of a center of canvas.\n       * Returned value is an object with top and left properties\n       * @return {Object} object with \"top\" and \"left\" number values\n       */\n      getCenter: function () {\n        return {\n          top: this.height / 2,\n          left: this.width / 2,\n        };\n      },\n\n      /**\n       * Centers object horizontally in the canvas\n       * @param {fabric.Object} object Object to center horizontally\n       * @return {fabric.Canvas} thisArg\n       */\n      centerObjectH: function (object) {\n        return this._centerObject(\n          object,\n          new fabric.Point(this.getCenter().left, object.getCenterPoint().y)\n        );\n      },\n\n      /**\n       * Centers object vertically in the canvas\n       * @param {fabric.Object} object Object to center vertically\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      centerObjectV: function (object) {\n        return this._centerObject(\n          object,\n          new fabric.Point(object.getCenterPoint().x, this.getCenter().top)\n        );\n      },\n\n      /**\n       * Centers object vertically and horizontally in the canvas\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      centerObject: function (object) {\n        var center = this.getCenter();\n\n        return this._centerObject(\n          object,\n          new fabric.Point(center.left, center.top)\n        );\n      },\n\n      /**\n       * Centers object vertically and horizontally in the viewport\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObject: function (object) {\n        var vpCenter = this.getVpCenter();\n\n        return this._centerObject(object, vpCenter);\n      },\n\n      /**\n       * Centers object horizontally in the viewport, object.top is unchanged\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObjectH: function (object) {\n        var vpCenter = this.getVpCenter();\n        this._centerObject(\n          object,\n          new fabric.Point(vpCenter.x, object.getCenterPoint().y)\n        );\n        return this;\n      },\n\n      /**\n       * Centers object Vertically in the viewport, object.top is unchanged\n       * @param {fabric.Object} object Object to center vertically and horizontally\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      viewportCenterObjectV: function (object) {\n        var vpCenter = this.getVpCenter();\n\n        return this._centerObject(\n          object,\n          new fabric.Point(object.getCenterPoint().x, vpCenter.y)\n        );\n      },\n\n      /**\n       * Calculate the point in canvas that correspond to the center of actual viewport.\n       * @return {fabric.Point} vpCenter, viewport center\n       * @chainable\n       */\n      getVpCenter: function () {\n        var center = this.getCenter(),\n          iVpt = invertTransform(this.viewportTransform);\n        return transformPoint({ x: center.left, y: center.top }, iVpt);\n      },\n\n      /**\n       * @private\n       * @param {fabric.Object} object Object to center\n       * @param {fabric.Point} center Center point\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      _centerObject: function (object, center) {\n        object.setPositionByOrigin(center, 'center', 'center');\n        object.setCoords();\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Returs dataless JSON representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {String} json string\n       */\n      toDatalessJSON: function (propertiesToInclude) {\n        return this.toDatalessObject(propertiesToInclude);\n      },\n\n      /**\n       * Returns object representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        return this._toObjectMethod('toObject', propertiesToInclude);\n      },\n\n      /**\n       * Returns dataless object representation of canvas\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        return this._toObjectMethod('toDatalessObject', propertiesToInclude);\n      },\n\n      /**\n       * @private\n       */\n      _toObjectMethod: function (methodName, propertiesToInclude) {\n        var clipPath = this.clipPath,\n          data = {\n            version: fabric.version,\n            objects: this._toObjects(methodName, propertiesToInclude),\n          };\n        if (clipPath) {\n          data.clipPath = this._toObject(\n            this.clipPath,\n            methodName,\n            propertiesToInclude\n          );\n        }\n        extend(\n          data,\n          this.__serializeBgOverlay(methodName, propertiesToInclude)\n        );\n\n        fabric.util.populateWithProperties(this, data, propertiesToInclude);\n\n        return data;\n      },\n\n      /**\n       * @private\n       */\n      _toObjects: function (methodName, propertiesToInclude) {\n        return this._objects\n          .filter(function (object) {\n            return !object.excludeFromExport;\n          })\n          .map(function (instance) {\n            return this._toObject(instance, methodName, propertiesToInclude);\n          }, this);\n      },\n\n      /**\n       * @private\n       */\n      _toObject: function (instance, methodName, propertiesToInclude) {\n        var originalValue;\n\n        if (!this.includeDefaultValues) {\n          originalValue = instance.includeDefaultValues;\n          instance.includeDefaultValues = false;\n        }\n\n        var object = instance[methodName](propertiesToInclude);\n        if (!this.includeDefaultValues) {\n          instance.includeDefaultValues = originalValue;\n        }\n        return object;\n      },\n\n      /**\n       * @private\n       */\n      __serializeBgOverlay: function (methodName, propertiesToInclude) {\n        var data = {},\n          bgImage = this.backgroundImage,\n          overlay = this.overlayImage;\n\n        if (this.backgroundColor) {\n          data.background = this.backgroundColor.toObject\n            ? this.backgroundColor.toObject(propertiesToInclude)\n            : this.backgroundColor;\n        }\n\n        if (this.overlayColor) {\n          data.overlay = this.overlayColor.toObject\n            ? this.overlayColor.toObject(propertiesToInclude)\n            : this.overlayColor;\n        }\n        if (bgImage && !bgImage.excludeFromExport) {\n          data.backgroundImage = this._toObject(\n            bgImage,\n            methodName,\n            propertiesToInclude\n          );\n        }\n        if (overlay && !overlay.excludeFromExport) {\n          data.overlayImage = this._toObject(\n            overlay,\n            methodName,\n            propertiesToInclude\n          );\n        }\n\n        return data;\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * When true, getSvgTransform() will apply the StaticCanvas.viewportTransform to the SVG transformation. When true,\n       * a zoomed canvas will then produce zoomed SVG output.\n       * @type Boolean\n       * @default\n       */\n      svgViewportTransformation: true,\n\n      /**\n       * Returns SVG representation of canvas\n       * @function\n       * @param {Object} [options] Options object for SVG output\n       * @param {Boolean} [options.suppressPreamble=false] If true xml tag is not included\n       * @param {Object} [options.viewBox] SVG viewbox object\n       * @param {Number} [options.viewBox.x] x-cooridnate of viewbox\n       * @param {Number} [options.viewBox.y] y-coordinate of viewbox\n       * @param {Number} [options.viewBox.width] Width of viewbox\n       * @param {Number} [options.viewBox.height] Height of viewbox\n       * @param {String} [options.encoding=UTF-8] Encoding of SVG output\n       * @param {String} [options.width] desired width of svg with or without units\n       * @param {String} [options.height] desired height of svg with or without units\n       * @param {Function} [reviver] Method for further parsing of svg elements, called after each fabric object converted into svg representation.\n       * @return {String} SVG string\n       * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n       * @see {@link http://jsfiddle.net/fabricjs/jQ3ZZ/|jsFiddle demo}\n       * @example <caption>Normal SVG output</caption>\n       * var svg = canvas.toSVG();\n       * @example <caption>SVG output without preamble (without &lt;?xml ../>)</caption>\n       * var svg = canvas.toSVG({suppressPreamble: true});\n       * @example <caption>SVG output with viewBox attribute</caption>\n       * var svg = canvas.toSVG({\n       *   viewBox: {\n       *     x: 100,\n       *     y: 100,\n       *     width: 200,\n       *     height: 300\n       *   }\n       * });\n       * @example <caption>SVG output with different encoding (default: UTF-8)</caption>\n       * var svg = canvas.toSVG({encoding: 'ISO-8859-1'});\n       * @example <caption>Modify SVG output with reviver function</caption>\n       * var svg = canvas.toSVG(null, function(svg) {\n       *   return svg.replace('stroke-dasharray: ; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; ', '');\n       * });\n       */\n      toSVG: function (options, reviver) {\n        options || (options = {});\n        options.reviver = reviver;\n        var markup = [];\n\n        this._setSVGPreamble(markup, options);\n        this._setSVGHeader(markup, options);\n        if (this.clipPath) {\n          markup.push(\n            '<g clip-path=\"url(#' + this.clipPath.clipPathId + ')\" >\\n'\n          );\n        }\n        this._setSVGBgOverlayColor(markup, 'background');\n        this._setSVGBgOverlayImage(markup, 'backgroundImage', reviver);\n        this._setSVGObjects(markup, reviver);\n        if (this.clipPath) {\n          markup.push('</g>\\n');\n        }\n        this._setSVGBgOverlayColor(markup, 'overlay');\n        this._setSVGBgOverlayImage(markup, 'overlayImage', reviver);\n\n        markup.push('</svg>');\n\n        return markup.join('');\n      },\n\n      /**\n       * @private\n       */\n      _setSVGPreamble: function (markup, options) {\n        if (options.suppressPreamble) {\n          return;\n        }\n        markup.push(\n          '<?xml version=\"1.0\" encoding=\"',\n          options.encoding || 'UTF-8',\n          '\" standalone=\"no\" ?>\\n',\n          '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" ',\n          '\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n'\n        );\n      },\n\n      /**\n       * @private\n       */\n      _setSVGHeader: function (markup, options) {\n        var width = options.width || this.width,\n          height = options.height || this.height,\n          vpt,\n          viewBox = 'viewBox=\"0 0 ' + this.width + ' ' + this.height + '\" ',\n          NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n\n        if (options.viewBox) {\n          viewBox =\n            'viewBox=\"' +\n            options.viewBox.x +\n            ' ' +\n            options.viewBox.y +\n            ' ' +\n            options.viewBox.width +\n            ' ' +\n            options.viewBox.height +\n            '\" ';\n        } else {\n          if (this.svgViewportTransformation) {\n            vpt = this.viewportTransform;\n            viewBox =\n              'viewBox=\"' +\n              toFixed(-vpt[4] / vpt[0], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(-vpt[5] / vpt[3], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(this.width / vpt[0], NUM_FRACTION_DIGITS) +\n              ' ' +\n              toFixed(this.height / vpt[3], NUM_FRACTION_DIGITS) +\n              '\" ';\n          }\n        }\n\n        markup.push(\n          '<svg ',\n          'xmlns=\"http://www.w3.org/2000/svg\" ',\n          'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ',\n          'version=\"1.1\" ',\n          'width=\"',\n          width,\n          '\" ',\n          'height=\"',\n          height,\n          '\" ',\n          viewBox,\n          'xml:space=\"preserve\">\\n',\n          '<desc>Created with Fabric.js ',\n          fabric.version,\n          '</desc>\\n',\n          '<defs>\\n',\n          this.createSVGFontFacesMarkup(),\n          this.createSVGRefElementsMarkup(),\n          this.createSVGClipPathMarkup(options),\n          '</defs>\\n'\n        );\n      },\n\n      createSVGClipPathMarkup: function (options) {\n        var clipPath = this.clipPath;\n        if (clipPath) {\n          clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n          return (\n            '<clipPath id=\"' +\n            clipPath.clipPathId +\n            '\" >\\n' +\n            this.clipPath.toClipPathSVG(options.reviver) +\n            '</clipPath>\\n'\n          );\n        }\n        return '';\n      },\n\n      /**\n       * Creates markup containing SVG referenced elements like patterns, gradients etc.\n       * @return {String}\n       */\n      createSVGRefElementsMarkup: function () {\n        var _this = this,\n          markup = ['background', 'overlay'].map(function (prop) {\n            var fill = _this[prop + 'Color'];\n            if (fill && fill.toLive) {\n              var shouldTransform = _this[prop + 'Vpt'],\n                vpt = _this.viewportTransform,\n                object = {\n                  width: _this.width / (shouldTransform ? vpt[0] : 1),\n                  height: _this.height / (shouldTransform ? vpt[3] : 1),\n                };\n              return fill.toSVG(object, {\n                additionalTransform: shouldTransform\n                  ? fabric.util.matrixToSVG(vpt)\n                  : '',\n              });\n            }\n            return undefined;\n          });\n        return markup.join('');\n      },\n\n      /**\n       * Creates markup containing SVG font faces,\n       * font URLs for font faces must be collected by developers\n       * and are not extracted from the DOM by fabricjs\n       * @param {Array} objects Array of fabric objects\n       * @return {String}\n       */\n      createSVGFontFacesMarkup: function () {\n        var markup = '',\n          fontList = {},\n          obj,\n          fontFamily,\n          style,\n          row,\n          rowIndex,\n          _char,\n          charIndex,\n          i,\n          len,\n          fontPaths = fabric.fontPaths,\n          objects = [];\n\n        this._objects.forEach(function add(object) {\n          objects.push(object);\n          if (object._objects) {\n            object._objects.forEach(add);\n          }\n        });\n\n        for (i = 0, len = objects.length; i < len; i++) {\n          obj = objects[i];\n          fontFamily = obj.fontFamily;\n          if (\n            obj.type.indexOf('text') === -1 ||\n            fontList[fontFamily] ||\n            !fontPaths[fontFamily]\n          ) {\n            continue;\n          }\n          fontList[fontFamily] = true;\n          if (!obj.styles) {\n            continue;\n          }\n          style = obj.styles;\n          for (rowIndex in style) {\n            row = style[rowIndex];\n            for (charIndex in row) {\n              _char = row[charIndex];\n              fontFamily = _char.fontFamily;\n              if (!fontList[fontFamily] && fontPaths[fontFamily]) {\n                fontList[fontFamily] = true;\n              }\n            }\n          }\n        }\n\n        for (var j in fontList) {\n          markup += [\n            '\\t\\t@font-face {\\n',\n            \"\\t\\t\\tfont-family: '\",\n            j,\n            \"';\\n\",\n            \"\\t\\t\\tsrc: url('\",\n            fontPaths[j],\n            \"');\\n\",\n            '\\t\\t}\\n',\n          ].join('');\n        }\n\n        if (markup) {\n          markup = [\n            '\\t<style type=\"text/css\">',\n            '<![CDATA[\\n',\n            markup,\n            ']]>',\n            '</style>\\n',\n          ].join('');\n        }\n\n        return markup;\n      },\n\n      /**\n       * @private\n       */\n      _setSVGObjects: function (markup, reviver) {\n        var instance,\n          i,\n          len,\n          objects = this._objects;\n        for (i = 0, len = objects.length; i < len; i++) {\n          instance = objects[i];\n          if (instance.excludeFromExport) {\n            continue;\n          }\n          this._setSVGObject(markup, instance, reviver);\n        }\n      },\n\n      /**\n       * @private\n       */\n      _setSVGObject: function (markup, instance, reviver) {\n        markup.push(instance.toSVG(reviver));\n      },\n\n      /**\n       * @private\n       */\n      _setSVGBgOverlayImage: function (markup, property, reviver) {\n        if (\n          this[property] &&\n          !this[property].excludeFromExport &&\n          this[property].toSVG\n        ) {\n          markup.push(this[property].toSVG(reviver));\n        }\n      },\n\n      /**\n       * @private\n       */\n      _setSVGBgOverlayColor: function (markup, property) {\n        var filler = this[property + 'Color'],\n          vpt = this.viewportTransform,\n          finalWidth = this.width,\n          finalHeight = this.height;\n        if (!filler) {\n          return;\n        }\n        if (filler.toLive) {\n          var repeat = filler.repeat,\n            iVpt = fabric.util.invertTransform(vpt),\n            shouldInvert = this[property + 'Vpt'],\n            additionalTransform = shouldInvert\n              ? fabric.util.matrixToSVG(iVpt)\n              : '';\n          markup.push(\n            '<rect transform=\"' + additionalTransform + ' translate(',\n            finalWidth / 2,\n            ',',\n            finalHeight / 2,\n            ')\"',\n            ' x=\"',\n            filler.offsetX - finalWidth / 2,\n            '\" y=\"',\n            filler.offsetY - finalHeight / 2,\n            '\" ',\n            'width=\"',\n            repeat === 'repeat-y' || repeat === 'no-repeat'\n              ? filler.source.width\n              : finalWidth,\n            '\" height=\"',\n            repeat === 'repeat-x' || repeat === 'no-repeat'\n              ? filler.source.height\n              : finalHeight,\n            '\" fill=\"url(#SVGID_' + filler.id + ')\"',\n            '></rect>\\n'\n          );\n        } else {\n          markup.push(\n            '<rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" ',\n            'fill=\"',\n            filler,\n            '\"',\n            '></rect>\\n'\n          );\n        }\n      },\n      /* _TO_SVG_END_ */\n\n      /**\n       * Moves an object or the objects of a multiple selection\n       * to the bottom of the stack of drawn objects\n       * @param {fabric.Object} object Object to send to back\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      sendToBack: function (object) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          objs;\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = objs.length; i--; ) {\n            obj = objs[i];\n            removeFromArray(this._objects, obj);\n            this._objects.unshift(obj);\n          }\n        } else {\n          removeFromArray(this._objects, object);\n          this._objects.unshift(object);\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Moves an object or the objects of a multiple selection\n       * to the top of the stack of drawn objects\n       * @param {fabric.Object} object Object to send\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      bringToFront: function (object) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          objs;\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = 0; i < objs.length; i++) {\n            obj = objs[i];\n            removeFromArray(this._objects, obj);\n            this._objects.push(obj);\n          }\n        } else {\n          removeFromArray(this._objects, object);\n          this._objects.push(object);\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * Moves an object or a selection down in stack of drawn objects\n       * An optional paramter, intersecting allowes to move the object in behind\n       * the first intersecting object. Where intersection is calculated with\n       * bounding box. If no intersection is found, there will not be change in the\n       * stack.\n       * @param {fabric.Object} object Object to send\n       * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      sendBackwards: function (object, intersecting) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          idx,\n          newIdx,\n          objs,\n          objsMoved = 0;\n\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = 0; i < objs.length; i++) {\n            obj = objs[i];\n            idx = this._objects.indexOf(obj);\n            if (idx > 0 + objsMoved) {\n              newIdx = idx - 1;\n              removeFromArray(this._objects, obj);\n              this._objects.splice(newIdx, 0, obj);\n            }\n            objsMoved++;\n          }\n        } else {\n          idx = this._objects.indexOf(object);\n          if (idx !== 0) {\n            // if object is not on the bottom of stack\n            newIdx = this._findNewLowerIndex(object, idx, intersecting);\n            removeFromArray(this._objects, object);\n            this._objects.splice(newIdx, 0, object);\n          }\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _findNewLowerIndex: function (object, idx, intersecting) {\n        var newIdx, i;\n\n        if (intersecting) {\n          newIdx = idx;\n\n          // traverse down the stack looking for the nearest intersecting object\n          for (i = idx - 1; i >= 0; --i) {\n            var isIntersecting =\n              object.intersectsWithObject(this._objects[i]) ||\n              object.isContainedWithinObject(this._objects[i]) ||\n              this._objects[i].isContainedWithinObject(object);\n\n            if (isIntersecting) {\n              newIdx = i;\n              break;\n            }\n          }\n        } else {\n          newIdx = idx - 1;\n        }\n\n        return newIdx;\n      },\n\n      /**\n       * Moves an object or a selection up in stack of drawn objects\n       * An optional paramter, intersecting allowes to move the object in front\n       * of the first intersecting object. Where intersection is calculated with\n       * bounding box. If no intersection is found, there will not be change in the\n       * stack.\n       * @param {fabric.Object} object Object to send\n       * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      bringForward: function (object, intersecting) {\n        if (!object) {\n          return this;\n        }\n        var activeSelection = this._activeObject,\n          i,\n          obj,\n          idx,\n          newIdx,\n          objs,\n          objsMoved = 0;\n\n        if (object === activeSelection && object.type === 'activeSelection') {\n          objs = activeSelection._objects;\n          for (i = objs.length; i--; ) {\n            obj = objs[i];\n            idx = this._objects.indexOf(obj);\n            if (idx < this._objects.length - 1 - objsMoved) {\n              newIdx = idx + 1;\n              removeFromArray(this._objects, obj);\n              this._objects.splice(newIdx, 0, obj);\n            }\n            objsMoved++;\n          }\n        } else {\n          idx = this._objects.indexOf(object);\n          if (idx !== this._objects.length - 1) {\n            // if object is not on top of stack (last item in an array)\n            newIdx = this._findNewUpperIndex(object, idx, intersecting);\n            removeFromArray(this._objects, object);\n            this._objects.splice(newIdx, 0, object);\n          }\n        }\n        this.renderOnAddRemove && this.requestRenderAll();\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _findNewUpperIndex: function (object, idx, intersecting) {\n        var newIdx, i, len;\n\n        if (intersecting) {\n          newIdx = idx;\n\n          // traverse up the stack looking for the nearest intersecting object\n          for (i = idx + 1, len = this._objects.length; i < len; ++i) {\n            var isIntersecting =\n              object.intersectsWithObject(this._objects[i]) ||\n              object.isContainedWithinObject(this._objects[i]) ||\n              this._objects[i].isContainedWithinObject(object);\n\n            if (isIntersecting) {\n              newIdx = i;\n              break;\n            }\n          }\n        } else {\n          newIdx = idx + 1;\n        }\n\n        return newIdx;\n      },\n\n      /**\n       * Moves an object to specified level in stack of drawn objects\n       * @param {fabric.Object} object Object to send\n       * @param {Number} index Position to move to\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      moveTo: function (object, index) {\n        removeFromArray(this._objects, object);\n        this._objects.splice(index, 0, object);\n        return this.renderOnAddRemove && this.requestRenderAll();\n      },\n\n      /**\n       * Clears a canvas element and dispose objects\n       * @return {fabric.Canvas} thisArg\n       * @chainable\n       */\n      dispose: function () {\n        // cancel eventually ongoing renders\n        if (this.isRendering) {\n          fabric.util.cancelAnimFrame(this.isRendering);\n          this.isRendering = 0;\n        }\n        this.forEachObject(function (object) {\n          object.dispose && object.dispose();\n        });\n        this._objects = [];\n        if (this.backgroundImage && this.backgroundImage.dispose) {\n          this.backgroundImage.dispose();\n        }\n        this.backgroundImage = null;\n        if (this.overlayImage && this.overlayImage.dispose) {\n          this.overlayImage.dispose();\n        }\n        this.overlayImage = null;\n        this._iTextInstances = null;\n        this.contextContainer = null;\n        fabric.util.cleanUpJsdomNode(this.lowerCanvasEl);\n        this.lowerCanvasEl = undefined;\n        return this;\n      },\n\n      /**\n       * Returns a string representation of an instance\n       * @return {String} string representation of an instance\n       */\n      toString: function () {\n        return (\n          '#<fabric.Canvas (' +\n          this.complexity() +\n          '): ' +\n          '{ objects: ' +\n          this._objects.length +\n          ' }>'\n        );\n      },\n    }\n  );\n\n  extend(fabric.StaticCanvas.prototype, fabric.Observable);\n  extend(fabric.StaticCanvas.prototype, fabric.Collection);\n  extend(fabric.StaticCanvas.prototype, fabric.DataURLExporter);\n\n  extend(\n    fabric.StaticCanvas,\n    /** @lends fabric.StaticCanvas */ {\n      /**\n       * @static\n       * @type String\n       * @default\n       */\n      EMPTY_JSON: '{\"objects\": [], \"background\": \"white\"}',\n\n      /**\n       * Provides a way to check support of some of the canvas methods\n       * (either those of HTMLCanvasElement itself, or rendering context)\n       *\n       * @param {String} methodName Method to check support for;\n       *                            Could be one of \"setLineDash\"\n       * @return {Boolean | null} `true` if method is supported (or at least exists),\n       *                          `null` if canvas element or context can not be initialized\n       */\n      supports: function (methodName) {\n        var el = createCanvasElement();\n\n        if (!el || !el.getContext) {\n          return null;\n        }\n\n        var ctx = el.getContext('2d');\n        if (!ctx) {\n          return null;\n        }\n\n        switch (methodName) {\n          case 'setLineDash':\n            return typeof ctx.setLineDash !== 'undefined';\n\n          default:\n            return null;\n        }\n      },\n    }\n  );\n\n  /**\n   * Returns JSON representation of canvas\n   * @function\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @return {String} JSON string\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n   * @see {@link http://jsfiddle.net/fabricjs/pec86/|jsFiddle demo}\n   * @example <caption>JSON without additional properties</caption>\n   * var json = canvas.toJSON();\n   * @example <caption>JSON with additional properties included</caption>\n   * var json = canvas.toJSON(['lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY', 'lockUniScaling']);\n   * @example <caption>JSON without default values</caption>\n   * canvas.includeDefaultValues = false;\n   * var json = canvas.toJSON();\n   */\n  fabric.StaticCanvas.prototype.toJSON = fabric.StaticCanvas.prototype.toObject;\n\n  if (fabric.isLikelyNode) {\n    fabric.StaticCanvas.prototype.createPNGStream = function () {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createPNGStream();\n    };\n    fabric.StaticCanvas.prototype.createJPEGStream = function (opts) {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createJPEGStream(opts);\n    };\n  }\n})();\n(function initToDataURL() {\n  fabric.util.object.extend(\n    fabric.StaticCanvas.prototype,\n    /** @lends fabric.StaticCanvas.prototype */ {\n      /**\n       * Exports canvas element to a dataurl image. Note that when multiplier is used, cropping is scaled appropriately\n       * @param {Object} [options] Options object\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by, to have consistent\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 2.0.0\n       * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n       * @see {@link http://jsfiddle.net/fabricjs/NfZVb/|jsFiddle demo}\n       * @example <caption>Generate jpeg dataURL with lower quality</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'jpeg',\n       *   quality: 0.8\n       * });\n       * @example <caption>Generate cropped png dataURL (clipping of canvas)</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'png',\n       *   left: 100,\n       *   top: 100,\n       *   width: 200,\n       *   height: 200\n       * });\n       * @example <caption>Generate double scaled png dataURL</caption>\n       * var dataURL = canvas.toDataURL({\n       *   format: 'png',\n       *   multiplier: 2\n       * });\n       */\n      toDataURL: function (options) {\n        options || (options = {});\n\n        var format = options.format || 'png',\n          quality = options.quality || 1,\n          multiplier =\n            (options.multiplier || 1) *\n            (options.enableRetinaScaling ? this.getRetinaScaling() : 1),\n          canvasEl = this.toCanvasElement(multiplier, options);\n        return fabric.util.toDataURL(canvasEl, format, quality);\n      },\n\n      /**\n       * Create a new HTMLCanvas element painted with the current canvas content.\n       * No need to resize the actual one or repaint it.\n       * Will transfer object ownership to a new canvas, paint it, and set everything back.\n       * This is an intermediary step used to get to a dataUrl but also it is useful to\n       * create quick image copies of a canvas without passing for the dataUrl string\n       * @param {Number} [multiplier] a zoom factor.\n       * @param {Object} [cropping] Cropping informations\n       * @param {Number} [cropping.left] Cropping left offset.\n       * @param {Number} [cropping.top] Cropping top offset.\n       * @param {Number} [cropping.width] Cropping width.\n       * @param {Number} [cropping.height] Cropping height.\n       */\n      toCanvasElement: function (multiplier, cropping) {\n        multiplier = multiplier || 1;\n        cropping = cropping || {};\n        var scaledWidth = (cropping.width || this.width) * multiplier,\n          scaledHeight = (cropping.height || this.height) * multiplier,\n          zoom = this.getZoom(),\n          originalWidth = this.width,\n          originalHeight = this.height,\n          newZoom = zoom * multiplier,\n          vp = this.viewportTransform,\n          translateX = (vp[4] - (cropping.left || 0)) * multiplier,\n          translateY = (vp[5] - (cropping.top || 0)) * multiplier,\n          originalInteractive = this.interactive,\n          newVp = [newZoom, 0, 0, newZoom, translateX, translateY],\n          originalRetina = this.enableRetinaScaling,\n          canvasEl = fabric.util.createCanvasElement(),\n          originalContextTop = this.contextTop;\n        canvasEl.width = scaledWidth;\n        canvasEl.height = scaledHeight;\n        this.contextTop = null;\n        this.enableRetinaScaling = false;\n        this.interactive = false;\n        this.viewportTransform = newVp;\n        this.width = scaledWidth;\n        this.height = scaledHeight;\n        this.calcViewportBoundaries();\n        this.renderCanvas(canvasEl.getContext('2d'), this._objects);\n        this.viewportTransform = vp;\n        this.width = originalWidth;\n        this.height = originalHeight;\n        this.calcViewportBoundaries();\n        this.interactive = originalInteractive;\n        this.enableRetinaScaling = originalRetina;\n        this.contextTop = originalContextTop;\n        return canvasEl;\n      },\n    }\n  );\n})();\n(function init2dRoot(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    extend = fabric.util.object.extend,\n    clone = fabric.util.object.clone,\n    toFixed = fabric.util.toFixed,\n    capitalize = fabric.util.string.capitalize,\n    degreesToRadians = fabric.util.degreesToRadians,\n    supportsLineDash = fabric.StaticCanvas.supports('setLineDash'),\n    objectCaching = !fabric.isLikelyNode,\n    ALIASING_LIMIT = 2;\n\n  if (fabric.Object) {\n    return;\n  }\n\n  /**\n   * Root object class from which all 2d shape classes inherit from\n   * @class fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#objects}\n   * @see {@link fabric.Object#initialize} for constructor definition\n   *\n   * @fires added\n   * @fires removed\n   *\n   * @fires selected\n   * @fires deselected\n   * @fires modified\n   * @fires modified\n   * @fires moved\n   * @fires scaled\n   * @fires rotated\n   * @fires skewed\n   *\n   * @fires rotating\n   * @fires scaling\n   * @fires moving\n   * @fires skewing\n   *\n   * @fires mousedown\n   * @fires mouseup\n   * @fires mouseover\n   * @fires mouseout\n   * @fires mousewheel\n   * @fires mousedblclick\n   *\n   * @fires dragover\n   * @fires dragenter\n   * @fires dragleave\n   * @fires drop\n   */\n  fabric.Object = fabric.util.createClass(\n    fabric.CommonMethods,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Type of an object (rect, circle, path, etc.).\n       * Note that this property is meant to be read-only and not meant to be modified.\n       * If you modify, certain parts of Fabric (such as JSON loading) won't work correctly.\n       * @type String\n       * @default\n       */\n      type: 'object',\n\n      /**\n       * Horizontal origin of transformation of an object (one of \"left\", \"right\", \"center\")\n       * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n       * @type String\n       * @default\n       */\n      originX: 'left',\n\n      /**\n       * Vertical origin of transformation of an object (one of \"top\", \"bottom\", \"center\")\n       * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n       * @type String\n       * @default\n       */\n      originY: 'top',\n\n      /**\n       * Top position of an object. Note that by default it's relative to object top. You can change this by setting originY={top/center/bottom}\n       * @type Number\n       * @default\n       */\n      top: 0,\n\n      /**\n       * Left position of an object. Note that by default it's relative to object left. You can change this by setting originX={left/center/right}\n       * @type Number\n       * @default\n       */\n      left: 0,\n\n      /**\n       * Object width\n       * @type Number\n       * @default\n       */\n      width: 0,\n\n      /**\n       * Object height\n       * @type Number\n       * @default\n       */\n      height: 0,\n\n      /**\n       * Object scale factor (horizontal)\n       * @type Number\n       * @default\n       */\n      scaleX: 1,\n\n      /**\n       * Object scale factor (vertical)\n       * @type Number\n       * @default\n       */\n      scaleY: 1,\n\n      /**\n       * When true, an object is rendered as flipped horizontally\n       * @type Boolean\n       * @default\n       */\n      flipX: false,\n\n      /**\n       * When true, an object is rendered as flipped vertically\n       * @type Boolean\n       * @default\n       */\n      flipY: false,\n\n      /**\n       * Opacity of an object\n       * @type Number\n       * @default\n       */\n      opacity: 1,\n\n      /**\n       * Angle of rotation of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      angle: 0,\n\n      /**\n       * Angle of skew on x axes of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      skewX: 0,\n\n      /**\n       * Angle of skew on y axes of an object (in degrees)\n       * @type Number\n       * @default\n       */\n      skewY: 0,\n\n      /**\n       * Size of object's controlling corners (in pixels)\n       * @type Number\n       * @default\n       */\n      cornerSize: 13,\n\n      /**\n       * When true, object's controlling corners are rendered as transparent inside (i.e. stroke instead of fill)\n       * @type Boolean\n       * @default\n       */\n      transparentCorners: true,\n\n      /**\n       * Default cursor value used when hovering over this object on canvas\n       * @type String\n       * @default\n       */\n      hoverCursor: null,\n\n      /**\n       * Default cursor value used when moving this object on canvas\n       * @type String\n       * @default\n       */\n      moveCursor: null,\n\n      /**\n       * Padding between object and its controlling borders (in pixels)\n       * @type Number\n       * @default\n       */\n      padding: 0,\n\n      /**\n       * Color of controlling borders of an object (when it's active)\n       * @type String\n       * @default\n       */\n      borderColor: 'rgba(102,153,255,0.75)',\n\n      /**\n       * Array specifying dash pattern of an object's borders (hasBorder must be true)\n       * @since 1.6.2\n       * @type Array\n       */\n      borderDashArray: null,\n\n      /**\n       * Color of controlling corners of an object (when it's active)\n       * @type String\n       * @default\n       */\n      cornerColor: 'rgba(102,153,255,0.5)',\n\n      /**\n       * Color of controlling corners of an object (when it's active and transparentCorners false)\n       * @since 1.6.2\n       * @type String\n       * @default\n       */\n      cornerStrokeColor: null,\n\n      /**\n       * Specify style of control, 'rect' or 'circle'\n       * @since 1.6.2\n       * @type String\n       */\n      cornerStyle: 'rect',\n\n      /**\n       * Array specifying dash pattern of an object's control (hasBorder must be true)\n       * @since 1.6.2\n       * @type Array\n       */\n      cornerDashArray: null,\n\n      /**\n       * When true, this object will use center point as the origin of transformation\n       * when being scaled via the controls.\n       * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n       * @since 1.3.4\n       * @type Boolean\n       * @default\n       */\n      centeredScaling: false,\n\n      /**\n       * When true, this object will use center point as the origin of transformation\n       * when being rotated via the controls.\n       * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n       * @since 1.3.4\n       * @type Boolean\n       * @default\n       */\n      centeredRotation: true,\n\n      /**\n       * Color of object's fill\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      fill: 'rgb(0,0,0)',\n\n      /**\n       * Fill rule used to fill an object\n       * accepted values are nonzero, evenodd\n       * <b>Backwards incompatibility note:</b> This property was used for setting globalCompositeOperation until v1.4.12 (use `fabric.Object#globalCompositeOperation` instead)\n       * @type String\n       * @default\n       */\n      fillRule: 'nonzero',\n\n      /**\n       * Composite rule used for canvas globalCompositeOperation\n       * @type String\n       * @default\n       */\n      globalCompositeOperation: 'source-over',\n\n      /**\n       * Background color of an object.\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      backgroundColor: '',\n\n      /**\n       * Selection Background color of an object. colored layer behind the object when it is active.\n       * does not mix good with globalCompositeOperation methods.\n       * @type String\n       * @default\n       */\n      selectionBackgroundColor: '',\n\n      /**\n       * When defined, an object is rendered via stroke and this property specifies its color\n       * takes css colors https://www.w3.org/TR/css-color-3/\n       * @type String\n       * @default\n       */\n      stroke: null,\n\n      /**\n       * Width of a stroke used to render this object\n       * @type Number\n       * @default\n       */\n      strokeWidth: 1,\n\n      /**\n       * Array specifying dash pattern of an object's stroke (stroke must be defined)\n       * @type Array\n       */\n      strokeDashArray: null,\n\n      /**\n       * Line offset of an object's stroke\n       * @type Number\n       * @default\n       */\n      strokeDashOffset: 0,\n\n      /**\n       * Line endings style of an object's stroke (one of \"butt\", \"round\", \"square\")\n       * @type String\n       * @default\n       */\n      strokeLineCap: 'butt',\n\n      /**\n       * Corner style of an object's stroke (one of \"bevil\", \"round\", \"miter\")\n       * @type String\n       * @default\n       */\n      strokeLineJoin: 'miter',\n\n      /**\n       * Maximum miter length (used for strokeLineJoin = \"miter\") of an object's stroke\n       * @type Number\n       * @default\n       */\n      strokeMiterLimit: 4,\n\n      /**\n       * Shadow object representing shadow of this shape\n       * @type fabric.Shadow\n       * @default\n       */\n      shadow: null,\n\n      /**\n       * Opacity of object's controlling borders when object is active and moving\n       * @type Number\n       * @default\n       */\n      borderOpacityWhenMoving: 0.4,\n\n      /**\n       * Scale factor of object's controlling borders\n       * bigger number will make a thicker border\n       * border is 1, so this is basically a border tickness\n       * since there is no way to change the border itself.\n       * @type Number\n       * @default\n       */\n      borderScaleFactor: 1,\n\n      /**\n       * Transform matrix (similar to SVG's transform matrix)\n       * This property has been depreacted. Since caching and and qrDecompose this\n       * property can be handled with the standard top,left,scaleX,scaleY,angle and skewX.\n       * A documentation example on how to parse and merge a transformMatrix will be provided before\n       * completely removing it in fabric 4.0\n       * If you are starting a project now, DO NOT use it.\n       * @deprecated since 3.2.0\n       * @type Array\n       */\n      transformMatrix: null,\n\n      /**\n       * Minimum allowed scale value of an object\n       * @type Number\n       * @default\n       */\n      minScaleLimit: 0,\n\n      /**\n       * When set to `false`, an object can not be selected for modification (using either point-click-based or group-based selection).\n       * But events still fire on it.\n       * @type Boolean\n       * @default\n       */\n      selectable: true,\n\n      /**\n       * When set to `false`, an object can not be a target of events. All events propagate through it. Introduced in v1.3.4\n       * @type Boolean\n       * @default\n       */\n      evented: true,\n\n      /**\n       * When set to `false`, an object is not rendered on canvas\n       * @type Boolean\n       * @default\n       */\n      visible: true,\n\n      /**\n       * When set to `false`, object's controls are not displayed and can not be used to manipulate object\n       * @type Boolean\n       * @default\n       */\n      hasControls: true,\n\n      /**\n       * When set to `false`, object's controlling borders are not rendered\n       * @type Boolean\n       * @default\n       */\n      hasBorders: true,\n\n      /**\n       * When set to `false`, object's controlling rotating point will not be visible or selectable\n       * @type Boolean\n       * @default\n       */\n      hasRotatingPoint: true,\n\n      /**\n       * Offset for object's controlling rotating point (when enabled via `hasRotatingPoint`)\n       * @type Number\n       * @default\n       */\n      rotatingPointOffset: 40,\n\n      /**\n       * When set to `true`, objects are \"found\" on canvas on per-pixel basis rather than according to bounding box\n       * @type Boolean\n       * @default\n       */\n      perPixelTargetFind: false,\n\n      /**\n       * When `false`, default object's values are not included in its serialization\n       * @type Boolean\n       * @default\n       */\n      includeDefaultValues: true,\n\n      /**\n       * Function that determines clipping of an object (context is passed as a first argument).\n       * If you are using code minification, ctx argument can be minified/manglied you should use\n       * as a workaround `var ctx = arguments[0];` in the function;\n       * Note that context origin is at the object's center point (not left/top corner)\n       * @deprecated since 2.0.0\n       * @type Function\n       */\n      clipTo: null,\n\n      /**\n       * When `true`, object horizontal movement is locked\n       * @type Boolean\n       * @default\n       */\n      lockMovementX: false,\n\n      /**\n       * When `true`, object vertical movement is locked\n       * @type Boolean\n       * @default\n       */\n      lockMovementY: false,\n\n      /**\n       * When `true`, object rotation is locked\n       * @type Boolean\n       * @default\n       */\n      lockRotation: false,\n\n      /**\n       * When `true`, object horizontal scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockScalingX: false,\n\n      /**\n       * When `true`, object vertical scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockScalingY: false,\n\n      /**\n       * When `true`, object non-uniform scaling is locked\n       * @type Boolean\n       * @default\n       */\n      lockUniScaling: false,\n\n      /**\n       * When `true`, object horizontal skewing is locked\n       * @type Boolean\n       * @default\n       */\n      lockSkewingX: false,\n\n      /**\n       * When `true`, object vertical skewing is locked\n       * @type Boolean\n       * @default\n       */\n      lockSkewingY: false,\n\n      /**\n       * When `true`, object cannot be flipped by scaling into negative values\n       * @type Boolean\n       * @default\n       */\n      lockScalingFlip: false,\n\n      /**\n       * When `true`, object is not exported in OBJECT/JSON\n       * @since 1.6.3\n       * @type Boolean\n       * @default\n       */\n      excludeFromExport: false,\n\n      /**\n       * When `true`, object is cached on an additional canvas.\n       * When `false`, object is not cached unless necessary ( clipPath )\n       * default to true\n       * @since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      objectCaching: objectCaching,\n\n      /**\n       * When `true`, object properties are checked for cache invalidation. In some particular\n       * situation you may want this to be disabled ( spray brush, very big, groups)\n       * or if your application does not allow you to modify properties for groups child you want\n       * to disable it for groups.\n       * default to false\n       * since 1.7.0\n       * @type Boolean\n       * @default false\n       */\n      statefullCache: false,\n\n      /**\n       * When `true`, cache does not get updated during scaling. The picture will get blocky if scaled\n       * too much and will be redrawn with correct details at the end of scaling.\n       * this setting is performance and application dependant.\n       * default to true\n       * since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      noScaleCache: true,\n\n      /**\n       * When `false`, the stoke width will scale with the object.\n       * When `true`, the stroke will always match the exact pixel size entered for stroke width.\n       * default to false\n       * @since 2.6.0\n       * @type Boolean\n       * @default false\n       * @type Boolean\n       * @default false\n       */\n      strokeUniform: false,\n\n      /**\n       * When set to `true`, object's cache will be rerendered next render call.\n       * since 1.7.0\n       * @type Boolean\n       * @default true\n       */\n      dirty: true,\n\n      /**\n       * keeps the value of the last hovered corner during mouse move.\n       * 0 is no corner, or 'mt', 'ml', 'mtr' etc..\n       * It should be private, but there is no harm in using it as\n       * a read-only property.\n       * @type number|string|any\n       * @default 0\n       */\n      __corner: 0,\n\n      /**\n       * Determines if the fill or the stroke is drawn first (one of \"fill\" or \"stroke\")\n       * @type String\n       * @default\n       */\n      paintFirst: 'fill',\n\n      /**\n       * List of properties to consider when checking if state\n       * of an object is changed (fabric.Object#hasStateChanged)\n       * as well as for history (undo/redo) purposes\n       * @type Array\n       */\n      stateProperties: (\n        'top left width height scaleX scaleY flipX flipY originX originY transformMatrix ' +\n        'stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit ' +\n        'angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor ' +\n        'skewX skewY fillRule paintFirst clipPath strokeUniform'\n      ).split(' '),\n\n      /**\n       * List of properties to consider when checking if cache needs refresh\n       * Those properties are checked by statefullCache ON ( or lazy mode if we want ) or from single\n       * calls to Object.set(key, value). If the key is in this list, the object is marked as dirty\n       * and refreshed at the next render\n       * @type Array\n       */\n      cacheProperties: (\n        'fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform' +\n        ' strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath'\n      ).split(' '),\n\n      /**\n       * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n       * the clipPath object gets used when the object has rendered, and the context is placed in the center\n       * of the object cacheCanvas.\n       * If you want 0,0 of a clipPath to align with an object center, use clipPath.originX/Y to 'center'\n       * @type fabric.Object\n       */\n      clipPath: undefined,\n\n      /**\n       * Meaningful ONLY when the object is used as clipPath.\n       * if true, the clipPath will make the object clip to the outside of the clipPath\n       * since 2.4.0\n       * @type boolean\n       * @default false\n       */\n      inverted: false,\n\n      /**\n       * Meaningful ONLY when the object is used as clipPath.\n       * if true, the clipPath will have its top and left relative to canvas, and will\n       * not be influenced by the object transform. This will make the clipPath relative\n       * to the canvas, but clipping just a particular object.\n       * WARNING this is beta, this feature may change or be renamed.\n       * since 2.4.0\n       * @type boolean\n       * @default false\n       */\n      absolutePositioned: false,\n\n      /**\n       * Constructor\n       * @param {Object} [options] Options object\n       */\n      initialize: function (options) {\n        if (options) {\n          this.setOptions(options);\n        }\n      },\n\n      /**\n       * Create a the canvas used to keep the cached copy of the object\n       * @private\n       */\n      _createCacheCanvas: function () {\n        this._cacheProperties = {};\n        this._cacheCanvas = fabric.util.createCanvasElement();\n        this._cacheContext = this._cacheCanvas.getContext('2d');\n        this._updateCacheCanvas();\n        // if canvas gets created, is empty, so dirty.\n        this.dirty = true;\n      },\n\n      /**\n       * Limit the cache dimensions so that X * Y do not cross fabric.perfLimitSizeTotal\n       * and each side do not cross fabric.cacheSideLimit\n       * those numbers are configurable so that you can get as much detail as you want\n       * making bargain with performances.\n       * @param {Object} dims\n       * @param {Object} dims.width width of canvas\n       * @param {Object} dims.height height of canvas\n       * @param {Object} dims.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @param {Object} dims.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       * @return {Object}.width width of canvas\n       * @return {Object}.height height of canvas\n       * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       */\n      _limitCacheSize: function (dims) {\n        var perfLimitSizeTotal = fabric.perfLimitSizeTotal,\n          width = dims.width,\n          height = dims.height,\n          max = fabric.maxCacheSideLimit,\n          min = fabric.minCacheSideLimit;\n        if (\n          width <= max &&\n          height <= max &&\n          width * height <= perfLimitSizeTotal\n        ) {\n          if (width < min) {\n            dims.width = min;\n          }\n          if (height < min) {\n            dims.height = min;\n          }\n          return dims;\n        }\n        var ar = width / height,\n          limitedDims = fabric.util.limitDimsByArea(ar, perfLimitSizeTotal),\n          capValue = fabric.util.capValue,\n          x = capValue(min, limitedDims.x, max),\n          y = capValue(min, limitedDims.y, max);\n        if (width > x) {\n          dims.zoomX /= width / x;\n          dims.width = x;\n          dims.capped = true;\n        }\n        if (height > y) {\n          dims.zoomY /= height / y;\n          dims.height = y;\n          dims.capped = true;\n        }\n        return dims;\n      },\n\n      /**\n       * Return the dimension and the zoom level needed to create a cache canvas\n       * big enough to host the object to be cached.\n       * @private\n       * @return {Object}.x width of object to be cached\n       * @return {Object}.y height of object to be cached\n       * @return {Object}.width width of canvas\n       * @return {Object}.height height of canvas\n       * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n       * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n       */\n      _getCacheCanvasDimensions: function () {\n        var objectScale = this.getTotalObjectScaling(),\n          // caculate dimensions without skewing\n          dim = this._getTransformedDimensions(0, 0),\n          neededX = (dim.x * objectScale.scaleX) / this.scaleX,\n          neededY = (dim.y * objectScale.scaleY) / this.scaleY;\n        return {\n          // for sure this ALIASING_LIMIT is slightly creating problem\n          // in situation in which the cache canvas gets an upper limit\n          // also objectScale contains already scaleX and scaleY\n          width: neededX + ALIASING_LIMIT,\n          height: neededY + ALIASING_LIMIT,\n          zoomX: objectScale.scaleX,\n          zoomY: objectScale.scaleY,\n          x: neededX,\n          y: neededY,\n        };\n      },\n\n      /**\n       * Update width and height of the canvas for cache\n       * returns true or false if canvas needed resize.\n       * @private\n       * @return {Boolean} true if the canvas has been resized\n       */\n      _updateCacheCanvas: function () {\n        var targetCanvas = this.canvas;\n        if (\n          this.noScaleCache &&\n          targetCanvas &&\n          targetCanvas._currentTransform\n        ) {\n          var target = targetCanvas._currentTransform.target,\n            action = targetCanvas._currentTransform.action;\n          if (\n            this === target &&\n            action.slice &&\n            action.slice(0, 5) === 'scale'\n          ) {\n            return false;\n          }\n        }\n        var canvas = this._cacheCanvas,\n          dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          minCacheSize = fabric.minCacheSideLimit,\n          width = dims.width,\n          height = dims.height,\n          drawingWidth,\n          drawingHeight,\n          zoomX = dims.zoomX,\n          zoomY = dims.zoomY,\n          dimensionsChanged =\n            width !== this.cacheWidth || height !== this.cacheHeight,\n          zoomChanged = this.zoomX !== zoomX || this.zoomY !== zoomY,\n          shouldRedraw = dimensionsChanged || zoomChanged,\n          additionalWidth = 0,\n          additionalHeight = 0,\n          shouldResizeCanvas = false;\n        if (dimensionsChanged) {\n          var canvasWidth = this._cacheCanvas.width,\n            canvasHeight = this._cacheCanvas.height,\n            sizeGrowing = width > canvasWidth || height > canvasHeight,\n            sizeShrinking =\n              (width < canvasWidth * 0.9 || height < canvasHeight * 0.9) &&\n              canvasWidth > minCacheSize &&\n              canvasHeight > minCacheSize;\n          shouldResizeCanvas = sizeGrowing || sizeShrinking;\n          if (\n            sizeGrowing &&\n            !dims.capped &&\n            (width > minCacheSize || height > minCacheSize)\n          ) {\n            additionalWidth = width * 0.1;\n            additionalHeight = height * 0.1;\n          }\n        }\n        if (shouldRedraw) {\n          if (shouldResizeCanvas) {\n            canvas.width = Math.ceil(width + additionalWidth);\n            canvas.height = Math.ceil(height + additionalHeight);\n          } else {\n            this._cacheContext.setTransform(1, 0, 0, 1, 0, 0);\n            this._cacheContext.clearRect(0, 0, canvas.width, canvas.height);\n          }\n          drawingWidth = dims.x / 2;\n          drawingHeight = dims.y / 2;\n          this.cacheTranslationX =\n            Math.round(canvas.width / 2 - drawingWidth) + drawingWidth;\n          this.cacheTranslationY =\n            Math.round(canvas.height / 2 - drawingHeight) + drawingHeight;\n          this.cacheWidth = width;\n          this.cacheHeight = height;\n          this._cacheContext.translate(\n            this.cacheTranslationX,\n            this.cacheTranslationY\n          );\n          this._cacheContext.scale(zoomX, zoomY);\n          this.zoomX = zoomX;\n          this.zoomY = zoomY;\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Sets object's properties from options\n       * @param {Object} [options] Options object\n       */\n      setOptions: function (options) {\n        this._setOptions(options);\n        this._initGradient(options.fill, 'fill');\n        this._initGradient(options.stroke, 'stroke');\n        this._initClipping(options);\n        this._initPattern(options.fill, 'fill');\n        this._initPattern(options.stroke, 'stroke');\n      },\n\n      /**\n       * Transforms context when rendering an object\n       * @param {CanvasRenderingContext2D} ctx Context\n       */\n      transform: function (ctx) {\n        var m;\n        if (this.group && !this.group._transformDone) {\n          m = this.calcTransformMatrix();\n        } else {\n          m = this.calcOwnMatrix();\n        }\n        ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n      },\n\n      /**\n       * Returns an object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n          object = {\n            type: this.type,\n            version: fabric.version,\n            originX: this.originX,\n            originY: this.originY,\n            left: toFixed(this.left, NUM_FRACTION_DIGITS),\n            top: toFixed(this.top, NUM_FRACTION_DIGITS),\n            width: toFixed(this.width, NUM_FRACTION_DIGITS),\n            height: toFixed(this.height, NUM_FRACTION_DIGITS),\n            fill:\n              this.fill && this.fill.toObject\n                ? this.fill.toObject()\n                : this.fill,\n            stroke:\n              this.stroke && this.stroke.toObject\n                ? this.stroke.toObject()\n                : this.stroke,\n            strokeWidth: toFixed(this.strokeWidth, NUM_FRACTION_DIGITS),\n            strokeDashArray: this.strokeDashArray\n              ? this.strokeDashArray.concat()\n              : this.strokeDashArray,\n            strokeLineCap: this.strokeLineCap,\n            strokeDashOffset: this.strokeDashOffset,\n            strokeLineJoin: this.strokeLineJoin,\n            // TODO: add this before release\n            // strokeUniform:            this.strokeUniform,\n            strokeMiterLimit: toFixed(\n              this.strokeMiterLimit,\n              NUM_FRACTION_DIGITS\n            ),\n            scaleX: toFixed(this.scaleX, NUM_FRACTION_DIGITS),\n            scaleY: toFixed(this.scaleY, NUM_FRACTION_DIGITS),\n            angle: toFixed(this.angle, NUM_FRACTION_DIGITS),\n            flipX: this.flipX,\n            flipY: this.flipY,\n            opacity: toFixed(this.opacity, NUM_FRACTION_DIGITS),\n            shadow:\n              this.shadow && this.shadow.toObject\n                ? this.shadow.toObject()\n                : this.shadow,\n            visible: this.visible,\n            clipTo: this.clipTo && String(this.clipTo),\n            backgroundColor: this.backgroundColor,\n            fillRule: this.fillRule,\n            paintFirst: this.paintFirst,\n            globalCompositeOperation: this.globalCompositeOperation,\n            transformMatrix: this.transformMatrix\n              ? this.transformMatrix.concat()\n              : null,\n            skewX: toFixed(this.skewX, NUM_FRACTION_DIGITS),\n            skewY: toFixed(this.skewY, NUM_FRACTION_DIGITS),\n          };\n\n        if (this.clipPath) {\n          object.clipPath = this.clipPath.toObject(propertiesToInclude);\n          object.clipPath.inverted = this.clipPath.inverted;\n          object.clipPath.absolutePositioned = this.clipPath.absolutePositioned;\n        }\n\n        fabric.util.populateWithProperties(this, object, propertiesToInclude);\n        if (!this.includeDefaultValues) {\n          object = this._removeDefaultValues(object);\n        }\n\n        return object;\n      },\n\n      /**\n       * Returns (dataless) object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        // will be overwritten by subclasses\n        return this.toObject(propertiesToInclude);\n      },\n\n      /**\n       * @private\n       * @param {Object} object\n       */\n      _removeDefaultValues: function (object) {\n        var prototype = fabric.util.getKlass(object.type).prototype,\n          stateProperties = prototype.stateProperties;\n        stateProperties.forEach(function (prop) {\n          if (prop === 'left' || prop === 'top') {\n            return;\n          }\n          if (object[prop] === prototype[prop]) {\n            delete object[prop];\n          }\n          var isArray =\n            Object.prototype.toString.call(object[prop]) === '[object Array]' &&\n            Object.prototype.toString.call(prototype[prop]) ===\n              '[object Array]';\n\n          // basically a check for [] === []\n          if (\n            isArray &&\n            object[prop].length === 0 &&\n            prototype[prop].length === 0\n          ) {\n            delete object[prop];\n          }\n        });\n\n        return object;\n      },\n\n      /**\n       * Returns a string representation of an instance\n       * @return {String}\n       */\n      toString: function () {\n        return '#<fabric.' + capitalize(this.type) + '>';\n      },\n\n      /**\n       * Return the object scale factor counting also the group scaling\n       * @return {Object} object with scaleX and scaleY properties\n       */\n      getObjectScaling: function () {\n        var options = fabric.util.qrDecompose(this.calcTransformMatrix());\n        return {\n          scaleX: Math.abs(options.scaleX),\n          scaleY: Math.abs(options.scaleY),\n        };\n      },\n\n      /**\n       * Return the object scale factor counting also the group scaling, zoom and retina\n       * @return {Object} object with scaleX and scaleY properties\n       */\n      getTotalObjectScaling: function () {\n        var scale = this.getObjectScaling(),\n          scaleX = scale.scaleX,\n          scaleY = scale.scaleY;\n        if (this.canvas) {\n          var zoom = this.canvas.getZoom();\n          var retina = this.canvas.getRetinaScaling();\n          scaleX *= zoom * retina;\n          scaleY *= zoom * retina;\n        }\n        return { scaleX: scaleX, scaleY: scaleY };\n      },\n\n      /**\n       * Return the object opacity counting also the group property\n       * @return {Number}\n       */\n      getObjectOpacity: function () {\n        var opacity = this.opacity;\n        if (this.group) {\n          opacity *= this.group.getObjectOpacity();\n        }\n        return opacity;\n      },\n\n      /**\n       * @private\n       * @param {String} key\n       * @param {*} value\n       * @return {fabric.Object} thisArg\n       */\n      _set: function (key, value) {\n        var shouldConstrainValue = key === 'scaleX' || key === 'scaleY',\n          isChanged = this[key] !== value,\n          groupNeedsUpdate = false;\n\n        if (shouldConstrainValue) {\n          value = this._constrainScale(value);\n        }\n        if (key === 'scaleX' && value < 0) {\n          this.flipX = !this.flipX;\n          value *= -1;\n        } else if (key === 'scaleY' && value < 0) {\n          this.flipY = !this.flipY;\n          value *= -1;\n        } else if (\n          key === 'shadow' &&\n          value &&\n          !(value instanceof fabric.Shadow)\n        ) {\n          value = new fabric.Shadow(value);\n        } else if (key === 'dirty' && this.group) {\n          this.group.set('dirty', value);\n        }\n\n        this[key] = value;\n\n        if (isChanged) {\n          groupNeedsUpdate = this.group && this.group.isOnACache();\n          if (this.cacheProperties.indexOf(key) > -1) {\n            this.dirty = true;\n            groupNeedsUpdate && this.group.set('dirty', true);\n          } else if (\n            groupNeedsUpdate &&\n            this.stateProperties.indexOf(key) > -1\n          ) {\n            this.group.set('dirty', true);\n          }\n        }\n\n        return this;\n      },\n\n      /**\n       * This callback function is called by the parent group of an object every\n       * time a non-delegated property changes on the group. It is passed the key\n       * and value as parameters. Not adding in this function's signature to avoid\n       * Travis build error about unused variables.\n       */\n      setOnGroup: function () {\n        // implemented by sub-classes, as needed.\n      },\n\n      /**\n       * Retrieves viewportTransform from Object's canvas if possible\n       * @method getViewportTransform\n       * @memberOf fabric.Object.prototype\n       * @return {Array}\n       */\n      getViewportTransform: function () {\n        if (this.canvas && this.canvas.viewportTransform) {\n          return this.canvas.viewportTransform;\n        }\n        return fabric.iMatrix.concat();\n      },\n\n      /*\n       * @private\n       * return if the object would be visible in rendering\n       * @memberOf fabric.Object.prototype\n       * @return {Boolean}\n       */\n      isNotVisible: function () {\n        return (\n          this.opacity === 0 ||\n          (this.width === 0 && this.height === 0 && this.strokeWidth === 0) ||\n          !this.visible\n        );\n      },\n\n      /**\n       * Renders an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      render: function (ctx) {\n        // do not render if width/height are zeros or object is not visible\n        if (this.isNotVisible()) {\n          return;\n        }\n        if (\n          this.canvas &&\n          this.canvas.skipOffscreen &&\n          !this.group &&\n          !this.isOnScreen()\n        ) {\n          return;\n        }\n        ctx.save();\n        this._setupCompositeOperation(ctx);\n        this.drawSelectionBackground(ctx);\n        this.transform(ctx);\n        this._setOpacity(ctx);\n        this._setShadow(ctx, this);\n        if (this.transformMatrix) {\n          ctx.transform.apply(ctx, this.transformMatrix);\n        }\n        this.clipTo && fabric.util.clipContext(this, ctx);\n        if (this.shouldCache()) {\n          this.renderCache();\n          this.drawCacheOnCanvas(ctx);\n        } else {\n          this._removeCacheCanvas();\n          this.dirty = false;\n          this.drawObject(ctx);\n          if (this.objectCaching && this.statefullCache) {\n            this.saveState({ propertySet: 'cacheProperties' });\n          }\n        }\n        this.clipTo && ctx.restore();\n        ctx.restore();\n      },\n\n      renderCache: function (options) {\n        options = options || {};\n        if (!this._cacheCanvas) {\n          this._createCacheCanvas();\n        }\n        if (this.isCacheDirty()) {\n          this.statefullCache &&\n            this.saveState({ propertySet: 'cacheProperties' });\n          this.drawObject(this._cacheContext, options.forClipping);\n          this.dirty = false;\n        }\n      },\n\n      /**\n       * Remove cacheCanvas and its dimensions from the objects\n       */\n      _removeCacheCanvas: function () {\n        this._cacheCanvas = null;\n        this.cacheWidth = 0;\n        this.cacheHeight = 0;\n      },\n\n      /**\n       * return true if the object will draw a stroke\n       * Does not consider text styles. This is just a shortcut used at rendering time\n       * We want it to be an aproximation and be fast.\n       * wrote to avoid extra caching, it has to return true when stroke happens,\n       * can guess when it will not happen at 100% chance, does not matter if it misses\n       * some use case where the stroke is invisible.\n       * @since 3.0.0\n       * @returns Boolean\n       */\n      hasStroke: function () {\n        return (\n          this.stroke && this.stroke !== 'transparent' && this.strokeWidth !== 0\n        );\n      },\n\n      /**\n       * return true if the object will draw a fill\n       * Does not consider text styles. This is just a shortcut used at rendering time\n       * We want it to be an aproximation and be fast.\n       * wrote to avoid extra caching, it has to return true when fill happens,\n       * can guess when it will not happen at 100% chance, does not matter if it misses\n       * some use case where the fill is invisible.\n       * @since 3.0.0\n       * @returns Boolean\n       */\n      hasFill: function () {\n        return this.fill && this.fill !== 'transparent';\n      },\n\n      /**\n       * When set to `true`, force the object to have its own cache, even if it is inside a group\n       * it may be needed when your object behave in a particular way on the cache and always needs\n       * its own isolated canvas to render correctly.\n       * Created to be overridden\n       * since 1.7.12\n       * @returns Boolean\n       */\n      needsItsOwnCache: function () {\n        if (\n          this.paintFirst === 'stroke' &&\n          this.hasFill() &&\n          this.hasStroke() &&\n          typeof this.shadow === 'object'\n        ) {\n          return true;\n        }\n        if (this.clipPath) {\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * objectCaching is a global flag, wins over everything\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group outside is cached.\n       * Read as: cache if is needed, or if the feature is enabled but we are not already caching.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        this.ownCaching =\n          this.needsItsOwnCache() ||\n          (this.objectCaching && (!this.group || !this.group.isOnACache()));\n        return this.ownCaching;\n      },\n\n      /**\n       * Check if this object or a child object will cast a shadow\n       * used by Group.shouldCache to know if child has a shadow recursively\n       * @return {Boolean}\n       */\n      willDrawShadow: function () {\n        return (\n          !!this.shadow &&\n          (this.shadow.offsetX !== 0 || this.shadow.offsetY !== 0)\n        );\n      },\n\n      /**\n       * Execute the drawing operation for an object clipPath\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawClipPathOnCache: function (ctx) {\n        var path = this.clipPath;\n        ctx.save();\n        // DEBUG: uncomment this line, comment the following\n        // ctx.globalAlpha = 0.4\n        if (path.inverted) {\n          ctx.globalCompositeOperation = 'destination-out';\n        } else {\n          ctx.globalCompositeOperation = 'destination-in';\n        }\n        //ctx.scale(1 / 2, 1 / 2);\n        if (path.absolutePositioned) {\n          var m = fabric.util.invertTransform(this.calcTransformMatrix());\n          ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        }\n        path.transform(ctx);\n        ctx.scale(1 / path.zoomX, 1 / path.zoomY);\n        ctx.drawImage(\n          path._cacheCanvas,\n          -path.cacheTranslationX,\n          -path.cacheTranslationY\n        );\n        ctx.restore();\n      },\n\n      /**\n       * Execute the drawing operation for an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawObject: function (ctx, forClipping) {\n        var originalFill = this.fill,\n          originalStroke = this.stroke;\n        if (forClipping) {\n          this.fill = 'black';\n          this.stroke = '';\n          this._setClippingProperties(ctx);\n        } else {\n          this._renderBackground(ctx);\n          this._setStrokeStyles(ctx, this);\n          this._setFillStyles(ctx, this);\n        }\n        this._render(ctx);\n        this._drawClipPath(ctx);\n        this.fill = originalFill;\n        this.stroke = originalStroke;\n      },\n\n      _drawClipPath: function (ctx) {\n        var path = this.clipPath;\n        if (!path) {\n          return;\n        }\n        // needed to setup a couple of variables\n        // path canvas gets overridden with this one.\n        // TODO find a better solution?\n        path.canvas = this.canvas;\n        path.shouldCache();\n        path._transformDone = true;\n        path.renderCache({ forClipping: true });\n        this.drawClipPathOnCache(ctx);\n      },\n\n      /**\n       * Paint the cached copy of the object on the target context.\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawCacheOnCanvas: function (ctx) {\n        ctx.scale(1 / this.zoomX, 1 / this.zoomY);\n        ctx.drawImage(\n          this._cacheCanvas,\n          -this.cacheTranslationX,\n          -this.cacheTranslationY\n        );\n      },\n\n      /**\n       * Check if cache is dirty\n       * @param {Boolean} skipCanvas skip canvas checks because this object is painted\n       * on parent canvas.\n       */\n      isCacheDirty: function (skipCanvas) {\n        if (this.isNotVisible()) {\n          return false;\n        }\n        if (this._cacheCanvas && !skipCanvas && this._updateCacheCanvas()) {\n          // in this case the context is already cleared.\n          return true;\n        } else {\n          if (\n            this.dirty ||\n            (this.clipPath && this.clipPath.absolutePositioned) ||\n            (this.statefullCache && this.hasStateChanged('cacheProperties'))\n          ) {\n            if (this._cacheCanvas && !skipCanvas) {\n              var width = this.cacheWidth / this.zoomX;\n              var height = this.cacheHeight / this.zoomY;\n              this._cacheContext.clearRect(\n                -width / 2,\n                -height / 2,\n                width,\n                height\n              );\n            }\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Draws a background for the object big as its untransformed dimensions\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderBackground: function (ctx) {\n        if (!this.backgroundColor) {\n          return;\n        }\n        var dim = this._getNonTransformedDimensions();\n        ctx.fillStyle = this.backgroundColor;\n\n        ctx.fillRect(-dim.x / 2, -dim.y / 2, dim.x, dim.y);\n        // if there is background color no other shadows\n        // should be casted\n        this._removeShadow(ctx);\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _setOpacity: function (ctx) {\n        if (this.group && !this.group._transformDone) {\n          ctx.globalAlpha = this.getObjectOpacity();\n        } else {\n          ctx.globalAlpha *= this.opacity;\n        }\n      },\n\n      _setStrokeStyles: function (ctx, decl) {\n        if (decl.stroke) {\n          ctx.lineWidth = decl.strokeWidth;\n          ctx.lineCap = decl.strokeLineCap;\n          ctx.lineDashOffset = decl.strokeDashOffset;\n          ctx.lineJoin = decl.strokeLineJoin;\n          ctx.miterLimit = decl.strokeMiterLimit;\n          ctx.strokeStyle = decl.stroke.toLive\n            ? decl.stroke.toLive(ctx, this)\n            : decl.stroke;\n        }\n      },\n\n      _setFillStyles: function (ctx, decl) {\n        if (decl.fill) {\n          ctx.fillStyle = decl.fill.toLive\n            ? decl.fill.toLive(ctx, this)\n            : decl.fill;\n        }\n      },\n\n      _setClippingProperties: function (ctx) {\n        ctx.globalAlpha = 1;\n        ctx.strokeStyle = 'transparent';\n        ctx.fillStyle = '#000000';\n      },\n\n      /**\n       * @private\n       * Sets line dash\n       * @param {CanvasRenderingContext2D} ctx Context to set the dash line on\n       * @param {Array} dashArray array representing dashes\n       * @param {Function} alternative function to call if browser does not support lineDash\n       */\n      _setLineDash: function (ctx, dashArray, alternative) {\n        if (!dashArray || dashArray.length === 0) {\n          return;\n        }\n        // Spec requires the concatenation of two copies the dash list when the number of elements is odd\n        if (1 & dashArray.length) {\n          dashArray.push.apply(dashArray, dashArray);\n        }\n        if (supportsLineDash) {\n          ctx.setLineDash(dashArray);\n        } else {\n          alternative && alternative(ctx);\n        }\n      },\n\n      /**\n       * Renders controls and borders for the object\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Object} [styleOverride] properties to override the object style\n       */\n      _renderControls: function (ctx, styleOverride) {\n        var vpt = this.getViewportTransform(),\n          matrix = this.calcTransformMatrix(),\n          options,\n          drawBorders,\n          drawControls;\n        styleOverride = styleOverride || {};\n        drawBorders =\n          typeof styleOverride.hasBorders !== 'undefined'\n            ? styleOverride.hasBorders\n            : this.hasBorders;\n        drawControls =\n          typeof styleOverride.hasControls !== 'undefined'\n            ? styleOverride.hasControls\n            : this.hasControls;\n        matrix = fabric.util.multiplyTransformMatrices(vpt, matrix);\n        options = fabric.util.qrDecompose(matrix);\n        ctx.save();\n        ctx.translate(options.translateX, options.translateY);\n        ctx.lineWidth = 1 * this.borderScaleFactor;\n        if (!this.group) {\n          ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\n        }\n        if (styleOverride.forActiveSelection) {\n          ctx.rotate(degreesToRadians(options.angle));\n          drawBorders && this.drawBordersInGroup(ctx, options, styleOverride);\n        } else {\n          ctx.rotate(degreesToRadians(this.angle));\n          drawBorders && this.drawBorders(ctx, styleOverride);\n        }\n        drawControls && this.drawControls(ctx, styleOverride);\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _setShadow: function (ctx) {\n        if (!this.shadow) {\n          return;\n        }\n\n        var shadow = this.shadow,\n          canvas = this.canvas,\n          scaling,\n          multX = (canvas && canvas.viewportTransform[0]) || 1,\n          multY = (canvas && canvas.viewportTransform[3]) || 1;\n        if (shadow.nonScaling) {\n          scaling = { scaleX: 1, scaleY: 1 };\n        } else {\n          scaling = this.getObjectScaling();\n        }\n        if (canvas && canvas._isRetinaScaling()) {\n          multX *= fabric.devicePixelRatio;\n          multY *= fabric.devicePixelRatio;\n        }\n        ctx.shadowColor = shadow.color;\n        ctx.shadowBlur =\n          (shadow.blur *\n            fabric.browserShadowBlurConstant *\n            (multX + multY) *\n            (scaling.scaleX + scaling.scaleY)) /\n          4;\n        ctx.shadowOffsetX = shadow.offsetX * multX * scaling.scaleX;\n        ctx.shadowOffsetY = shadow.offsetY * multY * scaling.scaleY;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _removeShadow: function (ctx) {\n        if (!this.shadow) {\n          return;\n        }\n\n        ctx.shadowColor = '';\n        ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {Object} filler fabric.Pattern or fabric.Gradient\n       * @return {Object} offset.offsetX offset for text rendering\n       * @return {Object} offset.offsetY offset for text rendering\n       */\n      _applyPatternGradientTransform: function (ctx, filler) {\n        if (!filler || !filler.toLive) {\n          return { offsetX: 0, offsetY: 0 };\n        }\n        var t = filler.gradientTransform || filler.patternTransform;\n        var offsetX = -this.width / 2 + filler.offsetX || 0,\n          offsetY = -this.height / 2 + filler.offsetY || 0;\n\n        if (filler.gradientUnits === 'percentage') {\n          ctx.transform(this.width, 0, 0, this.height, offsetX, offsetY);\n        } else {\n          ctx.transform(1, 0, 0, 1, offsetX, offsetY);\n        }\n        if (t) {\n          ctx.transform(t[0], t[1], t[2], t[3], t[4], t[5]);\n        }\n        return { offsetX: offsetX, offsetY: offsetY };\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderPaintInOrder: function (ctx) {\n        if (this.paintFirst === 'stroke') {\n          this._renderStroke(ctx);\n          this._renderFill(ctx);\n        } else {\n          this._renderFill(ctx);\n          this._renderStroke(ctx);\n        }\n      },\n\n      /**\n       * @private\n       * function that actually render something on the context.\n       * empty here to allow Obects to work on tests to benchmark fabric functionalites\n       * not related to rendering\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _render: function (/* ctx */) {},\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderFill: function (ctx) {\n        if (!this.fill) {\n          return;\n        }\n\n        ctx.save();\n        this._applyPatternGradientTransform(ctx, this.fill);\n        if (this.fillRule === 'evenodd') {\n          ctx.fill('evenodd');\n        } else {\n          ctx.fill();\n        }\n        ctx.restore();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderStroke: function (ctx) {\n        if (!this.stroke || this.strokeWidth === 0) {\n          return;\n        }\n\n        if (this.shadow && !this.shadow.affectStroke) {\n          this._removeShadow(ctx);\n        }\n\n        ctx.save();\n        if (this.strokeUniform && this.group) {\n          var scaling = this.getObjectScaling();\n          ctx.scale(1 / scaling.scaleX, 1 / scaling.scaleY);\n        } else if (this.strokeUniform) {\n          ctx.scale(1 / this.scaleX, 1 / this.scaleY);\n        }\n        this._setLineDash(ctx, this.strokeDashArray, this._renderDashedStroke);\n        if (this.stroke.toLive && this.stroke.gradientUnits === 'percentage') {\n          // need to transform gradient in a pattern.\n          // this is a slow process. If you are hitting this codepath, and the object\n          // is not using caching, you should consider switching it on.\n          // we need a canvas as big as the current object caching canvas.\n          this._applyPatternForTransformedGradient(ctx, this.stroke);\n        } else {\n          this._applyPatternGradientTransform(ctx, this.stroke);\n        }\n        ctx.stroke();\n        ctx.restore();\n      },\n\n      /**\n       * This function try to patch the missing gradientTransform on canvas gradients.\n       * transforming a context to transform the gradient, is going to transform the stroke too.\n       * we want to transform the gradient but not the stroke operation, so we create\n       * a transformed gradient on a pattern and then we use the pattern instead of the gradient.\n       * this method has drwabacks: is slow, is in low resolution, needs a patch for when the size\n       * is limited.\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       * @param {fabric.Gradient} filler a fabric gradient instance\n       */\n      _applyPatternForTransformedGradient: function (ctx, filler) {\n        var dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          pCanvas = fabric.util.createCanvasElement(),\n          pCtx,\n          retinaScaling = this.canvas.getRetinaScaling(),\n          width = dims.x / this.scaleX / retinaScaling,\n          height = dims.y / this.scaleY / retinaScaling;\n        pCanvas.width = width;\n        pCanvas.height = height;\n        pCtx = pCanvas.getContext('2d');\n        pCtx.beginPath();\n        pCtx.moveTo(0, 0);\n        pCtx.lineTo(width, 0);\n        pCtx.lineTo(width, height);\n        pCtx.lineTo(0, height);\n        pCtx.closePath();\n        pCtx.translate(width / 2, height / 2);\n        pCtx.scale(\n          dims.zoomX / this.scaleX / retinaScaling,\n          dims.zoomY / this.scaleY / retinaScaling\n        );\n        this._applyPatternGradientTransform(pCtx, filler);\n        pCtx.fillStyle = filler.toLive(ctx);\n        pCtx.fill();\n        ctx.translate(\n          -this.width / 2 - this.strokeWidth / 2,\n          -this.height / 2 - this.strokeWidth / 2\n        );\n        ctx.scale(\n          (retinaScaling * this.scaleX) / dims.zoomX,\n          (retinaScaling * this.scaleY) / dims.zoomY\n        );\n        ctx.strokeStyle = pCtx.createPattern(pCanvas, 'no-repeat');\n      },\n\n      /**\n       * This function is an helper for svg import. it returns the center of the object in the svg\n       * untransformed coordinates\n       * @private\n       * @return {Object} center point from element coordinates\n       */\n      _findCenterFromElement: function () {\n        return { x: this.left + this.width / 2, y: this.top + this.height / 2 };\n      },\n\n      /**\n       * This function is an helper for svg import. it decompose the transformMatrix\n       * and assign properties to object.\n       * untransformed coordinates\n       * @private\n       * @chainable\n       */\n      _assignTransformMatrixProps: function () {\n        if (this.transformMatrix) {\n          var options = fabric.util.qrDecompose(this.transformMatrix);\n          this.flipX = false;\n          this.flipY = false;\n          this.set('scaleX', options.scaleX);\n          this.set('scaleY', options.scaleY);\n          this.angle = options.angle;\n          this.skewX = options.skewX;\n          this.skewY = 0;\n        }\n      },\n\n      /**\n       * This function is an helper for svg import. it removes the transform matrix\n       * and set to object properties that fabricjs can handle\n       * @private\n       * @param {Object} preserveAspectRatioOptions\n       * @return {thisArg}\n       */\n      _removeTransformMatrix: function (preserveAspectRatioOptions) {\n        var center = this._findCenterFromElement();\n        if (this.transformMatrix) {\n          this._assignTransformMatrixProps();\n          center = fabric.util.transformPoint(center, this.transformMatrix);\n        }\n        this.transformMatrix = null;\n        if (preserveAspectRatioOptions) {\n          this.scaleX *= preserveAspectRatioOptions.scaleX;\n          this.scaleY *= preserveAspectRatioOptions.scaleY;\n          this.cropX = preserveAspectRatioOptions.cropX;\n          this.cropY = preserveAspectRatioOptions.cropY;\n          center.x += preserveAspectRatioOptions.offsetLeft;\n          center.y += preserveAspectRatioOptions.offsetTop;\n          this.width = preserveAspectRatioOptions.width;\n          this.height = preserveAspectRatioOptions.height;\n        }\n        this.setPositionByOrigin(center, 'center', 'center');\n      },\n\n      /**\n       * Clones an instance, using a callback method will work for every object.\n       * @param {Function} callback Callback is invoked with a clone as a first argument\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       */\n      clone: function (callback, propertiesToInclude) {\n        var objectForm = this.toObject(propertiesToInclude);\n        if (this.constructor.fromObject) {\n          this.constructor.fromObject(objectForm, callback);\n        } else {\n          fabric.Object._fromObject('Object', objectForm, callback);\n        }\n      },\n\n      /**\n       * Creates an instance of fabric.Image out of an object\n       * could make use of both toDataUrl or toCanvasElement.\n       * @param {Function} callback callback, invoked with an instance as a first argument\n       * @param {Object} [options] for clone as image, passed to toDataURL\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {fabric.Object} thisArg\n       */\n      cloneAsImage: function (callback, options) {\n        var canvasEl = this.toCanvasElement(options);\n        if (callback) {\n          callback(new fabric.Image(canvasEl));\n        }\n        return this;\n      },\n\n      /**\n       * Converts an object into a HTMLCanvas element\n       * @param {Object} options Options object\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {HTMLCanvasElement} Returns DOM element <canvas> with the fabric.Object\n       */\n      toCanvasElement: function (options) {\n        options || (options = {});\n\n        var utils = fabric.util,\n          origParams = utils.saveObjectTransform(this),\n          originalGroup = this.group,\n          originalShadow = this.shadow,\n          abs = Math.abs,\n          multiplier =\n            (options.multiplier || 1) *\n            (options.enableRetinaScaling ? fabric.devicePixelRatio : 1);\n        delete this.group;\n        if (options.withoutTransform) {\n          utils.resetObjectTransform(this);\n        }\n        if (options.withoutShadow) {\n          this.shadow = null;\n        }\n\n        var el = fabric.util.createCanvasElement(),\n          // skip canvas zoom and calculate with setCoords now.\n          boundingRect = this.getBoundingRect(true, true),\n          shadow = this.shadow,\n          scaling,\n          shadowOffset = { x: 0, y: 0 },\n          shadowBlur,\n          width,\n          height;\n\n        if (shadow) {\n          shadowBlur = shadow.blur;\n          if (shadow.nonScaling) {\n            scaling = { scaleX: 1, scaleY: 1 };\n          } else {\n            scaling = this.getObjectScaling();\n          }\n          // consider non scaling shadow.\n          shadowOffset.x =\n            2 *\n            Math.round(abs(shadow.offsetX) + shadowBlur) *\n            abs(scaling.scaleX);\n          shadowOffset.y =\n            2 *\n            Math.round(abs(shadow.offsetY) + shadowBlur) *\n            abs(scaling.scaleY);\n        }\n        width = boundingRect.width + shadowOffset.x;\n        height = boundingRect.height + shadowOffset.y;\n        // if the current width/height is not an integer\n        // we need to make it so.\n        el.width = Math.ceil(width);\n        el.height = Math.ceil(height);\n        var canvas = new fabric.StaticCanvas(el, {\n          enableRetinaScaling: false,\n          renderOnAddRemove: false,\n          skipOffscreen: false,\n        });\n        if (options.format === 'jpeg') {\n          canvas.backgroundColor = '#fff';\n        }\n        this.setPositionByOrigin(\n          new fabric.Point(canvas.width / 2, canvas.height / 2),\n          'center',\n          'center'\n        );\n\n        var originalCanvas = this.canvas;\n        canvas.add(this);\n        var canvasEl = canvas.toCanvasElement(multiplier || 1, options);\n        this.shadow = originalShadow;\n        this.set('canvas', originalCanvas);\n        if (originalGroup) {\n          this.group = originalGroup;\n        }\n        this.set(origParams).setCoords();\n        // canvas.dispose will call image.dispose that will nullify the elements\n        // since this canvas is a simple element for the process, we remove references\n        // to objects in this way in order to avoid object trashing.\n        canvas._objects = [];\n        canvas.dispose();\n        canvas = null;\n\n        return canvasEl;\n      },\n\n      /**\n       * Converts an object into a data-url-like string\n       * @param {Object} options Options object\n       * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n       * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n       * @param {Number} [options.multiplier=1] Multiplier to scale by\n       * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n       * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n       * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n       * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n       * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n       * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n       * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n       * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n       */\n      toDataURL: function (options) {\n        options || (options = {});\n        return fabric.util.toDataURL(\n          this.toCanvasElement(options),\n          options.format || 'png',\n          options.quality || 1\n        );\n      },\n\n      /**\n       * Returns true if specified type is identical to the type of an instance\n       * @param {String} type Type to check against\n       * @return {Boolean}\n       */\n      isType: function (type) {\n        return this.type === type;\n      },\n\n      /**\n       * Returns complexity of an instance\n       * @return {Number} complexity of this instance (is 1 unless subclassed)\n       */\n      complexity: function () {\n        return 1;\n      },\n\n      /**\n       * Returns a JSON representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} JSON\n       */\n      toJSON: function (propertiesToInclude) {\n        // delegate, not alias\n        return this.toObject(propertiesToInclude);\n      },\n\n      /**\n       * Sets gradient (fill or stroke) of an object\n       * percentages for x1,x2,y1,y2,r1,r2 together with gradientUnits 'pixels', are not supported.\n       * <b>Backwards incompatibility note:</b> This method was named \"setGradientFill\" until v1.1.0\n       * @param {String} property Property name 'stroke' or 'fill'\n       * @param {Object} [options] Options object\n       * @param {String} [options.type] Type of gradient 'radial' or 'linear'\n       * @param {Number} [options.x1=0] x-coordinate of start point\n       * @param {Number} [options.y1=0] y-coordinate of start point\n       * @param {Number} [options.x2=0] x-coordinate of end point\n       * @param {Number} [options.y2=0] y-coordinate of end point\n       * @param {Number} [options.r1=0] Radius of start point (only for radial gradients)\n       * @param {Number} [options.r2=0] Radius of end point (only for radial gradients)\n       * @param {Object} [options.colorStops] Color stops object eg. {0: 'ff0000', 1: '000000'}\n       * @param {Object} [options.gradientTransform] transformMatrix for gradient\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.4.0\n       * @see {@link http://jsfiddle.net/fabricjs/58y8b/|jsFiddle demo}\n       * @example <caption>Set linear gradient</caption>\n       * object.setGradient('fill', {\n       *   type: 'linear',\n       *   x1: -object.width / 2,\n       *   y1: 0,\n       *   x2: object.width / 2,\n       *   y2: 0,\n       *   colorStops: {\n       *     0: 'red',\n       *     0.5: '#005555',\n       *     1: 'rgba(0,0,255,0.5)'\n       *   }\n       * });\n       * canvas.renderAll();\n       * @example <caption>Set radial gradient</caption>\n       * object.setGradient('fill', {\n       *   type: 'radial',\n       *   x1: 0,\n       *   y1: 0,\n       *   x2: 0,\n       *   y2: 0,\n       *   r1: object.width / 2,\n       *   r2: 10,\n       *   colorStops: {\n       *     0: 'red',\n       *     0.5: '#005555',\n       *     1: 'rgba(0,0,255,0.5)'\n       *   }\n       * });\n       * canvas.renderAll();\n       */\n      setGradient: function (property, options) {\n        options || (options = {});\n\n        var gradient = { colorStops: [] };\n\n        gradient.type =\n          options.type || (options.r1 || options.r2 ? 'radial' : 'linear');\n        gradient.coords = {\n          x1: options.x1,\n          y1: options.y1,\n          x2: options.x2,\n          y2: options.y2,\n        };\n        gradient.gradientUnits = options.gradientUnits || 'pixels';\n        if (options.r1 || options.r2) {\n          gradient.coords.r1 = options.r1;\n          gradient.coords.r2 = options.r2;\n        }\n\n        gradient.gradientTransform = options.gradientTransform;\n        fabric.Gradient.prototype.addColorStop.call(\n          gradient,\n          options.colorStops\n        );\n\n        return this.set(property, fabric.Gradient.forObject(this, gradient));\n      },\n\n      /**\n       * Sets pattern fill of an object\n       * @param {Object} options Options object\n       * @param {(String|HTMLImageElement)} options.source Pattern source\n       * @param {String} [options.repeat=repeat] Repeat property of a pattern (one of repeat, repeat-x, repeat-y or no-repeat)\n       * @param {Number} [options.offsetX=0] Pattern horizontal offset from object's left/top corner\n       * @param {Number} [options.offsetY=0] Pattern vertical offset from object's left/top corner\n       * @param {Function} [callback] Callback to invoke when image set as a pattern\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.5.0\n       * @see {@link http://jsfiddle.net/fabricjs/QT3pa/|jsFiddle demo}\n       * @example <caption>Set pattern</caption>\n       * object.setPatternFill({\n       *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n       *   repeat: 'repeat'\n       * },canvas.renderAll.bind(canvas));\n       */\n      setPatternFill: function (options, callback) {\n        return this.set('fill', new fabric.Pattern(options, callback));\n      },\n\n      /**\n       * Sets {@link fabric.Object#shadow|shadow} of an object\n       * @param {Object|String} [options] Options object or string (e.g. \"2px 2px 10px rgba(0,0,0,0.2)\")\n       * @param {String} [options.color=rgb(0,0,0)] Shadow color\n       * @param {Number} [options.blur=0] Shadow blur\n       * @param {Number} [options.offsetX=0] Shadow horizontal offset\n       * @param {Number} [options.offsetY=0] Shadow vertical offset\n       * @return {fabric.Object} thisArg\n       * @chainable\n       * @deprecated since 3.5.0\n       * @see {@link http://jsfiddle.net/fabricjs/7gvJG/|jsFiddle demo}\n       * @example <caption>Set shadow with string notation</caption>\n       * object.setShadow('2px 2px 10px rgba(0,0,0,0.2)');\n       * canvas.renderAll();\n       * @example <caption>Set shadow with object notation</caption>\n       * object.setShadow({\n       *   color: 'red',\n       *   blur: 10,\n       *   offsetX: 20,\n       *   offsetY: 20\n       * });\n       * canvas.renderAll();\n       */\n      setShadow: function (options) {\n        return this.set('shadow', options ? new fabric.Shadow(options) : null);\n      },\n\n      /**\n       * Sets \"color\" of an instance (alias of `set('fill', &hellip;)`)\n       * @param {String} color Color value\n       * @return {fabric.Object} thisArg\n       * @deprecated since 3.5.0\n       * @chainable\n       */\n      setColor: function (color) {\n        this.set('fill', color);\n        return this;\n      },\n\n      /**\n       * Sets \"angle\" of an instance with centered rotation\n       * @param {Number} angle Angle value (in degrees)\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      rotate: function (angle) {\n        var shouldCenterOrigin =\n          (this.originX !== 'center' || this.originY !== 'center') &&\n          this.centeredRotation;\n\n        if (shouldCenterOrigin) {\n          this._setOriginToCenter();\n        }\n\n        this.set('angle', angle);\n\n        if (shouldCenterOrigin) {\n          this._resetOrigin();\n        }\n\n        return this;\n      },\n\n      /**\n       * Centers object horizontally on canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      centerH: function () {\n        this.canvas && this.canvas.centerObjectH(this);\n        return this;\n      },\n\n      /**\n       * Centers object horizontally on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenterH: function () {\n        this.canvas && this.canvas.viewportCenterObjectH(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically on canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      centerV: function () {\n        this.canvas && this.canvas.centerObjectV(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenterV: function () {\n        this.canvas && this.canvas.viewportCenterObjectV(this);\n        return this;\n      },\n\n      /**\n       * Centers object vertically and horizontally on canvas to which is was added last\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      center: function () {\n        this.canvas && this.canvas.centerObject(this);\n        return this;\n      },\n\n      /**\n       * Centers object on current viewport of canvas to which it was added last.\n       * You might need to call `setCoords` on an object after centering, to update controls area.\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      viewportCenter: function () {\n        this.canvas && this.canvas.viewportCenterObject(this);\n        return this;\n      },\n\n      /**\n       * Returns coordinates of a pointer relative to an object\n       * @param {Event} e Event to operate upon\n       * @param {Object} [pointer] Pointer to operate upon (instead of event)\n       * @return {Object} Coordinates of a pointer (x, y)\n       */\n      getLocalPointer: function (e, pointer) {\n        pointer = pointer || this.canvas.getPointer(e);\n        var pClicked = new fabric.Point(pointer.x, pointer.y),\n          objectLeftTop = this._getLeftTopCoords();\n        if (this.angle) {\n          pClicked = fabric.util.rotatePoint(\n            pClicked,\n            objectLeftTop,\n            degreesToRadians(-this.angle)\n          );\n        }\n        return {\n          x: pClicked.x - objectLeftTop.x,\n          y: pClicked.y - objectLeftTop.y,\n        };\n      },\n\n      /**\n       * Sets canvas globalCompositeOperation for specific object\n       * custom composition operation for the particular object can be specified using globalCompositeOperation property\n       * @param {CanvasRenderingContext2D} ctx Rendering canvas context\n       */\n      _setupCompositeOperation: function (ctx) {\n        if (this.globalCompositeOperation) {\n          ctx.globalCompositeOperation = this.globalCompositeOperation;\n        }\n      },\n    }\n  );\n\n  fabric.util.createAccessors && fabric.util.createAccessors(fabric.Object);\n\n  extend(fabric.Object.prototype, fabric.Observable);\n\n  /**\n   * Defines the number of fraction digits to use when serializing object values.\n   * You can use it to increase/decrease precision of such values like left, top, scaleX, scaleY, etc.\n   * @static\n   * @memberOf fabric.Object\n   * @constant\n   * @type Number\n   */\n  fabric.Object.NUM_FRACTION_DIGITS = 2;\n\n  fabric.Object._fromObject = function (\n    className,\n    object,\n    callback,\n    extraParam\n  ) {\n    var klass = fabric[className];\n    object = clone(object, true);\n    fabric.util.enlivenPatterns([object.fill, object.stroke], function (\n      patterns\n    ) {\n      if (typeof patterns[0] !== 'undefined') {\n        object.fill = patterns[0];\n      }\n      if (typeof patterns[1] !== 'undefined') {\n        object.stroke = patterns[1];\n      }\n      fabric.util.enlivenObjects([object.clipPath], function (enlivedProps) {\n        object.clipPath = enlivedProps[0];\n        var instance = extraParam\n          ? new klass(object[extraParam], object)\n          : new klass(object);\n        callback && callback(instance);\n      });\n    });\n  };\n\n  /**\n   * Unique id used internally when creating SVG elements\n   * @static\n   * @memberOf fabric.Object\n   * @type Number\n   */\n  fabric.Object.__uid = 0;\n})(typeof exports !== 'undefined' ? exports : this);\n(function initTranslations() {\n  var degreesToRadians = fabric.util.degreesToRadians,\n    originXOffset = {\n      left: -0.5,\n      center: 0,\n      right: 0.5,\n    },\n    originYOffset = {\n      top: -0.5,\n      center: 0,\n      bottom: 0.5,\n    };\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Translates the coordinates from a set of origin to another (based on the object's dimensions)\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @param {String} fromOriginX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} fromOriginY Vertical origin: 'top', 'center' or 'bottom'\n       * @param {String} toOriginX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} toOriginY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToGivenOrigin: function (\n        point,\n        fromOriginX,\n        fromOriginY,\n        toOriginX,\n        toOriginY\n      ) {\n        var x = point.x,\n          y = point.y,\n          offsetX,\n          offsetY,\n          dim;\n\n        if (typeof fromOriginX === 'string') {\n          fromOriginX = originXOffset[fromOriginX];\n        } else {\n          fromOriginX -= 0.5;\n        }\n\n        if (typeof toOriginX === 'string') {\n          toOriginX = originXOffset[toOriginX];\n        } else {\n          toOriginX -= 0.5;\n        }\n\n        offsetX = toOriginX - fromOriginX;\n\n        if (typeof fromOriginY === 'string') {\n          fromOriginY = originYOffset[fromOriginY];\n        } else {\n          fromOriginY -= 0.5;\n        }\n\n        if (typeof toOriginY === 'string') {\n          toOriginY = originYOffset[toOriginY];\n        } else {\n          toOriginY -= 0.5;\n        }\n\n        offsetY = toOriginY - fromOriginY;\n\n        if (offsetX || offsetY) {\n          dim = this._getTransformedDimensions();\n          x = point.x + offsetX * dim.x;\n          y = point.y + offsetY * dim.y;\n        }\n\n        return new fabric.Point(x, y);\n      },\n\n      /**\n       * Translates the coordinates from origin to center coordinates (based on the object's dimensions)\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToCenterPoint: function (point, originX, originY) {\n        var p = this.translateToGivenOrigin(\n          point,\n          originX,\n          originY,\n          'center',\n          'center'\n        );\n        if (this.angle) {\n          return fabric.util.rotatePoint(\n            p,\n            point,\n            degreesToRadians(this.angle)\n          );\n        }\n        return p;\n      },\n\n      /**\n       * Translates the coordinates from center to origin coordinates (based on the object's dimensions)\n       * @param {fabric.Point} center The point which corresponds to center of the object\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      translateToOriginPoint: function (center, originX, originY) {\n        var p = this.translateToGivenOrigin(\n          center,\n          'center',\n          'center',\n          originX,\n          originY\n        );\n        if (this.angle) {\n          return fabric.util.rotatePoint(\n            p,\n            center,\n            degreesToRadians(this.angle)\n          );\n        }\n        return p;\n      },\n\n      /**\n       * Returns the real center coordinates of the object\n       * @return {fabric.Point}\n       */\n      getCenterPoint: function () {\n        var leftTop = new fabric.Point(this.left, this.top);\n        return this.translateToCenterPoint(leftTop, this.originX, this.originY);\n      },\n\n      /**\n       * Returns the coordinates of the object based on center coordinates\n       * @param {fabric.Point} point The point which corresponds to the originX and originY params\n       * @return {fabric.Point}\n       */\n      // getOriginPoint: function(center) {\n      //   return this.translateToOriginPoint(center, this.originX, this.originY);\n      // },\n\n      /**\n       * Returns the coordinates of the object as if it has a different origin\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      getPointByOrigin: function (originX, originY) {\n        var center = this.getCenterPoint();\n        return this.translateToOriginPoint(center, originX, originY);\n      },\n\n      /**\n       * Returns the point in local coordinates\n       * @param {fabric.Point} point The point relative to the global coordinate system\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {fabric.Point}\n       */\n      toLocalPoint: function (point, originX, originY) {\n        var center = this.getCenterPoint(),\n          p,\n          p2;\n\n        if (typeof originX !== 'undefined' && typeof originY !== 'undefined') {\n          p = this.translateToGivenOrigin(\n            center,\n            'center',\n            'center',\n            originX,\n            originY\n          );\n        } else {\n          p = new fabric.Point(this.left, this.top);\n        }\n\n        p2 = new fabric.Point(point.x, point.y);\n        if (this.angle) {\n          p2 = fabric.util.rotatePoint(\n            p2,\n            center,\n            -degreesToRadians(this.angle)\n          );\n        }\n        return p2.subtractEquals(p);\n      },\n\n      /**\n       * Returns the point in global coordinates\n       * @param {fabric.Point} The point relative to the local coordinate system\n       * @return {fabric.Point}\n       */\n      // toGlobalPoint: function(point) {\n      //   return fabric.util.rotatePoint(point, this.getCenterPoint(), degreesToRadians(this.angle)).addEquals(new fabric.Point(this.left, this.top));\n      // },\n\n      /**\n       * Sets the position of the object taking into consideration the object's origin\n       * @param {fabric.Point} pos The new position of the object\n       * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n       * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n       * @return {void}\n       */\n      setPositionByOrigin: function (pos, originX, originY) {\n        var center = this.translateToCenterPoint(pos, originX, originY),\n          position = this.translateToOriginPoint(\n            center,\n            this.originX,\n            this.originY\n          );\n        this.set('left', position.x);\n        this.set('top', position.y);\n      },\n\n      /**\n       * @param {String} to One of 'left', 'center', 'right'\n       */\n      adjustPosition: function (to) {\n        var angle = degreesToRadians(this.angle),\n          hypotFull = this.getScaledWidth(),\n          xFull = fabric.util.cos(angle) * hypotFull,\n          yFull = fabric.util.sin(angle) * hypotFull,\n          offsetFrom,\n          offsetTo;\n\n        //TODO: this function does not consider mixed situation like top, center.\n        if (typeof this.originX === 'string') {\n          offsetFrom = originXOffset[this.originX];\n        } else {\n          offsetFrom = this.originX - 0.5;\n        }\n        if (typeof to === 'string') {\n          offsetTo = originXOffset[to];\n        } else {\n          offsetTo = to - 0.5;\n        }\n        this.left += xFull * (offsetTo - offsetFrom);\n        this.top += yFull * (offsetTo - offsetFrom);\n        this.setCoords();\n        this.originX = to;\n      },\n\n      /**\n       * Sets the origin/position of the object to it's center point\n       * @private\n       * @return {void}\n       */\n      _setOriginToCenter: function () {\n        this._originalOriginX = this.originX;\n        this._originalOriginY = this.originY;\n\n        var center = this.getCenterPoint();\n\n        this.originX = 'center';\n        this.originY = 'center';\n\n        this.left = center.x;\n        this.top = center.y;\n      },\n\n      /**\n       * Resets the origin/position of the object to it's original origin\n       * @private\n       * @return {void}\n       */\n      _resetOrigin: function () {\n        var originPoint = this.translateToOriginPoint(\n          this.getCenterPoint(),\n          this._originalOriginX,\n          this._originalOriginY\n        );\n\n        this.originX = this._originalOriginX;\n        this.originY = this._originalOriginY;\n\n        this.left = originPoint.x;\n        this.top = originPoint.y;\n\n        this._originalOriginX = null;\n        this._originalOriginY = null;\n      },\n\n      /**\n       * @private\n       */\n      _getLeftTopCoords: function () {\n        return this.translateToOriginPoint(\n          this.getCenterPoint(),\n          'left',\n          'top'\n        );\n      },\n    }\n  );\n})();\n(function initIntersectionsAndScaling() {\n  // Also threw in drawSelectionBackground\n\n  function getCoords(coords) {\n    return [\n      new fabric.Point(coords.tl.x, coords.tl.y),\n      new fabric.Point(coords.tr.x, coords.tr.y),\n      new fabric.Point(coords.br.x, coords.br.y),\n      new fabric.Point(coords.bl.x, coords.bl.y),\n    ];\n  }\n\n  var degreesToRadians = fabric.util.degreesToRadians,\n    multiplyMatrices = fabric.util.multiplyTransformMatrices,\n    transformPoint = fabric.util.transformPoint;\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Draws a colored layer behind the object, inside its selection borders.\n       * Requires public options: padding, selectionBackgroundColor\n       * this function is called when the context is transformed\n       * has checks to be skipped when the object is on a staticCanvas\n       * @param {CanvasRenderingContext2D} ctx Context to draw on\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      drawSelectionBackground: function (ctx) {\n        if (\n          !this.selectionBackgroundColor ||\n          (this.canvas && !this.canvas.interactive) ||\n          (this.canvas && this.canvas._activeObject !== this)\n        ) {\n          return this;\n        }\n        ctx.save();\n        var center = this.getCenterPoint(),\n          wh = this._calculateCurrentDimensions(),\n          vpt = this.canvas.viewportTransform;\n        ctx.translate(center.x, center.y);\n        ctx.scale(1 / vpt[0], 1 / vpt[3]);\n        ctx.rotate(degreesToRadians(this.angle));\n        ctx.fillStyle = this.selectionBackgroundColor;\n        ctx.fillRect(-wh.x / 2, -wh.y / 2, wh.x, wh.y);\n        ctx.restore();\n        return this;\n      },\n\n      /**\n       * Describe object's corner position in canvas element coordinates.\n       * properties are tl,mt,tr,ml,mr,bl,mb,br,mtr for the main controls.\n       * each property is an object with x, y and corner.\n       * The `corner` property contains in a similar manner the 4 points of the\n       * interactive area of the corner.\n       * The coordinates depends from this properties: width, height, scaleX, scaleY\n       * skewX, skewY, angle, strokeWidth, viewportTransform, top, left, padding.\n       * The coordinates get updated with @method setCoords.\n       * You can calculate them without updating with @method calcCoords;\n       * @memberOf fabric.Object.prototype\n       */\n      oCoords: null,\n\n      /**\n       * Describe object's corner position in canvas object absolute coordinates\n       * properties are tl,tr,bl,br and describe the four main corner.\n       * each property is an object with x, y, instance of Fabric.Point.\n       * The coordinates depends from this properties: width, height, scaleX, scaleY\n       * skewX, skewY, angle, strokeWidth, top, left.\n       * Those coordinates are useful to understand where an object is. They get updated\n       * with oCoords but they do not need to be updated when zoom or panning change.\n       * The coordinates get updated with @method setCoords.\n       * You can calculate them without updating with @method calcCoords(true);\n       * @memberOf fabric.Object.prototype\n       */\n      aCoords: null,\n\n      /**\n       * storage for object transform matrix\n       */\n      ownMatrixCache: null,\n\n      /**\n       * storage for object full transform matrix\n       */\n      matrixCache: null,\n\n      /**\n       * return correct set of coordinates for intersection\n       */\n      getCoords: function (absolute, calculate) {\n        if (!this.oCoords) {\n          this.setCoords();\n        }\n        var coords = absolute ? this.aCoords : this.oCoords;\n        return getCoords(calculate ? this.calcCoords(absolute) : coords);\n      },\n\n      /**\n       * Checks if object intersects with an area formed by 2 points\n       * @param {Object} pointTL top-left point of area\n       * @param {Object} pointBR bottom-right point of area\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object intersects with an area formed by 2 points\n       */\n      intersectsWithRect: function (pointTL, pointBR, absolute, calculate) {\n        var coords = this.getCoords(absolute, calculate),\n          intersection = fabric.Intersection.intersectPolygonRectangle(\n            coords,\n            pointTL,\n            pointBR\n          );\n        return intersection.status === 'Intersection';\n      },\n\n      /**\n       * Checks if object intersects with another object\n       * @param {Object} other Object to test\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object intersects with another object\n       */\n      intersectsWithObject: function (other, absolute, calculate) {\n        var intersection = fabric.Intersection.intersectPolygonPolygon(\n          this.getCoords(absolute, calculate),\n          other.getCoords(absolute, calculate)\n        );\n\n        return (\n          intersection.status === 'Intersection' ||\n          other.isContainedWithinObject(this, absolute, calculate) ||\n          this.isContainedWithinObject(other, absolute, calculate)\n        );\n      },\n\n      /**\n       * Checks if object is fully contained within area of another object\n       * @param {Object} other Object to test\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is fully contained within area of another object\n       */\n      isContainedWithinObject: function (other, absolute, calculate) {\n        var points = this.getCoords(absolute, calculate),\n          i = 0,\n          lines = other._getImageLines(\n            calculate\n              ? other.calcCoords(absolute)\n              : absolute\n              ? other.aCoords\n              : other.oCoords\n          );\n        for (; i < 4; i++) {\n          if (!other.containsPoint(points[i], lines)) {\n            return false;\n          }\n        }\n        return true;\n      },\n\n      /**\n       * Checks if object is fully contained within area formed by 2 points\n       * @param {Object} pointTL top-left point of area\n       * @param {Object} pointBR bottom-right point of area\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is fully contained within area formed by 2 points\n       */\n      isContainedWithinRect: function (pointTL, pointBR, absolute, calculate) {\n        var boundingRect = this.getBoundingRect(absolute, calculate);\n\n        return (\n          boundingRect.left >= pointTL.x &&\n          boundingRect.left + boundingRect.width <= pointBR.x &&\n          boundingRect.top >= pointTL.y &&\n          boundingRect.top + boundingRect.height <= pointBR.y\n        );\n      },\n\n      /**\n       * Checks if point is inside the object\n       * @param {fabric.Point} point Point to check against\n       * @param {Object} [lines] object returned from @method _getImageLines\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if point is inside the object\n       */\n      containsPoint: function (point, lines, absolute, calculate) {\n        let objLines =\n            lines ||\n            this._getImageLines(\n              calculate\n                ? this.calcCoords(absolute)\n                : absolute\n                ? this.aCoords\n                : this.oCoords\n            ),\n          xPoints = this._findCrossPoints(point, objLines);\n\n        // if xPoints is odd then point is inside the object\n        return xPoints !== 0 && xPoints % 2 === 1;\n      },\n\n      /**\n       * Checks if object is contained within the canvas with current viewportTransform\n       * the check is done stopping at first point that appears on screen\n       * @param {Boolean} [calculate] use coordinates of current position instead of .aCoords\n       * @return {Boolean} true if object is fully or partially contained within canvas\n       */\n      isOnScreen: function (calculate) {\n        if (!this.canvas) {\n          return false;\n        }\n        var pointTL = this.canvas.vptCoords.tl,\n          pointBR = this.canvas.vptCoords.br;\n        var points = this.getCoords(true, calculate),\n          point;\n        for (var i = 0; i < 4; i++) {\n          point = points[i];\n          if (\n            point.x <= pointBR.x &&\n            point.x >= pointTL.x &&\n            point.y <= pointBR.y &&\n            point.y >= pointTL.y\n          ) {\n            return true;\n          }\n        }\n        // no points on screen, check intersection with absolute coordinates\n        if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n          return true;\n        }\n        return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n      },\n\n      /**\n       * Checks if the object contains the midpoint between canvas extremities\n       * Does not make sense outside the context of isOnScreen and isPartiallyOnScreen\n       * @private\n       * @param {Fabric.Point} pointTL Top Left point\n       * @param {Fabric.Point} pointBR Top Right point\n       * @param {Boolean} calculate use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if the object contains the point\n       */\n      _containsCenterOfCanvas: function (pointTL, pointBR, calculate) {\n        // worst case scenario the object is so big that contains the screen\n        var centerPoint = {\n          x: (pointTL.x + pointBR.x) / 2,\n          y: (pointTL.y + pointBR.y) / 2,\n        };\n        if (this.containsPoint(centerPoint, null, true, calculate)) {\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Checks if object is partially contained within the canvas with current viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n       * @return {Boolean} true if object is partially contained within canvas\n       */\n      isPartiallyOnScreen: function (calculate) {\n        if (!this.canvas) {\n          return false;\n        }\n        var pointTL = this.canvas.vptCoords.tl,\n          pointBR = this.canvas.vptCoords.br;\n        if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n          return true;\n        }\n        return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n      },\n\n      /**\n       * Method that returns an object with the object edges in it, given the coordinates of the corners\n       * @private\n       * @param {Object} oCoords Coordinates of the object corners\n       */\n      _getImageLines: function (oCoords) {\n        return {\n          topline: {\n            o: oCoords.tl,\n            d: oCoords.tr,\n          },\n          rightline: {\n            o: oCoords.tr,\n            d: oCoords.br,\n          },\n          bottomline: {\n            o: oCoords.br,\n            d: oCoords.bl,\n          },\n          leftline: {\n            o: oCoords.bl,\n            d: oCoords.tl,\n          },\n        };\n      },\n\n      /**\n       * Helper method to determine how many cross points are between the 4 object edges\n       * and the horizontal line determined by a point on canvas\n       * @private\n       * @param {fabric.Point} point Point to check\n       * @param {Object} lines Coordinates of the object being evaluated\n       */\n      // remove yi, not used but left code here just in case.\n      _findCrossPoints: function (point, lines) {\n        var b1,\n          b2,\n          a1,\n          a2,\n          xi, // yi,\n          xcount = 0,\n          iLine;\n\n        for (var lineKey in lines) {\n          iLine = lines[lineKey];\n          // optimisation 1: line below point. no cross\n          if (iLine.o.y < point.y && iLine.d.y < point.y) {\n            continue;\n          }\n          // optimisation 2: line above point. no cross\n          if (iLine.o.y >= point.y && iLine.d.y >= point.y) {\n            continue;\n          }\n          // optimisation 3: vertical line case\n          if (iLine.o.x === iLine.d.x && iLine.o.x >= point.x) {\n            xi = iLine.o.x;\n            // yi = point.y;\n          }\n          // calculate the intersection point\n          else {\n            b1 = 0;\n            b2 = (iLine.d.y - iLine.o.y) / (iLine.d.x - iLine.o.x);\n            a1 = point.y - b1 * point.x;\n            a2 = iLine.o.y - b2 * iLine.o.x;\n\n            xi = -(a1 - a2) / (b1 - b2);\n            // yi = a1 + b1 * xi;\n          }\n          // dont count xi < point.x cases\n          if (xi >= point.x) {\n            xcount += 1;\n          }\n          // optimisation 4: specific for square images\n          if (xcount === 2) {\n            break;\n          }\n        }\n        return xcount;\n      },\n\n      /**\n       * Returns coordinates of object's bounding rectangle (left, top, width, height)\n       * the box is intended as aligned to axis of canvas.\n       * @param {Boolean} [absolute] use coordinates without viewportTransform\n       * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords / .aCoords\n       * @return {Object} Object with left, top, width, height properties\n       */\n      getBoundingRect: function (absolute, calculate) {\n        var coords = this.getCoords(absolute, calculate);\n        return fabric.util.makeBoundingBoxFromPoints(coords);\n      },\n\n      /**\n       * Returns width of an object's bounding box counting transformations\n       * before 2.0 it was named getWidth();\n       * @return {Number} width value\n       */\n      getScaledWidth: function () {\n        return this._getTransformedDimensions().x;\n      },\n\n      /**\n       * Returns height of an object bounding box counting transformations\n       * before 2.0 it was named getHeight();\n       * @return {Number} height value\n       */\n      getScaledHeight: function () {\n        return this._getTransformedDimensions().y;\n      },\n\n      /**\n       * Makes sure the scale is valid and modifies it if necessary\n       * @private\n       * @param {Number} value\n       * @return {Number}\n       */\n      _constrainScale: function (value) {\n        if (Math.abs(value) < this.minScaleLimit) {\n          if (value < 0) {\n            return -this.minScaleLimit;\n          } else {\n            return this.minScaleLimit;\n          }\n        } else if (value === 0) {\n          return 0.0001;\n        }\n        return value;\n      },\n\n      /**\n       * Scales an object (equally by x and y)\n       * @param {Number} value Scale factor\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scale: function (value) {\n        this._set('scaleX', value);\n        this._set('scaleY', value);\n        return this.setCoords();\n      },\n\n      /**\n       * Scales an object to a given width, with respect to bounding box (scaling by x/y equally)\n       * @param {Number} value New width value\n       * @param {Boolean} absolute ignore viewport\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scaleToWidth: function (value, absolute) {\n        // adjust to bounding rect factor so that rotated shapes would fit as well\n        var boundingRectFactor =\n          this.getBoundingRect(absolute).width / this.getScaledWidth();\n        return this.scale(value / this.width / boundingRectFactor);\n      },\n\n      /**\n       * Scales an object to a given height, with respect to bounding box (scaling by x/y equally)\n       * @param {Number} value New height value\n       * @param {Boolean} absolute ignore viewport\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      scaleToHeight: function (value, absolute) {\n        // adjust to bounding rect factor so that rotated shapes would fit as well\n        var boundingRectFactor =\n          this.getBoundingRect(absolute).height / this.getScaledHeight();\n        return this.scale(value / this.height / boundingRectFactor);\n      },\n\n      /**\n       * Calculates and returns the .coords of an object.\n       * @return {Object} Object with tl, tr, br, bl ....\n       * @chainable\n       */\n      calcCoords: function (absolute) {\n        var rotateMatrix = this._calcRotateMatrix(),\n          translateMatrix = this._calcTranslateMatrix(),\n          startMatrix = multiplyMatrices(translateMatrix, rotateMatrix),\n          vpt = this.getViewportTransform(),\n          finalMatrix = absolute\n            ? startMatrix\n            : multiplyMatrices(vpt, startMatrix),\n          dim = this._getTransformedDimensions(),\n          w = dim.x / 2,\n          h = dim.y / 2,\n          tl = transformPoint({ x: -w, y: -h }, finalMatrix),\n          tr = transformPoint({ x: w, y: -h }, finalMatrix),\n          bl = transformPoint({ x: -w, y: h }, finalMatrix),\n          br = transformPoint({ x: w, y: h }, finalMatrix);\n        if (!absolute) {\n          var padding = this.padding,\n            angle = degreesToRadians(this.angle),\n            cos = fabric.util.cos(angle),\n            sin = fabric.util.sin(angle),\n            cosP = cos * padding,\n            sinP = sin * padding,\n            cosPSinP = cosP + sinP,\n            cosPMinusSinP = cosP - sinP;\n          if (padding) {\n            tl.x -= cosPMinusSinP;\n            tl.y -= cosPSinP;\n            tr.x += cosPSinP;\n            tr.y -= cosPMinusSinP;\n            bl.x -= cosPSinP;\n            bl.y += cosPMinusSinP;\n            br.x += cosPMinusSinP;\n            br.y += cosPSinP;\n          }\n          var ml = new fabric.Point((tl.x + bl.x) / 2, (tl.y + bl.y) / 2),\n            mt = new fabric.Point((tr.x + tl.x) / 2, (tr.y + tl.y) / 2),\n            mr = new fabric.Point((br.x + tr.x) / 2, (br.y + tr.y) / 2),\n            mb = new fabric.Point((br.x + bl.x) / 2, (br.y + bl.y) / 2),\n            mtr = new fabric.Point(\n              mt.x + sin * this.rotatingPointOffset,\n              mt.y - cos * this.rotatingPointOffset\n            );\n        }\n\n        // if (!absolute) {\n        //   var canvas = this.canvas;\n        //   setTimeout(function() {\n        //     canvas.contextTop.clearRect(0, 0, 700, 700);\n        //     canvas.contextTop.fillStyle = 'green';\n        //     canvas.contextTop.fillRect(mb.x, mb.y, 3, 3);\n        //     canvas.contextTop.fillRect(bl.x, bl.y, 3, 3);\n        //     canvas.contextTop.fillRect(br.x, br.y, 3, 3);\n        //     canvas.contextTop.fillRect(tl.x, tl.y, 3, 3);\n        //     canvas.contextTop.fillRect(tr.x, tr.y, 3, 3);\n        //     canvas.contextTop.fillRect(ml.x, ml.y, 3, 3);\n        //     canvas.contextTop.fillRect(mr.x, mr.y, 3, 3);\n        //     canvas.contextTop.fillRect(mt.x, mt.y, 3, 3);\n        //     canvas.contextTop.fillRect(mtr.x, mtr.y, 3, 3);\n        //   }, 50);\n        // }\n\n        var coords = {\n          // corners\n          tl: tl,\n          tr: tr,\n          br: br,\n          bl: bl,\n        };\n        if (!absolute) {\n          // middle\n          coords.ml = ml;\n          coords.mt = mt;\n          coords.mr = mr;\n          coords.mb = mb;\n          // rotating point\n          coords.mtr = mtr;\n        }\n        return coords;\n      },\n\n      /**\n       * Sets corner position coordinates based on current angle, width and height.\n       * See {@link https://github.com/kangax/fabric.js/wiki/When-to-call-setCoords|When-to-call-setCoords}\n       * @param {Boolean} [ignoreZoom] set oCoords with or without the viewport transform.\n       * @param {Boolean} [skipAbsolute] skip calculation of aCoords, useful in setViewportTransform\n       * @return {fabric.Object} thisArg\n       * @chainable\n       */\n      setCoords: function (ignoreZoom, skipAbsolute) {\n        this.oCoords = this.calcCoords(ignoreZoom);\n        if (!skipAbsolute) {\n          this.aCoords = this.calcCoords(true);\n        }\n\n        // set coordinates of the draggable boxes in the corners used to scale/rotate the image\n        ignoreZoom || (this._setCornerCoords && this._setCornerCoords());\n\n        return this;\n      },\n\n      /**\n       * calculate rotation matrix of an object\n       * @return {Array} rotation matrix for the object\n       */\n      _calcRotateMatrix: function () {\n        return fabric.util.calcRotateMatrix(this);\n      },\n\n      /**\n       * calculate the translation matrix for an object transform\n       * @return {Array} rotation matrix for the object\n       */\n      _calcTranslateMatrix: function () {\n        var center = this.getCenterPoint();\n        return [1, 0, 0, 1, center.x, center.y];\n      },\n\n      transformMatrixKey: function (skipGroup) {\n        var sep = '_',\n          prefix = '';\n        if (!skipGroup && this.group) {\n          prefix = this.group.transformMatrixKey(skipGroup) + sep;\n        }\n        return (\n          prefix +\n          this.top +\n          sep +\n          this.left +\n          sep +\n          this.scaleX +\n          sep +\n          this.scaleY +\n          sep +\n          this.skewX +\n          sep +\n          this.skewY +\n          sep +\n          this.angle +\n          sep +\n          this.originX +\n          sep +\n          this.originY +\n          sep +\n          this.width +\n          sep +\n          this.height +\n          sep +\n          this.strokeWidth +\n          this.flipX +\n          this.flipY\n        );\n      },\n\n      /**\n       * calculate transform matrix that represents the current transformations from the\n       * object's properties.\n       * @param {Boolean} [skipGroup] return transform matrix for object not counting parent transformations\n       * @return {Array} transform matrix for the object\n       */\n      calcTransformMatrix: function (skipGroup) {\n        if (skipGroup) {\n          return this.calcOwnMatrix();\n        }\n        var key = this.transformMatrixKey(),\n          cache = this.matrixCache || (this.matrixCache = {});\n        if (cache.key === key) {\n          return cache.value;\n        }\n        var matrix = this.calcOwnMatrix();\n        if (this.group) {\n          matrix = multiplyMatrices(this.group.calcTransformMatrix(), matrix);\n        }\n        cache.key = key;\n        cache.value = matrix;\n        return matrix;\n      },\n\n      /**\n       * calculate transform matrix that represents the current transformations from the\n       * object's properties, this matrix does not include the group transformation\n       * @return {Array} transform matrix for the object\n       */\n      calcOwnMatrix: function () {\n        var key = this.transformMatrixKey(true),\n          cache = this.ownMatrixCache || (this.ownMatrixCache = {});\n        if (cache.key === key) {\n          return cache.value;\n        }\n        var tMatrix = this._calcTranslateMatrix();\n        this.translateX = tMatrix[4];\n        this.translateY = tMatrix[5];\n        cache.key = key;\n        cache.value = fabric.util.composeMatrix(this);\n        return cache.value;\n      },\n\n      /*\n       * Calculate object dimensions from its properties\n       * @private\n       * @deprecated since 3.4.0, please use fabric.util._calcDimensionsTransformMatrix\n       * not including or including flipX, flipY to emulate the flipping boolean\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _calcDimensionsTransformMatrix: function (skewX, skewY, flipping) {\n        return fabric.util.calcDimensionsMatrix({\n          skewX: skewX,\n          skewY: skewY,\n          scaleX: this.scaleX * (flipping && this.flipX ? -1 : 1),\n          scaleY: this.scaleY * (flipping && this.flipY ? -1 : 1),\n        });\n      },\n\n      /*\n       * Calculate object dimensions from its properties\n       * @private\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _getNonTransformedDimensions: function () {\n        var strokeWidth = this.strokeWidth,\n          w = this.width + strokeWidth,\n          h = this.height + strokeWidth;\n        return { x: w, y: h };\n      },\n\n      /*\n       * Calculate object bounding box dimensions from its properties scale, skew.\n       * The skewX and skewY parameters are used in the skewing logic path and\n       * do not provide something useful to common use cases.\n       * @param {Number} [skewX], a value to override current skewX\n       * @param {Number} [skewY], a value to override current skewY\n       * @private\n       * @return {Object} .x width dimension\n       * @return {Object} .y height dimension\n       */\n      _getTransformedDimensions: function (skewX, skewY) {\n        if (typeof skewX === 'undefined') {\n          skewX = this.skewX;\n        }\n        if (typeof skewY === 'undefined') {\n          skewY = this.skewY;\n        }\n        var dimensions = this._getNonTransformedDimensions(),\n          dimX,\n          dimY,\n          noSkew = skewX === 0 && skewY === 0;\n\n        if (this.strokeUniform) {\n          dimX = this.width;\n          dimY = this.height;\n        } else {\n          dimX = dimensions.x;\n          dimY = dimensions.y;\n        }\n        if (noSkew) {\n          return this._finalizeDimensions(\n            dimX * this.scaleX,\n            dimY * this.scaleY\n          );\n        } else {\n          dimX /= 2;\n          dimY /= 2;\n        }\n        var points = [\n            {\n              x: -dimX,\n              y: -dimY,\n            },\n            {\n              x: dimX,\n              y: -dimY,\n            },\n            {\n              x: -dimX,\n              y: dimY,\n            },\n            {\n              x: dimX,\n              y: dimY,\n            },\n          ],\n          transformMatrix = fabric.util.calcDimensionsMatrix({\n            scaleX: this.scaleX,\n            scaleY: this.scaleY,\n            skewX: skewX,\n            skewY: skewY,\n          }),\n          bbox = fabric.util.makeBoundingBoxFromPoints(points, transformMatrix);\n        return this._finalizeDimensions(bbox.width, bbox.height);\n      },\n\n      /*\n       * Calculate object bounding box dimensions from its properties scale, skew.\n       * @param Number width width of the bbox\n       * @param Number height height of the bbox\n       * @private\n       * @return {Object} .x finalized width dimension\n       * @return {Object} .y finalized height dimension\n       */\n      _finalizeDimensions: function (width, height) {\n        return this.strokeUniform\n          ? { x: width + this.strokeWidth, y: height + this.strokeWidth }\n          : { x: width, y: height };\n      },\n      /*\n       * Calculate object dimensions for controls, including padding and canvas zoom.\n       * private\n       */\n      _calculateCurrentDimensions: function () {\n        var vpt = this.getViewportTransform(),\n          dim = this._getTransformedDimensions(),\n          p = fabric.util.transformPoint(dim, vpt, true);\n\n        return p.scalarAdd(2 * this.padding);\n      },\n    }\n  );\n})();\nfabric.util.object.extend(\n  fabric.Object.prototype,\n  /** @lends fabric.Object.prototype */ {\n    /**\n     * Moves an object to the bottom of the stack of drawn objects\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    sendToBack: function () {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.sendToBack.call(this.group, this);\n      } else if (this.canvas) {\n        this.canvas.sendToBack(this);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object to the top of the stack of drawn objects\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    bringToFront: function () {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.bringToFront.call(this.group, this);\n      } else if (this.canvas) {\n        this.canvas.bringToFront(this);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object down in stack of drawn objects\n     * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    sendBackwards: function (intersecting) {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.sendBackwards.call(\n          this.group,\n          this,\n          intersecting\n        );\n      } else if (this.canvas) {\n        this.canvas.sendBackwards(this, intersecting);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object up in stack of drawn objects\n     * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    bringForward: function (intersecting) {\n      if (this.group) {\n        fabric.StaticCanvas.prototype.bringForward.call(\n          this.group,\n          this,\n          intersecting\n        );\n      } else if (this.canvas) {\n        this.canvas.bringForward(this, intersecting);\n      }\n      return this;\n    },\n\n    /**\n     * Moves an object to specified level in stack of drawn objects\n     * @param {Number} index New position of object\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    moveTo: function (index) {\n      if (this.group && this.group.type !== 'activeSelection') {\n        fabric.StaticCanvas.prototype.moveTo.call(this.group, this, index);\n      } else if (this.canvas) {\n        this.canvas.moveTo(this, index);\n      }\n      return this;\n    },\n  }\n);\n/* _TO_SVG_START_ */\n(function () {\n  function getSvgColorString(prop, value) {\n    if (!value) {\n      return prop + ': none; ';\n    } else if (value.toLive) {\n      return prop + ': url(#SVGID_' + value.id + '); ';\n    } else {\n      var color = new fabric.Color(value),\n        str = prop + ': ' + color.toRgb() + '; ',\n        opacity = color.getAlpha();\n      if (opacity !== 1) {\n        //change the color in rgb + opacity\n        str += prop + '-opacity: ' + opacity.toString() + '; ';\n      }\n      return str;\n    }\n  }\n\n  var toFixed = fabric.util.toFixed;\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Returns styles-string for svg-export\n       * @param {Boolean} skipShadow a boolean to skip shadow filter output\n       * @return {String}\n       */\n      getSvgStyles: function (skipShadow) {\n        var fillRule = this.fillRule ? this.fillRule : 'nonzero',\n          strokeWidth = this.strokeWidth ? this.strokeWidth : '0',\n          strokeDashArray = this.strokeDashArray\n            ? this.strokeDashArray.join(' ')\n            : 'none',\n          strokeDashOffset = this.strokeDashOffset\n            ? this.strokeDashOffset\n            : '0',\n          strokeLineCap = this.strokeLineCap ? this.strokeLineCap : 'butt',\n          strokeLineJoin = this.strokeLineJoin ? this.strokeLineJoin : 'miter',\n          strokeMiterLimit = this.strokeMiterLimit\n            ? this.strokeMiterLimit\n            : '4',\n          opacity = typeof this.opacity !== 'undefined' ? this.opacity : '1',\n          visibility = this.visible ? '' : ' visibility: hidden;',\n          filter = skipShadow ? '' : this.getSvgFilter(),\n          fill = getSvgColorString('fill', this.fill),\n          stroke = getSvgColorString('stroke', this.stroke);\n\n        return [\n          stroke,\n          'stroke-width: ',\n          strokeWidth,\n          '; ',\n          'stroke-dasharray: ',\n          strokeDashArray,\n          '; ',\n          'stroke-linecap: ',\n          strokeLineCap,\n          '; ',\n          'stroke-dashoffset: ',\n          strokeDashOffset,\n          '; ',\n          'stroke-linejoin: ',\n          strokeLineJoin,\n          '; ',\n          'stroke-miterlimit: ',\n          strokeMiterLimit,\n          '; ',\n          fill,\n          'fill-rule: ',\n          fillRule,\n          '; ',\n          'opacity: ',\n          opacity,\n          ';',\n          filter,\n          visibility,\n        ].join('');\n      },\n\n      /**\n       * Returns styles-string for svg-export\n       * @param {Object} style the object from which to retrieve style properties\n       * @param {Boolean} useWhiteSpace a boolean to include an additional attribute in the style.\n       * @return {String}\n       */\n      getSvgSpanStyles: function (style, useWhiteSpace) {\n        var term = '; ';\n        var fontFamily = style.fontFamily\n          ? 'font-family: ' +\n            (style.fontFamily.indexOf(\"'\") === -1 &&\n            style.fontFamily.indexOf('\"') === -1\n              ? \"'\" + style.fontFamily + \"'\"\n              : style.fontFamily) +\n            term\n          : '';\n        var strokeWidth = style.strokeWidth\n            ? 'stroke-width: ' + style.strokeWidth + term\n            : '',\n          // fontFamily = fontFamily,\n          fontSize = style.fontSize\n            ? 'font-size: ' + style.fontSize + 'px' + term\n            : '',\n          fontStyle = style.fontStyle\n            ? 'font-style: ' + style.fontStyle + term\n            : '',\n          fontWeight = style.fontWeight\n            ? 'font-weight: ' + style.fontWeight + term\n            : '',\n          fill = style.fill ? getSvgColorString('fill', style.fill) : '',\n          stroke = style.stroke\n            ? getSvgColorString('stroke', style.stroke)\n            : '',\n          textDecoration = this.getSvgTextDecoration(style),\n          deltaY = style.deltaY\n            ? 'baseline-shift: ' + -style.deltaY + '; '\n            : '';\n        if (textDecoration) {\n          textDecoration = 'text-decoration: ' + textDecoration + term;\n        }\n\n        return [\n          stroke,\n          strokeWidth,\n          fontFamily,\n          fontSize,\n          fontStyle,\n          fontWeight,\n          textDecoration,\n          fill,\n          deltaY,\n          useWhiteSpace ? 'white-space: pre; ' : '',\n        ].join('');\n      },\n\n      /**\n       * Returns text-decoration property for svg-export\n       * @param {Object} style the object from which to retrieve style properties\n       * @return {String}\n       */\n      getSvgTextDecoration: function (style) {\n        return ['overline', 'underline', 'line-through']\n          .filter(function (decoration) {\n            return style[decoration.replace('-', '')];\n          })\n          .join(' ');\n      },\n\n      /**\n       * Returns filter for svg shadow\n       * @return {String}\n       */\n      getSvgFilter: function () {\n        return this.shadow ? 'filter: url(#SVGID_' + this.shadow.id + ');' : '';\n      },\n\n      /**\n       * Returns id attribute for svg output\n       * @return {String}\n       */\n      getSvgCommons: function () {\n        return [\n          this.id ? 'id=\"' + this.id + '\" ' : '',\n          this.clipPath\n            ? 'clip-path=\"url(#' + this.clipPath.clipPathId + ')\" '\n            : '',\n        ].join('');\n      },\n\n      /**\n       * Returns transform-string for svg-export\n       * @param {Boolean} use the full transform or the single object one.\n       * @return {String}\n       */\n      getSvgTransform: function (full, additionalTransform) {\n        var transform = full\n            ? this.calcTransformMatrix()\n            : this.calcOwnMatrix(),\n          svgTransform = 'transform=\"' + fabric.util.matrixToSVG(transform);\n        return (\n          svgTransform +\n          (additionalTransform || '') +\n          this.getSvgTransformMatrix() +\n          '\" '\n        );\n      },\n\n      /**\n       * Returns transform-string for svg-export from the transform matrix of single elements\n       * @return {String}\n       */\n      getSvgTransformMatrix: function () {\n        return this.transformMatrix\n          ? ' ' + fabric.util.matrixToSVG(this.transformMatrix)\n          : '';\n      },\n\n      _setSVGBg: function (textBgRects) {\n        if (this.backgroundColor) {\n          var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n          textBgRects.push(\n            '\\t\\t<rect ',\n            this._getFillAttributes(this.backgroundColor),\n            ' x=\"',\n            toFixed(-this.width / 2, NUM_FRACTION_DIGITS),\n            '\" y=\"',\n            toFixed(-this.height / 2, NUM_FRACTION_DIGITS),\n            '\" width=\"',\n            toFixed(this.width, NUM_FRACTION_DIGITS),\n            '\" height=\"',\n            toFixed(this.height, NUM_FRACTION_DIGITS),\n            '\"></rect>\\n'\n          );\n        }\n      },\n\n      /**\n       * Returns svg representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toSVG: function (reviver) {\n        return this._createBaseSVGMarkup(this._toSVG(reviver), {\n          reviver: reviver,\n        });\n      },\n\n      /**\n       * Returns svg clipPath representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toClipPathSVG: function (reviver) {\n        return (\n          '\\t' +\n          this._createBaseClipPathSVGMarkup(this._toSVG(reviver), {\n            reviver: reviver,\n          })\n        );\n      },\n\n      /**\n       * @private\n       */\n      _createBaseClipPathSVGMarkup: function (objectMarkup, options) {\n        options = options || {};\n        var reviver = options.reviver,\n          additionalTransform = options.additionalTransform || '',\n          commonPieces = [\n            this.getSvgTransform(true, additionalTransform),\n            this.getSvgCommons(),\n          ].join(''),\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS');\n        objectMarkup[index] = commonPieces;\n        return reviver ? reviver(objectMarkup.join('')) : objectMarkup.join('');\n      },\n\n      /**\n       * @private\n       */\n      _createBaseSVGMarkup: function (objectMarkup, options) {\n        options = options || {};\n        var noStyle = options.noStyle,\n          reviver = options.reviver,\n          styleInfo = noStyle ? '' : 'style=\"' + this.getSvgStyles() + '\" ',\n          shadowInfo = options.withShadow\n            ? 'style=\"' + this.getSvgFilter() + '\" '\n            : '',\n          clipPath = this.clipPath,\n          vectorEffect = this.strokeUniform\n            ? 'vector-effect=\"non-scaling-stroke\" '\n            : '',\n          absoluteClipPath = clipPath && clipPath.absolutePositioned,\n          stroke = this.stroke,\n          fill = this.fill,\n          shadow = this.shadow,\n          commonPieces,\n          markup = [],\n          clipPathMarkup,\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS'),\n          additionalTransform = options.additionalTransform;\n        if (clipPath) {\n          clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n          clipPathMarkup =\n            '<clipPath id=\"' +\n            clipPath.clipPathId +\n            '\" >\\n' +\n            clipPath.toClipPathSVG(reviver) +\n            '</clipPath>\\n';\n        }\n        if (absoluteClipPath) {\n          markup.push('<g ', shadowInfo, this.getSvgCommons(), ' >\\n');\n        }\n        markup.push(\n          '<g ',\n          this.getSvgTransform(false),\n          !absoluteClipPath ? shadowInfo + this.getSvgCommons() : '',\n          ' >\\n'\n        );\n        commonPieces = [\n          styleInfo,\n          vectorEffect,\n          noStyle ? '' : this.addPaintOrder(),\n          ' ',\n          additionalTransform ? 'transform=\"' + additionalTransform + '\" ' : '',\n        ].join('');\n        objectMarkup[index] = commonPieces;\n        if (fill && fill.toLive) {\n          markup.push(fill.toSVG(this));\n        }\n        if (stroke && stroke.toLive) {\n          markup.push(stroke.toSVG(this));\n        }\n        if (shadow) {\n          markup.push(shadow.toSVG(this));\n        }\n        if (clipPath) {\n          markup.push(clipPathMarkup);\n        }\n        markup.push(objectMarkup.join(''));\n        markup.push('</g>\\n');\n        absoluteClipPath && markup.push('</g>\\n');\n        return reviver ? reviver(markup.join('')) : markup.join('');\n      },\n\n      addPaintOrder: function () {\n        return this.paintFirst !== 'fill'\n          ? ' paint-order=\"' + this.paintFirst + '\" '\n          : '';\n      },\n    }\n  );\n})();\n/* _TO_SVG_END_ */\n(function () {\n  var extend = fabric.util.object.extend,\n    originalSet = 'stateProperties';\n\n  /*\n    Depends on `stateProperties`\n  */\n  function saveProps(origin, destination, props) {\n    var tmpObj = {},\n      deep = true;\n    props.forEach(function (prop) {\n      tmpObj[prop] = origin[prop];\n    });\n    extend(origin[destination], tmpObj, deep);\n  }\n\n  function _isEqual(origValue, currentValue, firstPass) {\n    if (origValue === currentValue) {\n      // if the objects are identical, return\n      return true;\n    } else if (Array.isArray(origValue)) {\n      if (\n        !Array.isArray(currentValue) ||\n        origValue.length !== currentValue.length\n      ) {\n        return false;\n      }\n      for (let i = 0, len = origValue.length; i < len; i++) {\n        if (!_isEqual(origValue[i], currentValue[i])) {\n          return false;\n        }\n      }\n      return true;\n    } else if (origValue && typeof origValue === 'object') {\n      var keys = Object.keys(origValue),\n        key;\n      if (\n        !currentValue ||\n        typeof currentValue !== 'object' ||\n        (!firstPass && keys.length !== Object.keys(currentValue).length)\n      ) {\n        return false;\n      }\n      for (let i = 0, len = keys.length; i < len; i++) {\n        key = keys[i];\n        // since clipPath is in the statefull cache list and the clipPath objects\n        // would be iterated as an object, this would lead to possible infinite recursion\n        if (key === 'canvas') {\n          continue;\n        }\n        if (!_isEqual(origValue[key], currentValue[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  fabric.util.object.extend(\n    fabric.Object.prototype,\n    /** @lends fabric.Object.prototype */ {\n      /**\n       * Returns true if object state (one of its state properties) was changed\n       * @param {String} [propertySet] optional name for the set of property we want to save\n       * @return {Boolean} true if instance' state has changed since `{@link fabric.Object#saveState}` was called\n       */\n      hasStateChanged: function (propertySet) {\n        propertySet = propertySet || originalSet;\n        var dashedPropertySet = '_' + propertySet;\n        if (\n          Object.keys(this[dashedPropertySet]).length < this[propertySet].length\n        ) {\n          return true;\n        }\n        return !_isEqual(this[dashedPropertySet], this, true);\n      },\n\n      /**\n       * Saves state of an object\n       * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n       * @return {fabric.Object} thisArg\n       */\n      saveState: function (options) {\n        var propertySet = (options && options.propertySet) || originalSet,\n          destination = '_' + propertySet;\n        if (!this[destination]) {\n          return this.setupState(options);\n        }\n        saveProps(this, destination, this[propertySet]);\n        if (options && options.stateProperties) {\n          saveProps(this, destination, options.stateProperties);\n        }\n        return this;\n      },\n\n      /**\n       * Setups state of an object\n       * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n       * @return {fabric.Object} thisArg\n       */\n      setupState: function (options) {\n        options = options || {};\n        var propertySet = options.propertySet || originalSet;\n        options.propertySet = propertySet;\n        this['_' + propertySet] = {};\n        this.saveState(options);\n        return this;\n      },\n    }\n  );\n})();\n\nfabric.util.object.extend(\n  fabric.Object.prototype,\n  /** @lends fabric.Object.prototype */ {\n    /**\n     * Animates object's properties\n     * @param {String|Object} property Property to animate (if string) or properties to animate (if object)\n     * @param {Number|Object} value Value to animate property to (if string was given first) or options object\n     * @return {fabric.Object} thisArg\n     * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#animation}\n     * @chainable\n     *\n     * As object — multiple properties\n     *\n     * object.animate({ left: ..., top: ... });\n     * object.animate({ left: ..., top: ... }, { duration: ... });\n     *\n     * As string — one property\n     *\n     * object.animate('left', ...);\n     * object.animate('left', { duration: ... });\n     *\n     */\n    animate: function () {\n      if (arguments[0] && typeof arguments[0] === 'object') {\n        var propsToAnimate = [],\n          prop,\n          skipCallbacks;\n        for (prop in arguments[0]) {\n          propsToAnimate.push(prop);\n        }\n        for (var i = 0, len = propsToAnimate.length; i < len; i++) {\n          prop = propsToAnimate[i];\n          skipCallbacks = i !== len - 1;\n          this._animate(prop, arguments[0][prop], arguments[1], skipCallbacks);\n        }\n      } else {\n        this._animate.apply(this, arguments);\n      }\n      return this;\n    },\n\n    /**\n     * @private\n     * @param {String} property Property to animate\n     * @param {String} to Value to animate to\n     * @param {Object} [options] Options object\n     * @param {Boolean} [skipCallbacks] When true, callbacks like onchange and oncomplete are not invoked\n     */\n    _animate: function (property, to, options, skipCallbacks) {\n      var _this = this,\n        propPair;\n\n      to = to.toString();\n\n      if (!options) {\n        options = {};\n      } else {\n        options = fabric.util.object.clone(options);\n      }\n\n      if (~property.indexOf('.')) {\n        propPair = property.split('.');\n      }\n\n      var currentValue = propPair\n        ? this.get(propPair[0])[propPair[1]]\n        : this.get(property);\n\n      if (!('from' in options)) {\n        options.from = currentValue;\n      }\n\n      if (~to.indexOf('=')) {\n        to = currentValue + parseFloat(to.replace('=', ''));\n      } else {\n        to = parseFloat(to);\n      }\n\n      fabric.util.animate({\n        startValue: options.from,\n        endValue: to,\n        byValue: options.by,\n        easing: options.easing,\n        duration: options.duration,\n        abort:\n          options.abort &&\n          function () {\n            return options.abort.call(_this);\n          },\n        onChange: function (value, valueProgress, timeProgress) {\n          if (propPair) {\n            _this[propPair[0]][propPair[1]] = value;\n          } else {\n            _this.set(property, value);\n          }\n          if (skipCallbacks) {\n            return;\n          }\n          options.onChange &&\n            options.onChange(value, valueProgress, timeProgress);\n        },\n        onComplete: function (value, valueProgress, timeProgress) {\n          if (skipCallbacks) {\n            return;\n          }\n\n          _this.setCoords();\n          options.onComplete &&\n            options.onComplete(value, valueProgress, timeProgress);\n        },\n      });\n    },\n  }\n);\n(function initGroup(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    min = fabric.util.array.min,\n    max = fabric.util.array.max;\n\n  if (fabric.Group) {\n    return;\n  }\n\n  /**\n   * Group class\n   * @class fabric.Group\n   * @extends fabric.Object\n   * @mixes fabric.Collection\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#groups}\n   * @see {@link fabric.Group#initialize} for constructor definition\n   */\n  fabric.Group = fabric.util.createClass(\n    fabric.Object,\n    fabric.Collection,\n    /** @lends fabric.Group.prototype */ {\n      /**\n       * Type of an object\n       * @type String\n       * @default\n       */\n      type: 'group',\n\n      /**\n       * Width of stroke\n       * @type Number\n       * @default\n       */\n      strokeWidth: 0,\n\n      /**\n       * Indicates if click, mouseover, mouseout events & hoverCursor should also check for subtargets\n       * @type Boolean\n       * @default\n       */\n      subTargetCheck: false,\n\n      /**\n       * Groups are container, do not render anything on theyr own, ence no cache properties\n       * @type Array\n       * @default\n       */\n      cacheProperties: [],\n\n      /**\n       * setOnGroup is a method used for TextBox that is no more used since 2.0.0 The behavior is still\n       * available setting this boolean to true.\n       * @type Boolean\n       * @since 2.0.0\n       * @default\n       */\n      useSetOnGroup: false,\n\n      /**\n       * Constructor\n       * @param {Object} objects Group objects\n       * @param {Object} [options] Options object\n       * @param {Boolean} [isAlreadyGrouped] if true, objects have been grouped already.\n       * @return {Object} thisArg\n       */\n      initialize: function (objects, options, isAlreadyGrouped) {\n        options = options || {};\n        this._objects = [];\n        // if objects enclosed in a group have been grouped already,\n        // we cannot change properties of objects.\n        // Thus we need to set options to group without objects,\n        isAlreadyGrouped && this.callSuper('initialize', options);\n        this._objects = objects || [];\n        for (var i = this._objects.length; i--; ) {\n          this._objects[i].group = this;\n        }\n\n        if (!isAlreadyGrouped) {\n          var center = options && options.centerPoint;\n          // we want to set origins before calculating the bounding box.\n          // so that the topleft can be set with that in mind.\n          // if specific top and left are passed, are overwritten later\n          // with the callSuper('initialize', options)\n          if (options.originX !== undefined) {\n            this.originX = options.originX;\n          }\n          if (options.originY !== undefined) {\n            this.originY = options.originY;\n          }\n          // if coming from svg i do not want to calc bounds.\n          // i assume width and height are passed along options\n          center || this._calcBounds();\n          this._updateObjectsCoords(center);\n          delete options.centerPoint;\n          this.callSuper('initialize', options);\n        } else {\n          this._updateObjectsACoords();\n        }\n\n        this.setCoords();\n      },\n\n      /**\n       * @private\n       * @param {Boolean} [skipCoordsChange] if true, coordinates of objects enclosed in a group do not change\n       */\n      _updateObjectsACoords: function () {\n        var ignoreZoom = true,\n          skipAbsolute = true;\n        for (var i = this._objects.length; i--; ) {\n          this._objects[i].setCoords(ignoreZoom, skipAbsolute);\n        }\n      },\n\n      /**\n       * @private\n       * @param {Boolean} [skipCoordsChange] if true, coordinates of objects enclosed in a group do not change\n       */\n      _updateObjectsCoords: function (center) {\n        var actualCenter = center || this.getCenterPoint();\n        for (var i = this._objects.length; i--; ) {\n          this._updateObjectCoords(this._objects[i], actualCenter);\n        }\n      },\n\n      /**\n       * @private\n       * @param {Object} object\n       * @param {fabric.Point} center, current center of group.\n       */\n      _updateObjectCoords: function (object, center) {\n        var objectLeft = object.left,\n          objectTop = object.top,\n          ignoreZoom = true,\n          skipAbsolute = true;\n\n        object.set({\n          left: objectLeft - center.x,\n          top: objectTop - center.y,\n        });\n        object.group = this;\n        object.setCoords(ignoreZoom, skipAbsolute);\n      },\n\n      /**\n       * Returns string represenation of a group\n       * @return {String}\n       */\n      toString: function () {\n        return '#<fabric.Group: (' + this.complexity() + ')>';\n      },\n\n      /**\n       * Adds an object to a group; Then recalculates group's dimension, position.\n       * @param {Object} object\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      addWithUpdate: function (object) {\n        this._restoreObjectsState();\n        fabric.util.resetObjectTransform(this);\n        if (object) {\n          this._objects.push(object);\n          object.group = this;\n          object._set('canvas', this.canvas);\n        }\n        this._calcBounds();\n        this._updateObjectsCoords();\n        this.setCoords();\n        this.dirty = true;\n        return this;\n      },\n\n      /**\n       * Removes an object from a group; Then recalculates group's dimension, position.\n       * @param {Object} object\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      removeWithUpdate: function (object) {\n        this._restoreObjectsState();\n        fabric.util.resetObjectTransform(this);\n\n        this.remove(object);\n        this._calcBounds();\n        this._updateObjectsCoords();\n        this.setCoords();\n        this.dirty = true;\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _onObjectAdded: function (object) {\n        this.dirty = true;\n        object.group = this;\n        object._set('canvas', this.canvas);\n      },\n\n      /**\n       * @private\n       */\n      _onObjectRemoved: function (object) {\n        this.dirty = true;\n        delete object.group;\n      },\n\n      /**\n       * @private\n       */\n      _set: function (key, value) {\n        var i = this._objects.length;\n        if (this.useSetOnGroup) {\n          while (i--) {\n            this._objects[i].setOnGroup(key, value);\n          }\n        }\n        if (key === 'canvas') {\n          while (i--) {\n            this._objects[i]._set(key, value);\n          }\n        }\n        fabric.Object.prototype._set.call(this, key, value);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var _includeDefaultValues = this.includeDefaultValues;\n        var objsToObject = this._objects.map(function (obj) {\n          var originalDefaults = obj.includeDefaultValues;\n          obj.includeDefaultValues = _includeDefaultValues;\n          var _obj = obj.toObject(propertiesToInclude);\n          obj.includeDefaultValues = originalDefaults;\n          return _obj;\n        });\n        var obj = fabric.Object.prototype.toObject.call(\n          this,\n          propertiesToInclude\n        );\n        obj.objects = objsToObject;\n        return obj;\n      },\n\n      /**\n       * Returns object representation of an instance, in dataless mode.\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} object representation of an instance\n       */\n      toDatalessObject: function (propertiesToInclude) {\n        var objsToObject,\n          sourcePath = this.sourcePath;\n        if (sourcePath) {\n          objsToObject = sourcePath;\n        } else {\n          var _includeDefaultValues = this.includeDefaultValues;\n          objsToObject = this._objects.map(function (obj) {\n            var originalDefaults = obj.includeDefaultValues;\n            obj.includeDefaultValues = _includeDefaultValues;\n            var _obj = obj.toDatalessObject(propertiesToInclude);\n            obj.includeDefaultValues = originalDefaults;\n            return _obj;\n          });\n        }\n        var obj = fabric.Object.prototype.toDatalessObject.call(\n          this,\n          propertiesToInclude\n        );\n        obj.objects = objsToObject;\n        return obj;\n      },\n\n      /**\n       * Renders instance on a given context\n       * @param {CanvasRenderingContext2D} ctx context to render instance on\n       */\n      render: function (ctx) {\n        this._transformDone = true;\n        this.callSuper('render', ctx);\n        this._transformDone = false;\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group is already cached.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        var ownCache = fabric.Object.prototype.shouldCache.call(this);\n        if (ownCache) {\n          for (var i = 0, len = this._objects.length; i < len; i++) {\n            if (this._objects[i].willDrawShadow()) {\n              this.ownCaching = false;\n              return false;\n            }\n          }\n        }\n        return ownCache;\n      },\n\n      /**\n       * Check if this object or a child object will cast a shadow\n       * @return {Boolean}\n       */\n      willDrawShadow: function () {\n        if (fabric.Object.prototype.willDrawShadow.call(this)) {\n          return true;\n        }\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          if (this._objects[i].willDrawShadow()) {\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Check if this group or its parent group are caching, recursively up\n       * @return {Boolean}\n       */\n      isOnACache: function () {\n        return this.ownCaching || (this.group && this.group.isOnACache());\n      },\n\n      /**\n       * Execute the drawing operation for an object on a specified context\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      drawObject: function (ctx) {\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          this._objects[i].render(ctx);\n        }\n        this._drawClipPath(ctx);\n      },\n\n      /**\n       * Check if cache is dirty\n       */\n      isCacheDirty: function (skipCanvas) {\n        if (this.callSuper('isCacheDirty', skipCanvas)) {\n          return true;\n        }\n        if (!this.statefullCache) {\n          return false;\n        }\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          if (this._objects[i].isCacheDirty(true)) {\n            if (this._cacheCanvas) {\n              // if this group has not a cache canvas there is nothing to clean\n              var x = this.cacheWidth / this.zoomX,\n                y = this.cacheHeight / this.zoomY;\n              this._cacheContext.clearRect(-x / 2, -y / 2, x, y);\n            }\n            return true;\n          }\n        }\n        return false;\n      },\n\n      /**\n       * Retores original state of each of group objects (original state is that which was before group was created).\n       * @private\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      _restoreObjectsState: function () {\n        this._objects.forEach(this._restoreObjectState, this);\n        return this;\n      },\n\n      /**\n       * Realises the transform from this group onto the supplied object\n       * i.e. it tells you what would happen if the supplied object was in\n       * the group, and then the group was destroyed. It mutates the supplied\n       * object.\n       * @param {fabric.Object} object\n       * @return {fabric.Object} transformedObject\n       */\n      realizeTransform: function (object) {\n        var matrix = object.calcTransformMatrix(),\n          options = fabric.util.qrDecompose(matrix),\n          center = new fabric.Point(options.translateX, options.translateY);\n        object.flipX = false;\n        object.flipY = false;\n        object.set('scaleX', options.scaleX);\n        object.set('scaleY', options.scaleY);\n        object.skewX = options.skewX;\n        object.skewY = options.skewY;\n        object.angle = options.angle;\n        object.setPositionByOrigin(center, 'center', 'center');\n        return object;\n      },\n\n      /**\n       * Restores original state of a specified object in group\n       * @private\n       * @param {fabric.Object} object\n       * @return {fabric.Group} thisArg\n       */\n      _restoreObjectState: function (object) {\n        this.realizeTransform(object);\n        object.setCoords();\n        delete object.group;\n        return this;\n      },\n\n      /**\n       * Destroys a group (restoring state of its objects)\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      destroy: function () {\n        // when group is destroyed objects needs to get a repaint to be eventually\n        // displayed on canvas.\n        this._objects.forEach(function (object) {\n          object.set('dirty', true);\n        });\n        return this._restoreObjectsState();\n      },\n\n      /**\n       * make a group an active selection, remove the group from canvas\n       * the group has to be on canvas for this to work.\n       * @return {fabric.ActiveSelection} thisArg\n       * @chainable\n       */\n      toActiveSelection: function () {\n        if (!this.canvas) {\n          return;\n        }\n        var objects = this._objects,\n          canvas = this.canvas;\n        this._objects = [];\n        var options = this.toObject();\n        delete options.objects;\n        var activeSelection = new fabric.ActiveSelection([]);\n        activeSelection.set(options);\n        activeSelection.type = 'activeSelection';\n        canvas.remove(this);\n        objects.forEach(function (object) {\n          object.group = activeSelection;\n          object.dirty = true;\n          canvas.add(object);\n        });\n        activeSelection.canvas = canvas;\n        activeSelection._objects = objects;\n        canvas._activeObject = activeSelection;\n        activeSelection.setCoords();\n        return activeSelection;\n      },\n\n      /**\n       * Destroys a group (restoring state of its objects)\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      ungroupOnCanvas: function () {\n        return this._restoreObjectsState();\n      },\n\n      /**\n       * Sets coordinates of all objects inside group\n       * @return {fabric.Group} thisArg\n       * @chainable\n       */\n      setObjectsCoords: function () {\n        var ignoreZoom = true,\n          skipAbsolute = true;\n        this.forEachObject(function (object) {\n          object.setCoords(ignoreZoom, skipAbsolute);\n        });\n        return this;\n      },\n\n      /**\n       * @private\n       */\n      _calcBounds: function (onlyWidthHeight) {\n        var aX = [],\n          aY = [],\n          o,\n          prop,\n          props = ['tr', 'br', 'bl', 'tl'],\n          i = 0,\n          iLen = this._objects.length,\n          j,\n          jLen = props.length,\n          ignoreZoom = true;\n\n        for (; i < iLen; ++i) {\n          o = this._objects[i];\n          o.setCoords(ignoreZoom);\n          for (j = 0; j < jLen; j++) {\n            prop = props[j];\n            aX.push(o.oCoords[prop].x);\n            aY.push(o.oCoords[prop].y);\n          }\n        }\n\n        this._getBounds(aX, aY, onlyWidthHeight);\n      },\n\n      /**\n       * @private\n       */\n      _getBounds: function (aX, aY, onlyWidthHeight) {\n        var minXY = new fabric.Point(min(aX), min(aY)),\n          maxXY = new fabric.Point(max(aX), max(aY)),\n          top = minXY.y || 0,\n          left = minXY.x || 0,\n          width = maxXY.x - minXY.x || 0,\n          height = maxXY.y - minXY.y || 0;\n        this.width = width;\n        this.height = height;\n        if (!onlyWidthHeight) {\n          // the bounding box always finds the topleft most corner.\n          // whatever is the group origin, we set up here the left/top position.\n          this.setPositionByOrigin({ x: left, y: top }, 'left', 'top');\n        }\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * Returns svg representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      _toSVG: function (reviver) {\n        var svgString = ['<g ', 'COMMON_PARTS', ' >\\n'];\n\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          svgString.push('\\t\\t', this._objects[i].toSVG(reviver));\n        }\n        svgString.push('</g>\\n');\n        return svgString;\n      },\n\n      /**\n       * Returns styles-string for svg-export, specific version for group\n       * @return {String}\n       */\n      getSvgStyles: function () {\n        var opacity =\n            typeof this.opacity !== 'undefined' && this.opacity !== 1\n              ? 'opacity: ' + this.opacity + ';'\n              : '',\n          visibility = this.visible ? '' : ' visibility: hidden;';\n        return [opacity, this.getSvgFilter(), visibility].join('');\n      },\n\n      /**\n       * Returns svg clipPath representation of an instance\n       * @param {Function} [reviver] Method for further parsing of svg representation.\n       * @return {String} svg representation of an instance\n       */\n      toClipPathSVG: function (reviver) {\n        var svgString = [];\n\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          svgString.push('\\t', this._objects[i].toClipPathSVG(reviver));\n        }\n\n        return this._createBaseClipPathSVGMarkup(svgString, {\n          reviver: reviver,\n        });\n      },\n      /* _TO_SVG_END_ */\n    }\n  );\n\n  /**\n   * Returns {@link fabric.Group} instance from an object representation\n   * @static\n   * @memberOf fabric.Group\n   * @param {Object} object Object to create a group from\n   * @param {Function} [callback] Callback to invoke when an group instance is created\n   */\n  fabric.Group.fromObject = function (object, callback) {\n    var objects = object.objects,\n      options = fabric.util.object.clone(object, true);\n    delete options.objects;\n    if (typeof objects === 'string') {\n      // it has to be an url or something went wrong.\n      fabric.loadSVGFromURL(objects, function (elements) {\n        var group = fabric.util.groupSVGElements(elements, object, objects);\n        group.set(options);\n        callback && callback(group);\n      });\n      return;\n    }\n    fabric.util.enlivenObjects(objects, function (enlivenedObjects) {\n      fabric.util.enlivenObjects([object.clipPath], function (enlivedClipPath) {\n        var options = fabric.util.object.clone(object, true);\n        options.clipPath = enlivedClipPath[0];\n        delete options.objects;\n        callback && callback(new fabric.Group(enlivenedObjects, options, true));\n      });\n    });\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initImageClass(global) {\n  var extend = fabric.util.object.extend;\n\n  if (!global.fabric) {\n    global.fabric = {};\n  }\n\n  if (global.fabric.Image) {\n    fabric.warn('fabric.Image is already defined.');\n    return;\n  }\n\n  /**\n   * Image class\n   * @class fabric.Image\n   * @extends fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#images}\n   * @see {@link fabric.Image#initialize} for constructor definition\n   */\n  fabric.Image = fabric.util.createClass(\n    fabric.Object,\n    /** @lends fabric.Image.prototype */ {\n      /**\n       * Type of an object\n       * @type String\n       * @default\n       */\n      type: 'image',\n\n      /**\n       * crossOrigin value (one of \"\", \"anonymous\", \"use-credentials\")\n       * @see https://developer.mozilla.org/en-US/docs/HTML/CORS_settings_attributes\n       * @type String\n       * @default\n       */\n      crossOrigin: '',\n\n      /**\n       * Width of a stroke.\n       * For image quality a stroke multiple of 2 gives better results.\n       * @type Number\n       * @default\n       */\n      strokeWidth: 0,\n\n      /**\n       * When calling {@link fabric.Image.getSrc}, return value from element src with `element.getAttribute('src')`.\n       * This allows for relative urls as image src.\n       * @since 2.7.0\n       * @type Boolean\n       * @default\n       */\n      srcFromAttribute: false,\n\n      /**\n       * private\n       * contains last value of scaleX to detect\n       * if the Image got resized after the last Render\n       * @type Number\n       */\n      _lastScaleX: 1,\n\n      /**\n       * private\n       * contains last value of scaleY to detect\n       * if the Image got resized after the last Render\n       * @type Number\n       */\n      _lastScaleY: 1,\n\n      /**\n       * private\n       * contains last value of scaling applied by the apply filter chain\n       * @type Number\n       */\n      _filterScalingX: 1,\n\n      /**\n       * private\n       * contains last value of scaling applied by the apply filter chain\n       * @type Number\n       */\n      _filterScalingY: 1,\n\n      /**\n       * minimum scale factor under which any resizeFilter is triggered to resize the image\n       * 0 will disable the automatic resize. 1 will trigger automatically always.\n       * number bigger than 1 are not implemented yet.\n       * @type Number\n       */\n      minimumScaleTrigger: 0.5,\n\n      /**\n       * List of properties to consider when checking if\n       * state of an object is changed ({@link fabric.Object#hasStateChanged})\n       * as well as for history (undo/redo) purposes\n       * @type Array\n       */\n      stateProperties: fabric.Object.prototype.stateProperties.concat(\n        'cropX',\n        'cropY'\n      ),\n\n      /**\n       * key used to retrieve the texture representing this image\n       * @since 2.0.0\n       * @type String\n       * @default\n       */\n      cacheKey: '',\n\n      /**\n       * Image crop in pixels from original image size.\n       * @since 2.0.0\n       * @type Number\n       * @default\n       */\n      cropX: 0,\n\n      /**\n       * Image crop in pixels from original image size.\n       * @since 2.0.0\n       * @type Number\n       * @default\n       */\n      cropY: 0,\n\n      /**\n       * Constructor\n       * @param {HTMLImageElement | String} element Image element\n       * @param {Object} [options] Options object\n       * @param {function} [callback] callback function to call after eventual filters applied.\n       * @return {fabric.Image} thisArg\n       */\n      initialize: function (element, options) {\n        options || (options = {});\n        this.filters = [];\n        this.cacheKey = 'texture' + fabric.Object.__uid++;\n        this.callSuper('initialize', options);\n        this._initElement(element, options);\n      },\n\n      /**\n       * Returns image element which this instance if based on\n       * @return {HTMLImageElement} Image element\n       */\n      getElement: function () {\n        return this._element || {};\n      },\n\n      /**\n       * Sets image element for this instance to a specified one.\n       * If filters defined they are applied to new image.\n       * You might need to call `canvas.renderAll` and `object.setCoords` after replacing, to render new image and update controls area.\n       * @param {HTMLImageElement} element\n       * @param {Object} [options] Options object\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setElement: function (element, options) {\n        this.removeTexture(this.cacheKey);\n        this.removeTexture(this.cacheKey + '_filtered');\n        this._element = element;\n        this._originalElement = element;\n        this._initConfig(options);\n        if (this.filters.length !== 0) {\n          this.applyFilters();\n        }\n        // resizeFilters work on the already filtered copy.\n        // we need to apply resizeFilters AFTER normal filters.\n        // applyResizeFilters is run more often than normal fiters\n        // and is triggered by user interactions rather than dev code\n        if (this.resizeFilter) {\n          this.applyResizeFilters();\n        }\n        return this;\n      },\n\n      /**\n       * Delete a single texture if in webgl mode\n       */\n      removeTexture: function (key) {\n        var backend = fabric.filterBackend;\n        if (backend && backend.evictCachesForKey) {\n          backend.evictCachesForKey(key);\n        }\n      },\n\n      /**\n       * Delete textures, reference to elements and eventually JSDOM cleanup\n       */\n      dispose: function () {\n        this.removeTexture(this.cacheKey);\n        this.removeTexture(this.cacheKey + '_filtered');\n        this._cacheContext = undefined;\n        ['_originalElement', '_element', '_filteredEl', '_cacheCanvas'].forEach(\n          function (element) {\n            fabric.util.cleanUpJsdomNode(this[element]);\n            this[element] = undefined;\n          }.bind(this)\n        );\n      },\n\n      /**\n       * Sets crossOrigin value (on an instance and corresponding image element)\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setCrossOrigin: function (value) {\n        this.crossOrigin = value;\n        this._element.crossOrigin = value;\n\n        return this;\n      },\n\n      /**\n       * Returns original size of an image\n       * @return {Object} Object with \"width\" and \"height\" properties\n       */\n      getOriginalSize: function () {\n        var element = this.getElement();\n        return {\n          width: element.naturalWidth || element.width,\n          height: element.naturalHeight || element.height,\n        };\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _stroke: function (ctx) {\n        if (!this.stroke || this.strokeWidth === 0) {\n          return;\n        }\n        var w = this.width / 2,\n          h = this.height / 2;\n        ctx.beginPath();\n        ctx.moveTo(-w, -h);\n        ctx.lineTo(w, -h);\n        ctx.lineTo(w, h);\n        ctx.lineTo(-w, h);\n        ctx.lineTo(-w, -h);\n        ctx.closePath();\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _renderDashedStroke: function (ctx) {\n        var x = -this.width / 2,\n          y = -this.height / 2,\n          w = this.width,\n          h = this.height;\n\n        ctx.save();\n        this._setStrokeStyles(ctx, this);\n\n        ctx.beginPath();\n        fabric.util.drawDashedLine(ctx, x, y, x + w, y, this.strokeDashArray);\n        fabric.util.drawDashedLine(\n          ctx,\n          x + w,\n          y,\n          x + w,\n          y + h,\n          this.strokeDashArray\n        );\n        fabric.util.drawDashedLine(\n          ctx,\n          x + w,\n          y + h,\n          x,\n          y + h,\n          this.strokeDashArray\n        );\n        fabric.util.drawDashedLine(ctx, x, y + h, x, y, this.strokeDashArray);\n        ctx.closePath();\n        ctx.restore();\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function (propertiesToInclude) {\n        var filters = [];\n\n        this.filters.forEach(function (filterObj) {\n          if (filterObj) {\n            filters.push(filterObj.toObject());\n          }\n        });\n        var object = extend(\n          this.callSuper(\n            'toObject',\n            ['crossOrigin', 'cropX', 'cropY'].concat(propertiesToInclude)\n          ),\n          {\n            src: this.getSrc(),\n            filters: filters,\n          }\n        );\n        if (this.resizeFilter) {\n          object.resizeFilter = this.resizeFilter.toObject();\n        }\n        return object;\n      },\n\n      /**\n       * Returns true if an image has crop applied, inspecting values of cropX,cropY,width,hight.\n       * @return {Boolean}\n       */\n      hasCrop: function () {\n        return (\n          this.cropX ||\n          this.cropY ||\n          this.width < this._element.width ||\n          this.height < this._element.height\n        );\n      },\n\n      /* _TO_SVG_START_ */\n      /**\n       * Returns svg representation of an instance\n       * @return {Array} an array of strings with the specific svg representation\n       * of the instance\n       */\n      _toSVG: function () {\n        var svgString = [],\n          imageMarkup = [],\n          strokeSvg,\n          x = -this.width / 2,\n          y = -this.height / 2,\n          clipPath = '';\n        if (this.hasCrop()) {\n          var clipPathId = fabric.Object.__uid++;\n          svgString.push(\n            '<clipPath id=\"imageCrop_' + clipPathId + '\">\\n',\n            '\\t<rect x=\"' +\n              x +\n              '\" y=\"' +\n              y +\n              '\" width=\"' +\n              this.width +\n              '\" height=\"' +\n              this.height +\n              '\" />\\n',\n            '</clipPath>\\n'\n          );\n          clipPath = ' clip-path=\"url(#imageCrop_' + clipPathId + ')\" ';\n        }\n        imageMarkup.push(\n          '\\t<image ',\n          'COMMON_PARTS',\n          'xlink:href=\"',\n          this.getSvgSrc(true),\n          '\" x=\"',\n          x - this.cropX,\n          '\" y=\"',\n          y - this.cropY,\n          // we're essentially moving origin of transformation from top/left corner to the center of the shape\n          // by wrapping it in container <g> element with actual transformation, then offsetting object to the top/left\n          // so that object's center aligns with container's left/top\n          '\" width=\"',\n          this._element.width || this._element.naturalWidth,\n          '\" height=\"',\n          this._element.height || this._element.height,\n          '\"',\n          clipPath,\n          '></image>\\n'\n        );\n\n        if (this.stroke || this.strokeDashArray) {\n          var origFill = this.fill;\n          this.fill = null;\n          strokeSvg = [\n            '\\t<rect ',\n            'x=\"',\n            x,\n            '\" y=\"',\n            y,\n            '\" width=\"',\n            this.width,\n            '\" height=\"',\n            this.height,\n            '\" style=\"',\n            this.getSvgStyles(),\n            '\"/>\\n',\n          ];\n          this.fill = origFill;\n        }\n        if (this.paintFirst !== 'fill') {\n          svgString = svgString.concat(strokeSvg, imageMarkup);\n        } else {\n          svgString = svgString.concat(imageMarkup, strokeSvg);\n        }\n        return svgString;\n      },\n      /* _TO_SVG_END_ */\n\n      /**\n       * Returns source of an image\n       * @param {Boolean} filtered indicates if the src is needed for svg\n       * @return {String} Source of an image\n       */\n      getSrc: function (filtered) {\n        var element = filtered ? this._element : this._originalElement;\n        if (element) {\n          if (element.toDataURL) {\n            return element.toDataURL();\n          }\n\n          if (this.srcFromAttribute) {\n            return element.getAttribute('src');\n          } else {\n            return element.src;\n          }\n        } else {\n          return this.src || '';\n        }\n      },\n\n      /**\n       * Sets source of an image\n       * @param {String} src Source string (URL)\n       * @param {Function} [callback] Callback is invoked when image has been loaded (and all filters have been applied)\n       * @param {Object} [options] Options object\n       * @return {fabric.Image} thisArg\n       * @chainable\n       */\n      setSrc: function (src, callback, options) {\n        fabric.util.loadImage(\n          src,\n          function (img) {\n            this.setElement(img, options);\n            this._setWidthHeight();\n            callback && callback(this);\n          },\n          this,\n          options && options.crossOrigin\n        );\n        return this;\n      },\n\n      /**\n       * Returns string representation of an instance\n       * @return {String} String representation of an instance\n       */\n      toString: function () {\n        return '#<fabric.Image: { src: \"' + this.getSrc() + '\" }>';\n      },\n\n      applyResizeFilters: function () {\n        var filter = this.resizeFilter,\n          minimumScale = this.minimumScaleTrigger,\n          objectScale = this.getTotalObjectScaling(),\n          scaleX = objectScale.scaleX,\n          scaleY = objectScale.scaleY,\n          elementToFilter = this._filteredEl || this._originalElement;\n        if (this.group) {\n          this.set('dirty', true);\n        }\n        if (!filter || (scaleX > minimumScale && scaleY > minimumScale)) {\n          this._element = elementToFilter;\n          this._filterScalingX = 1;\n          this._filterScalingY = 1;\n          this._lastScaleX = scaleX;\n          this._lastScaleY = scaleY;\n          return;\n        }\n        if (!fabric.filterBackend) {\n          fabric.filterBackend = fabric.initFilterBackend();\n        }\n        var canvasEl = fabric.util.createCanvasElement(),\n          cacheKey = this._filteredEl\n            ? this.cacheKey + '_filtered'\n            : this.cacheKey,\n          sourceWidth = elementToFilter.width,\n          sourceHeight = elementToFilter.height;\n        canvasEl.width = sourceWidth;\n        canvasEl.height = sourceHeight;\n        this._element = canvasEl;\n        this._lastScaleX = filter.scaleX = scaleX;\n        this._lastScaleY = filter.scaleY = scaleY;\n        fabric.filterBackend.applyFilters(\n          [filter],\n          elementToFilter,\n          sourceWidth,\n          sourceHeight,\n          this._element,\n          cacheKey\n        );\n        this._filterScalingX = canvasEl.width / this._originalElement.width;\n        this._filterScalingY = canvasEl.height / this._originalElement.height;\n      },\n\n      /**\n       * Applies filters assigned to this image (from \"filters\" array) or from filter param\n       * @method applyFilters\n       * @param {Array} filters to be applied\n       * @param {Boolean} forResizing specify if the filter operation is a resize operation\n       * @return {thisArg} return the fabric.Image object\n       * @chainable\n       */\n      applyFilters: function (filters) {\n        filters = filters || this.filters || [];\n        filters = filters.filter(function (filter) {\n          return filter && !filter.isNeutralState();\n        });\n        this.set('dirty', true);\n\n        // needs to clear out or WEBGL will not resize correctly\n        this.removeTexture(this.cacheKey + '_filtered');\n\n        if (filters.length === 0) {\n          this._element = this._originalElement;\n          this._filteredEl = null;\n          this._filterScalingX = 1;\n          this._filterScalingY = 1;\n          return this;\n        }\n\n        var imgElement = this._originalElement,\n          sourceWidth = imgElement.naturalWidth || imgElement.width,\n          sourceHeight = imgElement.naturalHeight || imgElement.height;\n\n        if (this._element === this._originalElement) {\n          // if the element is the same we need to create a new element\n          var canvasEl = fabric.util.createCanvasElement();\n          canvasEl.width = sourceWidth;\n          canvasEl.height = sourceHeight;\n          this._element = canvasEl;\n          this._filteredEl = canvasEl;\n        } else {\n          // clear the existing element to get new filter data\n          // also dereference the eventual resized _element\n          this._element = this._filteredEl;\n          this._filteredEl\n            .getContext('2d')\n            .clearRect(0, 0, sourceWidth, sourceHeight);\n          // we also need to resize again at next renderAll, so remove saved _lastScaleX/Y\n          this._lastScaleX = 1;\n          this._lastScaleY = 1;\n        }\n        if (!fabric.filterBackend) {\n          fabric.filterBackend = fabric.initFilterBackend();\n        }\n        fabric.filterBackend.applyFilters(\n          filters,\n          this._originalElement,\n          sourceWidth,\n          sourceHeight,\n          this._element,\n          this.cacheKey\n        );\n        if (\n          this._originalElement.width !== this._element.width ||\n          this._originalElement.height !== this._element.height\n        ) {\n          this._filterScalingX =\n            this._element.width / this._originalElement.width;\n          this._filterScalingY =\n            this._element.height / this._originalElement.height;\n        }\n        return this;\n      },\n\n      /**\n       * @private\n       * @param {CanvasRenderingContext2D} ctx Context to render on\n       */\n      _render: function (ctx) {\n        if (\n          this.isMoving !== true &&\n          this.resizeFilter &&\n          this._needsResize()\n        ) {\n          this.applyResizeFilters();\n        }\n        this._stroke(ctx);\n        this._renderPaintInOrder(ctx);\n      },\n\n      /**\n       * Decide if the object should cache or not. Create its own cache level\n       * needsItsOwnCache should be used when the object drawing method requires\n       * a cache step. None of the fabric classes requires it.\n       * Generally you do not cache objects in groups because the group outside is cached.\n       * This is the special image version where we would like to avoid caching where possible.\n       * Essentially images do not benefit from caching. They may require caching, and in that\n       * case we do it. Also caching an image usually ends in a loss of details.\n       * A full performance audit should be done.\n       * @return {Boolean}\n       */\n      shouldCache: function () {\n        return this.needsItsOwnCache();\n      },\n\n      _renderFill: function (ctx) {\n        var elementToDraw = this._element,\n          w = this.width,\n          h = this.height,\n          sW = Math.min(\n            elementToDraw.naturalWidth || elementToDraw.width,\n            w * this._filterScalingX\n          ),\n          sH = Math.min(\n            elementToDraw.naturalHeight || elementToDraw.height,\n            h * this._filterScalingY\n          ),\n          x = -w / 2,\n          y = -h / 2,\n          sX = Math.max(0, this.cropX * this._filterScalingX),\n          sY = Math.max(0, this.cropY * this._filterScalingY);\n\n        elementToDraw &&\n          ctx.drawImage(elementToDraw, sX, sY, sW, sH, x, y, w, h);\n      },\n\n      /**\n       * needed to check if image needs resize\n       * @private\n       */\n      _needsResize: function () {\n        var scale = this.getTotalObjectScaling();\n        return (\n          scale.scaleX !== this._lastScaleX || scale.scaleY !== this._lastScaleY\n        );\n      },\n\n      /**\n       * @private\n       */\n      _resetWidthHeight: function () {\n        this.set(this.getOriginalSize());\n      },\n\n      /**\n       * The Image class's initialization method. This method is automatically\n       * called by the constructor.\n       * @private\n       * @param {HTMLImageElement|String} element The element representing the image\n       * @param {Object} [options] Options object\n       */\n      _initElement: function (element, options) {\n        this.setElement(fabric.util.getById(element), options);\n        fabric.util.addClass(this.getElement(), fabric.Image.CSS_CANVAS);\n      },\n\n      /**\n       * @private\n       * @param {Object} [options] Options object\n       */\n      _initConfig: function (options) {\n        options || (options = {});\n        this.setOptions(options);\n        this._setWidthHeight(options);\n        if (this._element && this.crossOrigin) {\n          this._element.crossOrigin = this.crossOrigin;\n        }\n      },\n\n      /**\n       * @private\n       * @param {Array} filters to be initialized\n       * @param {Function} callback Callback to invoke when all fabric.Image.filters instances are created\n       */\n      _initFilters: function (filters, callback) {\n        if (filters && filters.length) {\n          fabric.util.enlivenObjects(\n            filters,\n            function (enlivenedObjects) {\n              callback && callback(enlivenedObjects);\n            },\n            'fabric.Image.filters'\n          );\n        } else {\n          callback && callback();\n        }\n      },\n\n      /**\n       * @private\n       * Set the width and the height of the image object, using the element or the\n       * options.\n       * @param {Object} [options] Object with width/height properties\n       */\n      _setWidthHeight: function (options) {\n        options || (options = {});\n        var el = this.getElement();\n        this.width = options.width || el.naturalWidth || el.width || 0;\n        this.height = options.height || el.naturalHeight || el.height || 0;\n      },\n\n      /**\n       * Calculate offset for center and scale factor for the image in order to respect\n       * the preserveAspectRatio attribute\n       * @private\n       * @return {Object}\n       */\n      parsePreserveAspectRatioAttribute: function () {\n        var pAR = fabric.util.parsePreserveAspectRatioAttribute(\n            this.preserveAspectRatio || ''\n          ),\n          rWidth = this._element.width,\n          rHeight = this._element.height,\n          scaleX = 1,\n          scaleY = 1,\n          offsetLeft = 0,\n          offsetTop = 0,\n          cropX = 0,\n          cropY = 0,\n          offset,\n          pWidth = this.width,\n          pHeight = this.height,\n          parsedAttributes = { width: pWidth, height: pHeight };\n        if (pAR && (pAR.alignX !== 'none' || pAR.alignY !== 'none')) {\n          if (pAR.meetOrSlice === 'meet') {\n            scaleX = scaleY = fabric.util.findScaleToFit(\n              this._element,\n              parsedAttributes\n            );\n            offset = (pWidth - rWidth * scaleX) / 2;\n            if (pAR.alignX === 'Min') {\n              offsetLeft = -offset;\n            }\n            if (pAR.alignX === 'Max') {\n              offsetLeft = offset;\n            }\n            offset = (pHeight - rHeight * scaleY) / 2;\n            if (pAR.alignY === 'Min') {\n              offsetTop = -offset;\n            }\n            if (pAR.alignY === 'Max') {\n              offsetTop = offset;\n            }\n          }\n          if (pAR.meetOrSlice === 'slice') {\n            scaleX = scaleY = fabric.util.findScaleToCover(\n              this._element,\n              parsedAttributes\n            );\n            offset = rWidth - pWidth / scaleX;\n            if (pAR.alignX === 'Mid') {\n              cropX = offset / 2;\n            }\n            if (pAR.alignX === 'Max') {\n              cropX = offset;\n            }\n            offset = rHeight - pHeight / scaleY;\n            if (pAR.alignY === 'Mid') {\n              cropY = offset / 2;\n            }\n            if (pAR.alignY === 'Max') {\n              cropY = offset;\n            }\n            rWidth = pWidth / scaleX;\n            rHeight = pHeight / scaleY;\n          }\n        } else {\n          scaleX = pWidth / rWidth;\n          scaleY = pHeight / rHeight;\n        }\n        return {\n          width: rWidth,\n          height: rHeight,\n          scaleX: scaleX,\n          scaleY: scaleY,\n          offsetLeft: offsetLeft,\n          offsetTop: offsetTop,\n          cropX: cropX,\n          cropY: cropY,\n        };\n      },\n    }\n  );\n\n  /**\n   * Default CSS class name for canvas\n   * @static\n   * @type String\n   * @default\n   */\n  fabric.Image.CSS_CANVAS = 'canvas-img';\n\n  /**\n   * Alias for getSrc\n   * @static\n   */\n  fabric.Image.prototype.getSvgSrc = fabric.Image.prototype.getSrc;\n\n  /**\n   * Creates an instance of fabric.Image from its object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} callback Callback to invoke when an image instance is created\n   */\n  fabric.Image.fromObject = function (_object, callback) {\n    var object = fabric.util.object.clone(_object);\n    fabric.util.loadImage(\n      object.src,\n      function (img, error) {\n        if (error) {\n          callback && callback(null, error);\n          return;\n        }\n        fabric.Image.prototype._initFilters.call(\n          object,\n          object.filters,\n          function (filters) {\n            object.filters = filters || [];\n            fabric.Image.prototype._initFilters.call(\n              object,\n              [object.resizeFilter],\n              function (resizeFilters) {\n                object.resizeFilter = resizeFilters[0];\n                fabric.util.enlivenObjects([object.clipPath], function (\n                  enlivedProps\n                ) {\n                  object.clipPath = enlivedProps[0];\n                  var image = new fabric.Image(img, object);\n                  callback(image);\n                });\n              }\n            );\n          }\n        );\n      },\n      null,\n      object.crossOrigin\n    );\n  };\n\n  /**\n   * Creates an instance of fabric.Image from an URL string\n   * @static\n   * @param {String} url URL to create an image from\n   * @param {Function} [callback] Callback to invoke when image is created (newly created image is passed as a first argument)\n   * @param {Object} [imgOptions] Options object\n   */\n  fabric.Image.fromURL = function (url, callback, imgOptions) {\n    fabric.util.loadImage(\n      url,\n      function (img) {\n        callback && callback(new fabric.Image(img, imgOptions));\n      },\n      null,\n      imgOptions && imgOptions.crossOrigin\n    );\n  };\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Image.fromElement})\n   * @static\n   * @see {@link http://www.w3.org/TR/SVG/struct.html#ImageElement}\n   */\n  fabric.Image.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(\n    'x y width height preserveAspectRatio xlink:href crossOrigin'.split(' ')\n  );\n\n  /**\n   * Returns {@link fabric.Image} instance from an SVG element\n   * @static\n   * @param {SVGElement} element Element to parse\n   * @param {Object} [options] Options object\n   * @param {Function} callback Callback to execute when fabric.Image object is created\n   * @return {fabric.Image} Instance of fabric.Image\n   */\n  fabric.Image.fromElement = function (element, callback, options) {\n    var parsedAttributes = fabric.parseAttributes(\n      element,\n      fabric.Image.ATTRIBUTE_NAMES\n    );\n    fabric.Image.fromURL(\n      parsedAttributes['xlink:href'],\n      callback,\n      extend(options ? fabric.util.object.clone(options) : {}, parsedAttributes)\n    );\n  };\n  /* _FROM_SVG_END_ */\n})(typeof exports !== 'undefined' ? exports : this);\n(function initTestWebGL() {\n  /**\n   * Tests if webgl supports certain precision\n   * @param {WebGL} Canvas WebGL context to test on\n   * @param {String} Precision to test can be any of following: 'lowp', 'mediump', 'highp'\n   * @returns {Boolean} Whether the user's browser WebGL supports given precision.\n   */\n  function testPrecision(gl, precision) {\n    var fragmentSource = 'precision ' + precision + ' float;\\nvoid main(){}';\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentSource);\n    gl.compileShader(fragmentShader);\n    if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Indicate whether this filtering backend is supported by the user's browser.\n   * @param {Number} tileSize check if the tileSize is supported\n   * @returns {Boolean} Whether the user's browser supports WebGL.\n   */\n  fabric.isWebglSupported = function (tileSize) {\n    if (fabric.isLikelyNode) {\n      return false;\n    }\n    tileSize = tileSize || fabric.WebglFilterBackend.prototype.tileSize;\n    var canvas = document.createElement('canvas');\n    var gl =\n      canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    var isSupported = false;\n    // eslint-disable-next-line\n    if (gl) {\n      fabric.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n      isSupported = fabric.maxTextureSize >= tileSize;\n      var precisions = ['highp', 'mediump', 'lowp'];\n      for (var i = 0; i < 3; i++) {\n        if (testPrecision(gl, precisions[i])) {\n          fabric.webGlPrecision = precisions[i];\n          break;\n        }\n      }\n    }\n    this.isSupported = isSupported;\n    return isSupported;\n  };\n\n  fabric.WebglFilterBackend = WebglFilterBackend;\n\n  /**\n   * WebGL filter backend.\n   */\n  function WebglFilterBackend(options) {\n    if (options && options.tileSize) {\n      this.tileSize = options.tileSize;\n    }\n    this.setupGLContext(this.tileSize, this.tileSize);\n    this.captureGPUInfo();\n  }\n\n  WebglFilterBackend.prototype = /** @lends fabric.WebglFilterBackend.prototype */ {\n    tileSize: 2048,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you problably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {},\n\n    /**\n     * Setup a WebGL context suitable for filtering, and bind any needed event handlers.\n     */\n    setupGLContext: function (width, height) {\n      this.dispose();\n      this.createWebGLCanvas(width, height);\n      // eslint-disable-next-line\n      this.aPosition = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\n      this.chooseFastestCopyGLTo2DMethod(width, height);\n    },\n\n    /**\n     * Pick a method to copy data from GL context to 2d canvas.  In some browsers using\n     * putImageData is faster than drawImage for that specific operation.\n     */\n    chooseFastestCopyGLTo2DMethod: function (width, height) {\n      var canMeasurePerf = typeof window.performance !== 'undefined',\n        canUseImageData;\n      try {\n        new ImageData(1, 1);\n        canUseImageData = true;\n      } catch (e) {\n        canUseImageData = false;\n      }\n      // eslint-disable-next-line no-undef\n      var canUseArrayBuffer = typeof ArrayBuffer !== 'undefined';\n      // eslint-disable-next-line no-undef\n      var canUseUint8Clamped = typeof Uint8ClampedArray !== 'undefined';\n\n      if (\n        !(\n          canMeasurePerf &&\n          canUseImageData &&\n          canUseArrayBuffer &&\n          canUseUint8Clamped\n        )\n      ) {\n        return;\n      }\n\n      var targetCanvas = fabric.util.createCanvasElement();\n      // eslint-disable-next-line no-undef\n      var imageBuffer = new ArrayBuffer(width * height * 4);\n      if (fabric.forceGLPutImageData) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n        return;\n      }\n      var testContext = {\n        imageBuffer: imageBuffer,\n        destinationWidth: width,\n        destinationHeight: height,\n        targetCanvas: targetCanvas,\n      };\n      var startTime, drawImageTime, putImageDataTime;\n      targetCanvas.width = width;\n      targetCanvas.height = height;\n\n      startTime = window.performance.now();\n      copyGLTo2DDrawImage.call(testContext, this.gl, testContext);\n      drawImageTime = window.performance.now() - startTime;\n\n      startTime = window.performance.now();\n      copyGLTo2DPutImageData.call(testContext, this.gl, testContext);\n      putImageDataTime = window.performance.now() - startTime;\n\n      if (drawImageTime > putImageDataTime) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n      } else {\n        this.copyGLTo2D = copyGLTo2DDrawImage;\n      }\n    },\n\n    /**\n     * Create a canvas element and associated WebGL context and attaches them as\n     * class properties to the GLFilterBackend class.\n     */\n    createWebGLCanvas: function (width, height) {\n      var canvas = fabric.util.createCanvasElement();\n      canvas.width = width;\n      canvas.height = height;\n      var glOptions = {\n          alpha: true,\n          premultipliedAlpha: false,\n          depth: false,\n          stencil: false,\n          antialias: false,\n        },\n        gl = canvas.getContext('webgl', glOptions);\n      if (!gl) {\n        gl = canvas.getContext('experimental-webgl', glOptions);\n      }\n      if (!gl) {\n        return;\n      }\n      gl.clearColor(0, 0, 0, 0);\n      // this canvas can fire webglcontextlost and webglcontextrestored\n      this.canvas = canvas;\n      this.gl = gl;\n    },\n\n    /**\n     * Attempts to apply the requested filters to the source provided, drawing the filtered output\n     * to the provided target canvas.\n     *\n     * @param {Array} filters The filters to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} source The source to be filtered.\n     * @param {Number} width The width of the source input.\n     * @param {Number} height The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     * @param {String|undefined} cacheKey A key used to cache resources related to the source. If\n     * omitted, caching will be skipped.\n     */\n    applyFilters: function (\n      filters,\n      source,\n      width,\n      height,\n      targetCanvas,\n      cacheKey\n    ) {\n      var gl = this.gl;\n      var cachedTexture;\n      if (cacheKey) {\n        cachedTexture = this.getCachedTexture(cacheKey, source);\n      }\n      var pipelineState = {\n        originalWidth: source.width || source.originalWidth,\n        originalHeight: source.height || source.originalHeight,\n        sourceWidth: width,\n        sourceHeight: height,\n        destinationWidth: width,\n        destinationHeight: height,\n        context: gl,\n        sourceTexture: this.createTexture(\n          gl,\n          width,\n          height,\n          !cachedTexture && source\n        ),\n        targetTexture: this.createTexture(gl, width, height),\n        originalTexture:\n          cachedTexture ||\n          this.createTexture(gl, width, height, !cachedTexture && source),\n        passes: filters.length,\n        webgl: true,\n        aPosition: this.aPosition,\n        programCache: this.programCache,\n        pass: 0,\n        filterBackend: this,\n        targetCanvas: targetCanvas,\n      };\n      var tempFbo = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, tempFbo);\n      filters.forEach(function (filter) {\n        filter && filter.applyTo(pipelineState);\n      });\n      resizeCanvasIfNeeded(pipelineState);\n      this.copyGLTo2D(gl, pipelineState);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n      gl.deleteTexture(pipelineState.sourceTexture);\n      gl.deleteTexture(pipelineState.targetTexture);\n      gl.deleteFramebuffer(tempFbo);\n      targetCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n      return pipelineState;\n    },\n\n    /**\n     * Detach event listeners, remove references, and clean up caches.\n     */\n    dispose: function () {\n      if (this.canvas) {\n        this.canvas = null;\n        this.gl = null;\n      }\n      this.clearWebGLCaches();\n    },\n\n    /**\n     * Wipe out WebGL-related caches.\n     */\n    clearWebGLCaches: function () {\n      this.programCache = {};\n      this.textureCache = {};\n    },\n\n    /**\n     * Create a WebGL texture object.\n     *\n     * Accepts specific dimensions to initialize the textuer to or a source image.\n     *\n     * @param {WebGLRenderingContext} gl The GL context to use for creating the texture.\n     * @param {Number} width The width to initialize the texture at.\n     * @param {Number} height The height to initialize the texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source for the texture data.\n     * @returns {WebGLTexture}\n     */\n    createTexture: function (gl, width, height, textureImageSource) {\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      if (textureImageSource) {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          textureImageSource\n        );\n      } else {\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          width,\n          height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          null\n        );\n      }\n      return texture;\n    },\n\n    /**\n     * Can be optionally used to get a texture from the cache array\n     *\n     * If an existing texture is not found, a new texture is created and cached.\n     *\n     * @param {String} uniqueId A cache key to use to find an existing texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source to use to create the\n     * texture cache entry if one does not already exist.\n     */\n    getCachedTexture: function (uniqueId, textureImageSource) {\n      if (this.textureCache[uniqueId]) {\n        return this.textureCache[uniqueId];\n      } else {\n        var texture = this.createTexture(\n          this.gl,\n          textureImageSource.width,\n          textureImageSource.height,\n          textureImageSource\n        );\n        this.textureCache[uniqueId] = texture;\n        return texture;\n      }\n    },\n\n    /**\n     * Clear out cached resources related to a source image that has been\n     * filtered previously.\n     *\n     * @param {String} cacheKey The cache key provided when the source image was filtered.\n     */\n    evictCachesForKey: function (cacheKey) {\n      if (this.textureCache[cacheKey]) {\n        this.gl.deleteTexture(this.textureCache[cacheKey]);\n        delete this.textureCache[cacheKey];\n      }\n    },\n\n    copyGLTo2D: copyGLTo2DDrawImage,\n\n    /**\n     * Attempt to extract GPU information strings from a WebGL context.\n     *\n     * Useful information when debugging or blacklisting specific GPUs.\n     *\n     * @returns {Object} A GPU info object with renderer and vendor strings.\n     */\n    captureGPUInfo: function () {\n      if (this.gpuInfo) {\n        return this.gpuInfo;\n      }\n      var gl = this.gl,\n        gpuInfo = { renderer: '', vendor: '' };\n      if (!gl) {\n        return gpuInfo;\n      }\n      var ext = gl.getExtension('WEBGL_debug_renderer_info');\n      if (ext) {\n        var renderer = gl.getParameter(ext.UNMASKED_RENDERER_WEBGL);\n        var vendor = gl.getParameter(ext.UNMASKED_VENDOR_WEBGL);\n        if (renderer) {\n          gpuInfo.renderer = renderer.toLowerCase();\n        }\n        if (vendor) {\n          gpuInfo.vendor = vendor.toLowerCase();\n        }\n      }\n      this.gpuInfo = gpuInfo;\n      return gpuInfo;\n    },\n  };\n})();\n\nfunction resizeCanvasIfNeeded(pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas,\n    width = targetCanvas.width,\n    height = targetCanvas.height,\n    dWidth = pipelineState.destinationWidth,\n    dHeight = pipelineState.destinationHeight;\n\n  if (width !== dWidth || height !== dHeight) {\n    targetCanvas.width = dWidth;\n    targetCanvas.height = dHeight;\n  }\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas.\n *\n * The WebGL canvas is assumed to be upside down, with the top-left pixel of the\n * desired output image appearing in the bottom-left corner of the WebGL canvas.\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DDrawImage(gl, pipelineState) {\n  var glCanvas = gl.canvas,\n    targetCanvas = pipelineState.targetCanvas,\n    ctx = targetCanvas.getContext('2d');\n  ctx.translate(0, targetCanvas.height); // move it down again\n  ctx.scale(1, -1); // vertical flip\n  // where is my image on the big glcanvas?\n  var sourceY = glCanvas.height - targetCanvas.height;\n  ctx.drawImage(\n    glCanvas,\n    0,\n    sourceY,\n    targetCanvas.width,\n    targetCanvas.height,\n    0,\n    0,\n    targetCanvas.width,\n    targetCanvas.height\n  );\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas using 2d canvas' putImageData\n * API. Measurably faster than using ctx.drawImage in Firefox (version 54 on OSX Sierra).\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DPutImageData(gl, pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas,\n    ctx = targetCanvas.getContext('2d'),\n    dWidth = pipelineState.destinationWidth,\n    dHeight = pipelineState.destinationHeight,\n    numBytes = dWidth * dHeight * 4;\n\n  // eslint-disable-next-line no-undef\n  var u8 = new Uint8Array(this.imageBuffer, 0, numBytes);\n  // eslint-disable-next-line no-undef\n  var u8Clamped = new Uint8ClampedArray(this.imageBuffer, 0, numBytes);\n\n  gl.readPixels(0, 0, dWidth, dHeight, gl.RGBA, gl.UNSIGNED_BYTE, u8);\n  var imgData = new ImageData(u8Clamped, dWidth, dHeight);\n  ctx.putImageData(imgData, 0, 0);\n}\n(function initCanvas2dFilterBackend() {\n  var noop = function () {};\n\n  fabric.Canvas2dFilterBackend = Canvas2dFilterBackend;\n\n  /**\n   * Canvas 2D filter backend.\n   */\n  function Canvas2dFilterBackend() {}\n\n  Canvas2dFilterBackend.prototype = /** @lends fabric.Canvas2dFilterBackend.prototype */ {\n    evictCachesForKey: noop,\n    dispose: noop,\n    clearWebGLCaches: noop,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you probably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {},\n\n    /**\n     * Apply a set of filters against a source image and draw the filtered output\n     * to the provided destination canvas.\n     *\n     * @param {EnhancedFilter} filters The filter to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} sourceElement The source to be filtered.\n     * @param {Number} sourceWidth The width of the source input.\n     * @param {Number} sourceHeight The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     */\n    applyFilters: function (\n      filters,\n      sourceElement,\n      sourceWidth,\n      sourceHeight,\n      targetCanvas\n    ) {\n      var ctx = targetCanvas.getContext('2d');\n      ctx.drawImage(sourceElement, 0, 0, sourceWidth, sourceHeight);\n      var imageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var originalImageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var pipelineState = {\n        sourceWidth: sourceWidth,\n        sourceHeight: sourceHeight,\n        imageData: imageData,\n        originalEl: sourceElement,\n        originalImageData: originalImageData,\n        canvasEl: targetCanvas,\n        ctx: ctx,\n        filterBackend: this,\n      };\n      filters.forEach(function (filter) {\n        filter.applyTo(pipelineState);\n      });\n      if (\n        pipelineState.imageData.width !== sourceWidth ||\n        pipelineState.imageData.height !== sourceHeight\n      ) {\n        targetCanvas.width = pipelineState.imageData.width;\n        targetCanvas.height = pipelineState.imageData.height;\n      }\n      ctx.putImageData(pipelineState.imageData, 0, 0);\n      return pipelineState;\n    },\n  };\n})();\n/**\n * @namespace fabric.Image.filters\n * @memberOf fabric.Image\n * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#image_filters}\n * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n */\nfabric.Image = fabric.Image || {};\nfabric.Image.filters = fabric.Image.filters || {};\n\n/**\n * Root filter class from which all filter classes inherit from\n * @class fabric.Image.filters.BaseFilter\n * @memberOf fabric.Image.filters\n */\nfabric.Image.filters.BaseFilter = fabric.util.createClass(\n  /** @lends fabric.Image.filters.BaseFilter.prototype */ {\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'BaseFilter',\n\n    /**\n     * Array of attributes to send with buffers. do not modify\n     * @private\n     */\n\n    vertexSource:\n      'attribute vec2 aPosition;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n      'vTexCoord = aPosition;\\n' +\n      'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n      '}',\n\n    fragmentSource:\n      'precision highp float;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'void main() {\\n' +\n      'gl_FragColor = texture2D(uTexture, vTexCoord);\\n' +\n      '}',\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function (options) {\n      if (options) {\n        this.setOptions(options);\n      }\n    },\n\n    /**\n     * Sets filter's properties from options\n     * @param {Object} [options] Options object\n     */\n    setOptions: function (options) {\n      for (var prop in options) {\n        this[prop] = options[prop];\n      }\n    },\n\n    /**\n     * Compile this filter's shader program.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context to use for shader compilation.\n     * @param {String} fragmentSource fragmentShader source for compilation\n     * @param {String} vertexSource vertexShader source for compilation\n     */\n    createProgram: function (gl, fragmentSource, vertexSource) {\n      fragmentSource = fragmentSource || this.fragmentSource;\n      vertexSource = vertexSource || this.vertexSource;\n      if (fabric.webGlPrecision !== 'highp') {\n        fragmentSource = fragmentSource.replace(\n          /precision highp float/g,\n          'precision ' + fabric.webGlPrecision + ' float'\n        );\n      }\n      var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n      gl.shaderSource(vertexShader, vertexSource);\n      gl.compileShader(vertexShader);\n      if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n        throw new Error(\n          // eslint-disable-next-line prefer-template\n          'Vertex shader compile error for ' +\n            this.type +\n            ': ' +\n            gl.getShaderInfoLog(vertexShader)\n        );\n      }\n\n      var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n      gl.shaderSource(fragmentShader, fragmentSource);\n      gl.compileShader(fragmentShader);\n      if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n        throw new Error(\n          // eslint-disable-next-line prefer-template\n          'Fragment shader compile error for ' +\n            this.type +\n            ': ' +\n            gl.getShaderInfoLog(fragmentShader)\n        );\n      }\n\n      var program = gl.createProgram();\n      gl.attachShader(program, vertexShader);\n      gl.attachShader(program, fragmentShader);\n      gl.linkProgram(program);\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        throw new Error(\n          `Shader link error for \\\\\"\\${this.type}\\\\\" ${gl.getProgramInfoLog(\n            program\n          )}`\n        );\n      }\n\n      var attributeLocations = this.getAttributeLocations(gl, program);\n      var uniformLocations = this.getUniformLocations(gl, program) || {};\n      uniformLocations.uStepW = gl.getUniformLocation(program, 'uStepW');\n      uniformLocations.uStepH = gl.getUniformLocation(program, 'uStepH');\n      return {\n        program: program,\n        attributeLocations: attributeLocations,\n        uniformLocations: uniformLocations,\n      };\n    },\n\n    /**\n     * Return a map of attribute names to WebGLAttributeLocation objects.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {WebGLShaderProgram} program The shader program from which to take attribute locations.\n     * @returns {Object} A map of attribute names to attribute locations.\n     */\n    getAttributeLocations: function (gl, program) {\n      return {\n        aPosition: gl.getAttribLocation(program, 'aPosition'),\n      };\n    },\n\n    /**\n     * Return a map of uniform names to WebGLUniformLocation objects.\n     *\n     * Intended to be overridden by subclasses.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {WebGLShaderProgram} program The shader program from which to take uniform locations.\n     * @returns {Object} A map of uniform names to uniform locations.\n     */\n    getUniformLocations: function (/* gl, program */) {\n      // in case i do not need any special uniform i need to return an empty object\n      return {};\n    },\n\n    /**\n     * Send attribute data from this filter to its shader program on the GPU.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {Object} attributeLocations A map of shader attribute names to their locations.\n     */\n    sendAttributeData: function (gl, attributeLocations, aPositionData) {\n      var attributeLocation = attributeLocations.aPosition;\n      var buffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n      gl.enableVertexAttribArray(attributeLocation);\n      gl.vertexAttribPointer(attributeLocation, 2, gl.FLOAT, false, 0, 0);\n      gl.bufferData(gl.ARRAY_BUFFER, aPositionData, gl.STATIC_DRAW);\n    },\n\n    _setupFrameBuffer: function (options) {\n      var gl = options.context,\n        width,\n        height;\n      if (options.passes > 1) {\n        width = options.destinationWidth;\n        height = options.destinationHeight;\n        if (options.sourceWidth !== width || options.sourceHeight !== height) {\n          gl.deleteTexture(options.targetTexture);\n          options.targetTexture = options.filterBackend.createTexture(\n            gl,\n            width,\n            height\n          );\n        }\n        gl.framebufferTexture2D(\n          gl.FRAMEBUFFER,\n          gl.COLOR_ATTACHMENT0,\n          gl.TEXTURE_2D,\n          options.targetTexture,\n          0\n        );\n      } else {\n        // draw last filter on canvas and not to framebuffer.\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.finish();\n      }\n    },\n\n    _swapTextures: function (options) {\n      options.passes--;\n      options.pass++;\n      var temp = options.targetTexture;\n      options.targetTexture = options.sourceTexture;\n      options.sourceTexture = temp;\n    },\n\n    /**\n     * Generic isNeutral implementation for one parameter based filters.\n     * Used only in image applyFilters to discard filters that will not have an effect\n     * on the image\n     * Other filters may need their own verison ( ColorMatrix, HueRotation, gamma, ComposedFilter )\n     * @param {Object} options\n     **/\n    isNeutralState: function (/* options */) {\n      var main = this.mainParameter,\n        _class = fabric.Image.filters[this.type].prototype;\n      if (main) {\n        if (Array.isArray(_class[main])) {\n          for (var i = _class[main].length; i--; ) {\n            if (this[main][i] !== _class[main][i]) {\n              return false;\n            }\n          }\n          return true;\n        } else {\n          return _class[main] === this[main];\n        }\n      } else {\n        return false;\n      }\n    },\n\n    /**\n     * Apply this filter to the input image data provided.\n     *\n     * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyTo: function (options) {\n      if (options.webgl) {\n        this._setupFrameBuffer(options);\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n      } else {\n        this.applyTo2d(options);\n      }\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function (options) {\n      if (!options.programCache.hasOwnProperty(this.type)) {\n        options.programCache[this.type] = this.createProgram(options.context);\n      }\n      return options.programCache[this.type];\n    },\n\n    /**\n     * Apply this filter using webgl.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.originalTexture The texture of the original input image.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyToWebGL: function (options) {\n      var gl = options.context;\n      var shader = this.retrieveShader(options);\n      if (options.pass === 0 && options.originalTexture) {\n        gl.bindTexture(gl.TEXTURE_2D, options.originalTexture);\n      } else {\n        gl.bindTexture(gl.TEXTURE_2D, options.sourceTexture);\n      }\n      gl.useProgram(shader.program);\n      this.sendAttributeData(gl, shader.attributeLocations, options.aPosition);\n\n      gl.uniform1f(shader.uniformLocations.uStepW, 1 / options.sourceWidth);\n      gl.uniform1f(shader.uniformLocations.uStepH, 1 / options.sourceHeight);\n\n      this.sendUniformData(gl, shader.uniformLocations);\n      gl.viewport(0, 0, options.destinationWidth, options.destinationHeight);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    },\n\n    bindAdditionalTexture: function (gl, texture, textureUnit) {\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      // reset active texture to 0 as usual\n      gl.activeTexture(gl.TEXTURE0);\n    },\n\n    unbindAdditionalTexture: function (gl, textureUnit) {\n      gl.activeTexture(textureUnit);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n      gl.activeTexture(gl.TEXTURE0);\n    },\n\n    getMainParameter: function () {\n      return this[this.mainParameter];\n    },\n\n    setMainParameter: function (value) {\n      this[this.mainParameter] = value;\n    },\n\n    /**\n     * Send uniform data from this filter to its shader program on the GPU.\n     *\n     * Intended to be overridden by subclasses.\n     *\n     * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n     * @param {Object} uniformLocations A map of shader uniform names to their locations.\n     */\n    sendUniformData: function (/* gl, uniformLocations */) {\n      // Intentionally left blank.  Override me in subclasses.\n    },\n\n    /**\n     * If needed by a 2d filter, this functions can create an helper canvas to be used\n     * remember that options.targetCanvas is available for use till end of chain.\n     */\n    createHelpLayer: function (options) {\n      if (!options.helpLayer) {\n        var helpLayer = document.createElement('canvas');\n        helpLayer.width = options.sourceWidth;\n        helpLayer.height = options.sourceHeight;\n        options.helpLayer = helpLayer;\n      }\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function () {\n      var object = { type: this.type },\n        mainP = this.mainParameter;\n      if (mainP) {\n        object[mainP] = this[mainP];\n      }\n      return object;\n    },\n\n    /**\n     * Returns a JSON representation of an instance\n     * @return {Object} JSON\n     */\n    toJSON: function () {\n      // delegate, not alias\n      return this.toObject();\n    },\n  }\n);\n\nfabric.Image.filters.BaseFilter.fromObject = function (object, callback) {\n  var filter = new fabric.Image.filters[object.type](object);\n  callback && callback(filter);\n  return filter;\n};\n(function initColorBlendFilter(global) {\n  var fabric = global.fabric,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Color Blend filter class\n   * @class fabric.Image.filter.BlendColor\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendColor = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.Blend.prototype */ {\n      type: 'BlendColor',\n\n      /**\n       * Color to make the blend operation with. default to a reddish color since black or white\n       * gives always strong result.\n       **/\n      color: '#F95C63',\n\n      /**\n       * Blend mode for the filter: one of multiply, add, diff, screen, subtract,\n       * darken, lighten, overlay, exclusion, tint.\n       **/\n      mode: 'multiply',\n\n      /**\n       * alpha value. represent the strength of the blend color operation.\n       **/\n      alpha: 1,\n\n      /**\n       * Fragment source for the Multiply program\n       */\n      fragmentSource: {\n        multiply: 'gl_FragColor.rgb *= uColor.rgb;\\n',\n        screen:\n          'gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\\n',\n        add: 'gl_FragColor.rgb += uColor.rgb;\\n',\n        diff: 'gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\\n',\n        subtract: 'gl_FragColor.rgb -= uColor.rgb;\\n',\n        lighten: 'gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\\n',\n        darken: 'gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\\n',\n        exclusion:\n          'gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\\n',\n        overlay:\n          'if (uColor.r < 0.5) {\\n' +\n          'gl_FragColor.r *= 2.0 * uColor.r;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\\n' +\n          '}\\n' +\n          'if (uColor.g < 0.5) {\\n' +\n          'gl_FragColor.g *= 2.0 * uColor.g;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\\n' +\n          '}\\n' +\n          'if (uColor.b < 0.5) {\\n' +\n          'gl_FragColor.b *= 2.0 * uColor.b;\\n' +\n          '} else {\\n' +\n          'gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\\n' +\n          '}\\n',\n        tint:\n          'gl_FragColor.rgb *= (1.0 - uColor.a);\\n' +\n          'gl_FragColor.rgb += uColor.rgb;\\n',\n      },\n\n      /**\n       * build the fragment source for the filters, joining the common part with\n       * the specific one.\n       * @param {String} mode the mode of the filter, a key of this.fragmentSource\n       * @return {String} the source to be compiled\n       * @private\n       */\n      buildSource: function (mode) {\n        return (\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'gl_FragColor = color;\\n' +\n          'if (color.a > 0.0) {\\n' +\n          this.fragmentSource[mode] +\n          '}\\n' +\n          '}'\n        );\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var cacheKey = this.type + '_' + this.mode,\n          shaderSource;\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          shaderSource = this.buildSource(this.mode);\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            shaderSource\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      /**\n       * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n       *\n       * @param {Object} options\n       * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          data = imageData.data,\n          iLen = data.length,\n          tr,\n          tg,\n          tb,\n          r,\n          g,\n          b,\n          source,\n          alpha1 = 1 - this.alpha;\n\n        source = new fabric.Color(this.color).getSource();\n        tr = source[0] * this.alpha;\n        tg = source[1] * this.alpha;\n        tb = source[2] * this.alpha;\n\n        for (var i = 0; i < iLen; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n\n          switch (this.mode) {\n            case 'multiply':\n              data[i] = (r * tr) / 255;\n              data[i + 1] = (g * tg) / 255;\n              data[i + 2] = (b * tb) / 255;\n              break;\n            case 'screen':\n              data[i] = 255 - ((255 - r) * (255 - tr)) / 255;\n              data[i + 1] = 255 - ((255 - g) * (255 - tg)) / 255;\n              data[i + 2] = 255 - ((255 - b) * (255 - tb)) / 255;\n              break;\n            case 'add':\n              data[i] = r + tr;\n              data[i + 1] = g + tg;\n              data[i + 2] = b + tb;\n              break;\n            case 'diff':\n            case 'difference':\n              data[i] = Math.abs(r - tr);\n              data[i + 1] = Math.abs(g - tg);\n              data[i + 2] = Math.abs(b - tb);\n              break;\n            case 'subtract':\n              data[i] = r - tr;\n              data[i + 1] = g - tg;\n              data[i + 2] = b - tb;\n              break;\n            case 'darken':\n              data[i] = Math.min(r, tr);\n              data[i + 1] = Math.min(g, tg);\n              data[i + 2] = Math.min(b, tb);\n              break;\n            case 'lighten':\n              data[i] = Math.max(r, tr);\n              data[i + 1] = Math.max(g, tg);\n              data[i + 2] = Math.max(b, tb);\n              break;\n            case 'overlay':\n              data[i] =\n                tr < 128\n                  ? (2 * r * tr) / 255\n                  : 255 - (2 * (255 - r) * (255 - tr)) / 255;\n              data[i + 1] =\n                tg < 128\n                  ? (2 * g * tg) / 255\n                  : 255 - (2 * (255 - g) * (255 - tg)) / 255;\n              data[i + 2] =\n                tb < 128\n                  ? (2 * b * tb) / 255\n                  : 255 - (2 * (255 - b) * (255 - tb)) / 255;\n              break;\n            case 'exclusion':\n              data[i] = tr + r - (2 * tr * r) / 255;\n              data[i + 1] = tg + g - (2 * tg * g) / 255;\n              data[i + 2] = tb + b - (2 * tb * b) / 255;\n              break;\n            case 'tint':\n              data[i] = tr + r * alpha1;\n              data[i + 1] = tg + g * alpha1;\n              data[i + 2] = tb + b * alpha1;\n              break;\n            default:\n              break;\n          }\n        }\n      },\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uColor: gl.getUniformLocation(program, 'uColor'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        var source = new fabric.Color(this.color).getSource();\n        source[0] = (this.alpha * source[0]) / 255;\n        source[1] = (this.alpha * source[1]) / 255;\n        source[2] = (this.alpha * source[2]) / 255;\n        source[3] = this.alpha;\n        gl.uniform4fv(uniformLocations.uColor, source);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          color: this.color,\n          mode: this.mode,\n          alpha: this.alpha,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendColor} Instance of fabric.Image.filters.BlendColor\n   */\n  fabric.Image.filters.BlendColor.fromObject =\n    fabric.Image.filters.BaseFilter.fromObject;\n})(typeof exports !== 'undefined' ? exports : this);\n(function initImageBlendFilter(global) {\n  var fabric = global.fabric,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Image Blend filter class\n   * @class fabric.Image.filter.BlendImage\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendImage = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.BlendImage.prototype */ {\n      type: 'BlendImage',\n\n      /**\n       * Color to make the blend operation with. default to a reddish color since black or white\n       * gives always strong result.\n       **/\n      image: null,\n\n      /**\n       * Blend mode for the filter: one of multiply, add, diff, screen, subtract,\n       * darken, lighten, overlay, exclusion, tint.\n       **/\n      mode: 'multiply',\n\n      /**\n       * alpha value. represent the strength of the blend image operation.\n       * not implemented.\n       **/\n      alpha: 1,\n\n      vertexSource:\n        'attribute vec2 aPosition;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'varying vec2 vTexCoord2;\\n' +\n        'uniform mat3 uTransformMatrix;\\n' +\n        'void main() {\\n' +\n        'vTexCoord = aPosition;\\n' +\n        'vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\\n' +\n        'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n        '}',\n\n      /**\n       * Fragment source for the Multiply program\n       */\n      fragmentSource: {\n        multiply:\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform sampler2D uImage;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'varying vec2 vTexCoord2;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.rgba *= color2.rgba;\\n' +\n          'gl_FragColor = color;\\n' +\n          '}',\n        mask:\n          'precision highp float;\\n' +\n          'uniform sampler2D uTexture;\\n' +\n          'uniform sampler2D uImage;\\n' +\n          'uniform vec4 uColor;\\n' +\n          'varying vec2 vTexCoord;\\n' +\n          'varying vec2 vTexCoord2;\\n' +\n          'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.a = color2.a;\\n' +\n          'gl_FragColor = color;\\n' +\n          '}',\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var cacheKey = this.type + '_' + this.mode;\n        var shaderSource = this.fragmentSource[this.mode];\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            shaderSource\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      applyToWebGL: function (options) {\n        // load texture to blend.\n        var gl = options.context,\n          texture = this.createTexture(options.filterBackend, this.image);\n        this.bindAdditionalTexture(gl, texture, gl.TEXTURE1);\n        this.callSuper('applyToWebGL', options);\n        this.unbindAdditionalTexture(gl, gl.TEXTURE1);\n      },\n\n      createTexture: function (backend, image) {\n        return backend.getCachedTexture(image.cacheKey, image._element);\n      },\n\n      /**\n       * Calculate a transformMatrix to adapt the image to blend over\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      calculateMatrix: function () {\n        var image = this.image,\n          width = image._element.width,\n          height = image._element.height;\n        return [\n          1 / image.scaleX,\n          0,\n          0,\n          0,\n          1 / image.scaleY,\n          0,\n          -image.left / width,\n          -image.top / height,\n          1,\n        ];\n      },\n\n      /**\n       * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n       *\n       * @param {Object} options\n       * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          resources = options.filterBackend.resources,\n          data = imageData.data,\n          iLen = data.length,\n          width = imageData.width,\n          height = imageData.height,\n          tr,\n          tg,\n          tb,\n          ta,\n          r,\n          g,\n          b,\n          a,\n          canvas1,\n          context,\n          image = this.image,\n          blendData;\n\n        if (!resources.blendImage) {\n          resources.blendImage = fabric.util.createCanvasElement();\n        }\n        canvas1 = resources.blendImage;\n        context = canvas1.getContext('2d');\n        if (canvas1.width !== width || canvas1.height !== height) {\n          canvas1.width = width;\n          canvas1.height = height;\n        } else {\n          context.clearRect(0, 0, width, height);\n        }\n        context.setTransform(\n          image.scaleX,\n          0,\n          0,\n          image.scaleY,\n          image.left,\n          image.top\n        );\n        context.drawImage(image._element, 0, 0, width, height);\n        blendData = context.getImageData(0, 0, width, height).data;\n        for (var i = 0; i < iLen; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n          a = data[i + 3];\n\n          tr = blendData[i];\n          tg = blendData[i + 1];\n          tb = blendData[i + 2];\n          ta = blendData[i + 3];\n\n          switch (this.mode) {\n            case 'multiply':\n              data[i] = (r * tr) / 255;\n              data[i + 1] = (g * tg) / 255;\n              data[i + 2] = (b * tb) / 255;\n              data[i + 3] = (a * ta) / 255;\n              break;\n            case 'mask':\n              data[i + 3] = ta;\n              break;\n            default:\n              break;\n          }\n        }\n      },\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uTransformMatrix: gl.getUniformLocation(program, 'uTransformMatrix'),\n          uImage: gl.getUniformLocation(program, 'uImage'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        var matrix = this.calculateMatrix();\n        gl.uniform1i(uniformLocations.uImage, 1); // texture unit 1.\n        gl.uniformMatrix3fv(uniformLocations.uTransformMatrix, false, matrix);\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          image: this.image && this.image.toObject(),\n          mode: this.mode,\n          alpha: this.alpha,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} callback to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendImage} Instance of fabric.Image.filters.BlendImage\n   */\n  fabric.Image.filters.BlendImage.fromObject = function (object, callback) {\n    fabric.Image.fromObject(object.image, function (image) {\n      var options = fabric.util.object.clone(object);\n      options.image = image;\n      callback(new fabric.Image.filters.BlendImage(options));\n    });\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n(function initResizeImageFilter(global) {\n  var fabric = global.fabric || (global.fabric = {}),\n    pow = Math.pow,\n    floor = Math.floor,\n    sqrt = Math.sqrt,\n    abs = Math.abs,\n    round = Math.round,\n    sin = Math.sin,\n    ceil = Math.ceil,\n    filters = fabric.Image.filters,\n    createClass = fabric.util.createClass;\n\n  /**\n   * Resize image filter class\n   * @class fabric.Image.filters.Resize\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Resize();\n   * object.filters.push(filter);\n   * object.applyFilters(canvas.renderAll.bind(canvas));\n   */\n  filters.Resize = createClass(\n    filters.BaseFilter,\n    /** @lends fabric.Image.filters.Resize.prototype */ {\n      /**\n       * Filter type\n       * @param {String} type\n       * @default\n       */\n      type: 'Resize',\n\n      /**\n       * Resize type\n       * for webgl resizeType is just lanczos, for canvas2d can be:\n       * bilinear, hermite, sliceHack, lanczos.\n       * @param {String} resizeType\n       * @default\n       */\n      resizeType: 'hermite',\n\n      /**\n       * Scale factor for resizing, x axis\n       * @param {Number} scaleX\n       * @default\n       */\n      scaleX: 1,\n\n      /**\n       * Scale factor for resizing, y axis\n       * @param {Number} scaleY\n       * @default\n       */\n      scaleY: 1,\n\n      /**\n       * LanczosLobes parameter for lanczos filter, valid for resizeType lanczos\n       * @param {Number} lanczosLobes\n       * @default\n       */\n      lanczosLobes: 3,\n\n      /**\n       * Return WebGL uniform locations for this filter's shader.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {WebGLShaderProgram} program This filter's compiled shader program.\n       */\n      getUniformLocations: function (gl, program) {\n        return {\n          uDelta: gl.getUniformLocation(program, 'uDelta'),\n          uTaps: gl.getUniformLocation(program, 'uTaps'),\n        };\n      },\n\n      /**\n       * Send data from this filter to its shader program's uniforms.\n       *\n       * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n       * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n       */\n      sendUniformData: function (gl, uniformLocations) {\n        gl.uniform2fv(\n          uniformLocations.uDelta,\n          this.horizontal ? [1 / this.width, 0] : [0, 1 / this.height]\n        );\n        gl.uniform1fv(uniformLocations.uTaps, this.taps);\n      },\n\n      /**\n       * Retrieves the cached shader.\n       * @param {Object} options\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      retrieveShader: function (options) {\n        var filterWindow = this.getFilterWindow(),\n          cacheKey = this.type + '_' + filterWindow;\n        if (!options.programCache.hasOwnProperty(cacheKey)) {\n          var fragmentShader = this.generateShader(filterWindow);\n          options.programCache[cacheKey] = this.createProgram(\n            options.context,\n            fragmentShader\n          );\n        }\n        return options.programCache[cacheKey];\n      },\n\n      getFilterWindow: function () {\n        var scale = this.tempScale;\n        return Math.ceil(this.lanczosLobes / scale);\n      },\n\n      getTaps: function () {\n        var lobeFunction = this.lanczosCreate(this.lanczosLobes),\n          scale = this.tempScale,\n          filterWindow = this.getFilterWindow(),\n          taps = new Array(filterWindow);\n        for (var i = 1; i <= filterWindow; i++) {\n          taps[i - 1] = lobeFunction(i * scale);\n        }\n        return taps;\n      },\n\n      /**\n       * Generate vertex and shader sources from the necessary steps numbers\n       * @param {Number} filterWindow\n       */\n      generateShader: function (filterWindow) {\n        var offsets = new Array(filterWindow),\n          fragmentShader = this.fragmentSourceTOP;\n        // filterWindow;\n\n        for (var i = 1; i <= filterWindow; i++) {\n          offsets[i - 1] = i + '.0 * uDelta';\n        }\n\n        fragmentShader += 'uniform float uTaps[' + filterWindow + '];\\n';\n        fragmentShader += 'void main() {\\n';\n        fragmentShader += '  vec4 color = texture2D(uTexture, vTexCoord);\\n';\n        fragmentShader += '  float sum = 1.0;\\n';\n\n        offsets.forEach(function (offset, i) {\n          fragmentShader +=\n            '  color += texture2D(uTexture, vTexCoord + ' +\n            offset +\n            ') * uTaps[' +\n            i +\n            '];\\n';\n          fragmentShader +=\n            '  color += texture2D(uTexture, vTexCoord - ' +\n            offset +\n            ') * uTaps[' +\n            i +\n            '];\\n';\n          fragmentShader += '  sum += 2.0 * uTaps[' + i + '];\\n';\n        });\n        fragmentShader += '  gl_FragColor = color / sum;\\n';\n        fragmentShader += '}';\n        return fragmentShader;\n      },\n\n      fragmentSourceTOP:\n        'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform vec2 uDelta;\\n' +\n        'varying vec2 vTexCoord;\\n',\n\n      /**\n       * Apply the resize filter to the image\n       * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n       *\n       * @param {Object} options\n       * @param {Number} options.passes The number of filters remaining to be executed\n       * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n       * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n       * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n       * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n       * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n       */\n      applyTo: function (options) {\n        if (options.webgl) {\n          options.passes++;\n          this.width = options.sourceWidth;\n          this.horizontal = true;\n          this.dW = Math.round(this.width * this.scaleX);\n          this.dH = options.sourceHeight;\n          this.tempScale = this.dW / this.width;\n          this.taps = this.getTaps();\n          options.destinationWidth = this.dW;\n          this._setupFrameBuffer(options);\n          this.applyToWebGL(options);\n          this._swapTextures(options);\n          options.sourceWidth = options.destinationWidth;\n\n          this.height = options.sourceHeight;\n          this.horizontal = false;\n          this.dH = Math.round(this.height * this.scaleY);\n          this.tempScale = this.dH / this.height;\n          this.taps = this.getTaps();\n          options.destinationHeight = this.dH;\n          this._setupFrameBuffer(options);\n          this.applyToWebGL(options);\n          this._swapTextures(options);\n          options.sourceHeight = options.destinationHeight;\n        } else {\n          this.applyTo2d(options);\n        }\n      },\n\n      isNeutralState: function () {\n        return this.scaleX === 1 && this.scaleY === 1;\n      },\n\n      lanczosCreate: function (lobes) {\n        return function (x) {\n          if (x >= lobes || x <= -lobes) {\n            return 0.0;\n          }\n          if (x < 1.1920929e-7 && x > -1.1920929e-7) {\n            return 1.0;\n          }\n          x *= Math.PI;\n          var xx = x / lobes;\n          return ((sin(x) / x) * sin(xx)) / xx;\n        };\n      },\n\n      /**\n       * Applies filter to canvas element\n       * @memberOf fabric.Image.filters.Resize.prototype\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} scaleX\n       * @param {Number} scaleY\n       */\n      applyTo2d: function (options) {\n        var imageData = options.imageData,\n          scaleX = this.scaleX,\n          scaleY = this.scaleY;\n\n        this.rcpScaleX = 1 / scaleX;\n        this.rcpScaleY = 1 / scaleY;\n\n        var oW = imageData.width,\n          oH = imageData.height,\n          dW = round(oW * scaleX),\n          dH = round(oH * scaleY),\n          newData;\n\n        if (this.resizeType === 'sliceHack') {\n          newData = this.sliceByTwo(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'hermite') {\n          newData = this.hermiteFastResize(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'bilinear') {\n          newData = this.bilinearFiltering(options, oW, oH, dW, dH);\n        } else if (this.resizeType === 'lanczos') {\n          newData = this.lanczosResize(options, oW, oH, dW, dH);\n        }\n        options.imageData = newData;\n      },\n\n      /**\n       * Filter sliceByTwo\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      sliceByTwo: function (options, oW, oH, dW, dH) {\n        var imageData = options.imageData,\n          mult = 0.5,\n          doneW = false,\n          doneH = false,\n          stepW = oW * mult,\n          stepH = oH * mult,\n          resources = fabric.filterBackend.resources,\n          tmpCanvas,\n          ctx,\n          sX = 0,\n          sY = 0,\n          dX = oW,\n          dY = 0;\n        if (!resources.sliceByTwo) {\n          resources.sliceByTwo = document.createElement('canvas');\n        }\n        tmpCanvas = resources.sliceByTwo;\n        if (tmpCanvas.width < oW * 1.5 || tmpCanvas.height < oH) {\n          tmpCanvas.width = oW * 1.5;\n          tmpCanvas.height = oH;\n        }\n        ctx = tmpCanvas.getContext('2d');\n        ctx.clearRect(0, 0, oW * 1.5, oH);\n        ctx.putImageData(imageData, 0, 0);\n\n        dW = floor(dW);\n        dH = floor(dH);\n\n        while (!doneW || !doneH) {\n          oW = stepW;\n          oH = stepH;\n          if (dW < floor(stepW * mult)) {\n            stepW = floor(stepW * mult);\n          } else {\n            stepW = dW;\n            doneW = true;\n          }\n          if (dH < floor(stepH * mult)) {\n            stepH = floor(stepH * mult);\n          } else {\n            stepH = dH;\n            doneH = true;\n          }\n          ctx.drawImage(tmpCanvas, sX, sY, oW, oH, dX, dY, stepW, stepH);\n          sX = dX;\n          sY = dY;\n          dY += stepH;\n        }\n        return ctx.getImageData(sX, sY, dW, dH);\n      },\n\n      /**\n       * Filter lanczosResize\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      lanczosResize: function (options, oW, oH, dW, dH) {\n        function process(u) {\n          var v, i, weight, idx, a, red, green, blue, alpha, fX, fY;\n          center.x = (u + 0.5) * ratioX;\n          icenter.x = floor(center.x);\n          for (v = 0; v < dH; v++) {\n            center.y = (v + 0.5) * ratioY;\n            icenter.y = floor(center.y);\n            a = 0;\n            red = 0;\n            green = 0;\n            blue = 0;\n            alpha = 0;\n            for (i = icenter.x - range2X; i <= icenter.x + range2X; i++) {\n              if (i < 0 || i >= oW) {\n                continue;\n              }\n              fX = floor(1000 * abs(i - center.x));\n              if (!cacheLanc[fX]) {\n                cacheLanc[fX] = {};\n              }\n              for (var j = icenter.y - range2Y; j <= icenter.y + range2Y; j++) {\n                if (j < 0 || j >= oH) {\n                  continue;\n                }\n                fY = floor(1000 * abs(j - center.y));\n                if (!cacheLanc[fX][fY]) {\n                  cacheLanc[fX][fY] = lanczos(\n                    sqrt(pow(fX * rcpRatioX, 2) + pow(fY * rcpRatioY, 2)) / 1000\n                  );\n                }\n                weight = cacheLanc[fX][fY];\n                if (weight > 0) {\n                  idx = (j * oW + i) * 4;\n                  a += weight;\n                  red += weight * srcData[idx];\n                  green += weight * srcData[idx + 1];\n                  blue += weight * srcData[idx + 2];\n                  alpha += weight * srcData[idx + 3];\n                }\n              }\n            }\n            idx = (v * dW + u) * 4;\n            destData[idx] = red / a;\n            destData[idx + 1] = green / a;\n            destData[idx + 2] = blue / a;\n            destData[idx + 3] = alpha / a;\n          }\n\n          if (++u < dW) {\n            return process(u);\n          } else {\n            return destImg;\n          }\n        }\n\n        var srcData = options.imageData.data,\n          destImg = options.ctx.createImageData(dW, dH),\n          destData = destImg.data,\n          lanczos = this.lanczosCreate(this.lanczosLobes),\n          ratioX = this.rcpScaleX,\n          ratioY = this.rcpScaleY,\n          rcpRatioX = 2 / this.rcpScaleX,\n          rcpRatioY = 2 / this.rcpScaleY,\n          range2X = ceil((ratioX * this.lanczosLobes) / 2),\n          range2Y = ceil((ratioY * this.lanczosLobes) / 2),\n          cacheLanc = {},\n          center = {},\n          icenter = {};\n\n        return process(0);\n      },\n\n      /**\n       * bilinearFiltering\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      bilinearFiltering: function (options, oW, oH, dW, dH) {\n        var a,\n          b,\n          c,\n          d,\n          x,\n          y,\n          i,\n          j,\n          xDiff,\n          yDiff,\n          chnl,\n          color,\n          offset = 0,\n          origPix,\n          ratioX = this.rcpScaleX,\n          ratioY = this.rcpScaleY,\n          w4 = 4 * (oW - 1),\n          img = options.imageData,\n          pixels = img.data,\n          destImage = options.ctx.createImageData(dW, dH),\n          destPixels = destImage.data;\n        for (i = 0; i < dH; i++) {\n          for (j = 0; j < dW; j++) {\n            x = floor(ratioX * j);\n            y = floor(ratioY * i);\n            xDiff = ratioX * j - x;\n            yDiff = ratioY * i - y;\n            origPix = 4 * (y * oW + x);\n\n            for (chnl = 0; chnl < 4; chnl++) {\n              a = pixels[origPix + chnl];\n              b = pixels[origPix + 4 + chnl];\n              c = pixels[origPix + w4 + chnl];\n              d = pixels[origPix + w4 + 4 + chnl];\n              color =\n                a * (1 - xDiff) * (1 - yDiff) +\n                b * xDiff * (1 - yDiff) +\n                c * yDiff * (1 - xDiff) +\n                d * xDiff * yDiff;\n              destPixels[offset++] = color;\n            }\n          }\n        }\n        return destImage;\n      },\n\n      /**\n       * hermiteFastResize\n       * @param {Object} canvasEl Canvas element to apply filter to\n       * @param {Number} oW Original Width\n       * @param {Number} oH Original Height\n       * @param {Number} dW Destination Width\n       * @param {Number} dH Destination Height\n       * @returns {ImageData}\n       */\n      hermiteFastResize: function (options, oW, oH, dW, dH) {\n        var ratioW = this.rcpScaleX,\n          ratioH = this.rcpScaleY,\n          ratioWHalf = ceil(ratioW / 2),\n          ratioHHalf = ceil(ratioH / 2),\n          img = options.imageData,\n          data = img.data,\n          img2 = options.ctx.createImageData(dW, dH),\n          data2 = img2.data;\n        for (var j = 0; j < dH; j++) {\n          for (var i = 0; i < dW; i++) {\n            var x2 = (i + j * dW) * 4,\n              weight = 0,\n              weights = 0,\n              weightsAlpha = 0,\n              gxR = 0,\n              gxG = 0,\n              gxB = 0,\n              gxA = 0,\n              centerY = (j + 0.5) * ratioH;\n            for (var yy = floor(j * ratioH); yy < (j + 1) * ratioH; yy++) {\n              var dy = abs(centerY - (yy + 0.5)) / ratioHHalf,\n                centerX = (i + 0.5) * ratioW,\n                w0 = dy * dy;\n              for (var xx = floor(i * ratioW); xx < (i + 1) * ratioW; xx++) {\n                var dx = abs(centerX - (xx + 0.5)) / ratioWHalf,\n                  w = sqrt(w0 + dx * dx);\n                /* eslint-disable max-depth */\n                if (w > 1 && w < -1) {\n                  continue;\n                }\n                //hermite filter\n                weight = 2 * w * w * w - 3 * w * w + 1;\n                if (weight > 0) {\n                  dx = 4 * (xx + yy * oW);\n                  //alpha\n                  gxA += weight * data[dx + 3];\n                  weightsAlpha += weight;\n                  //colors\n                  if (data[dx + 3] < 255) {\n                    weight = (weight * data[dx + 3]) / 250;\n                  }\n                  gxR += weight * data[dx];\n                  gxG += weight * data[dx + 1];\n                  gxB += weight * data[dx + 2];\n                  weights += weight;\n                }\n                /* eslint-enable max-depth */\n              }\n            }\n            data2[x2] = gxR / weights;\n            data2[x2 + 1] = gxG / weights;\n            data2[x2 + 2] = gxB / weights;\n            data2[x2 + 3] = gxA / weightsAlpha;\n          }\n        }\n        return img2;\n      },\n\n      /**\n       * Returns object representation of an instance\n       * @return {Object} Object representation of an instance\n       */\n      toObject: function () {\n        return {\n          type: this.type,\n          scaleX: this.scaleX,\n          scaleY: this.scaleY,\n          resizeType: this.resizeType,\n          lanczosLobes: this.lanczosLobes,\n        };\n      },\n    }\n  );\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Resize} Instance of fabric.Image.filters.Resize\n   */\n  fabric.Image.filters.Resize.fromObject =\n    fabric.Image.filters.BaseFilter.fromObject;\n})(typeof exports !== 'undefined' ? exports : this);\n","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/lineart.39ddec09.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAclJREFUeNrt2r/LTnEYx/HryPgsTIrBYLBYTRSDyV9gtvoHjMpgk9EfYBFGu4EMlJTZjwwGyVNE+fE23Hc9jwwok/v1Ws45ne1Tn66+1zkzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwzywi+Fl1YmYOrR8fLsvyQiqwKsdWdaV6Xz2vLkoFdgpypHpUfW/laXVeMrBTkJf97FV1udovITa9IAequ/3qdXVJQptnrwh2LMvypro3M/tm5vjM7Fm/OjgzZ6uZmZvLsjyTFps8SU5Ut6qv6wnyZX19W91Yb7pgo0tysrq9Lsb36vP6fru6VG1JiU0vyanq+q4J8qn6Vj2ozkgIJVlNkie7Duxfqg/VBVMEViW5Wr3b9X3kY3W/OiWd/5st1p+5NjPbM3N6Zo7Nast1VCz/P/9i/d0kOTwz52a19t2emTvLsjyWDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwOz8A+z4Ss9550f4AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAfxJREFUeNrt27+rT3EcBvDnIAbXJLkDuumWkoGyKspqu4NZBpu/gEH5C6wmk8WoTCaD0h0xKJlZlOl29X0M9+h+L+Iipe95vaZzPuNTT+/P5/xIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAID/1yCCP9d2Kcn58fbTMAzrUoHtgqy2fdj2fdtbElk8e0TwV1aTnE1yOMkpcSgIOx1NciTJLMlBcSgIOx2au94Qh4KAgrCrA/pSknNJDow5Hm97QTKwVZCLbd9222bbe21XpGOCTL0cK0kuJTkxt7w3yVqSKxJSkKk7luTqN/kNSZaTnBGPgkzd9SQn8/2XCLOxJCyIfSL47e3VkySXxy3Vj7yWkgkyyXNH28e/KMeHJC+lxRQLcrftRn/u1fj4FxNkMsVYansjybUk+78uJ/mY5FmSzbm1NxJjagVZbvt8bkrM2q6PW67TbZ/OvQe5IzGH9En3ZZwSN4dheDcW6MHcueOFiBaLH6Z2scVKcjtbn5V8TvJoGIb7kgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAf+MLY8y7iYFLHuwAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAvhJREFUeNrt3btqVUEUBuA13iBgY6dokSZWYmMt2Nn7BKl8AsHKMmCeQIiFtvoKFmqRQsTGxhsBEQzEJqioMcnJssiOHPQk8dyQPfv74EAuMCGL+bNm9t4nEwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABdV5SAf5WZc78nTinvVISuB2I+M59k5mpmfsvMn5m5mZm95rWdmS/7gwOd6BSZ+SAz15oQHGYnM19l5rzq0YWAPMvMjRzeWmYuqSC1BuNmZq43HWFU6ypJrcuqDzm+Xk17kiOmBo3ZiDi3X36GnFMLykltHeTpARvwYX3SQajNhQFf64041kkBoar9R0ScGvCtzRjtZvIJAaEm1wcEYTsiZkYc76iAUJOrAzblYz2GVMtNQwEhImJuCl1AQKhi/zE/YM8wiYdYL9dQH0/zCshqRJyZ0vDn2/7Urw7S7XDMRcTpKf6IWUss2mxhyquIswJCm11RAgFhf9O+4/1RQGiz45Pe1vzx+fu2F8hVrG5v0nvT/CNZSmn9/NJBuq0M0Q3G7SYCAn02BIQ2L68Oe9ffuMuj5wJCm12b8vj3BIQ2uzTNBhURywJCm11sJnLG7hujJul7Lf95UUC6rUTETkQcm/C4K7UUSEA6vldvQjLJedCLiBsCQtut9XWRSXpRSnkkIPC37Yi4U9MvJCBMdO9RSrkvINS0xNq7kjWurYi4XVuRBMQmfe9K1jh2IuJWbd1DQChNSL6OOc7bUspijQUSkO763Pfxj2aDPWoXWqy1SALSXcsR8aWZAzNNSEYJx5sal1YQmfm478Cc3gjngNxVRboQki8jHHEgHHQiIHPNmYSbQ4TjocrRtaAsNcc9H7TU2nbkMzrK7mulLyxbmfladQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA/+kX8LLTex9Q0nAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAqVJREFUeNrt2TGLHlUUBuD3LpFYbK0iCouki4JgIoJbCP4B7SxiJekszA8QWwtb/4FNFBFFiVopClGIAZVgkyKBNBZCAtGNmv1eC+czn2F3kbCbgfg8MMwMTHE5d87cc+4kAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwlyEE97a260nWp9vrY4zrovLfHRKCe96xJC9O158mOSMkEsSqkbyZZCPJA0meSLKW5Om262OM90SJ/3OCHG97uX/bbrs1XS/afth2U5SsIHfzhTya5OEkzyS5L8lWkrNJzs1U8z+W5MGVPvNwkk73zyc53/bKGOOS2ZMgd6OceSvJ5pQch5LcSPJ2knMzDWsryfZKgnTlfDjJySRrbb9J8pXGnYNKjpfaft32z96yaPt72zem5JllRWv72TSWRf9t0fbmVHa93/YhM8lBvISbbb/tzv5o+1PbU203ZhrfK23P7pIkS9+3PWI22feyqu2ZqQHuDl/o5fli29dmXElOtP2iu7skQfa2JgR35PUkz+0Sv+XP1+0kjyZ5ZK5BjjHeSfJlkmvTeHrbIzeS6D806fv6Vd5I8lSS+/d47GaSn5OcnrFRX3o3yW9JXp4S5PGVMf4gQSTIQTiSWztDt7ua5IPp+HHurdQxxoW2vyb5OMnxJE9Oq9qVJJ/YwWLfV5Bph+rqSgO8aPtL28/bvjpXz8EBfGCE4I7LrBeSPDvF8EKS78YYH4mOBCH//CBcljHKFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHbyF/YSmR4SGmT4AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV+/rEhFxIIiDhmqkwVREUepYhEslLZCqw4ml35Bk4YkxcVRcC04+LFYdXBx1tXBVRAEP0CcHJ0UXaTE/yWFFjEeHPfj3b3H3TvA26gwxfBPAIpq6ql4TMjmVoXgK/wIYBD96BKZoSXSixm4jq97ePh6F+VZ7uf+HL1y3mCARyCeY5puEm8Qz2yaGud94jAriTLxOfG4ThckfuS65PAb56LNXp4Z1jOpeeIwsVDsYKmDWUlXiKeJI7KiUr4367DMeYuzUqmx1j35C0N5dSXNdZojiGMJCSQhQEINZVRgIkqrSoqBFO3HXPzDtj9JLolcZTByLKAKBaLtB/+D390ahalJJykUAwIvlvUxCgR3gWbdsr6PLat5AviegSu17a82gNlP0uttLXIE9G0DF9dtTdoDLneAoSdN1EVb8tH0FgrA+xl9Uw4YuAV61pzeWvs4fQAy1NXyDXBwCIwVKXvd5d3dnb39e6bV3w8Tx3KBQLEYWwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAwpJREFUeNrt3T+LXFUYB+Df2UQkSqISlRAIWTvRwiIYEqJFKouQRkTwM+SLpEwTy7TB2iK1aKH2YhFIIhIIhAVj1oTsn3kt7h3m7t1ZBNvzPDDszkx1Lu9vz3nPnjuTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwf7QeB11Vm0k2x6ePWmuPlAKsAnKjqn6vqodVdbOqLrgqsArI7araq6pFVb2qqrtVdd2VYe54p+M+keTY+PtrSb5OcraqzrXWvlUWLG10Ou6tJC+TLJLU2It9nuTLsT+BrgOyk+TVGJKNMSAtyadJvlIW9B6Q7SRvr3n9VJJvqkpI6Dogu0meJnlzzXufJLliqUXPAfkryckj3lskuXZEeBCQLnyQYfdqrjLsbm0pDZJ+t3m/yGqbd2p5suBZkj+UB93NIFX18TiDzJdV05CcS3JeedDjEutyDu5g7c4CkjEcZ5UHPQbkag4e0twfH1N7SoNeA/LhLCDrepFfk9xXHnTVpFfVmSTvTl8a/0hMQ/IiyR1H4OlxBrmY5J1Zc95mM8pvSX5WGvQYkI8ynOSdziDz3uOe2YNeA/LebLbYyMEdrJ0kPykLeg3IGzl8m/G0/3imOafngJyYBWQelueWV/QckLfWhKKNvcj+2KBDtwF5/YhwtAxnr+4qCQRkZT+rbd4nSe4pCXoOyNQ/Ge4LqfHxsrW2rSToOSAvZg37cvyLDLfhQvczSE3GfmpcXm0kOa0cMIMcbtKXP3eVA70H5HEOHy9ZNutPlQO9B+SXDP8tn88ge0l+VA70HpAfMmznzgOyyPoPcUBAurKd5Ls1/cbxJH8qB7pXVZvjVx9MPaiqz1wdGEJyq6q2q+rvqtqpqjuuCuv0+g1TF5K8n+RSkodJtlpr3ysHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA//AvL7PBruluyaUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/lineart.58993160.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.7fdc069a.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.c35fe11b.png\";","module.exports = __webpack_public_path__ + \"static/media/lineart.3456d47e.png\";","module.exports = __webpack_public_path__ + \"static/media/save_alt-black-18dp.0bb6882f.svg\";"],"sourceRoot":""}